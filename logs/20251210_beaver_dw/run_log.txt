--- Log Session Started at 2025-12-10 15:57:13 ---

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What are the subject titles, their material titles, ISBN numbers, new shelf prices, and total costs of new materials for each subject title, sorted by individual item prices in ascending order?

(Hints: Schema Mapping Hints:
- 'subject titles' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE
- 'material titles' is related to TIP_MATERIAL.TITLE
- 'ISBN numbers' is related to TIP_MATERIAL.ISBN
- 'new shelf prices' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'cost of new materials' is related to TIP_MATERIAL.NEW_SHELF_PRICE

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_SUBJECT_OFFERED.SUBJECT_ID = TIP_DETAIL.SUBJECT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QRjCsWHPv3avCFIgLIa1CDcNjI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    tso.SUBJECT_TITLE,\n    tm.TITLE AS MATERIAL_TITLE,\n    tm.ISBN,\n    tm.NEW_SHELF_PRICE,\n    tm.NEW_SHELF_PRICE AS TOTAL_COST\nFROM \n    TIP_SUBJECT_OFFERED tso\nJOIN \n    TIP_DETAIL td ON tso.SUBJECT_ID = td.SUBJECT_ID\nJOIN \n    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY\nORDER BY \n    tm.NEW_SHELF_PRICE ASC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349839, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=106, prompt_tokens=1423, total_tokens=1529, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=106, prompt_tokens=1423, total_tokens=1529, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    tso.SUBJECT_TITLE,
    tm.TITLE AS MATERIAL_TITLE,
    tm.ISBN,
    tm.NEW_SHELF_PRICE,
    tm.NEW_SHELF_PRICE AS TOTAL_COST
FROM 
    TIP_SUBJECT_OFFERED tso
JOIN 
    TIP_DETAIL td ON tso.SUBJECT_ID = td.SUBJECT_ID
JOIN 
    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY
ORDER BY 
    tm.NEW_SHELF_PRICE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1423, 106
TOTAL                  : 1529, 1423, 106
AVG                    : 1529.00, 1423.00, 106.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
What is the room, floor, building key, building street address, city, state, and postal code of Professor Summer Haynes's office?

(Hints: Schema Mapping Hints:
- 'room' is related to FAC_ROOMS.ROOM
- 'floor' is related to FAC_ROOMS.FLOOR
- 'building key' is related to FAC_BUILDING_ADDRESS.BUILDING_KEY
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'postal code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'Professor Summer Haynes' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'office' is related to EMPLOYEE_DIRECTORY.OFFICE_LOCATION

Join Information: (EMPLOYEE_DIRECTORY.OFFICE_LOCATION = FAC_ROOMS.FAC_ROOM_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QRQI9X6tcOH3QGTFUDCNor3M6W', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    fr.ROOM, \n    fr.FLOOR, \n    fr.BUILDING_KEY, \n    b.BUILDING_STREET_ADDRESS, \n    fba.CITY, \n    fba.STATE, \n    fba.POSTAL_CODE \nFROM \n    EMPLOYEE_DIRECTORY ed \nJOIN \n    FAC_ROOMS fr ON ed.OFFICE_LOCATION = fr.FAC_ROOM_KEY \nJOIN \n    FAC_BUILDING_ADDRESS fba ON fr.BUILDING_KEY = fba.BUILDING_KEY \nJOIN \n    BUILDINGS b ON b.BUILDING_KEY = fba.BUILDING_KEY \nWHERE \n    ed.FULL_NAME = 'Summer Haynes';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349839, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=141, prompt_tokens=1903, total_tokens=2044, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=141, prompt_tokens=1903, total_tokens=2044, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    fr.ROOM, 
    fr.FLOOR, 
    fr.BUILDING_KEY, 
    b.BUILDING_STREET_ADDRESS, 
    fba.CITY, 
    fba.STATE, 
    fba.POSTAL_CODE 
FROM 
    EMPLOYEE_DIRECTORY ed 
JOIN 
    FAC_ROOMS fr ON ed.OFFICE_LOCATION = fr.FAC_ROOM_KEY 
JOIN 
    FAC_BUILDING_ADDRESS fba ON fr.BUILDING_KEY = fba.BUILDING_KEY 
JOIN 
    BUILDINGS b ON b.BUILDING_KEY = fba.BUILDING_KEY 
WHERE 
    ed.FULL_NAME = 'Summer Haynes';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1903, 141
TOTAL                  : 3573, 3326, 247
AVG                    : 1786.50, 1663.00, 123.50
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the unique course instructor names, course titles, and the amount of material for each course instructor key and the key of subject offered.

(Hints: Schema Mapping Hints:
- 'course instructor names' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'course titles' is related to LIBRARY_SUBJECT_OFFERED.SUBJECT_TITLE
- 'amount of material' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN
- 'course instructor key' is related to LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY
- 'key of subject offered' is related to LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY

Join Information: (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QRkkTUHj56L8inwYCkl3iQNtfR', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    DISTINCT LCI.INSTRUCTOR_NAME,\n    LSO.SUBJECT_TITLE,\n    COUNT(LRCD.CATALOG_ISBN) AS material_count\nFROM \n    LIBRARY_COURSE_INSTRUCTOR LCI\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    LIBRARY_SUBJECT_OFFERED LSO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG LRCD ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRCD.LIBRARY_RESERVE_CATALOG_KEY\nGROUP BY \n    LCI.INSTRUCTOR_NAME,\n    LSO.SUBJECT_TITLE;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349839, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=174, prompt_tokens=1889, total_tokens=2063, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=174, prompt_tokens=1889, total_tokens=2063, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    DISTINCT LCI.INSTRUCTOR_NAME,
    LSO.SUBJECT_TITLE,
    COUNT(LRCD.CATALOG_ISBN) AS material_count
FROM 
    LIBRARY_COURSE_INSTRUCTOR LCI
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    LIBRARY_SUBJECT_OFFERED LSO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG LRCD ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRCD.LIBRARY_RESERVE_CATALOG_KEY
GROUP BY 
    LCI.INSTRUCTOR_NAME,
    LSO.SUBJECT_TITLE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1889, 174
TOTAL                  : 5636, 5215, 421
AVG                    : 1878.67, 1738.33, 140.33
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_PERSON
[
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(PERSON_ROLE:VARCHAR2, Examples: ['Activity leader', 'Session leader', 'Contact person']),
(PERSON_MIT_AFFILIATION:VARCHAR2, Examples: ['Staff', 'Senior Lecturer', 'Other MIT']),
(PERSON_NAME:VARCHAR2, Examples: ['Willie Hewitt', 'Junaid Ochoa', 'Rufus Armstrong']),
(PERSON_LOCATION:VARCHAR2, Examples: ['Register for Zoom ID', 'NE48', 'E15-413']),
(PERSON_EMAIL:VARCHAR2, Examples: ['anac@worker.com', 'ec@worker.com', 'pv@worker.com']),
(PERSON_ORGANIZATION:VARCHAR2),
(PERSON_TITLE:VARCHAR2),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Show the unique activity titles, locations, term start date, and supervisor name for all independent activities, sorted by the ascending order of start date.

(Hints: Schema Mapping Hints:
- 'activity titles' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'locations' is related to IAP_SUBJECT_SESSION.SESSION_LOCATION
- 'term start date' is related to ACADEMIC_TERMS_ALL.TERM_START_DATE
- 'supervisor name' is related to IAP_SUBJECT_PERSON.PERSON_NAME, IAP_SUBJECT_PERSON.PERSON_ROLE

Join Information: (IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_PERSON_KEY), (ACADEMIC_TERMS_ALL.TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QRmxg8NxXmQYAii1dpKvVgkd17', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT DISTINCT \n    IAD.ACTIVITY_TITLE, \n    ISS.SESSION_LOCATION, \n    ATA.TERM_START_DATE, \n    ISP.PERSON_NAME\nFROM \n    IAP_SUBJECT_DETAIL IAD\nJOIN \n    IAP_SUBJECT_SESSION ISS ON IAD.IAP_SUBJECT_SESSION_KEY = ISS.IAP_SUBJECT_SESSION_KEY\nJOIN \n    ACADEMIC_TERMS_ALL ATA ON IAD.TERM_CODE = ATA.TERM_CODE\nJOIN \n    IAP_SUBJECT_PERSON ISP ON IAD.IAP_SUBJECT_PERSON_KEY = ISP.IAP_SUBJECT_PERSON_KEY\nWHERE \n    ISP.PERSON_ROLE = 'Activity leader'\nORDER BY \n    ATA.TERM_START_DATE ASC;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349839, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=148, prompt_tokens=2262, total_tokens=2410, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=148, prompt_tokens=2262, total_tokens=2410, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT DISTINCT 
    IAD.ACTIVITY_TITLE, 
    ISS.SESSION_LOCATION, 
    ATA.TERM_START_DATE, 
    ISP.PERSON_NAME
FROM 
    IAP_SUBJECT_DETAIL IAD
JOIN 
    IAP_SUBJECT_SESSION ISS ON IAD.IAP_SUBJECT_SESSION_KEY = ISS.IAP_SUBJECT_SESSION_KEY
JOIN 
    ACADEMIC_TERMS_ALL ATA ON IAD.TERM_CODE = ATA.TERM_CODE
JOIN 
    IAP_SUBJECT_PERSON ISP ON IAD.IAP_SUBJECT_PERSON_KEY = ISP.IAP_SUBJECT_PERSON_KEY
WHERE 
    ISP.PERSON_ROLE = 'Activity leader'
ORDER BY 
    ATA.TERM_START_DATE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2262, 148
TOTAL                  : 8046, 7477, 569
AVG                    : 2011.50, 1869.25, 142.25
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FCLT_BUILDING_HIST
[
(FCLT_BUILDING_HIST_KEY:VARCHAR2, Examples: ['14S-201505', '46-201505', 'E14-201505']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['201505', '201506', '201507']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['14S', '46', 'E14']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['14', 'W61', 'W70']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY', 'MACGREGOR HOUSE', 'NEW HOUSE']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library', 'Frank S MacGregor House', 'New West Campus Houses']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library (South Wing)', 'Brain & Cognitive Sciences Complex', 'Building E14']),
(EXT_GROSS_AREA:NUMBER, Examples: [48622.2, 418663.0, 173875.0]),
(ASSIGNABLE_AREA:NUMBER, Examples: [34500.5, 218519.0, 73792.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [10286.5, 152699.0, 83752.7]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHWEST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['(NULL)', 'UGBA3', 'UGBI2']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['136.4', '82.8', '88.3']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3623, 42.3605, 42.3615]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0916, -71.0873, -71.0879]),
(EASTING_X_SPCS:NUMBER, Examples: [766530.0, 767698.0, 767547.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2957330.0, 2956650.0, 2957020.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['14S', '46', 'E14']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['SEELY G. MUDD', 'HORACE SAYFORD FORD JR.', 'SEBASTIAN S. KRESGE']),
(BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY (S)', 'BCSC', 'BUILDING E14']),
(DATE_BUILT:VARCHAR2, Examples: ['04/25/2003', '12/31/1932', '12/31/1920']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['05/01/1961', '12/31/1955', '12/31/1939']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['09/01/2005', '03/06/1975', '10/01/1964']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-DEC-14', '01-JAN-15', '01-FEB-15']),
(NUM_OF_ROOMS:NUMBER, Examples: [118, 1403, 341])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the long names of buildings constructed before 1950 that have more than 100 employees, the built year of the building, and number of employees.

(Hints: Schema Mapping Hints:
- 'long names of buildings' is related to FCLT_BUILDING_HIST.BUILDING_NAME_LONG
- 'built year' is related to FCLT_BUILDING_HIST.DATE_BUILT
- 'employees' is related to EMPLOYEE_DIRECTORY.MIT_ID

Join Information: (EMPLOYEE_DIRECTORY.OFFICE_LOCATION = FCLT_ROOMS.BUILDING_ROOM))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QR2nX88ZrHXMeUvRJKNLIhw8zG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT FCLT_BUILDING_HIST.BUILDING_NAME_LONG, \n       FCLT_BUILDING_HIST.DATE_BUILT, \n       COUNT(EMPLOYEE_DIRECTORY.MIT_ID) AS number_of_employees\nFROM FCLT_BUILDING_HIST\nJOIN FCLT_ROOMS ON FCLT_BUILDING_HIST.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY\nJOIN EMPLOYEE_DIRECTORY ON FCLT_ROOMS.BUILDING_ROOM = EMPLOYEE_DIRECTORY.OFFICE_LOCATION\nWHERE FCLT_BUILDING_HIST.DATE_BUILT < '01-JAN-1950'\nGROUP BY FCLT_BUILDING_HIST.BUILDING_NAME_LONG, FCLT_BUILDING_HIST.DATE_BUILT\nHAVING COUNT(EMPLOYEE_DIRECTORY.MIT_ID) > 100;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349839, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=174, prompt_tokens=2265, total_tokens=2439, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=174, prompt_tokens=2265, total_tokens=2439, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT FCLT_BUILDING_HIST.BUILDING_NAME_LONG, 
       FCLT_BUILDING_HIST.DATE_BUILT, 
       COUNT(EMPLOYEE_DIRECTORY.MIT_ID) AS number_of_employees
FROM FCLT_BUILDING_HIST
JOIN FCLT_ROOMS ON FCLT_BUILDING_HIST.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY
JOIN EMPLOYEE_DIRECTORY ON FCLT_ROOMS.BUILDING_ROOM = EMPLOYEE_DIRECTORY.OFFICE_LOCATION
WHERE FCLT_BUILDING_HIST.DATE_BUILT < '01-JAN-1950'
GROUP BY FCLT_BUILDING_HIST.BUILDING_NAME_LONG, FCLT_BUILDING_HIST.DATE_BUILT
HAVING COUNT(EMPLOYEE_DIRECTORY.MIT_ID) > 100;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2265, 174
TOTAL                  : 10485, 9742, 743
AVG                    : 2097.00, 1948.40, 148.60
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
List the unique term code, subject title, room, floor, building key, building street address, city, state, and postal code, formats, and number of enrolled students for all courses with more than 300 attendees.

(Hints: Schema Mapping Hints:
- 'term code' is related to SUBJECT_OFFERED.TERM_CODE
- 'subject title' is related to SUBJECT_OFFERED.SUBJECT_TITLE
- 'room' is related to FCLT_ROOMS.ROOM
- 'floor' is related to FCLT_ROOMS.FLOOR
- 'building key' is related to BUILDINGS.BUILDING_KEY
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FCLT_BUILDING_ADDRESS.CITY
- 'state' is related to FCLT_BUILDING_ADDRESS.STATE
- 'postal code' is related to FCLT_BUILDING_ADDRESS.POSTAL_CODE
- 'formats' is related to SUBJECT_OFFERED.FORM_TYPE
- 'number of enrolled students' is related to SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'attendees' is related to SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (FCLT_ROOMS.FCLT_ROOM_KEY = SUBJECT_OFFERED.MEET_PLACE), (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QQ5py63ReAQbjfUON81b8Wl3tY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT DISTINCT \n    SO.TERM_CODE, \n    SO.SUBJECT_TITLE, \n    FR.ROOM, \n    FR.FLOOR, \n    FR.FCLT_BUILDING_KEY, \n    BA.BUILDING_STREET_ADDRESS, \n    BA.CITY, \n    BA.STATE, \n    BA.POSTAL_CODE, \n    SO.FORM_TYPE, \n    SO.NUM_ENROLLED_STUDENTS\nFROM SUBJECT_OFFERED SO\nJOIN FCLT_ROOMS FR ON SO.MEET_PLACE = FR.FCLT_ROOM_KEY\nJOIN FCLT_BUILDING_ADDRESS BA ON FR.FCLT_BUILDING_KEY = BA.FCLT_BUILDING_KEY\nJOIN BUILDINGS B ON FR.FCLT_BUILDING_KEY = B.BUILDING_KEY\nWHERE SO.NUM_ENROLLED_STUDENTS > 300;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349838, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=174, prompt_tokens=2891, total_tokens=3065, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=174, prompt_tokens=2891, total_tokens=3065, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT DISTINCT 
    SO.TERM_CODE, 
    SO.SUBJECT_TITLE, 
    FR.ROOM, 
    FR.FLOOR, 
    FR.FCLT_BUILDING_KEY, 
    BA.BUILDING_STREET_ADDRESS, 
    BA.CITY, 
    BA.STATE, 
    BA.POSTAL_CODE, 
    SO.FORM_TYPE, 
    SO.NUM_ENROLLED_STUDENTS
FROM SUBJECT_OFFERED SO
JOIN FCLT_ROOMS FR ON SO.MEET_PLACE = FR.FCLT_ROOM_KEY
JOIN FCLT_BUILDING_ADDRESS BA ON FR.FCLT_BUILDING_KEY = BA.FCLT_BUILDING_KEY
JOIN BUILDINGS B ON FR.FCLT_BUILDING_KEY = B.BUILDING_KEY
WHERE SO.NUM_ENROLLED_STUDENTS > 300;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2891, 174
TOTAL                  : 13550, 12633, 917
AVG                    : 2258.33, 2105.50, 152.83
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORG_DLC_KEY
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MASTER_DEPT_HIERARCHY
[
(HIERARCHY_TYPE:VARCHAR2, Examples: ['Standard Hierarchy']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_CODE:VARCHAR2, Examples: ['D_DOF_CORE', 'D_DOF_RESERVE', 'D_DOF_RESIDENCE']),
(DLC_NAME:VARCHAR2, Examples: ['Facilities Building Core (hallways, stairs, etc.)', 'Facilities Provost Reserved', 'Facilities Residences']),
(MASTER_DEPT_HIER_LEVEL_1_CODE:VARCHAR2, Examples: ['D_ALL']),
(MASTER_DEPT_HIER_LEVEL_1_NAME:VARCHAR2, Examples: ['All Departments']),
(MASTER_DEPT_HIER_LEVEL_2_CODE:VARCHAR2, Examples: ['D_EXECVP_AREA', 'D_PROVOST_AREA', 'D_PRES_AREA']),
(MASTER_DEPT_HIER_LEVEL_2_NAME:VARCHAR2, Examples: ['Executive Vice President's Area', 'Provost Area', 'President's area']),
(MASTER_DEPT_HIER_LEVEL_3_CODE:VARCHAR2, Examples: ['D_FINANCE_AREA', 'D_TREAS_AREA', 'D_SC_ENVP']),
(MASTER_DEPT_HIER_LEVEL_3_NAME:VARCHAR2, Examples: ['VP Finance Area', 'Treasurer's Area', 'Senior Council and Environmental Programs']),
(MASTER_DEPT_HIER_LEVEL_4_CODE:VARCHAR2, Examples: ['D_SOURCING_AREA', 'D_OSATT_AREA']),
(MASTER_DEPT_HIER_LEVEL_4_NAME:VARCHAR2, Examples: ['Sourcing Area', 'Office of Strategic Alliances & Tech Transfer Area']),
(MASTER_DEPT_HIER_LEVEL_5_CODE:VARCHAR2),
(MASTER_DEPT_HIER_LEVEL_5_NAME:VARCHAR2)
]

### Question ###
What is the current building key, building street address, city, state, and postal code of the history department?

(Hints: Schema Mapping Hints:
- 'building key' is related to FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FCLT_BUILDING_ADDRESS.CITY
- 'state' is related to FCLT_BUILDING_ADDRESS.STATE
- 'postal code' is related to FCLT_BUILDING_ADDRESS.POSTAL_CODE
- 'history department' is related to MASTER_DEPT_HIERARCHY.DLC_NAME

Join Information: (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORG_DLC_KEY.FCLT_ORGANIZATION_KEY), (FCLT_ORG_DLC_KEY.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY), (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QRfYSKF47TLk1TqWZMJoHbpAmh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    BUILDINGS.BUILDING_KEY, \n    BUILDINGS.BUILDING_STREET_ADDRESS, \n    FCLT_BUILDING_ADDRESS.CITY, \n    FCLT_BUILDING_ADDRESS.STATE, \n    FCLT_BUILDING_ADDRESS.POSTAL_CODE \nFROM \n    BUILDINGS \nJOIN \n    FCLT_BUILDING_ADDRESS ON BUILDINGS.BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY \nJOIN \n    FCLT_ROOMS ON FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY \nJOIN \n    FCLT_ORG_DLC_KEY ON FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORG_DLC_KEY.FCLT_ORGANIZATION_KEY \nJOIN \n    MASTER_DEPT_HIERARCHY ON FCLT_ORG_DLC_KEY.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY \nWHERE \n    MASTER_DEPT_HIERARCHY.DLC_NAME = 'History Department';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349839, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=221, prompt_tokens=1827, total_tokens=2048, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=221, prompt_tokens=1827, total_tokens=2048, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    BUILDINGS.BUILDING_KEY, 
    BUILDINGS.BUILDING_STREET_ADDRESS, 
    FCLT_BUILDING_ADDRESS.CITY, 
    FCLT_BUILDING_ADDRESS.STATE, 
    FCLT_BUILDING_ADDRESS.POSTAL_CODE 
FROM 
    BUILDINGS 
JOIN 
    FCLT_BUILDING_ADDRESS ON BUILDINGS.BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY 
JOIN 
    FCLT_ROOMS ON FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY 
JOIN 
    FCLT_ORG_DLC_KEY ON FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORG_DLC_KEY.FCLT_ORGANIZATION_KEY 
JOIN 
    MASTER_DEPT_HIERARCHY ON FCLT_ORG_DLC_KEY.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY 
WHERE 
    MASTER_DEPT_HIERARCHY.DLC_NAME = 'History Department';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1827, 221
TOTAL                  : 15598, 14460, 1138
AVG                    : 2228.29, 2065.71, 162.57
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the unique full room names, their corresponding building names, street addresses, cities, states, postal codes, and building heights for rooms associated with subjects that Computer Science students can enroll in.

(Hints: Schema Mapping Hints:
- 'full room names' is related to FCLT_ROOMS.ROOM_FULL_NAME
- 'building names' is related to BUILDINGS.BUILDING_NAME
- 'street addresses' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'cities' is related to FCLT_BUILDING_ADDRESS.CITY
- 'states' is related to FCLT_BUILDING_ADDRESS.STATE
- 'postal codes' is related to FCLT_BUILDING_ADDRESS.POSTAL_CODE
- 'building heights' is related to FCLT_BUILDING.BUILDING_HEIGHT
- 'Computer Science' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FCLT_ROOMS.FCLT_ROOM_KEY), (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QRqEKBVDQV7B8mijsL0FnhHVSf', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT DISTINCT \n    FCLT_ROOMS.ROOM_FULL_NAME, \n    BUILDINGS.BUILDING_NAME, \n    BUILDINGS.BUILDING_STREET_ADDRESS, \n    FCLT_BUILDING_ADDRESS.CITY, \n    FCLT_BUILDING_ADDRESS.STATE, \n    FCLT_BUILDING_ADDRESS.POSTAL_CODE, \n    FCLT_BUILDING.BUILDING_HEIGHT\nFROM \n    FCLT_ROOMS\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED ON FCLT_ROOMS.FCLT_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE\nJOIN \n    FCLT_BUILDING ON FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY\nJOIN \n    BUILDINGS ON FCLT_BUILDING.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY\nJOIN \n    FCLT_BUILDING_ADDRESS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY\nWHERE \n    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME = 'Electrical Eng & Computer Sci';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349839, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=245, prompt_tokens=4205, total_tokens=4450, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=245, prompt_tokens=4205, total_tokens=4450, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT DISTINCT 
    FCLT_ROOMS.ROOM_FULL_NAME, 
    BUILDINGS.BUILDING_NAME, 
    BUILDINGS.BUILDING_STREET_ADDRESS, 
    FCLT_BUILDING_ADDRESS.CITY, 
    FCLT_BUILDING_ADDRESS.STATE, 
    FCLT_BUILDING_ADDRESS.POSTAL_CODE, 
    FCLT_BUILDING.BUILDING_HEIGHT
FROM 
    FCLT_ROOMS
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED ON FCLT_ROOMS.FCLT_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE
JOIN 
    FCLT_BUILDING ON FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY
JOIN 
    BUILDINGS ON FCLT_BUILDING.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY
JOIN 
    FCLT_BUILDING_ADDRESS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY
WHERE 
    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME = 'Electrical Eng & Computer Sci';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4205, 245
TOTAL                  : 20048, 18665, 1383
AVG                    : 2506.00, 2333.12, 172.88
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]

### Question ###
List the name and floor of the building with the largest floor number.

(Hints: Schema Mapping Hints:
- 'name' is related to FAC_BUILDING.BUILDING_NAME
- 'floor' is related to FAC_FLOOR.FLOOR

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_FLOOR.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QTxEfCFlbl1ua9D9dkrjOkcXH9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT fb.BUILDING_NAME, ff.FLOOR \nFROM FAC_BUILDING fb \nJOIN FAC_FLOOR ff ON fb.FAC_BUILDING_KEY = ff.BUILDING_KEY \nWHERE ff.FLOOR = (SELECT MAX(FLOOR) FROM FAC_FLOOR) \nLIMIT 1;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349841, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=66, prompt_tokens=1372, total_tokens=1438, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=66, prompt_tokens=1372, total_tokens=1438, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT fb.BUILDING_NAME, ff.FLOOR 
FROM FAC_BUILDING fb 
JOIN FAC_FLOOR ff ON fb.FAC_BUILDING_KEY = ff.BUILDING_KEY 
WHERE ff.FLOOR = (SELECT MAX(FLOOR) FROM FAC_FLOOR) 
LIMIT 1;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1372, 66
TOTAL                  : 21486, 20037, 1449
AVG                    : 2387.33, 2226.33, 161.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the name of the building that accomodates the most students, and how many students does it accomodate?

(Hints: Schema Mapping Hints:
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME
- 'students' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (FCLT_ROOMS.BUILDING_ROOM = MIT_STUDENT_DIRECTORY.OFFICE_LOCATION), (FCLT_ROOMS.BUILDING_ROOM = MIT_STUDENT_DIRECTORY.OFFICE_LOCATION))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QT29ZA9vWSwYo4AcJeNw9JGfY2', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT FCLT_BUILDING.BUILDING_NAME, COUNT(MIT_STUDENT_DIRECTORY.FULL_NAME) AS student_count\nFROM FCLT_BUILDING\nJOIN FCLT_ROOMS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY\nJOIN MIT_STUDENT_DIRECTORY ON FCLT_ROOMS.BUILDING_ROOM = MIT_STUDENT_DIRECTORY.OFFICE_LOCATION\nGROUP BY FCLT_BUILDING.BUILDING_NAME\nORDER BY student_count DESC\nLIMIT 1;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349841, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=114, prompt_tokens=1901, total_tokens=2015, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=114, prompt_tokens=1901, total_tokens=2015, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT FCLT_BUILDING.BUILDING_NAME, COUNT(MIT_STUDENT_DIRECTORY.FULL_NAME) AS student_count
FROM FCLT_BUILDING
JOIN FCLT_ROOMS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY
JOIN MIT_STUDENT_DIRECTORY ON FCLT_ROOMS.BUILDING_ROOM = MIT_STUDENT_DIRECTORY.OFFICE_LOCATION
GROUP BY FCLT_BUILDING.BUILDING_NAME
ORDER BY student_count DESC
LIMIT 1;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1901, 114
TOTAL                  : 23501, 21938, 1563
AVG                    : 2350.10, 2193.80, 156.30
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: CIS_COURSE_CATALOG
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2003', '2002', '2007']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['097', '098', '090']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['N', 'Y', 'S']),
(DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:DATE, Examples: ['Electrical Eng & Computer Sci', 'Architecture', 'Chemistry']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1991FA', '1995FA', '1989FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['Y', 'N']),
(LECTURE_UNITS:VARCHAR2, Examples: [0, 3, 1]),
(LAB_UNITS:VARCHAR2, Examples: [0, 12, 4]),
(PREPARATION_UNITS:VARCHAR2, Examples: [0, 9, 5]),
(TOTAL_UNITS:VARCHAR2, Examples: [0, 12, 6]),
(DESIGN_UNITS:VARCHAR2, Examples: [0, 6, 8]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['R', 'J', 'N']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Can be repeated for credit', 'Continuing and Repeatable', 'Not repeatable for credit']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', 'H-LEVEL Grad Credit (except for Course 18 students)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['HD1', 'HE', 'HD5']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS-D, Category 1', 'HASS Elective', 'HASS-D, Category 5']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:NUMBER, Examples: ['RESH', 'NTRN', 'COOP']),
(TUITION_ATTRIBUTE_DESC:NUMBER, Examples: ['Pre-thesis Research Subject', 'Internship', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:NUMBER, Examples: ['WRT2', 'WRT1']),
(WRITE_REQ_ATTRIBUTE_DESC:NUMBER, Examples: ['Writing Requirement, Phase II', 'Writing Requirement, Phase I']),
(SUPERVISOR_ATTRIBUTE:NUMBER, Examples: ['UROP', 'THG', 'THU']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['UROP subject', 'Grad Thesis', 'Undergrad Thesis']),
(PREREQUISITES:VARCHAR2, Examples: ['Permission of instructor', '10.213', '12.120 and 12.103, or permission of instructor']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Crystal structures of mantle and core minerals, elastic and thermodynamic properties of materials at high pressure-temperature,', 'Investigates social conflict and distributional disputes in the public sector. While theoretical aspects of conflict are consid', 'Presents a framework for current landscape ecological theory, structured to encourage application in physical planning of lands']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.285J, 11.482J', '3.57J', '1.232J, 15.054J, 16.71J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE', '1.EPW, 3.EPW, 6.EPW, 10.EPW, 16.EPW, 20.EPW, 22.EPW', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['2.729J, EC.729J', 'EC.718J, WGS.277J', '21A.136J, 21G.026J']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['15.511, 15.515', '15.024', '15.414']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(STATUS_CHANGE:VARCHAR2, Examples: ['(2016: New number: 21G.110)', '(2016: New number: 21G.113)', '(2016: New number: 21G.142)']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['02-SEP-01', '12-JAN-06', '16-MAY-05']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.005']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HS', 'HA', 'HH']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Social Sciences', 'HASS Arts', 'HASS Humanities']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'Second Half Term Subject', 'First Half Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Asia', 'United States of America']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['China', 'Brazil|Uruguay|Vietnam|Russia|Australia', 'United States of America']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m2c.html', 'http://student.mit.edu/catalog/m3b.html'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each building key, what is the building name and the number of courses offered by the Center for International Studies?

(Hints: Schema Mapping Hints:
- 'building key' is related to FCLT_BUILDING.FCLT_BUILDING_KEY
- 'building name' is related to FCLT_BUILDING.BUILDING_NAME
- 'courses offered by the Center for International Studies' is related to CIS_COURSE_CATALOG.SUBJECT_ID

Join Information: (CIS_COURSE_CATALOG.SUBJECT_ID = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FCLT_ROOMS.FCLT_ROOM_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QTBo5fAVsafhNqjHCEzTN5elMb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    FCLT_BUILDING.FCLT_BUILDING_KEY, \n    FCLT_BUILDING.BUILDING_NAME, \n    COUNT(COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS number_of_courses\nFROM \n    FCLT_BUILDING\nJOIN \n    FCLT_ROOMS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED ON FCLT_ROOMS.FCLT_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE\nJOIN \n    CIS_COURSE_CATALOG ON COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID = CIS_COURSE_CATALOG.SUBJECT_ID\nWHERE \n    CIS_COURSE_CATALOG.DEPARTMENT_NAME = 'Center for International Studies'\nGROUP BY \n    FCLT_BUILDING.FCLT_BUILDING_KEY, \n    FCLT_BUILDING.BUILDING_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349841, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=212, prompt_tokens=5193, total_tokens=5405, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=212, prompt_tokens=5193, total_tokens=5405, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    FCLT_BUILDING.FCLT_BUILDING_KEY, 
    FCLT_BUILDING.BUILDING_NAME, 
    COUNT(COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS number_of_courses
FROM 
    FCLT_BUILDING
JOIN 
    FCLT_ROOMS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED ON FCLT_ROOMS.FCLT_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE
JOIN 
    CIS_COURSE_CATALOG ON COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID = CIS_COURSE_CATALOG.SUBJECT_ID
WHERE 
    CIS_COURSE_CATALOG.DEPARTMENT_NAME = 'Center for International Studies'
GROUP BY 
    FCLT_BUILDING.FCLT_BUILDING_KEY, 
    FCLT_BUILDING.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5193, 212
TOTAL                  : 28906, 27131, 1775
AVG                    : 2627.82, 2466.45, 161.36
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIME_DAY
[
(FISCAL_PERIOD:VARCHAR2, Examples: ['195007', '195008', '195009']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1975 Period 6', 'FY 1987 Period 11', 'FY 1983 Period 12']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['197412', '198705', '198306']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['December 1974', 'May 1987', 'June 1983']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1974', '1987', '1983']),
(START_DATE:DATE, Examples: ['01-DEC-74', '01-MAY-87', '01-JUN-83']),
(END_DATE:DATE, Examples: ['31-DEC-74', '31-MAY-87', '30-JUN-83']),
(CALENDAR_DATE:DATE, Examples: ['01-APR-00', '01-APR-01', '01-APR-02']),
(DAY_OF_WEEK:VARCHAR2, Examples: ['Friday   ', 'Wednesday', 'Sunday   ']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['2021', '2002', '1994']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 2020-2021', 'Aid Year 2001-2002', 'Aid year 1993-94']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(ACADEMIC_TERM_CODE:VARCHAR2, Examples: ['1951SP', '1951SU', '1952SP']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1986-1987', 'Summer Term 1983', 'Summer Term 2020'])
]

### Question ###
For each IAP category and academic year, list the category name, academic year, total fee collected, total number of IAP subjects, and the minimum and maximum enrollment.

(Hints: Schema Mapping Hints:
- 'category name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'academic year' is related to TIME_DAY.ACADEMIC_YEAR
- 'fee collected' is related to IAP_SUBJECT_DETAIL.FEE
- 'IAP subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY), (TIME_DAY.ACADEMIC_TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QTaoPd2iApp01VE46ZU4Ss41V2', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    isc.IAP_CATEGORY_NAME,\n    td.ACADEMIC_YEAR,\n    SUM(isd.FEE) AS total_fee_collected,\n    COUNT(isd.ACTIVITY_TITLE) AS total_number_of_IAP_subjects,\n    MIN(isd.MAX_ENROLLMENT) AS minimum_enrollment,\n    MAX(isd.MAX_ENROLLMENT) AS maximum_enrollment\nFROM \n    IAP_SUBJECT_DETAIL isd\nJOIN \n    IAP_SUBJECT_CATEGORY isc ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY\nJOIN \n    TIME_DAY td ON isd.TERM_CODE = td.ACADEMIC_TERM_CODE\nGROUP BY \n    isc.IAP_CATEGORY_NAME, td.ACADEMIC_YEAR;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349841, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=152, prompt_tokens=1683, total_tokens=1835, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=152, prompt_tokens=1683, total_tokens=1835, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    isc.IAP_CATEGORY_NAME,
    td.ACADEMIC_YEAR,
    SUM(isd.FEE) AS total_fee_collected,
    COUNT(isd.ACTIVITY_TITLE) AS total_number_of_IAP_subjects,
    MIN(isd.MAX_ENROLLMENT) AS minimum_enrollment,
    MAX(isd.MAX_ENROLLMENT) AS maximum_enrollment
FROM 
    IAP_SUBJECT_DETAIL isd
JOIN 
    IAP_SUBJECT_CATEGORY isc ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY
JOIN 
    TIME_DAY td ON isd.TERM_CODE = td.ACADEMIC_TERM_CODE
GROUP BY 
    isc.IAP_CATEGORY_NAME, td.ACADEMIC_YEAR;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1683, 152
TOTAL                  : 30741, 28814, 1927
AVG                    : 2561.75, 2401.17, 160.58
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_PERSON
[
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(PERSON_ROLE:VARCHAR2, Examples: ['Activity leader', 'Session leader', 'Contact person']),
(PERSON_MIT_AFFILIATION:VARCHAR2, Examples: ['Staff', 'Senior Lecturer', 'Other MIT']),
(PERSON_NAME:VARCHAR2, Examples: ['Willie Hewitt', 'Junaid Ochoa', 'Rufus Armstrong']),
(PERSON_LOCATION:VARCHAR2, Examples: ['Register for Zoom ID', 'NE48', 'E15-413']),
(PERSON_EMAIL:VARCHAR2, Examples: ['anac@worker.com', 'ec@worker.com', 'pv@worker.com']),
(PERSON_ORGANIZATION:VARCHAR2),
(PERSON_TITLE:VARCHAR2),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIME_DAY
[
(FISCAL_PERIOD:VARCHAR2, Examples: ['195007', '195008', '195009']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1975 Period 6', 'FY 1987 Period 11', 'FY 1983 Period 12']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['197412', '198705', '198306']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['December 1974', 'May 1987', 'June 1983']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1974', '1987', '1983']),
(START_DATE:DATE, Examples: ['01-DEC-74', '01-MAY-87', '01-JUN-83']),
(END_DATE:DATE, Examples: ['31-DEC-74', '31-MAY-87', '30-JUN-83']),
(CALENDAR_DATE:DATE, Examples: ['01-APR-00', '01-APR-01', '01-APR-02']),
(DAY_OF_WEEK:VARCHAR2, Examples: ['Friday   ', 'Wednesday', 'Sunday   ']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['2021', '2002', '1994']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 2020-2021', 'Aid Year 2001-2002', 'Aid year 1993-94']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(ACADEMIC_TERM_CODE:VARCHAR2, Examples: ['1951SP', '1951SU', '1952SP']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1986-1987', 'Summer Term 1983', 'Summer Term 2020'])
]

### Question ###
What are the individual's email and name, academic year, total number of IAP subjects, the minimum and maximum fees, and the total course enrollment for each individual and academic year?

(Hints: Schema Mapping Hints:
- 'email' is related to IAP_SUBJECT_PERSON.PERSON_EMAIL
- 'name' is related to IAP_SUBJECT_PERSON.PERSON_NAME
- 'academic year' is related to TIME_DAY.ACADEMIC_YEAR
- 'IAP subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'fees' is related to IAP_SUBJECT_DETAIL.FEE
- 'course enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_PERSON_KEY = IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY), (TIME_DAY.ACADEMIC_TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QU4ZN9labSyhMglS4I0vqYlfv4', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    p.PERSON_EMAIL, \n    p.PERSON_NAME, \n    td.ACADEMIC_YEAR, \n    COUNT(DISTINCT d.ACTIVITY_TITLE) AS total_IAP_subjects, \n    MIN(d.FEE) AS min_fee, \n    MAX(d.FEE) AS max_fee, \n    SUM(d.MAX_ENROLLMENT) AS total_course_enrollment\nFROM \n    IAP_SUBJECT_PERSON p\nJOIN \n    IAP_SUBJECT_DETAIL d ON p.IAP_SUBJECT_PERSON_KEY = d.IAP_SUBJECT_PERSON_KEY\nJOIN \n    TIME_DAY td ON td.ACADEMIC_TERM_CODE = d.TERM_CODE\nGROUP BY \n    p.PERSON_EMAIL, \n    p.PERSON_NAME, \n    td.ACADEMIC_YEAR;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349842, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=165, prompt_tokens=1750, total_tokens=1915, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=165, prompt_tokens=1750, total_tokens=1915, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    p.PERSON_EMAIL, 
    p.PERSON_NAME, 
    td.ACADEMIC_YEAR, 
    COUNT(DISTINCT d.ACTIVITY_TITLE) AS total_IAP_subjects, 
    MIN(d.FEE) AS min_fee, 
    MAX(d.FEE) AS max_fee, 
    SUM(d.MAX_ENROLLMENT) AS total_course_enrollment
FROM 
    IAP_SUBJECT_PERSON p
JOIN 
    IAP_SUBJECT_DETAIL d ON p.IAP_SUBJECT_PERSON_KEY = d.IAP_SUBJECT_PERSON_KEY
JOIN 
    TIME_DAY td ON td.ACADEMIC_TERM_CODE = d.TERM_CODE
GROUP BY 
    p.PERSON_EMAIL, 
    p.PERSON_NAME, 
    td.ACADEMIC_YEAR;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1750, 165
TOTAL                  : 32656, 30564, 2092
AVG                    : 2512.00, 2351.08, 160.92
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is total number of subjects, the total fee, and the shortest and longest sessions, for all virtual IAP sessions?

(Hints: Schema Mapping Hints:
- 'subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'sessions' is related to IAP_SUBJECT_SESSION.SESSION_END_TIME, IAP_SUBJECT_SESSION.SESSION_START_TIME

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_SESSION.SESSION_LOCATION = BUILDINGS.BUILDING_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QVVgvlXGbfR0zmYjei5nx9es4p', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    COUNT(DISTINCT IAP_SUBJECT_DETAIL.ACTIVITY_TITLE) AS total_subjects,\n    SUM(IAP_SUBJECT_DETAIL.FEE) AS total_fee,\n    MIN(julianday(IAP_SUBJECT_SESSION.SESSION_END_TIME) - julianday(IAP_SUBJECT_SESSION.SESSION_START_TIME)) AS shortest_session,\n    MAX(julianday(IAP_SUBJECT_SESSION.SESSION_END_TIME) - julianday(IAP_SUBJECT_SESSION.SESSION_START_TIME)) AS longest_session\nFROM \n    IAP_SUBJECT_DETAIL\nJOIN \n    IAP_SUBJECT_SESSION ON IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY\nWHERE \n    IAP_SUBJECT_SESSION.SESSION_LOCATION = 'On line';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349843, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=161, prompt_tokens=1558, total_tokens=1719, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=161, prompt_tokens=1558, total_tokens=1719, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    COUNT(DISTINCT IAP_SUBJECT_DETAIL.ACTIVITY_TITLE) AS total_subjects,
    SUM(IAP_SUBJECT_DETAIL.FEE) AS total_fee,
    MIN(julianday(IAP_SUBJECT_SESSION.SESSION_END_TIME) - julianday(IAP_SUBJECT_SESSION.SESSION_START_TIME)) AS shortest_session,
    MAX(julianday(IAP_SUBJECT_SESSION.SESSION_END_TIME) - julianday(IAP_SUBJECT_SESSION.SESSION_START_TIME)) AS longest_session
FROM 
    IAP_SUBJECT_DETAIL
JOIN 
    IAP_SUBJECT_SESSION ON IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY
WHERE 
    IAP_SUBJECT_SESSION.SESSION_LOCATION = 'On line';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1558, 161
TOTAL                  : 34375, 32122, 2253
AVG                    : 2455.36, 2294.43, 160.93
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the name of the building, total number of subjects, total fee, and shortest and longest sessions for each physical IAP session location?

(Hints: Schema Mapping Hints:
- 'name of the building' is related to BUILDINGS.BUILDING_NAME
- 'subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'sessions' is related to IAP_SUBJECT_SESSION.SESSION_END_TIME, IAP_SUBJECT_SESSION.SESSION_START_TIME

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_SESSION.SESSION_LOCATION = BUILDINGS.BUILDING_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QV78v5vq2DfaNXy4rvYlEz5g7u', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    B.BUILDING_NAME,\n    COUNT(DISTINCT ISD.ACTIVITY_TITLE) AS total_subjects,\n    SUM(ISD.FEE) AS total_fee,\n    MIN(STRFTIME('%H%M', ISS.SESSION_END_TIME) - STRFTIME('%H%M', ISS.SESSION_START_TIME)) AS shortest_session,\n    MAX(STRFTIME('%H%M', ISS.SESSION_END_TIME) - STRFTIME('%H%M', ISS.SESSION_START_TIME)) AS longest_session\nFROM \n    BUILDINGS B\nJOIN \n    IAP_SUBJECT_SESSION ISS ON B.BUILDING_NUMBER = ISS.SESSION_LOCATION\nJOIN \n    IAP_SUBJECT_DETAIL ISD ON ISS.IAP_SUBJECT_SESSION_KEY = ISD.IAP_SUBJECT_SESSION_KEY\nGROUP BY \n    B.BUILDING_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349843, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=178, prompt_tokens=1579, total_tokens=1757, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=178, prompt_tokens=1579, total_tokens=1757, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    B.BUILDING_NAME,
    COUNT(DISTINCT ISD.ACTIVITY_TITLE) AS total_subjects,
    SUM(ISD.FEE) AS total_fee,
    MIN(STRFTIME('%H%M', ISS.SESSION_END_TIME) - STRFTIME('%H%M', ISS.SESSION_START_TIME)) AS shortest_session,
    MAX(STRFTIME('%H%M', ISS.SESSION_END_TIME) - STRFTIME('%H%M', ISS.SESSION_START_TIME)) AS longest_session
FROM 
    BUILDINGS B
JOIN 
    IAP_SUBJECT_SESSION ISS ON B.BUILDING_NUMBER = ISS.SESSION_LOCATION
JOIN 
    IAP_SUBJECT_DETAIL ISD ON ISS.IAP_SUBJECT_SESSION_KEY = ISD.IAP_SUBJECT_SESSION_KEY
GROUP BY 
    B.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1579, 178
TOTAL                  : 36132, 33701, 2431
AVG                    : 2408.80, 2246.73, 162.07
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the term code, term description, total number of IAP sessions, total fee collected, and minimum and maximum enrollment for each term code?

(Hints: Schema Mapping Hints:
- 'term code' is related to IAP_SUBJECT_DETAIL.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'IAP sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (ACADEMIC_TERMS_ALL.TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QVeU7Md8VPt8P1GKQtFz63BYKW', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    ACADEMIC_TERMS_ALL.TERM_CODE, \n    ACADEMIC_TERMS_ALL.TERM_DESCRIPTION, \n    COUNT(IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY) AS total_sessions, \n    SUM(IAP_SUBJECT_DETAIL.FEE) AS total_fee_collected, \n    MIN(IAP_SUBJECT_DETAIL.MAX_ENROLLMENT) AS min_enrollment, \n    MAX(IAP_SUBJECT_DETAIL.MAX_ENROLLMENT) AS max_enrollment\nFROM \n    ACADEMIC_TERMS_ALL\nJOIN \n    IAP_SUBJECT_DETAIL ON ACADEMIC_TERMS_ALL.TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE\nJOIN \n    IAP_SUBJECT_SESSION ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY\nGROUP BY \n    ACADEMIC_TERMS_ALL.TERM_CODE, \n    ACADEMIC_TERMS_ALL.TERM_DESCRIPTION;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349843, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=198, prompt_tokens=2000, total_tokens=2198, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=198, prompt_tokens=2000, total_tokens=2198, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ACADEMIC_TERMS_ALL.TERM_CODE, 
    ACADEMIC_TERMS_ALL.TERM_DESCRIPTION, 
    COUNT(IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY) AS total_sessions, 
    SUM(IAP_SUBJECT_DETAIL.FEE) AS total_fee_collected, 
    MIN(IAP_SUBJECT_DETAIL.MAX_ENROLLMENT) AS min_enrollment, 
    MAX(IAP_SUBJECT_DETAIL.MAX_ENROLLMENT) AS max_enrollment
FROM 
    ACADEMIC_TERMS_ALL
JOIN 
    IAP_SUBJECT_DETAIL ON ACADEMIC_TERMS_ALL.TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE
JOIN 
    IAP_SUBJECT_SESSION ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
GROUP BY 
    ACADEMIC_TERMS_ALL.TERM_CODE, 
    ACADEMIC_TERMS_ALL.TERM_DESCRIPTION;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2000, 198
TOTAL                  : 38330, 35701, 2629
AVG                    : 2395.62, 2231.31, 164.31
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the school code, school name, full name of the department, course level, total number of courses, and total number of degree-granting courses for each school code, department, and course level?

(Hints: Schema Mapping Hints:
- 'school code' is related to SIS_SUBJECT_CODE.SCHOOL_CODE
- 'school name' is related to SIS_SUBJECT_CODE.SCHOOL_NAME
- 'full name of the department' is related to SIS_DEPARTMENT.DEPARTMENT_FULL_NAME
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'courses' is related to SIS_COURSE_DESCRIPTION.COURSE
- 'degree-granting courses' is related to SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING

Join Information: (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_COURSE_DESCRIPTION.DEPARTMENT), (SIS_COURSE_DESCRIPTION.COURSE = SIS_SUBJECT_CODE.SUBJECT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QW1fIsfMkO9BeTm2DbM8U8QY1t', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    s.SCHOOL_CODE, \n    s.SCHOOL_NAME, \n    d.DEPARTMENT_FULL_NAME, \n    c.COURSE_LEVEL, \n    COUNT(c.COURSE) AS TOTAL_COURSES, \n    COUNT(CASE WHEN c.IS_DEGREE_GRANTING = 'Y' THEN 1 END) AS TOTAL_DEGREE_GRANTING_COURSES\nFROM \n    SIS_COURSE_DESCRIPTION c\nJOIN \n    SIS_DEPARTMENT d ON c.DEPARTMENT = d.DEPARTMENT_CODE\nJOIN \n    SIS_SUBJECT_CODE s ON c.COURSE = s.SUBJECT_CODE\nGROUP BY \n    s.SCHOOL_CODE, \n    s.SCHOOL_NAME, \n    d.DEPARTMENT_FULL_NAME, \n    c.COURSE_LEVEL;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349844, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=170, prompt_tokens=1459, total_tokens=1629, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=170, prompt_tokens=1459, total_tokens=1629, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    s.SCHOOL_CODE, 
    s.SCHOOL_NAME, 
    d.DEPARTMENT_FULL_NAME, 
    c.COURSE_LEVEL, 
    COUNT(c.COURSE) AS TOTAL_COURSES, 
    COUNT(CASE WHEN c.IS_DEGREE_GRANTING = 'Y' THEN 1 END) AS TOTAL_DEGREE_GRANTING_COURSES
FROM 
    SIS_COURSE_DESCRIPTION c
JOIN 
    SIS_DEPARTMENT d ON c.DEPARTMENT = d.DEPARTMENT_CODE
JOIN 
    SIS_SUBJECT_CODE s ON c.COURSE = s.SUBJECT_CODE
GROUP BY 
    s.SCHOOL_CODE, 
    s.SCHOOL_NAME, 
    d.DEPARTMENT_FULL_NAME, 
    c.COURSE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1459, 170
TOTAL                  : 39959, 37160, 2799
AVG                    : 2350.53, 2185.88, 164.65
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each sponsor of the independent activity periods, list the sponsor name, number of sessions held, the total number of enrollment, the minimum and maximum fee, the number of sessions with info, and the number of sessions without info.

(Hints: Schema Mapping Hints:
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'info' is related to IAP_SUBJECT_SESSION.HAS_SESSION_INFO

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QVNfX8vYxOd03AjYXlWSpMAF5T', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    s.SPONSOR_NAME,\n    COUNT(DISTINCT ses.IAP_SUBJECT_SESSION_KEY) AS number_of_sessions_held,\n    SUM(d.MAX_ENROLLMENT) AS total_number_of_enrollment,\n    MIN(d.FEE) AS minimum_fee,\n    MAX(d.FEE) AS maximum_fee,\n    SUM(CASE WHEN ses.HAS_SESSION_INFO = 'Y' THEN 1 ELSE 0 END) AS number_of_sessions_with_info,\n    SUM(CASE WHEN ses.HAS_SESSION_INFO = 'N' THEN 1 ELSE 0 END) AS number_of_sessions_without_info\nFROM \n    IAP_SUBJECT_SPONSOR s\nJOIN \n    IAP_SUBJECT_DETAIL d ON s.IAP_SUBJECT_SPONSOR_KEY = d.IAP_SUBJECT_SPONSOR_KEY\nJOIN \n    IAP_SUBJECT_SESSION ses ON d.IAP_SUBJECT_SESSION_KEY = ses.IAP_SUBJECT_SESSION_KEY\nGROUP BY \n    s.SPONSOR_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349843, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=204, prompt_tokens=1585, total_tokens=1789, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=204, prompt_tokens=1585, total_tokens=1789, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    s.SPONSOR_NAME,
    COUNT(DISTINCT ses.IAP_SUBJECT_SESSION_KEY) AS number_of_sessions_held,
    SUM(d.MAX_ENROLLMENT) AS total_number_of_enrollment,
    MIN(d.FEE) AS minimum_fee,
    MAX(d.FEE) AS maximum_fee,
    SUM(CASE WHEN ses.HAS_SESSION_INFO = 'Y' THEN 1 ELSE 0 END) AS number_of_sessions_with_info,
    SUM(CASE WHEN ses.HAS_SESSION_INFO = 'N' THEN 1 ELSE 0 END) AS number_of_sessions_without_info
FROM 
    IAP_SUBJECT_SPONSOR s
JOIN 
    IAP_SUBJECT_DETAIL d ON s.IAP_SUBJECT_SPONSOR_KEY = d.IAP_SUBJECT_SPONSOR_KEY
JOIN 
    IAP_SUBJECT_SESSION ses ON d.IAP_SUBJECT_SESSION_KEY = ses.IAP_SUBJECT_SESSION_KEY
GROUP BY 
    s.SPONSOR_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1585, 204
TOTAL                  : 41748, 38745, 3003
AVG                    : 2319.33, 2152.50, 166.83
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the school code, school name, DLC key, the graduate level, total number of SIS subjects, the minimum and maximum course numbers, and the total number of departments offering subjects for each school?

(Hints: Schema Mapping Hints:
- 'school code' is related to SIS_SUBJECT_CODE.SCHOOL_CODE
- 'school name' is related to SIS_SUBJECT_CODE.SCHOOL_NAME
- 'DLC key' is related to SIS_DEPARTMENT.DLC_KEY
- 'graduate level' is related to SIS_COURSE_DESCRIPTION.GRADUATE_LEVEL
- 'SIS subjects' is related to SIS_SUBJECT_CODE.SUBJECT_CODE
- 'course numbers' is related to SIS_SUBJECT_CODE.COURSE_NUMBER
- 'departments' is related to SIS_DEPARTMENT.DEPARTMENT_CODE

Join Information: (SIS_SUBJECT_CODE.SUBJECT_CODE = SIS_COURSE_DESCRIPTION.COURSE), (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QWSMu98nZvIrHFefXa9l0NY1JQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    s.SCHOOL_CODE, \n    s.SCHOOL_NAME, \n    d.DLC_KEY, \n    c.GRADUATE_LEVEL, \n    COUNT(DISTINCT s.SUBJECT_CODE) AS total_sis_subjects, \n    MIN(s.COURSE_NUMBER) AS min_course_number, \n    MAX(s.COURSE_NUMBER) AS max_course_number, \n    COUNT(DISTINCT d.DEPARTMENT_CODE) AS total_departments\nFROM \n    SIS_SUBJECT_CODE s\nJOIN \n    SIS_COURSE_DESCRIPTION c ON s.SUBJECT_CODE = c.COURSE\nJOIN \n    SIS_DEPARTMENT d ON c.DEPARTMENT = d.DEPARTMENT_CODE\nGROUP BY \n    s.SCHOOL_CODE, \n    s.SCHOOL_NAME, \n    d.DLC_KEY, \n    c.GRADUATE_LEVEL;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349844, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=181, prompt_tokens=1464, total_tokens=1645, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=181, prompt_tokens=1464, total_tokens=1645, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    s.SCHOOL_CODE, 
    s.SCHOOL_NAME, 
    d.DLC_KEY, 
    c.GRADUATE_LEVEL, 
    COUNT(DISTINCT s.SUBJECT_CODE) AS total_sis_subjects, 
    MIN(s.COURSE_NUMBER) AS min_course_number, 
    MAX(s.COURSE_NUMBER) AS max_course_number, 
    COUNT(DISTINCT d.DEPARTMENT_CODE) AS total_departments
FROM 
    SIS_SUBJECT_CODE s
JOIN 
    SIS_COURSE_DESCRIPTION c ON s.SUBJECT_CODE = c.COURSE
JOIN 
    SIS_DEPARTMENT d ON c.DEPARTMENT = d.DEPARTMENT_CODE
GROUP BY 
    s.SCHOOL_CODE, 
    s.SCHOOL_NAME, 
    d.DLC_KEY, 
    c.GRADUATE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1464, 181
TOTAL                  : 43393, 40209, 3184
AVG                    : 2283.84, 2116.26, 167.58
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What are the different schools and departments that offer SIS courses? List their school code, school name, department code, department name, the total number of phone numbers, and the most common course level.

(Hints: Schema Mapping Hints:
- 'school code' is related to SIS_SUBJECT_CODE.SCHOOL_CODE
- 'school name' is related to SIS_SUBJECT_CODE.SCHOOL_NAME
- 'department code' is related to SIS_DEPARTMENT.DEPARTMENT_CODE
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL

Join Information: (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_COURSE_DESCRIPTION.DEPARTMENT), (SIS_SUBJECT_CODE.SUBJECT_CODE = SIS_COURSE_DESCRIPTION.COURSE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QWNnZZCMIngT6ABU3rpmhq9nvr', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    SIS_SUBJECT_CODE.SCHOOL_CODE,\n    SIS_SUBJECT_CODE.SCHOOL_NAME,\n    SIS_DEPARTMENT.DEPARTMENT_CODE,\n    SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME AS DEPARTMENT_NAME,\n    COUNT(SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER) AS TOTAL_PHONE_NUMBERS,\n    (SELECT COURSE_LEVEL \n     FROM SIS_COURSE_DESCRIPTION \n     WHERE SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE \n     GROUP BY COURSE_LEVEL \n     ORDER BY COUNT(*) DESC \n     LIMIT 1) AS MOST_COMMON_COURSE_LEVEL\nFROM \n    SIS_ADMIN_DEPARTMENT\nJOIN \n    SIS_DEPARTMENT ON SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE\nJOIN \n    SIS_COURSE_DESCRIPTION ON SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_COURSE_DESCRIPTION.DEPARTMENT\nJOIN \n    SIS_SUBJECT_CODE ON SIS_COURSE_DESCRIPTION.COURSE = SIS_SUBJECT_CODE.SUBJECT_CODE\nGROUP BY \n    SIS_SUBJECT_CODE.SCHOOL_CODE,\n    SIS_SUBJECT_CODE.SCHOOL_NAME,\n    SIS_DEPARTMENT.DEPARTMENT_CODE,\n    SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349844, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=262, prompt_tokens=1637, total_tokens=1899, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=262, prompt_tokens=1637, total_tokens=1899, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    SIS_SUBJECT_CODE.SCHOOL_CODE,
    SIS_SUBJECT_CODE.SCHOOL_NAME,
    SIS_DEPARTMENT.DEPARTMENT_CODE,
    SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME AS DEPARTMENT_NAME,
    COUNT(SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER) AS TOTAL_PHONE_NUMBERS,
    (SELECT COURSE_LEVEL 
     FROM SIS_COURSE_DESCRIPTION 
     WHERE SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE 
     GROUP BY COURSE_LEVEL 
     ORDER BY COUNT(*) DESC 
     LIMIT 1) AS MOST_COMMON_COURSE_LEVEL
FROM 
    SIS_ADMIN_DEPARTMENT
JOIN 
    SIS_DEPARTMENT ON SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE
JOIN 
    SIS_COURSE_DESCRIPTION ON SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_COURSE_DESCRIPTION.DEPARTMENT
JOIN 
    SIS_SUBJECT_CODE ON SIS_COURSE_DESCRIPTION.COURSE = SIS_SUBJECT_CODE.SUBJECT_CODE
GROUP BY 
    SIS_SUBJECT_CODE.SCHOOL_CODE,
    SIS_SUBJECT_CODE.SCHOOL_NAME,
    SIS_DEPARTMENT.DEPARTMENT_CODE,
    SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1637, 262
TOTAL                  : 45292, 41846, 3446
AVG                    : 2264.60, 2092.30, 172.30
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the department name, total number of types of TIP subjects, total number of enrolled students, the minimum and maximum rental new price for each department?

(Hints: Schema Mapping Hints:
- 'department name' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'TIP subjects' is related to TIP_SUBJECT_OFFERED.SUBJECT_ID
- 'enrolled students' is related to TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'rental new price' is related to TIP_MATERIAL.RENTAL_NEW_PRICE

Join Information: (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QYy2KjGbbQF6qllZcyFEiksFn0', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    tso.OFFER_DEPT_NAME,\n    COUNT(DISTINCT tso.SUBJECT_ID) AS total_types_of_tip_subjects,\n    SUM(tso.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,\n    MIN(tm.RENTAL_NEW_PRICE) AS min_rental_new_price,\n    MAX(tm.RENTAL_NEW_PRICE) AS max_rental_new_price\nFROM \n    TIP_SUBJECT_OFFERED tso\nJOIN \n    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    TIP_MATERIAL tm ON tm.TIP_MATERIAL_KEY = td.TIP_MATERIAL_KEY\nGROUP BY \n    tso.OFFER_DEPT_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349846, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=153, prompt_tokens=1424, total_tokens=1577, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=153, prompt_tokens=1424, total_tokens=1577, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    tso.OFFER_DEPT_NAME,
    COUNT(DISTINCT tso.SUBJECT_ID) AS total_types_of_tip_subjects,
    SUM(tso.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,
    MIN(tm.RENTAL_NEW_PRICE) AS min_rental_new_price,
    MAX(tm.RENTAL_NEW_PRICE) AS max_rental_new_price
FROM 
    TIP_SUBJECT_OFFERED tso
JOIN 
    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY
JOIN 
    TIP_MATERIAL tm ON tm.TIP_MATERIAL_KEY = td.TIP_MATERIAL_KEY
GROUP BY 
    tso.OFFER_DEPT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1424, 153
TOTAL                  : 46869, 43270, 3599
AVG                    : 2231.86, 2060.48, 171.38
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_FLOOR
[
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR_NAME:VARCHAR2, Examples: ['0 Floor', '00 Floor', '000 Floor']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_SUPERVISOR_USAGE
[
(MIT_ID:VARCHAR2, Examples: ['932464132', '989998641', '904031741']),
(DEPT_COUNT:NUMBER, Examples: [1, 2, 4]),
(DEPT_NAMES:VARCHAR2, Examples: ['D_ACT', 'D_ACT,D_RESDEV', 'D_ADM']),
(NUM_OF_SUPERVISEES:NUMBER, Examples: [1, 4, 2]),
(SQFT:NUMBER, Examples: [0.0, 103.0, 162.0]),
(RESEARCH_VOLUME:NUMBER, Examples: [0.0, 1350070.0, 56280.0]),
(SQFT_PER_SUPERVISEE:NUMBER, Examples: [0.0, 103.0, 162.0]),
(SQFT_PER_RES_VOL:NUMBER, Examples: [0.0, -18.0, 5.0]),
(RES_VOL_PER_SQFT:NUMBER, Examples: [0.0, 522.0, 253.0])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the building component, name of the building, square footage for all rooms, total number of floors, total number of rooms, total number of facility organizations, total number of supervisors, and total number of supervisees for each building component?

(Hints: Schema Mapping Hints:
- 'building component' is related to SPACE_DETAIL.BUILDING_COMPONENT
- 'name of the building' is related to BUILDINGS.BUILDING_NAME
- 'square footage' is related to SPACE_DETAIL.ROOM_SQUARE_FOOTAGE
- 'rooms' is related to SPACE_DETAIL.BUILDING_ROOM
- 'floors' is related to SPACE_FLOOR.FLOOR
- 'facility organizations' is related to SPACE_UNIT.FCLT_ORGANIZATION_KEY
- 'supervisors' is related to SPACE_SUPERVISOR_USAGE.MIT_ID
- 'supervisees' is related to SPACE_SUPERVISOR_USAGE.NUM_OF_SUPERVISEES

Join Information: (SPACE_SUPERVISOR_USAGE.DEPT_NAMES = SPACE_UNIT.DLC_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QXB8sQW9JEzTxnXsYOabSEkxSL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    SD.BUILDING_COMPONENT,\n    B.BUILDING_NAME,\n    SUM(SD.ROOM_SQUARE_FOOTAGE) AS Total_Room_Square_Footage,\n    COUNT(DISTINCT SF.FLOOR) AS Total_Floors,\n    COUNT(DISTINCT SD.BUILDING_ROOM) AS Total_Rooms,\n    COUNT(DISTINCT SU.FCLT_ORGANIZATION_KEY) AS Total_Facility_Organizations,\n    COUNT(DISTINCT SSU.MIT_ID) AS Total_Supervisors,\n    SUM(SSU.NUM_OF_SUPERVISEES) AS Total_Supervisees\nFROM \n    SPACE_DETAIL SD\nJOIN \n    BUILDINGS B ON SD.BUILDING_KEY = B.BUILDING_KEY\nJOIN \n    SPACE_FLOOR SF ON SD.FLOOR_KEY = SF.FLOOR_KEY\nLEFT JOIN \n    SPACE_UNIT SU ON SU.SPACE_UNIT_KEY = SD.SPACE_UNIT_KEY\nLEFT JOIN \n    SPACE_SUPERVISOR_USAGE SSU ON SU.DLC_KEY = SSU.DEPT_NAMES\nGROUP BY \n    SD.BUILDING_COMPONENT,\n    B.BUILDING_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349845, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=242, prompt_tokens=1231, total_tokens=1473, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=242, prompt_tokens=1231, total_tokens=1473, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    SD.BUILDING_COMPONENT,
    B.BUILDING_NAME,
    SUM(SD.ROOM_SQUARE_FOOTAGE) AS Total_Room_Square_Footage,
    COUNT(DISTINCT SF.FLOOR) AS Total_Floors,
    COUNT(DISTINCT SD.BUILDING_ROOM) AS Total_Rooms,
    COUNT(DISTINCT SU.FCLT_ORGANIZATION_KEY) AS Total_Facility_Organizations,
    COUNT(DISTINCT SSU.MIT_ID) AS Total_Supervisors,
    SUM(SSU.NUM_OF_SUPERVISEES) AS Total_Supervisees
FROM 
    SPACE_DETAIL SD
JOIN 
    BUILDINGS B ON SD.BUILDING_KEY = B.BUILDING_KEY
JOIN 
    SPACE_FLOOR SF ON SD.FLOOR_KEY = SF.FLOOR_KEY
LEFT JOIN 
    SPACE_UNIT SU ON SU.SPACE_UNIT_KEY = SD.SPACE_UNIT_KEY
LEFT JOIN 
    SPACE_SUPERVISOR_USAGE SSU ON SU.DLC_KEY = SSU.DEPT_NAMES
GROUP BY 
    SD.BUILDING_COMPONENT,
    B.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1231, 242
TOTAL                  : 48342, 44501, 3841
AVG                    : 2197.36, 2022.77, 174.59
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: ACADEMIC_TERM_PARAMETER
[
(TERM_PARAMETER:VARCHAR2, Examples: ['SIS_CURRENT_TERM', 'SIS_PREVIOUS_TERM', 'SIS_UPCOMING_TERM']),
(TERM_INDICATOR:VARCHAR2, Examples: ['C', 'P', 'F']),
(TERM_CODE:VARCHAR2, Examples: ['2024SU', '2025FA', '2025JA']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Fall Term 2024-2025', 'Summer Term 2024', 'January Term 2024-2025']),
(TERM_START_DATE:DATE, Examples: ['03-SEP-24', '10-JUN-24', '06-JAN-25']),
(TERM_END_DATE:DATE, Examples: ['20-DEC-24', '20-AUG-24', '31-JAN-25']),
(TERM_LAST_DAY_BEFORE_NEXT_TERM:DATE, Examples: ['05-JAN-25', '02-SEP-24', '31-JAN-25']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['Y', 'N'])
]
# Table: CIS_COURSE_CATALOG
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2003', '2002', '2007']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['097', '098', '090']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['N', 'Y', 'S']),
(DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:DATE, Examples: ['Electrical Eng & Computer Sci', 'Architecture', 'Chemistry']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1991FA', '1995FA', '1989FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['Y', 'N']),
(LECTURE_UNITS:VARCHAR2, Examples: [0, 3, 1]),
(LAB_UNITS:VARCHAR2, Examples: [0, 12, 4]),
(PREPARATION_UNITS:VARCHAR2, Examples: [0, 9, 5]),
(TOTAL_UNITS:VARCHAR2, Examples: [0, 12, 6]),
(DESIGN_UNITS:VARCHAR2, Examples: [0, 6, 8]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['R', 'J', 'N']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Can be repeated for credit', 'Continuing and Repeatable', 'Not repeatable for credit']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', 'H-LEVEL Grad Credit (except for Course 18 students)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['HD1', 'HE', 'HD5']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS-D, Category 1', 'HASS Elective', 'HASS-D, Category 5']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:NUMBER, Examples: ['RESH', 'NTRN', 'COOP']),
(TUITION_ATTRIBUTE_DESC:NUMBER, Examples: ['Pre-thesis Research Subject', 'Internship', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:NUMBER, Examples: ['WRT2', 'WRT1']),
(WRITE_REQ_ATTRIBUTE_DESC:NUMBER, Examples: ['Writing Requirement, Phase II', 'Writing Requirement, Phase I']),
(SUPERVISOR_ATTRIBUTE:NUMBER, Examples: ['UROP', 'THG', 'THU']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['UROP subject', 'Grad Thesis', 'Undergrad Thesis']),
(PREREQUISITES:VARCHAR2, Examples: ['Permission of instructor', '10.213', '12.120 and 12.103, or permission of instructor']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Crystal structures of mantle and core minerals, elastic and thermodynamic properties of materials at high pressure-temperature,', 'Investigates social conflict and distributional disputes in the public sector. While theoretical aspects of conflict are consid', 'Presents a framework for current landscape ecological theory, structured to encourage application in physical planning of lands']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.285J, 11.482J', '3.57J', '1.232J, 15.054J, 16.71J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE', '1.EPW, 3.EPW, 6.EPW, 10.EPW, 16.EPW, 20.EPW, 22.EPW', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['2.729J, EC.729J', 'EC.718J, WGS.277J', '21A.136J, 21G.026J']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['15.511, 15.515', '15.024', '15.414']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(STATUS_CHANGE:VARCHAR2, Examples: ['(2016: New number: 21G.110)', '(2016: New number: 21G.113)', '(2016: New number: 21G.142)']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['02-SEP-01', '12-JAN-06', '16-MAY-05']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.005']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HS', 'HA', 'HH']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Social Sciences', 'HASS Arts', 'HASS Humanities']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'Second Half Term Subject', 'First Half Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Asia', 'United States of America']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['China', 'Brazil|Uruguay|Vietnam|Russia|Australia', 'United States of America']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m2c.html', 'http://student.mit.edu/catalog/m3b.html'])
]

### Question ###
For each term, list the term code, the term description, whether the term is current or not, and the total number of types of CIS courses.

(Hints: Schema Mapping Hints:
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'term is current or not' is related to ACADEMIC_TERM_PARAMETER.IS_CURRENT_TERM
- 'CIS courses' is related to CIS_COURSE_CATALOG.SUBJECT_ID)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QZ8jKy5PiaL1ggNnR1NpHJu19y', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    ata.TERM_CODE,\n    ata.TERM_DESCRIPTION,\n    atp.IS_CURRENT_TERM,\n    COUNT(cc.SUBJECT_ID) AS TOTAL_CIS_COURSES\nFROM \n    ACADEMIC_TERMS_ALL ata\nLEFT JOIN \n    ACADEMIC_TERM_PARAMETER atp ON ata.TERM_CODE = atp.TERM_CODE\nLEFT JOIN \n    CIS_COURSE_CATALOG cc ON atp.TERM_CODE = cc.EFFECTIVE_TERM_CODE\nGROUP BY \n    ata.TERM_CODE, ata.TERM_DESCRIPTION, atp.IS_CURRENT_TERM;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349847, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=119, prompt_tokens=2700, total_tokens=2819, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=119, prompt_tokens=2700, total_tokens=2819, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ata.TERM_CODE,
    ata.TERM_DESCRIPTION,
    atp.IS_CURRENT_TERM,
    COUNT(cc.SUBJECT_ID) AS TOTAL_CIS_COURSES
FROM 
    ACADEMIC_TERMS_ALL ata
LEFT JOIN 
    ACADEMIC_TERM_PARAMETER atp ON ata.TERM_CODE = atp.TERM_CODE
LEFT JOIN 
    CIS_COURSE_CATALOG cc ON atp.TERM_CODE = cc.EFFECTIVE_TERM_CODE
GROUP BY 
    ata.TERM_CODE, ata.TERM_DESCRIPTION, atp.IS_CURRENT_TERM;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2700, 119
TOTAL                  : 51161, 47201, 3960
AVG                    : 2224.39, 2052.22, 172.17
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Show the department names, the corresponding SIS subject code, subject code descriptions, graduate level, and the total number of courses per department.

(Hints: Schema Mapping Hints:
- 'department names' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'SIS subject code' is related to SIS_SUBJECT_CODE.SUBJECT_CODE
- 'subject code descriptions' is related to SIS_SUBJECT_CODE.SUBJECT_CODE_DESC
- 'graduate level' is related to SIS_COURSE_DESCRIPTION.GRADUATE_LEVEL
- 'courses' is related to SIS_SUBJECT_CODE.COURSE_NUMBER

Join Information: (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_SUBJECT_CODE.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QZNvYEYZ7aT6v2XbznfokVjh7E', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    d.DEPARTMENT_NAME,\n    s.SUBJECT_CODE,\n    s.SUBJECT_CODE_DESC,\n    c.GRADUATE_LEVEL,\n    COUNT(s.COURSE_NUMBER) AS total_courses\nFROM \n    SIS_DEPARTMENT d\nJOIN \n    SIS_COURSE_DESCRIPTION c ON d.DEPARTMENT_CODE = c.DEPARTMENT\nJOIN \n    SIS_SUBJECT_CODE s ON s.COURSE_NUMBER = c.COURSE\nGROUP BY \n    d.DEPARTMENT_NAME, s.SUBJECT_CODE, s.SUBJECT_CODE_DESC, c.GRADUATE_LEVEL;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349847, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=127, prompt_tokens=1421, total_tokens=1548, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=127, prompt_tokens=1421, total_tokens=1548, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    d.DEPARTMENT_NAME,
    s.SUBJECT_CODE,
    s.SUBJECT_CODE_DESC,
    c.GRADUATE_LEVEL,
    COUNT(s.COURSE_NUMBER) AS total_courses
FROM 
    SIS_DEPARTMENT d
JOIN 
    SIS_COURSE_DESCRIPTION c ON d.DEPARTMENT_CODE = c.DEPARTMENT
JOIN 
    SIS_SUBJECT_CODE s ON s.COURSE_NUMBER = c.COURSE
GROUP BY 
    d.DEPARTMENT_NAME, s.SUBJECT_CODE, s.SUBJECT_CODE_DESC, c.GRADUATE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1421, 127
TOTAL                  : 52709, 48622, 4087
AVG                    : 2196.21, 2025.92, 170.29
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_FLOOR
[
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR_NAME:VARCHAR2, Examples: ['0 Floor', '00 Floor', '000 Floor']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_SUPERVISOR_USAGE
[
(MIT_ID:VARCHAR2, Examples: ['932464132', '989998641', '904031741']),
(DEPT_COUNT:NUMBER, Examples: [1, 2, 4]),
(DEPT_NAMES:VARCHAR2, Examples: ['D_ACT', 'D_ACT,D_RESDEV', 'D_ADM']),
(NUM_OF_SUPERVISEES:NUMBER, Examples: [1, 4, 2]),
(SQFT:NUMBER, Examples: [0.0, 103.0, 162.0]),
(RESEARCH_VOLUME:NUMBER, Examples: [0.0, 1350070.0, 56280.0]),
(SQFT_PER_SUPERVISEE:NUMBER, Examples: [0.0, 103.0, 162.0]),
(SQFT_PER_RES_VOL:NUMBER, Examples: [0.0, -18.0, 5.0]),
(RES_VOL_PER_SQFT:NUMBER, Examples: [0.0, 522.0, 253.0])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the DLC key, name of the DLC, total number of floors, total square footage, total number of facility organizations, total number of supervisors, total number of supervisees, and total building heights for each DLC?

(Hints: Schema Mapping Hints:
- 'DLC key' is related to SPACE_UNIT.DLC_KEY
- 'name of the DLC' is related to FCLT_ORGANIZATION.DLC_NAME
- 'floors' is related to SPACE_FLOOR.FLOOR
- 'square footage' is related to SPACE_DETAIL.ROOM_SQUARE_FOOTAGE
- 'facility organizations' is related to SPACE_UNIT.FCLT_ORGANIZATION_KEY
- 'supervisors' is related to SPACE_SUPERVISOR_USAGE.MIT_ID
- 'supervisees' is related to SPACE_SUPERVISOR_USAGE.NUM_OF_SUPERVISEES
- 'building heights' is related to FCLT_BUILDING.BUILDING_HEIGHT

Join Information: (SPACE_UNIT.DLC_KEY = SPACE_SUPERVISOR_USAGE.DEPT_NAMES))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QY6qpeS0BX45d5C96DTSFwjECw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    su.DLC_KEY AS 'DLC key',\n    fo.DLC_NAME AS 'name of the DLC',\n    COUNT(DISTINCT sf.FLOOR_KEY) AS 'total number of floors',\n    SUM(sd.ROOM_SQUARE_FOOTAGE) AS 'total square footage',\n    COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) AS 'total number of facility organizations',\n    COUNT(DISTINCT spu.MIT_ID) AS 'total number of supervisors',\n    SUM(spu.NUM_OF_SUPERVISEES) AS 'total number of supervisees',\n    SUM(fb.BUILDING_HEIGHT) AS 'total building heights'\nFROM \n    SPACE_UNIT su\nJOIN \n    SPACE_SUPERVISOR_USAGE spu ON su.DLC_KEY = spu.DEPT_NAMES\nJOIN \n    FCLT_ORGANIZATION fo ON su.DLC_KEY = fo.DLC_KEY\nJOIN \n    SPACE_DETAIL sd ON su.SPACE_UNIT_KEY = sd.SPACE_UNIT_KEY\nJOIN \n    SPACE_FLOOR sf ON sd.BUILDING_KEY = sf.FLOOR_KEY\nJOIN \n    FCLT_BUILDING fb ON sd.BUILDING_KEY = fb.FCLT_BUILDING_KEY\nGROUP BY \n    su.DLC_KEY, fo.DLC_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349846, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=264, prompt_tokens=2373, total_tokens=2637, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=264, prompt_tokens=2373, total_tokens=2637, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    su.DLC_KEY AS 'DLC key',
    fo.DLC_NAME AS 'name of the DLC',
    COUNT(DISTINCT sf.FLOOR_KEY) AS 'total number of floors',
    SUM(sd.ROOM_SQUARE_FOOTAGE) AS 'total square footage',
    COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) AS 'total number of facility organizations',
    COUNT(DISTINCT spu.MIT_ID) AS 'total number of supervisors',
    SUM(spu.NUM_OF_SUPERVISEES) AS 'total number of supervisees',
    SUM(fb.BUILDING_HEIGHT) AS 'total building heights'
FROM 
    SPACE_UNIT su
JOIN 
    SPACE_SUPERVISOR_USAGE spu ON su.DLC_KEY = spu.DEPT_NAMES
JOIN 
    FCLT_ORGANIZATION fo ON su.DLC_KEY = fo.DLC_KEY
JOIN 
    SPACE_DETAIL sd ON su.SPACE_UNIT_KEY = sd.SPACE_UNIT_KEY
JOIN 
    SPACE_FLOOR sf ON sd.BUILDING_KEY = sf.FLOOR_KEY
JOIN 
    FCLT_BUILDING fb ON sd.BUILDING_KEY = fb.FCLT_BUILDING_KEY
GROUP BY 
    su.DLC_KEY, fo.DLC_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2373, 264
TOTAL                  : 55346, 50995, 4351
AVG                    : 2213.84, 2039.80, 174.04
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
What are the details of courses offered in the current academic term, including the academic year, term code, hgn code, the total number of types of courses, the average number of units, the department name, the name and email address of the person in charge?

(Hints: Schema Mapping Hints:
- 'current academic term' is related to ACADEMIC_TERMS.IS_CURRENT_TERM
- 'academic year' is related to COURSE_CATALOG_SUBJECT_OFFERED.ACADEMIC_YEAR
- 'term code' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'hgn code' is related to SUBJECT_OFFERED.HGN_CODE
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'number of units' is related to COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS
- 'department name' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME
- 'name' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'email address' is related to EMPLOYEE_DIRECTORY.EMAIL_ADDRESS

Join Information: (SUBJECT_OFFERED.SUBJECT_ID = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (EMPLOYEE_DIRECTORY.MIT_ID = SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QYUhovUJVC67rQeMZntg2CVj9H', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ACADEMIC_TERMS.ACADEMIC_YEAR,\n    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE,\n    SUBJECT_OFFERED.HGN_CODE,\n    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS total_course_types,\n    AVG(COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS) AS average_units,\n    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME,\n    EMPLOYEE_DIRECTORY.FULL_NAME,\n    EMPLOYEE_DIRECTORY.EMAIL_ADDRESS\nFROM \n    ACADEMIC_TERMS\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED ON ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE\nJOIN \n    SUBJECT_OFFERED ON COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID = SUBJECT_OFFERED.SUBJECT_ID\nJOIN \n    EMPLOYEE_DIRECTORY ON SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID\nWHERE \n    ACADEMIC_TERMS.IS_CURRENT_TERM = 'Y'\nGROUP BY \n    ACADEMIC_TERMS.ACADEMIC_YEAR,\n    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE,\n    SUBJECT_OFFERED.HGN_CODE,\n    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME,\n    EMPLOYEE_DIRECTORY.FULL_NAME,\n    EMPLOYEE_DIRECTORY.EMAIL_ADDRESS;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349846, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=293, prompt_tokens=5064, total_tokens=5357, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=293, prompt_tokens=5064, total_tokens=5357, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ACADEMIC_TERMS.ACADEMIC_YEAR,
    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE,
    SUBJECT_OFFERED.HGN_CODE,
    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS total_course_types,
    AVG(COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS) AS average_units,
    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME,
    EMPLOYEE_DIRECTORY.FULL_NAME,
    EMPLOYEE_DIRECTORY.EMAIL_ADDRESS
FROM 
    ACADEMIC_TERMS
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED ON ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
JOIN 
    SUBJECT_OFFERED ON COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID = SUBJECT_OFFERED.SUBJECT_ID
JOIN 
    EMPLOYEE_DIRECTORY ON SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID
WHERE 
    ACADEMIC_TERMS.IS_CURRENT_TERM = 'Y'
GROUP BY 
    ACADEMIC_TERMS.ACADEMIC_YEAR,
    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE,
    SUBJECT_OFFERED.HGN_CODE,
    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME,
    EMPLOYEE_DIRECTORY.FULL_NAME,
    EMPLOYEE_DIRECTORY.EMAIL_ADDRESS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5064, 293
TOTAL                  : 60703, 56059, 4644
AVG                    : 2334.73, 2156.12, 178.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Retrieve information about the IAP subjects, including their titles, categories, session titles, session start time, session end time, sponsor names, and total number of sessions.

(Hints: Schema Mapping Hints:
- 'titles' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'categories' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'session titles' is related to IAP_SUBJECT_SESSION.SESSION_TITLE
- 'session start time' is related to IAP_SUBJECT_SESSION.SESSION_START_TIME
- 'session end time' is related to IAP_SUBJECT_SESSION.SESSION_END_TIME
- 'sponsor names' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY

Join Information: (IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QZvUTg1CLTd4TmKdZx1E9joUYc', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    IAP_SUBJECT_DETAIL.ACTIVITY_TITLE AS title,\n    IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME AS category,\n    IAP_SUBJECT_SESSION.SESSION_TITLE AS session_title,\n    IAP_SUBJECT_SESSION.SESSION_START_TIME AS session_start_time,\n    IAP_SUBJECT_SESSION.SESSION_END_TIME AS session_end_time,\n    IAP_SUBJECT_SPONSOR.SPONSOR_NAME AS sponsor_name,\n    COUNT(IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY) AS total_sessions\nFROM \n    IAP_SUBJECT_DETAIL\nJOIN \n    IAP_SUBJECT_CATEGORY ON IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY\nJOIN \n    IAP_SUBJECT_SESSION ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY\nJOIN \n    IAP_SUBJECT_SPONSOR ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY\nGROUP BY \n    IAP_SUBJECT_DETAIL.ACTIVITY_TITLE, \n    IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME,\n    IAP_SUBJECT_SESSION.SESSION_TITLE,\n    IAP_SUBJECT_SESSION.SESSION_START_TIME,\n    IAP_SUBJECT_SESSION.SESSION_END_TIME,\n    IAP_SUBJECT_SPONSOR.SPONSOR_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349847, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=294, prompt_tokens=1830, total_tokens=2124, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=294, prompt_tokens=1830, total_tokens=2124, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    IAP_SUBJECT_DETAIL.ACTIVITY_TITLE AS title,
    IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME AS category,
    IAP_SUBJECT_SESSION.SESSION_TITLE AS session_title,
    IAP_SUBJECT_SESSION.SESSION_START_TIME AS session_start_time,
    IAP_SUBJECT_SESSION.SESSION_END_TIME AS session_end_time,
    IAP_SUBJECT_SPONSOR.SPONSOR_NAME AS sponsor_name,
    COUNT(IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY) AS total_sessions
FROM 
    IAP_SUBJECT_DETAIL
JOIN 
    IAP_SUBJECT_CATEGORY ON IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY
JOIN 
    IAP_SUBJECT_SESSION ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
JOIN 
    IAP_SUBJECT_SPONSOR ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY
GROUP BY 
    IAP_SUBJECT_DETAIL.ACTIVITY_TITLE, 
    IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME,
    IAP_SUBJECT_SESSION.SESSION_TITLE,
    IAP_SUBJECT_SESSION.SESSION_START_TIME,
    IAP_SUBJECT_SESSION.SESSION_END_TIME,
    IAP_SUBJECT_SPONSOR.SPONSOR_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1830, 294
TOTAL                  : 62827, 57889, 4938
AVG                    : 2326.93, 2144.04, 182.89
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: STUDENT_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Ctr for Transportation Studies', 'Foreign Study Program', 'Center for Adv Eng Studies']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['CTS-Ctr for Transportation Studies', 'FOR-Foreign Study Program', 'EN-Center for Adv Eng Studies']),
(SCHOOL_CODE:VARCHAR2, Examples: ['E', 'Y', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'MIT, academic', 'Hum, Arts & Social Sciences'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the author, school name, material status, total record counts, and total number of types of courses for each author and school?

(Hints: Schema Mapping Hints:
- 'author' is related to TIP_MATERIAL.AUTHOR
- 'school name' is related to STUDENT_DEPARTMENT.SCHOOL_NAME
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'record counts' is related to TIP_DETAIL.RECORD_COUNT
- 'courses' is related to TIP_DETAIL.SUBJECT_ID

Join Information: (TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY = TIP_DETAIL.TIP_MATERIAL_STATUS_KEY), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (STUDENT_DEPARTMENT.DEPARTMENT_CODE = TIP_SUBJECT_OFFERED.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QaPV8wYRaiKnIASc1igpUdf8kD', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    m.AUTHOR, \n    d.SCHOOL_NAME, \n    s.TIP_MATERIAL_STATUS AS material_status, \n    SUM(td.RECORD_COUNT) AS total_record_counts, \n    COUNT(DISTINCT td.SUBJECT_ID) AS total_types_of_courses\nFROM \n    TIP_MATERIAL m\nJOIN \n    TIP_DETAIL td ON m.TIP_MATERIAL_KEY = td.TIP_MATERIAL_KEY\nJOIN \n    TIP_SUBJECT_OFFERED so ON td.TIP_SUBJECT_OFFERED_KEY = so.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    STUDENT_DEPARTMENT d ON so.OFFER_DEPT_CODE = d.DEPARTMENT_CODE\nJOIN \n    TIP_MATERIAL_STATUS s ON td.TIP_MATERIAL_STATUS_KEY = s.TIP_MATERIAL_STATUS_KEY\nGROUP BY \n    m.AUTHOR, \n    d.SCHOOL_NAME, \n    s.TIP_MATERIAL_STATUS;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349848, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=192, prompt_tokens=1670, total_tokens=1862, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=192, prompt_tokens=1670, total_tokens=1862, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    m.AUTHOR, 
    d.SCHOOL_NAME, 
    s.TIP_MATERIAL_STATUS AS material_status, 
    SUM(td.RECORD_COUNT) AS total_record_counts, 
    COUNT(DISTINCT td.SUBJECT_ID) AS total_types_of_courses
FROM 
    TIP_MATERIAL m
JOIN 
    TIP_DETAIL td ON m.TIP_MATERIAL_KEY = td.TIP_MATERIAL_KEY
JOIN 
    TIP_SUBJECT_OFFERED so ON td.TIP_SUBJECT_OFFERED_KEY = so.TIP_SUBJECT_OFFERED_KEY
JOIN 
    STUDENT_DEPARTMENT d ON so.OFFER_DEPT_CODE = d.DEPARTMENT_CODE
JOIN 
    TIP_MATERIAL_STATUS s ON td.TIP_MATERIAL_STATUS_KEY = s.TIP_MATERIAL_STATUS_KEY
GROUP BY 
    m.AUTHOR, 
    d.SCHOOL_NAME, 
    s.TIP_MATERIAL_STATUS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1670, 192
TOTAL                  : 64689, 59559, 5130
AVG                    : 2310.32, 2127.11, 183.21
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the course number, subject title, material status, the total, min, and max new shelf price, the total, min, and max used shelf price, total number of schools and the total number of materials for each TIP subject and material status?

(Hints: Schema Mapping Hints:
- 'course number' is related to TIP_SUBJECT_OFFERED.COURSE_NUMBER
- 'subject title' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'new shelf price' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'used shelf price' is related to TIP_MATERIAL.USED_SHELF_PRICE
- 'schools' is related to TIP_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'materials' is related to TIP_DETAIL.TIP_MATERIAL_KEY
- 'TIP subject' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE

Join Information: (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY), (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY), (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QbpTsJbFLAFsOLX9cTFXOltaWE', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    so.COURSE_NUMBER,\n    so.SUBJECT_TITLE,\n    ms.TIP_MATERIAL_STATUS,\n    COUNT(DISTINCT so.OFFER_SCHOOL_NAME) AS total_schools,\n    COUNT(DISTINCT td.TIP_MATERIAL_KEY) AS total_materials,\n    SUM(m.NEW_SHELF_PRICE) AS total_new_price,\n    MIN(m.NEW_SHELF_PRICE) AS min_new_price,\n    MAX(m.NEW_SHELF_PRICE) AS max_new_price,\n    SUM(m.USED_SHELF_PRICE) AS total_used_price,\n    MIN(m.USED_SHELF_PRICE) AS min_used_price,\n    MAX(m.USED_SHELF_PRICE) AS max_used_price\nFROM \n    TIP_SUBJECT_OFFERED so\nJOIN \n    TIP_DETAIL td ON so.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    TIP_MATERIAL m ON td.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY\nJOIN \n    TIP_MATERIAL_STATUS ms ON td.TIP_MATERIAL_STATUS_KEY = ms.TIP_MATERIAL_STATUS_KEY\nGROUP BY \n    so.COURSE_NUMBER, so.SUBJECT_TITLE, ms.TIP_MATERIAL_STATUS\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349849, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=256, prompt_tokens=1626, total_tokens=1882, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=256, prompt_tokens=1626, total_tokens=1882, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    so.COURSE_NUMBER,
    so.SUBJECT_TITLE,
    ms.TIP_MATERIAL_STATUS,
    COUNT(DISTINCT so.OFFER_SCHOOL_NAME) AS total_schools,
    COUNT(DISTINCT td.TIP_MATERIAL_KEY) AS total_materials,
    SUM(m.NEW_SHELF_PRICE) AS total_new_price,
    MIN(m.NEW_SHELF_PRICE) AS min_new_price,
    MAX(m.NEW_SHELF_PRICE) AS max_new_price,
    SUM(m.USED_SHELF_PRICE) AS total_used_price,
    MIN(m.USED_SHELF_PRICE) AS min_used_price,
    MAX(m.USED_SHELF_PRICE) AS max_used_price
FROM 
    TIP_SUBJECT_OFFERED so
JOIN 
    TIP_DETAIL td ON so.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY
JOIN 
    TIP_MATERIAL m ON td.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY
JOIN 
    TIP_MATERIAL_STATUS ms ON td.TIP_MATERIAL_STATUS_KEY = ms.TIP_MATERIAL_STATUS_KEY
GROUP BY 
    so.COURSE_NUMBER, so.SUBJECT_TITLE, ms.TIP_MATERIAL_STATUS

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1626, 256
TOTAL                  : 66571, 61185, 5386
AVG                    : 2295.55, 2109.83, 185.72
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: STUDENT_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Ctr for Transportation Studies', 'Foreign Study Program', 'Center for Adv Eng Studies']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['CTS-Ctr for Transportation Studies', 'FOR-Foreign Study Program', 'EN-Center for Adv Eng Studies']),
(SCHOOL_CODE:VARCHAR2, Examples: ['E', 'Y', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'MIT, academic', 'Hum, Arts & Social Sciences'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is material status, the total number of materials, the total number of subjects, the total number of schools, and the most recent publication year for each material status?

(Hints: Schema Mapping Hints:
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'materials' is related to TIP_DETAIL.TIP_MATERIAL_KEY
- 'subjects' is related to TIP_DETAIL.SUBJECT_ID
- 'schools' is related to STUDENT_DEPARTMENT.SCHOOL_NAME
- 'publication year' is related to TIP_MATERIAL.YEAR

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY = TIP_DETAIL.TIP_MATERIAL_STATUS_KEY), (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY), (STUDENT_DEPARTMENT.DEPARTMENT_CODE = TIP_SUBJECT_OFFERED.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QbWmrqAD3JCUV9LljGN7QISf1H', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    TMS.TIP_MATERIAL_STATUS AS material_status,\n    COUNT(DISTINCT TD.TIP_MATERIAL_KEY) AS total_materials,\n    COUNT(DISTINCT TD.SUBJECT_ID) AS total_subjects,\n    COUNT(DISTINCT SD.SCHOOL_NAME) AS total_schools,\n    MAX(TM.YEAR) AS most_recent_publication_year\nFROM \n    TIP_DETAIL TD\nJOIN \n    TIP_MATERIAL TM ON TM.TIP_MATERIAL_KEY = TD.TIP_MATERIAL_KEY\nJOIN \n    TIP_MATERIAL_STATUS TMS ON TMS.TIP_MATERIAL_STATUS_KEY = TD.TIP_MATERIAL_STATUS_KEY\nJOIN \n    TIP_SUBJECT_OFFERED TSO ON TSO.TIP_SUBJECT_OFFERED_KEY = TD.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    STUDENT_DEPARTMENT SD ON SD.DEPARTMENT_CODE = TSO.OFFER_DEPT_CODE\nGROUP BY \n    TMS.TIP_MATERIAL_STATUS;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349849, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=204, prompt_tokens=1694, total_tokens=1898, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=204, prompt_tokens=1694, total_tokens=1898, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    TMS.TIP_MATERIAL_STATUS AS material_status,
    COUNT(DISTINCT TD.TIP_MATERIAL_KEY) AS total_materials,
    COUNT(DISTINCT TD.SUBJECT_ID) AS total_subjects,
    COUNT(DISTINCT SD.SCHOOL_NAME) AS total_schools,
    MAX(TM.YEAR) AS most_recent_publication_year
FROM 
    TIP_DETAIL TD
JOIN 
    TIP_MATERIAL TM ON TM.TIP_MATERIAL_KEY = TD.TIP_MATERIAL_KEY
JOIN 
    TIP_MATERIAL_STATUS TMS ON TMS.TIP_MATERIAL_STATUS_KEY = TD.TIP_MATERIAL_STATUS_KEY
JOIN 
    TIP_SUBJECT_OFFERED TSO ON TSO.TIP_SUBJECT_OFFERED_KEY = TD.TIP_SUBJECT_OFFERED_KEY
JOIN 
    STUDENT_DEPARTMENT SD ON SD.DEPARTMENT_CODE = TSO.OFFER_DEPT_CODE
GROUP BY 
    TMS.TIP_MATERIAL_STATUS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1694, 204
TOTAL                  : 68469, 62879, 5590
AVG                    : 2282.30, 2095.97, 186.33
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]

### Question ###
For the 2023 Fall term, what are the unique term descriptions, subject titles along with their prerequisites, total number of types of subjects per term code, instructor of this course, and the number of types of courses ever taught by the instructor?

(Hints: Schema Mapping Hints:
- '2023 Fall term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'term descriptions' is related to ACADEMIC_TERMS.TERM_DESCRIPTION
- 'subject titles' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'prerequisites' is related to COURSE_CATALOG_SUBJECT_OFFERED.PREREQUISITES
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'term code' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'instructor' is related to COURSE_CATALOG_SUBJECT_OFFERED.FALL_INSTRUCTORS
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QdIiZM01a90KoQme9zMVEwMnNO', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT DISTINCT \n    AT.TERM_DESCRIPTION, \n    C.SUBJECT_TITLE, \n    C.PREREQUISITES, \n    COUNT(DISTINCT C.SUBJECT_ID) OVER (PARTITION BY C.TERM_CODE) AS TYPE_COUNT_PER_TERM,\n    C.FALL_INSTRUCTORS, \n    COUNT(DISTINCT C.SUBJECT_ID) OVER (PARTITION BY C.FALL_INSTRUCTORS) AS TYPE_COUNT_PER_INSTRUCTOR\nFROM \n    ACADEMIC_TERMS AT\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED C ON AT.TERM_CODE = C.TERM_CODE\nWHERE \n    AT.TERM_CODE = '2023FA';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349851, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=141, prompt_tokens=2982, total_tokens=3123, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=141, prompt_tokens=2982, total_tokens=3123, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT DISTINCT 
    AT.TERM_DESCRIPTION, 
    C.SUBJECT_TITLE, 
    C.PREREQUISITES, 
    COUNT(DISTINCT C.SUBJECT_ID) OVER (PARTITION BY C.TERM_CODE) AS TYPE_COUNT_PER_TERM,
    C.FALL_INSTRUCTORS, 
    COUNT(DISTINCT C.SUBJECT_ID) OVER (PARTITION BY C.FALL_INSTRUCTORS) AS TYPE_COUNT_PER_INSTRUCTOR
FROM 
    ACADEMIC_TERMS AT
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED C ON AT.TERM_CODE = C.TERM_CODE
WHERE 
    AT.TERM_CODE = '2023FA';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2982, 141
TOTAL                  : 71592, 65861, 5731
AVG                    : 2309.42, 2124.55, 184.87
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
What are the academic year, and instructors names for courses offered in the academic year 2022, along with the total number of types of courses per instructor?

(Hints: Schema Mapping Hints:
- 'academic year' is related to ACADEMIC_TERMS_ALL.ACADEMIC_YEAR
- 'instructors names' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'courses' is related to SUBJECT_OFFERED.COURSE_NUMBER

Join Information: (SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE), (SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qe4FtbKGgGoMXJ4ZJAXFcvO2L7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR, \n    EMPLOYEE_DIRECTORY.FULL_NAME, \n    COUNT(DISTINCT SUBJECT_OFFERED.COURSE_NUMBER) AS total_course_types\nFROM \n    ACADEMIC_TERMS_ALL \nJOIN \n    SUBJECT_OFFERED ON ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_OFFERED.TERM_CODE \nJOIN \n    EMPLOYEE_DIRECTORY ON SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID \nWHERE \n    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR = '2022' \nGROUP BY \n    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR, EMPLOYEE_DIRECTORY.FULL_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349852, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=154, prompt_tokens=2900, total_tokens=3054, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=154, prompt_tokens=2900, total_tokens=3054, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR, 
    EMPLOYEE_DIRECTORY.FULL_NAME, 
    COUNT(DISTINCT SUBJECT_OFFERED.COURSE_NUMBER) AS total_course_types
FROM 
    ACADEMIC_TERMS_ALL 
JOIN 
    SUBJECT_OFFERED ON ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_OFFERED.TERM_CODE 
JOIN 
    EMPLOYEE_DIRECTORY ON SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID 
WHERE 
    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR = '2022' 
GROUP BY 
    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR, EMPLOYEE_DIRECTORY.FULL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2900, 154
TOTAL                  : 74646, 68761, 5885
AVG                    : 2332.69, 2148.78, 183.91
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List all buildings with their names, building numbers, building height, street address, city, state, HR department name, assignable square footage, total and average square footage, ordered in descending order of assignable, total, and average square footage.

(Hints: Schema Mapping Hints:
- 'names' is related to BUILDINGS.BUILDING_NAME
- 'building numbers' is related to BUILDINGS.BUILDING_NUMBER
- 'building height' is related to FAC_BUILDING.BUILDING_HEIGHT
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'HR department name' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'assignable square footage' is related to BUILDINGS.BLDG_ASSIGNABLE_SQUARE_FOOTAGE
- 'square footage' is related to FAC_ROOMS.AREA

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = BUILDINGS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qc5A7AD3Wh2TJkJLKpeoZ7FYEb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    B.BUILDING_NAME, \n    B.BUILDING_NUMBER, \n    FB.BUILDING_HEIGHT, \n    B.BUILDING_STREET_ADDRESS, \n    A.CITY, \n    A.STATE, \n    O.HR_DEPARTMENT_NAME, \n    B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE, \n    SUM(R.AREA) AS TOTAL_SQUARE_FOOTAGE, \n    AVG(R.AREA) AS AVERAGE_SQUARE_FOOTAGE \nFROM \n    BUILDINGS B \nJOIN \n    FAC_BUILDING FB ON B.BUILDING_KEY = FB.FAC_BUILDING_KEY \nJOIN \n    FAC_ROOMS R ON FB.FAC_BUILDING_KEY = R.BUILDING_KEY \nJOIN \n    FAC_BUILDING_ADDRESS A ON B.BUILDING_KEY = A.BUILDING_KEY \nJOIN \n    FAC_ORGANIZATION O ON R.ORGANIZATION_KEY = O.ORGANIZATION_KEY \nGROUP BY \n    B.BUILDING_NAME, \n    B.BUILDING_NUMBER, \n    FB.BUILDING_HEIGHT, \n    B.BUILDING_STREET_ADDRESS, \n    A.CITY, \n    A.STATE, \n    O.HR_DEPARTMENT_NAME, \n    B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE \nORDER BY \n    B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE DESC, \n    TOTAL_SQUARE_FOOTAGE DESC, \n    AVERAGE_SQUARE_FOOTAGE DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349850, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=305, prompt_tokens=2617, total_tokens=2922, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=305, prompt_tokens=2617, total_tokens=2922, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    B.BUILDING_NAME, 
    B.BUILDING_NUMBER, 
    FB.BUILDING_HEIGHT, 
    B.BUILDING_STREET_ADDRESS, 
    A.CITY, 
    A.STATE, 
    O.HR_DEPARTMENT_NAME, 
    B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE, 
    SUM(R.AREA) AS TOTAL_SQUARE_FOOTAGE, 
    AVG(R.AREA) AS AVERAGE_SQUARE_FOOTAGE 
FROM 
    BUILDINGS B 
JOIN 
    FAC_BUILDING FB ON B.BUILDING_KEY = FB.FAC_BUILDING_KEY 
JOIN 
    FAC_ROOMS R ON FB.FAC_BUILDING_KEY = R.BUILDING_KEY 
JOIN 
    FAC_BUILDING_ADDRESS A ON B.BUILDING_KEY = A.BUILDING_KEY 
JOIN 
    FAC_ORGANIZATION O ON R.ORGANIZATION_KEY = O.ORGANIZATION_KEY 
GROUP BY 
    B.BUILDING_NAME, 
    B.BUILDING_NUMBER, 
    FB.BUILDING_HEIGHT, 
    B.BUILDING_STREET_ADDRESS, 
    A.CITY, 
    A.STATE, 
    O.HR_DEPARTMENT_NAME, 
    B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE 
ORDER BY 
    B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE DESC, 
    TOTAL_SQUARE_FOOTAGE DESC, 
    AVERAGE_SQUARE_FOOTAGE DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2617, 305
TOTAL                  : 77568, 71378, 6190
AVG                    : 2350.55, 2162.97, 187.58
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Show the details of rooms including the full name of the rooms, the building names, floor numbers, the organizations occupying them, name of the departments occupying them, and the percentage of the room area over the floor area and building.

(Hints: Schema Mapping Hints:
- 'full name' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'floor numbers' is related to FAC_FLOOR.FLOOR
- 'organizations' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'departments' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'room area' is related to FAC_ROOMS.AREA
- 'floor area' is related to FAC_ROOMS.AREA, FAC_ROOMS.FLOOR_KEY)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qesk9hC825tpZvw5xoC9PS5Z0V', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    R.ROOM_FULL_NAME, \n    B.BUILDING_NAME, \n    F.FLOOR, \n    O.ORGANIZATION_NAME, \n    O.HR_DEPARTMENT_NAME,\n    (R.AREA / F.ASSIGNABLE_AREA * 100) AS ROOM_AREA_PERCENTAGE,\n    (R.AREA / B.ASSIGNABLE_AREA * 100) AS ROOM_AREA_PERCENTAGE_BUILDING\nFROM \n    FAC_ROOMS R\nJOIN \n    FAC_BUILDING B ON R.BUILDING_KEY = B.FAC_BUILDING_KEY\nJOIN \n    FAC_FLOOR F ON R.BUILDING_KEY = F.BUILDING_KEY AND R.FLOOR = F.FLOOR\nJOIN \n    FAC_ORGANIZATION O ON R.ORGANIZATION_KEY = O.ORGANIZATION_KEY;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349852, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=172, prompt_tokens=2355, total_tokens=2527, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1152)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=172, prompt_tokens=2355, total_tokens=2527, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1152))

***** FINAL SQL QUERY *****
SELECT 
    R.ROOM_FULL_NAME, 
    B.BUILDING_NAME, 
    F.FLOOR, 
    O.ORGANIZATION_NAME, 
    O.HR_DEPARTMENT_NAME,
    (R.AREA / F.ASSIGNABLE_AREA * 100) AS ROOM_AREA_PERCENTAGE,
    (R.AREA / B.ASSIGNABLE_AREA * 100) AS ROOM_AREA_PERCENTAGE_BUILDING
FROM 
    FAC_ROOMS R
JOIN 
    FAC_BUILDING B ON R.BUILDING_KEY = B.FAC_BUILDING_KEY
JOIN 
    FAC_FLOOR F ON R.BUILDING_KEY = F.BUILDING_KEY AND R.FLOOR = F.FLOOR
JOIN 
    FAC_ORGANIZATION O ON R.ORGANIZATION_KEY = O.ORGANIZATION_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2355, 172
TOTAL                  : 80095, 73733, 6362
AVG                    : 2355.74, 2168.62, 187.12
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Provide the complete information for students with the first name Kevin, including their full names, email addresses, department names, department phone numbers, school names, and the total student count per department and school. If a student is associated with more than one department, list a separate row for each department.

(Hints: Schema Mapping Hints:
- 'first name' is related to MIT_STUDENT_DIRECTORY.FIRST_NAME
- 'full names' is related to MIT_STUDENT_DIRECTORY.FULL_NAME
- 'email addresses' is related to MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS
- 'department names' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'department phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'school names' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'student' is related to MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS
- 'department' is related to SIS_DEPARTMENT.DEPARTMENT_CODE
- 'school' is related to SIS_DEPARTMENT.SCHOOL_CODE

Join Information: (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QfF6lYrQ4Kwr2iFYNSsE6S0P9x', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    MSD.FULL_NAME,\n    MSD.EMAIL_ADDRESS,\n    SD.DEPARTMENT_NAME,\n    SAD.DEPARTMENT_PHONE_NUMBER,\n    SD.SCHOOL_NAME,\n    COUNT(*) OVER (PARTITION BY SD.DEPARTMENT_CODE, SD.SCHOOL_CODE) AS TOTAL_STUDENT_COUNT\nFROM \n    MIT_STUDENT_DIRECTORY MSD\nJOIN \n    SIS_DEPARTMENT SD ON MSD.DEPARTMENT = SD.DEPARTMENT_CODE\nJOIN \n    SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE\nWHERE \n    MSD.FIRST_NAME = 'Kevin';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349853, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=131, prompt_tokens=1240, total_tokens=1371, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=131, prompt_tokens=1240, total_tokens=1371, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    MSD.FULL_NAME,
    MSD.EMAIL_ADDRESS,
    SD.DEPARTMENT_NAME,
    SAD.DEPARTMENT_PHONE_NUMBER,
    SD.SCHOOL_NAME,
    COUNT(*) OVER (PARTITION BY SD.DEPARTMENT_CODE, SD.SCHOOL_CODE) AS TOTAL_STUDENT_COUNT
FROM 
    MIT_STUDENT_DIRECTORY MSD
JOIN 
    SIS_DEPARTMENT SD ON MSD.DEPARTMENT = SD.DEPARTMENT_CODE
JOIN 
    SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE
WHERE 
    MSD.FIRST_NAME = 'Kevin';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1240, 131
TOTAL                  : 81466, 74973, 6493
AVG                    : 2327.60, 2142.09, 185.51
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the term description, whether the term is current or not, total number of types of TIP subjects offered and materials needed, the minimum and maximum number of enrolled students, the total number of schools offering subjects, and the total number of records for each term code?

(Hints: Schema Mapping Hints:
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'term is current or not' is related to ACADEMIC_TERMS_ALL.IS_CURRENT_TERM
- 'TIP subjects' is related to TIP_SUBJECT_OFFERED.COURSE_NUMBER
- 'materials' is related to TIP_MATERIAL.ISBN
- 'enrolled students' is related to TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'schools' is related to TIP_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'number of records' is related to TIP_DETAIL.RECORD_COUNT
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE

Join Information: (ACADEMIC_TERMS_ALL.TERM_CODE = TIP_SUBJECT_OFFERED.TERM_CODE), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY), (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qc5CVzRYv2yzh1Os1NQexo9RXx', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    AT.TERM_DESCRIPTION,\n    AT.IS_CURRENT_TERM,\n    COUNT(DISTINCT TSO.COURSE_NUMBER) AS total_tip_subjects,\n    COUNT(DISTINCT TM.ISBN) AS total_materials,\n    MIN(TSO.NUM_ENROLLED_STUDENTS) AS min_enrolled_students,\n    MAX(TSO.NUM_ENROLLED_STUDENTS) AS max_enrolled_students,\n    COUNT(DISTINCT TSO.OFFER_SCHOOL_NAME) AS total_schools,\n    SUM(TD.RECORD_COUNT) AS total_records\nFROM \n    ACADEMIC_TERMS_ALL AT\nLEFT JOIN \n    TIP_SUBJECT_OFFERED TSO ON AT.TERM_CODE = TSO.TERM_CODE\nLEFT JOIN \n    TIP_DETAIL TD ON TSO.TIP_SUBJECT_OFFERED_KEY = TD.TIP_SUBJECT_OFFERED_KEY\nLEFT JOIN \n    TIP_MATERIAL TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY\nLEFT JOIN \n    TIP_MATERIAL_STATUS TMS ON TD.TIP_MATERIAL_STATUS_KEY = TMS.TIP_MATERIAL_STATUS_KEY\nGROUP BY \n    AT.TERM_DESCRIPTION, AT.IS_CURRENT_TERM;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349850, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=246, prompt_tokens=2254, total_tokens=2500, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=246, prompt_tokens=2254, total_tokens=2500, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    AT.TERM_DESCRIPTION,
    AT.IS_CURRENT_TERM,
    COUNT(DISTINCT TSO.COURSE_NUMBER) AS total_tip_subjects,
    COUNT(DISTINCT TM.ISBN) AS total_materials,
    MIN(TSO.NUM_ENROLLED_STUDENTS) AS min_enrolled_students,
    MAX(TSO.NUM_ENROLLED_STUDENTS) AS max_enrolled_students,
    COUNT(DISTINCT TSO.OFFER_SCHOOL_NAME) AS total_schools,
    SUM(TD.RECORD_COUNT) AS total_records
FROM 
    ACADEMIC_TERMS_ALL AT
LEFT JOIN 
    TIP_SUBJECT_OFFERED TSO ON AT.TERM_CODE = TSO.TERM_CODE
LEFT JOIN 
    TIP_DETAIL TD ON TSO.TIP_SUBJECT_OFFERED_KEY = TD.TIP_SUBJECT_OFFERED_KEY
LEFT JOIN 
    TIP_MATERIAL TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY
LEFT JOIN 
    TIP_MATERIAL_STATUS TMS ON TD.TIP_MATERIAL_STATUS_KEY = TMS.TIP_MATERIAL_STATUS_KEY
GROUP BY 
    AT.TERM_DESCRIPTION, AT.IS_CURRENT_TERM;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2254, 246
TOTAL                  : 83966, 77227, 6739
AVG                    : 2332.39, 2145.19, 187.19
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Show the details of rooms including the full name of the rooms, the building names, floor numbers, the organizations occupying them, name of the departments occupying them, and the percentage of the room area over the assignable floor area and building.

(Hints: Schema Mapping Hints:
- 'full name of the rooms' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'floor numbers' is related to FAC_FLOOR.FLOOR
- 'organizations' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'name of the departments' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'room area' is related to FAC_ROOMS.AREA
- 'assignable floor area' is related to FAC_FLOOR.ASSIGNABLE_AREA

Join Information: (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_ROOMS.FLOOR_KEY = FAC_FLOOR.FLOOR_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qe632pJdKnnNiu95fZmTGEWSNA', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    FR.ROOM_FULL_NAME,\n    FB.BUILDING_NAME,\n    FF.FLOOR,\n    FO.ORGANIZATION_NAME,\n    FO.HR_DEPARTMENT_NAME,\n    (FR.AREA / FF.ASSIGNABLE_AREA) * 100 AS ROOM_AREA_PERCENTAGE,\n    (FR.AREA / (SELECT SUM(FF2.ASSIGNABLE_AREA) \n                 FROM FAC_FLOOR FF2 \n                 WHERE FF2.BUILDING_KEY = FR.BUILDING_KEY)) * 100 AS BUILDING_AREA_PERCENTAGE\nFROM \n    FAC_ROOMS FR\nJOIN \n    FAC_FLOOR FF ON FR.FLOOR_KEY = FF.FLOOR_KEY\nJOIN \n    FAC_BUILDING FB ON FR.BUILDING_KEY = FB.FAC_BUILDING_KEY\nJOIN \n    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349852, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=187, prompt_tokens=2417, total_tokens=2604, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=187, prompt_tokens=2417, total_tokens=2604, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    FR.ROOM_FULL_NAME,
    FB.BUILDING_NAME,
    FF.FLOOR,
    FO.ORGANIZATION_NAME,
    FO.HR_DEPARTMENT_NAME,
    (FR.AREA / FF.ASSIGNABLE_AREA) * 100 AS ROOM_AREA_PERCENTAGE,
    (FR.AREA / (SELECT SUM(FF2.ASSIGNABLE_AREA) 
                 FROM FAC_FLOOR FF2 
                 WHERE FF2.BUILDING_KEY = FR.BUILDING_KEY)) * 100 AS BUILDING_AREA_PERCENTAGE
FROM 
    FAC_ROOMS FR
JOIN 
    FAC_FLOOR FF ON FR.FLOOR_KEY = FF.FLOOR_KEY
JOIN 
    FAC_BUILDING FB ON FR.BUILDING_KEY = FB.FAC_BUILDING_KEY
JOIN 
    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2417, 187
TOTAL                  : 86570, 79644, 6926
AVG                    : 2339.73, 2152.54, 187.19
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]

### Question ###
What are the unique titles of subjects offered in the fall term along with their instructor names, instructor emails, and the total number of types of subjects per instructor?

(Hints: Schema Mapping Hints:
- 'titles' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'fall term' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'instructor names' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'instructor emails' is related to EMPLOYEE_DIRECTORY.EMAIL_ADDRESS

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qgfuzy0OLmBrRrevCgaIuK37KK', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT DISTINCT c.SUBJECT_TITLE, \n                e.FULL_NAME, \n                e.EMAIL_ADDRESS, \n                COUNT(DISTINCT c.SUBJECT_ID) AS TOTAL_SUBJECT_TYPES\nFROM COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID\nJOIN ACADEMIC_TERMS_ALL a ON c.TERM_CODE = a.TERM_CODE\nWHERE a.TERM_CODE LIKE '%FA' \nGROUP BY c.SUBJECT_TITLE, e.FULL_NAME, e.EMAIL_ADDRESS;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349854, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=121, prompt_tokens=3436, total_tokens=3557, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=121, prompt_tokens=3436, total_tokens=3557, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT DISTINCT c.SUBJECT_TITLE, 
                e.FULL_NAME, 
                e.EMAIL_ADDRESS, 
                COUNT(DISTINCT c.SUBJECT_ID) AS TOTAL_SUBJECT_TYPES
FROM COURSE_CATALOG_SUBJECT_OFFERED c
JOIN EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID
JOIN ACADEMIC_TERMS_ALL a ON c.TERM_CODE = a.TERM_CODE
WHERE a.TERM_CODE LIKE '%FA' 
GROUP BY c.SUBJECT_TITLE, e.FULL_NAME, e.EMAIL_ADDRESS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3436, 121
TOTAL                  : 90127, 83080, 7047
AVG                    : 2371.76, 2186.32, 185.45
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
What are the building names, department names, organizations, their highest and lowest floor number, along with the total number of rooms per each building key?

(Hints: Schema Mapping Hints:
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'department names' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'organizations' is related to FAC_ORGANIZATION.ORGANIZATION
- 'floor number' is related to FAC_FLOOR.LEVEL_ID
- 'room' is related to FAC_ROOMS.FAC_ROOM_KEY
- 'building key' is related to FAC_BUILDING.FAC_BUILDING_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY), (FAC_ORGANIZATION.ORGANIZATION_KEY = FAC_ROOMS.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QeqVeUnr7DniQk9eiaLWq7ray1', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    b.BUILDING_NAME AS building_name,\n    o.HR_DEPARTMENT_NAME AS department_name,\n    o.ORGANIZATION AS organization,\n    MIN(f.FLOOR) AS lowest_floor,\n    MAX(f.FLOOR) AS highest_floor,\n    COUNT(r.FAC_ROOM_KEY) AS total_rooms\nFROM \n    FAC_BUILDING b\nJOIN \n    FAC_ROOMS r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY\nJOIN \n    FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY\nJOIN \n    FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY\nGROUP BY \n    b.BUILDING_NAME, o.HR_DEPARTMENT_NAME, o.ORGANIZATION\nORDER BY \n    b.BUILDING_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349852, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=172, prompt_tokens=2375, total_tokens=2547, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2048)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=172, prompt_tokens=2375, total_tokens=2547, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2048))

***** FINAL SQL QUERY *****
SELECT 
    b.BUILDING_NAME AS building_name,
    o.HR_DEPARTMENT_NAME AS department_name,
    o.ORGANIZATION AS organization,
    MIN(f.FLOOR) AS lowest_floor,
    MAX(f.FLOOR) AS highest_floor,
    COUNT(r.FAC_ROOM_KEY) AS total_rooms
FROM 
    FAC_BUILDING b
JOIN 
    FAC_ROOMS r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY
JOIN 
    FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY
JOIN 
    FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY
GROUP BY 
    b.BUILDING_NAME, o.HR_DEPARTMENT_NAME, o.ORGANIZATION
ORDER BY 
    b.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2375, 172
TOTAL                  : 92674, 85455, 7219
AVG                    : 2376.26, 2191.15, 185.10
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List the building names, names of HR departments occupying them, the total gross square footage, the total and average assignable square footage, and the built year per building key.

(Hints: Schema Mapping Hints:
- 'building names' is related to BUILDINGS.BUILDING_NAME
- 'names of HR departments' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'gross square footage' is related to BUILDINGS.BLDG_GROSS_SQUARE_FOOTAGE
- 'assignable square footage' is related to BUILDINGS.BLDG_ASSIGNABLE_SQUARE_FOOTAGE
- 'built year' is related to FAC_BUILDING.DATE_BUILT
- 'building key' is related to BUILDINGS.BUILDING_KEY

Join Information: (BUILDINGS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qh4vwmN2p2iq2r2Ufyin5BJ7It', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    B.BUILDING_NAME,\n    FO.HR_DEPARTMENT_NAME,\n    B.BLDG_GROSS_SQUARE_FOOTAGE,\n    SUM(B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS total_assignable_sq_ft,\n    AVG(B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS average_assignable_sq_ft,\n    FB.DATE_BUILT\nFROM \n    BUILDINGS B\nJOIN \n    FAC_BUILDING FB ON B.BUILDING_KEY = FB.FAC_BUILDING_KEY\nJOIN \n    FAC_ROOMS FR ON FB.FAC_BUILDING_KEY = FR.BUILDING_KEY\nJOIN \n    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY\nGROUP BY \n    B.BUILDING_NAME, FO.HR_DEPARTMENT_NAME, B.BLDG_GROSS_SQUARE_FOOTAGE, FB.DATE_BUILT\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349855, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=186, prompt_tokens=2283, total_tokens=2469, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=186, prompt_tokens=2283, total_tokens=2469, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    B.BUILDING_NAME,
    FO.HR_DEPARTMENT_NAME,
    B.BLDG_GROSS_SQUARE_FOOTAGE,
    SUM(B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS total_assignable_sq_ft,
    AVG(B.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS average_assignable_sq_ft,
    FB.DATE_BUILT
FROM 
    BUILDINGS B
JOIN 
    FAC_BUILDING FB ON B.BUILDING_KEY = FB.FAC_BUILDING_KEY
JOIN 
    FAC_ROOMS FR ON FB.FAC_BUILDING_KEY = FR.BUILDING_KEY
JOIN 
    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY
GROUP BY 
    B.BUILDING_NAME, FO.HR_DEPARTMENT_NAME, B.BLDG_GROSS_SQUARE_FOOTAGE, FB.DATE_BUILT

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2283, 186
TOTAL                  : 95143, 87738, 7405
AVG                    : 2378.57, 2193.45, 185.12
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: CIS_HASS_ATTRIBUTE
[
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HA,HS']),
(DESCRIPTION_ON_FORM:VARCHAR2, Examples: ['HASS Elective', '1/2 HASS Social Sciences', 'HASS-D, Category 1']),
(DESCRIPTION_IN_BULLETIN:VARCHAR2, Examples: ['HASS-E', 'HASS-S/2', 'HASS-D 1']),
(CIS_ATTRIBUTE_GROUP:VARCHAR2, Examples: ['H', 'G']),
(CIS_ATTRIBUTE_GROUP_NOTE:VARCHAR2, Examples: ['HASS_ATTRIBUTE, for students entering in Fall 2010 or later', 'GIR_ATTRIBUTE, for students entering prior to Fall 2010']),
(ICON_GIF_NAME:VARCHAR2, Examples: ['hassT.gif', 'hass1.gif', 'hass2.gif']),
(ICON_HEIGHT:VARCHAR2, Examples: ['16']),
(ICON_WIDTH:VARCHAR2, Examples: ['16', '35']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['05-MAR-10', '22-FEB-12', '26-APR-10']),
(LAST_UPDATE_USER:VARCHAR2, Examples: ['PETECHOI']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each term code, list the term description, attribute desciption, department name, school name, and the number of subjects in the area of humanities, arts and social sciences.

(Hints: Schema Mapping Hints:
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'attribute desciption' is related to COURSE_CATALOG_SUBJECT_OFFERED.HASS_ATTRIBUTE_DESC
- 'department name' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'area of humanities, arts and social studies' is related to CIS_HASS_ATTRIBUTE.CIS_ATTRIBUTE_GROUP

Join Information: (CIS_HASS_ATTRIBUTE.HASS_ATTRIBUTE = COURSE_CATALOG_SUBJECT_OFFERED.HASS_ATTRIBUTE), (COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE), (ACADEMIC_TERMS_ALL.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QhnBBsQyAen70BpFCsTd0yPeqB', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ACADEMIC_TERMS_ALL.TERM_CODE,\n    ACADEMIC_TERMS_ALL.TERM_DESCRIPTION,\n    CIS_HASS_ATTRIBUTE.HASS_ATTRIBUTE_DESC,\n    SIS_DEPARTMENT.DEPARTMENT_NAME,\n    SIS_DEPARTMENT.SCHOOL_NAME,\n    COUNT(COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS NUMBER_OF_SUBJECTS\nFROM \n    ACADEMIC_TERMS_ALL\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED ON ACADEMIC_TERMS_ALL.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE\nJOIN \n    CIS_HASS_ATTRIBUTE ON COURSE_CATALOG_SUBJECT_OFFERED.HASS_ATTRIBUTE = CIS_HASS_ATTRIBUTE.HASS_ATTRIBUTE\nJOIN \n    SIS_DEPARTMENT ON COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE\nWHERE \n    CIS_HASS_ATTRIBUTE.CIS_ATTRIBUTE_GROUP = 'H'\nGROUP BY \n    ACADEMIC_TERMS_ALL.TERM_CODE, \n    ACADEMIC_TERMS_ALL.TERM_DESCRIPTION, \n    CIS_HASS_ATTRIBUTE.HASS_ATTRIBUTE_DESC,\n    SIS_DEPARTMENT.DEPARTMENT_NAME,\n    SIS_DEPARTMENT.SCHOOL_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349855, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=251, prompt_tokens=3559, total_tokens=3810, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=251, prompt_tokens=3559, total_tokens=3810, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ACADEMIC_TERMS_ALL.TERM_CODE,
    ACADEMIC_TERMS_ALL.TERM_DESCRIPTION,
    CIS_HASS_ATTRIBUTE.HASS_ATTRIBUTE_DESC,
    SIS_DEPARTMENT.DEPARTMENT_NAME,
    SIS_DEPARTMENT.SCHOOL_NAME,
    COUNT(COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS NUMBER_OF_SUBJECTS
FROM 
    ACADEMIC_TERMS_ALL
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED ON ACADEMIC_TERMS_ALL.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
JOIN 
    CIS_HASS_ATTRIBUTE ON COURSE_CATALOG_SUBJECT_OFFERED.HASS_ATTRIBUTE = CIS_HASS_ATTRIBUTE.HASS_ATTRIBUTE
JOIN 
    SIS_DEPARTMENT ON COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE
WHERE 
    CIS_HASS_ATTRIBUTE.CIS_ATTRIBUTE_GROUP = 'H'
GROUP BY 
    ACADEMIC_TERMS_ALL.TERM_CODE, 
    ACADEMIC_TERMS_ALL.TERM_DESCRIPTION, 
    CIS_HASS_ATTRIBUTE.HASS_ATTRIBUTE_DESC,
    SIS_DEPARTMENT.DEPARTMENT_NAME,
    SIS_DEPARTMENT.SCHOOL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3559, 251
TOTAL                  : 98953, 91297, 7656
AVG                    : 2413.49, 2226.76, 186.73
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the total number of library reserve materials, the minimum and maximum publication years, and the total number of enrolled students for each course instructor?

(Hints: Schema Mapping Hints:
- 'library reserve materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_SYSTEM_NUMBER
- 'publication years' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'course instructor' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QigXgU39w1bNCC1dRACURuzzDm', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    lci.INSTRUCTOR_NAME,\n    COUNT(lrc.CATALOG_SYSTEM_NUMBER) AS total_library_reserve_materials,\n    MIN(lrc.CATALOG_YEAR) AS min_publication_year,\n    MAX(lrc.CATALOG_YEAR) AS max_publication_year,\n    SUM(lso.NUM_ENROLLED_STUDENTS) AS total_enrolled_students\nFROM \n    LIBRARY_COURSE_INSTRUCTOR lci\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL lrm ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrm.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG lrc ON lrm.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_SUBJECT_OFFERED lso ON lrm.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY\nGROUP BY \n    lci.INSTRUCTOR_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349856, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=208, prompt_tokens=1860, total_tokens=2068, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=208, prompt_tokens=1860, total_tokens=2068, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    lci.INSTRUCTOR_NAME,
    COUNT(lrc.CATALOG_SYSTEM_NUMBER) AS total_library_reserve_materials,
    MIN(lrc.CATALOG_YEAR) AS min_publication_year,
    MAX(lrc.CATALOG_YEAR) AS max_publication_year,
    SUM(lso.NUM_ENROLLED_STUDENTS) AS total_enrolled_students
FROM 
    LIBRARY_COURSE_INSTRUCTOR lci
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL lrm ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrm.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG lrc ON lrm.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_SUBJECT_OFFERED lso ON lrm.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY
GROUP BY 
    lci.INSTRUCTOR_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1860, 208
TOTAL                  : 101021, 93157, 7864
AVG                    : 2405.26, 2218.02, 187.24
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List building names, their height, street address, city, state, postal code, their gross and assignable square footage, the smallest and largest floor level and the total area of all rooms for each building key.

(Hints: Schema Mapping Hints:
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'height' is related to FAC_BUILDING.BUILDING_HEIGHT
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'postal code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'gross square footage' is related to FAC_BUILDING.EXT_GROSS_AREA
- 'assignable square footage' is related to FAC_BUILDING.ASSIGNABLE_AREA
- 'floor level' is related to FAC_FLOOR.LEVEL_ID
- 'area' is related to FAC_ROOMS.AREA
- 'building key' is related to FAC_BUILDING.FAC_BUILDING_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_FLOOR.BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = BUILDINGS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qhbz8wfccHmjZEtcg5fUfybMNr', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    fb.BUILDING_NAME,\n    fb.BUILDING_HEIGHT,\n    b.BUILDING_STREET_ADDRESS,\n    fba.CITY,\n    fba.STATE,\n    fba.POSTAL_CODE,\n    fb.EXT_GROSS_AREA,\n    fb.ASSIGNABLE_AREA,\n    MIN(f.FLOOR) AS SMALLEST_FLOOR_LEVEL,\n    MAX(f.FLOOR) AS LARGEST_FLOOR_LEVEL,\n    SUM(r.AREA) AS TOTAL_ROOM_AREA\nFROM \n    FAC_BUILDING fb\nJOIN \n    BUILDINGS b ON fb.FAC_BUILDING_KEY = b.BUILDING_KEY\nJOIN \n    FAC_BUILDING_ADDRESS fba ON fb.FAC_BUILDING_KEY = fba.BUILDING_KEY\nJOIN \n    FAC_FLOOR f ON fb.FAC_BUILDING_KEY = f.BUILDING_KEY\nJOIN \n    FAC_ROOMS r ON f.FLOOR_KEY = r.FLOOR_KEY\nGROUP BY \n    fb.BUILDING_NAME, \n    fb.BUILDING_HEIGHT,\n    b.BUILDING_STREET_ADDRESS,\n    fba.CITY,\n    fba.STATE,\n    fba.POSTAL_CODE,\n    fb.EXT_GROSS_AREA,\n    fb.ASSIGNABLE_AREA;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349855, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=261, prompt_tokens=2539, total_tokens=2800, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=261, prompt_tokens=2539, total_tokens=2800, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    fb.BUILDING_NAME,
    fb.BUILDING_HEIGHT,
    b.BUILDING_STREET_ADDRESS,
    fba.CITY,
    fba.STATE,
    fba.POSTAL_CODE,
    fb.EXT_GROSS_AREA,
    fb.ASSIGNABLE_AREA,
    MIN(f.FLOOR) AS SMALLEST_FLOOR_LEVEL,
    MAX(f.FLOOR) AS LARGEST_FLOOR_LEVEL,
    SUM(r.AREA) AS TOTAL_ROOM_AREA
FROM 
    FAC_BUILDING fb
JOIN 
    BUILDINGS b ON fb.FAC_BUILDING_KEY = b.BUILDING_KEY
JOIN 
    FAC_BUILDING_ADDRESS fba ON fb.FAC_BUILDING_KEY = fba.BUILDING_KEY
JOIN 
    FAC_FLOOR f ON fb.FAC_BUILDING_KEY = f.BUILDING_KEY
JOIN 
    FAC_ROOMS r ON f.FLOOR_KEY = r.FLOOR_KEY
GROUP BY 
    fb.BUILDING_NAME, 
    fb.BUILDING_HEIGHT,
    b.BUILDING_STREET_ADDRESS,
    fba.CITY,
    fba.STATE,
    fba.POSTAL_CODE,
    fb.EXT_GROSS_AREA,
    fb.ASSIGNABLE_AREA;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2539, 261
TOTAL                  : 103821, 95696, 8125
AVG                    : 2414.44, 2225.49, 188.95
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]

### Question ###
What is the total number of library materials, the minimum and maximum publication years, and the total number of materials status for each course name?

(Hints: Schema Mapping Hints:
- 'library materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_SYSTEM_NUMBER
- 'publication years' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'materials status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'course name' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QjZx0637dew86zR1fKyZMs7DFx', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    LCI.COURSE_NAME,\n    COUNT(DISTINCT LRC.CATALOG_SYSTEM_NUMBER) AS total_materials,\n    MIN(LRC.CATALOG_YEAR) AS min_publication_year,\n    MAX(LRC.CATALOG_YEAR) AS max_publication_year,\n    COUNT(DISTINCT LMS.LIBRARY_MATERIAL_STATUS) AS total_material_status\nFROM \n    LIBRARY_COURSE_INSTRUCTOR LCI\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_MATERIAL_STATUS LMS ON LRMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY\nGROUP BY \n    LCI.COURSE_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349857, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=202, prompt_tokens=1397, total_tokens=1599, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=202, prompt_tokens=1397, total_tokens=1599, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    LCI.COURSE_NAME,
    COUNT(DISTINCT LRC.CATALOG_SYSTEM_NUMBER) AS total_materials,
    MIN(LRC.CATALOG_YEAR) AS min_publication_year,
    MAX(LRC.CATALOG_YEAR) AS max_publication_year,
    COUNT(DISTINCT LMS.LIBRARY_MATERIAL_STATUS) AS total_material_status
FROM 
    LIBRARY_COURSE_INSTRUCTOR LCI
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_MATERIAL_STATUS LMS ON LRMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY
GROUP BY 
    LCI.COURSE_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1397, 202
TOTAL                  : 105420, 97093, 8327
AVG                    : 2395.91, 2206.66, 189.25
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: CIP
[
(PROGRAM_CODE:VARCHAR2, Examples: ['010000', '010100', '010101']),
(PROGRAM_TITLE:VARCHAR2, Examples: ['Agriculture, General', 'Agricultural Business and Management', 'Agricultural Business and Management, General']),
(CATEGORY_CODE:VARCHAR2, Examples: ['1', '2', '3']),
(CATEGORY_TITLE:VARCHAR2, Examples: ['AGRICULTURAL/ANIMAL/PLANT/VETERINARY SCIENCE AND RELATED FIELDS', 'AGRICULTURAL BUSINESS AND PRODUCTION', 'AGRICULTURE, AGRICULTURE OPERATIONS, AND RELATED SCIENCES']),
(FOUR_DIGIT_CODE:VARCHAR2, Examples: ['0100', '0101', '0102']),
(FOUR_DIGIT_TITLE:VARCHAR2, Examples: ['Agriculture, General', 'Agricultural Business and Management', 'Agricultural Mechanization']),
(NOTE:VARCHAR2, Examples: ['(2020) No substantive changes ', '(2020) No substantive changes- CIP text change ', 'New in 2020']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['17-MAY-23', '11-JUN-14']),
(VERSION:VARCHAR2, Examples: ['2020', '1990', '2010'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the category title, version, department name, school name, total number of courses for each course level, and the total number of degree-granting courses for each CIP category code?

(Hints: Schema Mapping Hints:
- 'category title' is related to CIP.CATEGORY_TITLE
- 'version' is related to CIP.VERSION
- 'department name' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'degree-granting courses' is related to SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING
- 'CIP category code' is related to CIP.CATEGORY_CODE

Join Information: (SIS_COURSE_DESCRIPTION.CIP_PROGRAM_CODE = CIP.PROGRAM_CODE), (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qi8fQrKxafZ3BxPapkmkos1CYT', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    CIP.CATEGORY_TITLE,\n    CIP.VERSION,\n    SIS_DEPARTMENT.DEPARTMENT_NAME,\n    SIS_DEPARTMENT.SCHOOL_NAME,\n    SIS_COURSE_DESCRIPTION.COURSE_LEVEL,\n    COUNT(SIS_COURSE_DESCRIPTION.COURSE) AS total_courses,\n    COUNT(CASE WHEN SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING = 'Y' THEN 1 END) AS total_degree_granting_courses\nFROM \n    CIP\nJOIN \n    SIS_COURSE_DESCRIPTION ON SIS_COURSE_DESCRIPTION.CIP_PROGRAM_CODE = CIP.PROGRAM_CODE\nJOIN \n    SIS_DEPARTMENT ON SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE\nGROUP BY \n    CIP.CATEGORY_TITLE, \n    CIP.VERSION, \n    SIS_DEPARTMENT.DEPARTMENT_NAME, \n    SIS_DEPARTMENT.SCHOOL_NAME, \n    SIS_COURSE_DESCRIPTION.COURSE_LEVEL\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349856, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=196, prompt_tokens=1538, total_tokens=1734, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=196, prompt_tokens=1538, total_tokens=1734, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    CIP.CATEGORY_TITLE,
    CIP.VERSION,
    SIS_DEPARTMENT.DEPARTMENT_NAME,
    SIS_DEPARTMENT.SCHOOL_NAME,
    SIS_COURSE_DESCRIPTION.COURSE_LEVEL,
    COUNT(SIS_COURSE_DESCRIPTION.COURSE) AS total_courses,
    COUNT(CASE WHEN SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING = 'Y' THEN 1 END) AS total_degree_granting_courses
FROM 
    CIP
JOIN 
    SIS_COURSE_DESCRIPTION ON SIS_COURSE_DESCRIPTION.CIP_PROGRAM_CODE = CIP.PROGRAM_CODE
JOIN 
    SIS_DEPARTMENT ON SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE
GROUP BY 
    CIP.CATEGORY_TITLE, 
    CIP.VERSION, 
    SIS_DEPARTMENT.DEPARTMENT_NAME, 
    SIS_DEPARTMENT.SCHOOL_NAME, 
    SIS_COURSE_DESCRIPTION.COURSE_LEVEL

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1538, 196
TOTAL                  : 107154, 98631, 8523
AVG                    : 2381.20, 2191.80, 189.40
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Retrieve the titles of subjects offered in the summer term along with their descriptions, responsible faculty names, email address, building name, room name, floor level, building street address, and the total number of types of courses per departmnet.

(Hints: Schema Mapping Hints:
- 'titles of subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'summer term' is related to ACADEMIC_TERMS.TERM_CODE
- 'descriptions' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_DESCRIPTION
- 'responsible faculty names' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_NAME
- 'email address' is related to EMPLOYEE_DIRECTORY.EMAIL_ADDRESS
- 'building name' is related to BUILDINGS.BUILDING_NAME
- 'room name' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'floor level' is related to FAC_FLOOR.LEVEL_ID
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'department' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID), (ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE), (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FAC_ROOMS.FAC_ROOM_KEY), (FAC_ROOMS.FLOOR_KEY = FAC_FLOOR.FLOOR_KEY), (FAC_ROOMS.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QhHgApjwXd7FKMyud9Tfos7e0q', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    c.SUBJECT_TITLE, \n    c.SUBJECT_DESCRIPTION, \n    c.RESPONSIBLE_FACULTY_NAME, \n    e.EMAIL_ADDRESS, \n    b.BUILDING_NAME, \n    r.ROOM_FULL_NAME, \n    f.LEVEL_ID, \n    b.BUILDING_STREET_ADDRESS, \n    COUNT(DISTINCT c.SUBJECT_ID) AS TOTAL_COURSE_TYPES\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN \n    ACADEMIC_TERMS t ON c.TERM_CODE = t.TERM_CODE\nJOIN \n    EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID\nJOIN \n    FAC_ROOMS r ON c.MEET_PLACE = r.FAC_ROOM_KEY\nJOIN \n    FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY\nJOIN \n    BUILDINGS b ON r.BUILDING_KEY = b.BUILDING_KEY\nJOIN \n    FAC_BUILDING_ADDRESS a ON b.BUILDING_KEY = a.BUILDING_KEY\nWHERE \n    t.TERM_CODE LIKE '%SUMMER%' \nGROUP BY \n    c.SUBJECT_TITLE, \n    c.SUBJECT_DESCRIPTION, \n    c.RESPONSIBLE_FACULTY_NAME, \n    e.EMAIL_ADDRESS, \n    b.BUILDING_NAME, \n    r.ROOM_FULL_NAME, \n    f.LEVEL_ID, \n    b.BUILDING_STREET_ADDRESS;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349855, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=310, prompt_tokens=4978, total_tokens=5288, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=310, prompt_tokens=4978, total_tokens=5288, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    c.SUBJECT_TITLE, 
    c.SUBJECT_DESCRIPTION, 
    c.RESPONSIBLE_FACULTY_NAME, 
    e.EMAIL_ADDRESS, 
    b.BUILDING_NAME, 
    r.ROOM_FULL_NAME, 
    f.LEVEL_ID, 
    b.BUILDING_STREET_ADDRESS, 
    COUNT(DISTINCT c.SUBJECT_ID) AS TOTAL_COURSE_TYPES
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED c
JOIN 
    ACADEMIC_TERMS t ON c.TERM_CODE = t.TERM_CODE
JOIN 
    EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID
JOIN 
    FAC_ROOMS r ON c.MEET_PLACE = r.FAC_ROOM_KEY
JOIN 
    FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY
JOIN 
    BUILDINGS b ON r.BUILDING_KEY = b.BUILDING_KEY
JOIN 
    FAC_BUILDING_ADDRESS a ON b.BUILDING_KEY = a.BUILDING_KEY
WHERE 
    t.TERM_CODE LIKE '%SUMMER%' 
GROUP BY 
    c.SUBJECT_TITLE, 
    c.SUBJECT_DESCRIPTION, 
    c.RESPONSIBLE_FACULTY_NAME, 
    e.EMAIL_ADDRESS, 
    b.BUILDING_NAME, 
    r.ROOM_FULL_NAME, 
    f.LEVEL_ID, 
    b.BUILDING_STREET_ADDRESS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4978, 310
TOTAL                  : 112442, 103609, 8833
AVG                    : 2444.39, 2252.37, 192.02
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the material status, term description, total number of courses and materials, occurences in departments and school, and the total number of instructors for each library material status code and term code?

(Hints: Schema Mapping Hints:
- 'material status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'courses' is related to LIBRARY_SUBJECT_OFFERED.COURSE_NUMBER
- 'materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_SYSTEM_NUMBER
- 'departments' is related to LIBRARY_SUBJECT_OFFERED.OFFER_DEPT_CODE
- 'school' is related to LIBRARY_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'instructors' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'library material status code' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_CODE
- 'term code' is related to LIBRARY_SUBJECT_OFFERED.TERM_CODE

Join Information: (LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (ACADEMIC_TERMS_ALL.TERM_CODE = LIBRARY_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QjT5eJjI8OFOPCiMAhZodWtEvm', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    LMS.LIBRARY_MATERIAL_STATUS AS material_status,\n    ATA.TERM_DESCRIPTION AS term_description,\n    COUNT(DISTINCT LSO.COURSE_NUMBER) AS total_courses,\n    COUNT(DISTINCT LRC.CATALOG_SYSTEM_NUMBER) AS total_materials,\n    COUNT(DISTINCT LSO.OFFER_DEPT_CODE) AS occurrences_in_departments,\n    COUNT(DISTINCT LSO.OFFER_SCHOOL_NAME) AS occurrences_in_schools,\n    COUNT(DISTINCT LCI.INSTRUCTOR_NAME) AS total_instructors\nFROM \n    LIBRARY_MATERIAL_STATUS LMS\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LMS.LIBRARY_MATERIAL_STATUS_KEY = LRMD.LIBRARY_MATERIAL_STATUS_KEY\nJOIN \n    LIBRARY_SUBJECT_OFFERED LSO ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRMD.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG LRC ON LRC.LIBRARY_RESERVE_CATALOG_KEY = LRMD.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_COURSE_INSTRUCTOR LCI ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    ACADEMIC_TERMS_ALL ATA ON ATA.TERM_CODE = LSO.TERM_CODE\nGROUP BY \n    LMS.LIBRARY_MATERIAL_STATUS, ATA.TERM_DESCRIPTION;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349857, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=305, prompt_tokens=2719, total_tokens=3024, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=305, prompt_tokens=2719, total_tokens=3024, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    LMS.LIBRARY_MATERIAL_STATUS AS material_status,
    ATA.TERM_DESCRIPTION AS term_description,
    COUNT(DISTINCT LSO.COURSE_NUMBER) AS total_courses,
    COUNT(DISTINCT LRC.CATALOG_SYSTEM_NUMBER) AS total_materials,
    COUNT(DISTINCT LSO.OFFER_DEPT_CODE) AS occurrences_in_departments,
    COUNT(DISTINCT LSO.OFFER_SCHOOL_NAME) AS occurrences_in_schools,
    COUNT(DISTINCT LCI.INSTRUCTOR_NAME) AS total_instructors
FROM 
    LIBRARY_MATERIAL_STATUS LMS
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LMS.LIBRARY_MATERIAL_STATUS_KEY = LRMD.LIBRARY_MATERIAL_STATUS_KEY
JOIN 
    LIBRARY_SUBJECT_OFFERED LSO ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRMD.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG LRC ON LRC.LIBRARY_RESERVE_CATALOG_KEY = LRMD.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_COURSE_INSTRUCTOR LCI ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    ACADEMIC_TERMS_ALL ATA ON ATA.TERM_CODE = LSO.TERM_CODE
GROUP BY 
    LMS.LIBRARY_MATERIAL_STATUS, ATA.TERM_DESCRIPTION;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2719, 305
TOTAL                  : 115466, 106328, 9138
AVG                    : 2456.72, 2262.30, 194.43
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_FLOOR
[
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR_NAME:VARCHAR2, Examples: ['0 Floor', '00 Floor', '000 Floor']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_USAGE
[
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(SPACE_USAGE:VARCHAR2, Examples: ['ARC ROOM', 'TST ROOM', 'RSRC RM']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For building 36, list all space units, their floor and building name, building street address, their space usage, and the number of organizations and space units on the same building and floor.

(Hints: Schema Mapping Hints:
- 'building 36' is related to BUILDINGS.BUILDING_NUMBER
- 'space units' is related to SPACE_UNIT.SPACE_UNIT
- 'floor' is related to SPACE_FLOOR.FLOOR
- 'building name' is related to BUILDINGS.BUILDING_NAME
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'space usage' is related to SPACE_USAGE.SPACE_USAGE
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY

Join Information: (SPACE_DETAIL.SPACE_UNIT_KEY = SPACE_UNIT.SPACE_UNIT_KEY), (SPACE_USAGE.SPACE_USAGE_KEY = SPACE_DETAIL.SPACE_USAGE_KEY), (SPACE_DETAIL.FLOOR_KEY = SPACE_FLOOR.FLOOR_KEY), (SPACE_DETAIL.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = SPACE_UNIT.FCLT_ORGANIZATION_KEY), (BUILDINGS.BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qk0kR0l8AFJw2eHppNqZzeWJTL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    SU.SPACE_UNIT, \n    SF.FLOOR, \n    B.BUILDING_NAME, \n    B.BUILDING_STREET_ADDRESS, \n    SUU.SPACE_USAGE, \n    COUNT(DISTINCT O.FCLT_ORGANIZATION_KEY) AS ORGANIZATION_COUNT, \n    COUNT(DISTINCT SU.SPACE_UNIT_KEY) AS SPACE_UNIT_COUNT\nFROM \n    BUILDINGS B\nJOIN \n    SPACE_DETAIL SD ON B.BUILDING_KEY = SD.BUILDING_KEY\nJOIN \n    SPACE_UNIT SU ON SD.SPACE_UNIT_KEY = SU.SPACE_UNIT_KEY\nJOIN \n    SPACE_USAGE SUU ON SD.SPACE_USAGE_KEY = SUU.SPACE_USAGE_KEY\nJOIN \n    SPACE_FLOOR SF ON SD.FLOOR_KEY = SF.FLOOR_KEY\nLEFT JOIN \n    FCLT_ORGANIZATION O ON SU.FCLT_ORGANIZATION_KEY = O.FCLT_ORGANIZATION_KEY\nWHERE \n    B.BUILDING_NUMBER = '36'\nGROUP BY \n    SU.SPACE_UNIT, SF.FLOOR, B.BUILDING_NAME, B.BUILDING_STREET_ADDRESS, SUU.SPACE_USAGE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349858, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=245, prompt_tokens=1922, total_tokens=2167, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=245, prompt_tokens=1922, total_tokens=2167, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    SU.SPACE_UNIT, 
    SF.FLOOR, 
    B.BUILDING_NAME, 
    B.BUILDING_STREET_ADDRESS, 
    SUU.SPACE_USAGE, 
    COUNT(DISTINCT O.FCLT_ORGANIZATION_KEY) AS ORGANIZATION_COUNT, 
    COUNT(DISTINCT SU.SPACE_UNIT_KEY) AS SPACE_UNIT_COUNT
FROM 
    BUILDINGS B
JOIN 
    SPACE_DETAIL SD ON B.BUILDING_KEY = SD.BUILDING_KEY
JOIN 
    SPACE_UNIT SU ON SD.SPACE_UNIT_KEY = SU.SPACE_UNIT_KEY
JOIN 
    SPACE_USAGE SUU ON SD.SPACE_USAGE_KEY = SUU.SPACE_USAGE_KEY
JOIN 
    SPACE_FLOOR SF ON SD.FLOOR_KEY = SF.FLOOR_KEY
LEFT JOIN 
    FCLT_ORGANIZATION O ON SU.FCLT_ORGANIZATION_KEY = O.FCLT_ORGANIZATION_KEY
WHERE 
    B.BUILDING_NUMBER = '36'
GROUP BY 
    SU.SPACE_UNIT, SF.FLOOR, B.BUILDING_NAME, B.BUILDING_STREET_ADDRESS, SUU.SPACE_USAGE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1922, 245
TOTAL                  : 117633, 108250, 9383
AVG                    : 2450.69, 2255.21, 195.48
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each distinct mailing list containing more than 1000 people and with a name starting with A (case insensitive), provide its name, whether it is a mailing list, whether it is a moira group, whether it is a NFS group, the owner of the mailing list, and the number of people in the list.

(Hints: Schema Mapping Hints:
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'mailing list' is related to MOIRA_LIST.IS_MOIRA_MAILING_LIST
- 'moira group' is related to MOIRA_LIST.IS_MOIRA_GROUP
- 'NFS group' is related to MOIRA_LIST.IS_NFS_GROUP
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'people' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Ql43vhbCvq7ZZVsotfCivoG8Wq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ML.MOIRA_LIST_NAME, \n    ML.IS_MOIRA_MAILING_LIST, \n    ML.IS_MOIRA_GROUP, \n    ML.IS_NFS_GROUP, \n    O.OWNER, \n    COUNT(DISTINCT MD.MOIRA_LIST_MEMBER) AS NumberOfPeople\nFROM \n    MOIRA_LIST ML\nJOIN \n    MOIRA_LIST_DETAIL MD ON ML.MOIRA_LIST_KEY = MD.MOIRA_LIST_KEY\nJOIN \n    MOIRA_LIST_OWNER O ON MD.MOIRA_LIST_OWNER_KEY = O.MOIRA_LIST_OWNER_KEY\nWHERE \n    ML.IS_MOIRA_MAILING_LIST = 'Y' \n    AND ML.MOIRA_LIST_NAME LIKE 'A%' \nGROUP BY \n    ML.MOIRA_LIST_NAME, \n    ML.IS_MOIRA_MAILING_LIST, \n    ML.IS_MOIRA_GROUP, \n    ML.IS_NFS_GROUP, \n    O.OWNER\nHAVING \n    COUNT(DISTINCT MD.MOIRA_LIST_MEMBER) > 1000;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349859, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=216, prompt_tokens=889, total_tokens=1105, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=216, prompt_tokens=889, total_tokens=1105, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ML.MOIRA_LIST_NAME, 
    ML.IS_MOIRA_MAILING_LIST, 
    ML.IS_MOIRA_GROUP, 
    ML.IS_NFS_GROUP, 
    O.OWNER, 
    COUNT(DISTINCT MD.MOIRA_LIST_MEMBER) AS NumberOfPeople
FROM 
    MOIRA_LIST ML
JOIN 
    MOIRA_LIST_DETAIL MD ON ML.MOIRA_LIST_KEY = MD.MOIRA_LIST_KEY
JOIN 
    MOIRA_LIST_OWNER O ON MD.MOIRA_LIST_OWNER_KEY = O.MOIRA_LIST_OWNER_KEY
WHERE 
    ML.IS_MOIRA_MAILING_LIST = 'Y' 
    AND ML.MOIRA_LIST_NAME LIKE 'A%' 
GROUP BY 
    ML.MOIRA_LIST_NAME, 
    ML.IS_MOIRA_MAILING_LIST, 
    ML.IS_MOIRA_GROUP, 
    ML.IS_NFS_GROUP, 
    O.OWNER
HAVING 
    COUNT(DISTINCT MD.MOIRA_LIST_MEMBER) > 1000;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 889, 216
TOTAL                  : 118738, 109139, 9599
AVG                    : 2423.22, 2227.33, 195.90
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For email lists with names starting with C (case insensitive) and containing faculty who teach courses in the summer in financial aid years after 2001, provide the name of the list, the number of people in the list, and the number of faculty in the list.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'faculty' is related to EMPLOYEE_DIRECTORY.MIT_ID
- 'courses in the summer' is related to ACADEMIC_TERMS.TERM_CODE
- 'financial aid years' is related to ACADEMIC_TERMS.FINANCIAL_AID_YEAR
- 'people' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (EMPLOYEE_DIRECTORY.MIT_ID = COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID), (ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QmrGJIaxB8U27yg2zI1zcWMsBM', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME,\n    COUNT(mld.MOIRA_LIST_MEMBER) AS total_members,\n    COUNT(DISTINCT ed.MIT_ID) AS faculty_count\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    EMPLOYEE_DIRECTORY ed ON mld.MOIRA_LIST_MEMBER_MIT_ID = ed.MIT_ID\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED cc ON ed.MIT_ID = cc.RESPONSIBLE_FACULTY_MIT_ID\nJOIN \n    ACADEMIC_TERMS at ON cc.TERM_CODE = at.TERM_CODE\nWHERE \n    ml.MOIRA_LIST_NAME ILIKE 'C%'\n    AND at.FINANCIAL_AID_YEAR > '2001'\n    AND at.IS_OFFERED_SUMMER_TERM = 'Y'\nGROUP BY \n    ml.MOIRA_LIST_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349860, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=204, prompt_tokens=3943, total_tokens=4147, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=204, prompt_tokens=3943, total_tokens=4147, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME,
    COUNT(mld.MOIRA_LIST_MEMBER) AS total_members,
    COUNT(DISTINCT ed.MIT_ID) AS faculty_count
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    EMPLOYEE_DIRECTORY ed ON mld.MOIRA_LIST_MEMBER_MIT_ID = ed.MIT_ID
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED cc ON ed.MIT_ID = cc.RESPONSIBLE_FACULTY_MIT_ID
JOIN 
    ACADEMIC_TERMS at ON cc.TERM_CODE = at.TERM_CODE
WHERE 
    ml.MOIRA_LIST_NAME ILIKE 'C%'
    AND at.FINANCIAL_AID_YEAR > '2001'
    AND at.IS_OFFERED_SUMMER_TERM = 'Y'
GROUP BY 
    ml.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3943, 204
TOTAL                  : 122885, 113082, 9803
AVG                    : 2457.70, 2261.64, 196.06
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For faculty who are responsible for courses in 2023 fall term, list the name of mailing lists with ten members that they subscribe to, the number of faculty in these lists, and the number of courses associated with those faculty.

(Hints: Schema Mapping Hints:
- 'faculty' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID
- '2023 fall term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'name of mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE

Join Information: (employee_directory.MIT_ID = COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID), (employee_directory.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QmOI3qUvPMNyY7CxXwENKJPyfh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS number_of_faculty, \n    COUNT(DISTINCT c.SUBJECT_TITLE) AS number_of_courses\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN \n    EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID\nJOIN \n    MOIRA_LIST_DETAIL mld ON e.KRB_NAME = mld.MOIRA_LIST_MEMBER\nJOIN \n    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY\nWHERE \n    c.TERM_CODE = '2023FA'\nGROUP BY \n    ml.MOIRA_LIST_NAME\nHAVING \n    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) = 10;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349860, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=179, prompt_tokens=3276, total_tokens=3455, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=179, prompt_tokens=3276, total_tokens=3455, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS number_of_faculty, 
    COUNT(DISTINCT c.SUBJECT_TITLE) AS number_of_courses
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED c
JOIN 
    EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID
JOIN 
    MOIRA_LIST_DETAIL mld ON e.KRB_NAME = mld.MOIRA_LIST_MEMBER
JOIN 
    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY
WHERE 
    c.TERM_CODE = '2023FA'
GROUP BY 
    ml.MOIRA_LIST_NAME
HAVING 
    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) = 10;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3276, 179
TOTAL                  : 126340, 116358, 9982
AVG                    : 2477.25, 2281.53, 195.73
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Regarding the mailing list about duo users, provide the number of students in this list, and the number of departments and schools associated with these students.

(Hints: Schema Mapping Hints:
- 'duo users' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'students' is related to SE_PERSON.MIT_ID
- 'departments' is related to SIS_DEPARTMENT.DEPARTMENT_CODE
- 'schools' is related to SIS_DEPARTMENT.SCHOOL_CODE

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qm1M7OH81OxW7dNsDcctpkaNkE', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    COUNT(DISTINCT moira.MOIRA_LIST_MEMBER_MIT_ID) AS student_count,\n    COUNT(DISTINCT dept.DEPARTMENT_CODE) AS department_count,\n    COUNT(DISTINCT dept.SCHOOL_CODE) AS school_count\nFROM \n    MOIRA_LIST moira\nJOIN \n    MOIRA_LIST_DETAIL moira_detail ON moira.MOIRA_LIST_KEY = moira_detail.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON student ON moira_detail.MOIRA_LIST_MEMBER_MIT_ID = student.MIT_ID\nJOIN \n    MIT_STUDENT_DIRECTORY std_dir ON student.MIT_ID = std_dir.EMAIL_ADDRESS\nJOIN \n    SIS_DEPARTMENT dept ON std_dir.DEPARTMENT = dept.DEPARTMENT_CODE\nWHERE \n    moira.MOIRA_LIST_NAME = 'cat-duo-users';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349860, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=176, prompt_tokens=1623, total_tokens=1799, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=176, prompt_tokens=1623, total_tokens=1799, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    COUNT(DISTINCT moira.MOIRA_LIST_MEMBER_MIT_ID) AS student_count,
    COUNT(DISTINCT dept.DEPARTMENT_CODE) AS department_count,
    COUNT(DISTINCT dept.SCHOOL_CODE) AS school_count
FROM 
    MOIRA_LIST moira
JOIN 
    MOIRA_LIST_DETAIL moira_detail ON moira.MOIRA_LIST_KEY = moira_detail.MOIRA_LIST_KEY
JOIN 
    SE_PERSON student ON moira_detail.MOIRA_LIST_MEMBER_MIT_ID = student.MIT_ID
JOIN 
    MIT_STUDENT_DIRECTORY std_dir ON student.MIT_ID = std_dir.EMAIL_ADDRESS
JOIN 
    SIS_DEPARTMENT dept ON std_dir.DEPARTMENT = dept.DEPARTMENT_CODE
WHERE 
    moira.MOIRA_LIST_NAME = 'cat-duo-users';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1623, 176
TOTAL                  : 128139, 117981, 10158
AVG                    : 2464.21, 2268.87, 195.35
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the mailing lists with the largest number of members and the least number of members, including their names, owners, public status, hidden status, and number of members in the list. If a mailing list has multiple owners, create a separate entry for each owner. Similarly, if multiple lists share the minimum or maximum member count, include all those lists.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'owners' is related to MOIRA_LIST_OWNER.OWNER
- 'public status' is related to MOIRA_LIST.IS_PUBLIC
- 'hidden status' is related to MOIRA_LIST.IS_HIDDEN
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qm0fTor1LKAYOekQdXS3SGYdSd', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nWITH MemberCounts AS (\n    SELECT \n        ml.MOIRA_LIST_NAME,\n        mol.OWNER,\n        ml.IS_PUBLIC,\n        ml.IS_HIDDEN,\n        COUNT(mld.MOIRA_LIST_MEMBER) AS member_count\n    FROM \n        MOIRA_LIST ml\n    JOIN \n        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\n    JOIN \n        MOIRA_LIST_OWNER mol ON mld.MOIRA_LIST_OWNER_KEY = mol.MOIRA_LIST_OWNER_KEY\n    GROUP BY \n        ml.MOIRA_LIST_NAME, mol.OWNER, ml.IS_PUBLIC, ml.IS_HIDDEN\n),\nMaxMinCounts AS (\n    SELECT \n        MAX(member_count) AS max_count,\n        MIN(member_count) AS min_count\n    FROM \n        MemberCounts\n)\nSELECT \n    mc.MOIRA_LIST_NAME,\n    mc.OWNER,\n    mc.IS_PUBLIC,\n    mc.IS_HIDDEN,\n    mc.member_count\nFROM \n    MemberCounts mc\nJOIN \n    MaxMinCounts mmc ON mc.member_count = mmc.max_count OR mc.member_count = mmc.min_count\nORDER BY \n    mc.member_count;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349860, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=245, prompt_tokens=868, total_tokens=1113, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=245, prompt_tokens=868, total_tokens=1113, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH MemberCounts AS (
    SELECT 
        ml.MOIRA_LIST_NAME,
        mol.OWNER,
        ml.IS_PUBLIC,
        ml.IS_HIDDEN,
        COUNT(mld.MOIRA_LIST_MEMBER) AS member_count
    FROM 
        MOIRA_LIST ml
    JOIN 
        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
    JOIN 
        MOIRA_LIST_OWNER mol ON mld.MOIRA_LIST_OWNER_KEY = mol.MOIRA_LIST_OWNER_KEY
    GROUP BY 
        ml.MOIRA_LIST_NAME, mol.OWNER, ml.IS_PUBLIC, ml.IS_HIDDEN
),
MaxMinCounts AS (
    SELECT 
        MAX(member_count) AS max_count,
        MIN(member_count) AS min_count
    FROM 
        MemberCounts
)
SELECT 
    mc.MOIRA_LIST_NAME,
    mc.OWNER,
    mc.IS_PUBLIC,
    mc.IS_HIDDEN,
    mc.member_count
FROM 
    MemberCounts mc
JOIN 
    MaxMinCounts mmc ON mc.member_count = mmc.max_count OR mc.member_count = mmc.min_count
ORDER BY 
    mc.member_count;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 868, 245
TOTAL                  : 129252, 118849, 10403
AVG                    : 2438.72, 2242.43, 196.28
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the email lists subscribed by faculty members with last names begin with Y, list the names of the lists, the total number of subjects managed by faculty in those mailing lists, and the number of such faculty in the lists.

(Hints: Schema Mapping Hints:
- 'last names' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_NAME
- 'names of the lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'faculty' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_NAME

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QqAvGMFe2B22evup8U4RylPNKi', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME,\n    COUNT(DISTINCT cso.SUBJECT_ID) AS total_subjects,\n    COUNT(DISTINCT ed.MIT_ID) AS total_faculty\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    EMPLOYEE_DIRECTORY ed ON mld.MOIRA_LIST_MEMBER_MIT_ID = ed.MIT_ID\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED cso ON ed.FULL_NAME LIKE '%' || SUBSTR(ed.LAST_NAME, 1, 1) || '%'\nWHERE \n    ed.LAST_NAME LIKE 'Y%'\nGROUP BY \n    ml.MOIRA_LIST_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349864, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=161, prompt_tokens=3225, total_tokens=3386, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=161, prompt_tokens=3225, total_tokens=3386, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME,
    COUNT(DISTINCT cso.SUBJECT_ID) AS total_subjects,
    COUNT(DISTINCT ed.MIT_ID) AS total_faculty
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    EMPLOYEE_DIRECTORY ed ON mld.MOIRA_LIST_MEMBER_MIT_ID = ed.MIT_ID
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED cso ON ed.FULL_NAME LIKE '%' || SUBSTR(ed.LAST_NAME, 1, 1) || '%'
WHERE 
    ed.LAST_NAME LIKE 'Y%'
GROUP BY 
    ml.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3225, 161
TOTAL                  : 132638, 122074, 10564
AVG                    : 2456.26, 2260.63, 195.63
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the email list with name 'date-destiny', list the name of the list, department name, the number of students from the Management department, and the percentage of students who are from the Management department, rounded to two decimal places.

(Hints: Schema Mapping Hints:
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'students' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'Management department' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME

Join Information: (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (SE_PERSON.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QobSX2i63XJ20lBErH9SxbVHSG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME,\n    sad.SIS_ADMIN_DEPARTMENT_NAME,\n    COUNT(DISTINCT ms.FULL_NAME) AS number_of_students,\n    ROUND(COUNT(DISTINCT ms.FULL_NAME) * 100.0 / (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL mld WHERE mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY), 2) AS percentage_of_management_students\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON sp ON sp.KRB_NAME = mld.MOIRA_LIST_MEMBER\nJOIN \n    MIT_STUDENT_DIRECTORY ms ON ms.FULL_NAME = sp.FULL_NAME\nJOIN \n    SIS_ADMIN_DEPARTMENT sad ON ms.DEPARTMENT = sad.SIS_ADMIN_DEPARTMENT_CODE\nWHERE \n    ml.MOIRA_LIST_NAME = 'date-destiny' \n    AND sad.SIS_ADMIN_DEPARTMENT_NAME = 'Management department'\nGROUP BY \n    ml.MOIRA_LIST_NAME, sad.SIS_ADMIN_DEPARTMENT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349862, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=237, prompt_tokens=1470, total_tokens=1707, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=237, prompt_tokens=1470, total_tokens=1707, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME,
    sad.SIS_ADMIN_DEPARTMENT_NAME,
    COUNT(DISTINCT ms.FULL_NAME) AS number_of_students,
    ROUND(COUNT(DISTINCT ms.FULL_NAME) * 100.0 / (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL mld WHERE mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY), 2) AS percentage_of_management_students
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    SE_PERSON sp ON sp.KRB_NAME = mld.MOIRA_LIST_MEMBER
JOIN 
    MIT_STUDENT_DIRECTORY ms ON ms.FULL_NAME = sp.FULL_NAME
JOIN 
    SIS_ADMIN_DEPARTMENT sad ON ms.DEPARTMENT = sad.SIS_ADMIN_DEPARTMENT_CODE
WHERE 
    ml.MOIRA_LIST_NAME = 'date-destiny' 
    AND sad.SIS_ADMIN_DEPARTMENT_NAME = 'Management department'
GROUP BY 
    ml.MOIRA_LIST_NAME, sad.SIS_ADMIN_DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1470, 237
TOTAL                  : 134345, 123544, 10801
AVG                    : 2442.64, 2246.25, 196.38
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For students with last names starting with H who are subscribed to mailing list 'beacon-date-date', list the names of the students, the phone numbers of departments they belong to, and the size of the mailing list 'beacon-date-date' that they are subscribed to.

(Hints: Schema Mapping Hints:
- 'last names' is related to MIT_STUDENT_DIRECTORY.LAST_NAME
- 'mailing list 'beacon-date-date'' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'names' is related to MIT_STUDENT_DIRECTORY.FULL_NAME
- 'phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'size of the mailing list' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE), (MIT_STUDENT_DIRECTORY.FULL_NAME = SE_PERSON.FULL_NAME), (SE_PERSON.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qq11TvEuwKxJiEArGsOcgWtZCK', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    msd.FULL_NAME, \n    sad.DEPARTMENT_PHONE_NUMBER, \n    (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL mld WHERE mld.MOIRA_LIST_KEY = 'beacon-date-date') AS mailing_list_size\nFROM \n    MIT_STUDENT_DIRECTORY msd\nJOIN \n    SE_PERSON sp ON msd.FULL_NAME = sp.FULL_NAME\nJOIN \n    MOIRA_LIST_DETAIL mld ON sp.KRB_NAME = mld.MOIRA_LIST_MEMBER\nJOIN \n    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY\nJOIN \n    SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE\nJOIN \n    SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE\nWHERE \n    msd.LAST_NAME LIKE 'H%' AND \n    ml.MOIRA_LIST_NAME = 'beacon-date-date';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349864, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=204, prompt_tokens=1920, total_tokens=2124, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=204, prompt_tokens=1920, total_tokens=2124, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    msd.FULL_NAME, 
    sad.DEPARTMENT_PHONE_NUMBER, 
    (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL mld WHERE mld.MOIRA_LIST_KEY = 'beacon-date-date') AS mailing_list_size
FROM 
    MIT_STUDENT_DIRECTORY msd
JOIN 
    SE_PERSON sp ON msd.FULL_NAME = sp.FULL_NAME
JOIN 
    MOIRA_LIST_DETAIL mld ON sp.KRB_NAME = mld.MOIRA_LIST_MEMBER
JOIN 
    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY
JOIN 
    SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE
JOIN 
    SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE
WHERE 
    msd.LAST_NAME LIKE 'H%' AND 
    ml.MOIRA_LIST_NAME = 'beacon-date-date';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1920, 204
TOTAL                  : 136469, 125464, 11005
AVG                    : 2436.95, 2240.43, 196.52
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
Give the count of mailing lists with names starting with B that include members from the Electrical Engineering and Computer Science department, along with the name of the list starting with B that have the highest number of members from that department and the corresponding member count.

(Hints: Schema Mapping Hints:
- 'mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'members' is related to SE_PERSON.MIT_ID
- 'Electrical Engineering and Computer Science department' is related to SE_PERSON.ORGANIZATION

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = SE_PERSON.KRB_NAME))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QqoquowixOgwe8yPA2LnL1gxyg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH MemberCounts AS (\n    SELECT \n        ml.MOIRA_LIST_NAME,\n        COUNT(*) AS member_count\n    FROM \n        MOIRA_LIST ml\n    JOIN \n        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\n    JOIN \n        SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME\n    WHERE \n        ml.MOIRA_LIST_NAME LIKE 'B%' AND \n        sp.ORGANIZATION = 'Electrical Engineering and Computer Science'\n    GROUP BY \n        ml.MOIRA_LIST_NAME\n)\nSELECT \n    (SELECT COUNT(*) FROM MemberCounts) AS total_mailings,\n    MAX(MOIRA_LIST_NAME) AS max_list_name,\n    MAX(member_count) AS max_member_count\nFROM \n    MemberCounts;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349864, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=170, prompt_tokens=954, total_tokens=1124, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=170, prompt_tokens=954, total_tokens=1124, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH MemberCounts AS (
    SELECT 
        ml.MOIRA_LIST_NAME,
        COUNT(*) AS member_count
    FROM 
        MOIRA_LIST ml
    JOIN 
        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
    JOIN 
        SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME
    WHERE 
        ml.MOIRA_LIST_NAME LIKE 'B%' AND 
        sp.ORGANIZATION = 'Electrical Engineering and Computer Science'
    GROUP BY 
        ml.MOIRA_LIST_NAME
)
SELECT 
    (SELECT COUNT(*) FROM MemberCounts) AS total_mailings,
    MAX(MOIRA_LIST_NAME) AS max_list_name,
    MAX(member_count) AS max_member_count
FROM 
    MemberCounts;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 954, 170
TOTAL                  : 137593, 126418, 11175
AVG                    : 2413.91, 2217.86, 196.05
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For each mailing list with a name beginning with R (case insensitive), and that Professor Ayden Hopkins is subscribed to, list its name, description, owner, number of people in the list, and number of tenured faculty in the list.

(Hints: Schema Mapping Hints:
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'Professor Ayden Hopkins' is related to SE_PERSON.FULL_NAME
- 'description' is related to MOIRA_LIST.MOIRA_LIST_DESCRIPTION
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'people' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'tenured faculty' is related to SE_PERSON.PAYROLL_RANK, MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QoSIqjj3u6LpCQdk9fhzmt4r2B', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    ml.MOIRA_LIST_DESCRIPTION, \n    mo.OWNER, \n    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS number_of_people,\n    SUM(CASE WHEN sp.PAYROLL_RANK LIKE '%tenured%' THEN 1 ELSE 0 END) AS number_of_tenured_faculty\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    MOIRA_LIST_OWNER mo ON mo.MOIRA_LIST_OWNER_KEY = mld.MOIRA_LIST_OWNER_KEY\nJOIN \n    SE_PERSON sp ON sp.MIT_ID = mld.MOIRA_LIST_MEMBER_MIT_ID\nWHERE \n    ml.IS_MOIRA_MAILING_LIST = 'Y' \n    AND ml.MOIRA_LIST_NAME LIKE 'R%' \n    AND mld.MOIRA_LIST_MEMBER_FULL_NAME = 'Hopkins, Ayden'\nGROUP BY \n    ml.MOIRA_LIST_NAME, \n    ml.MOIRA_LIST_DESCRIPTION, \n    mo.OWNER;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349862, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=237, prompt_tokens=1136, total_tokens=1373, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=237, prompt_tokens=1136, total_tokens=1373, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    ml.MOIRA_LIST_DESCRIPTION, 
    mo.OWNER, 
    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS number_of_people,
    SUM(CASE WHEN sp.PAYROLL_RANK LIKE '%tenured%' THEN 1 ELSE 0 END) AS number_of_tenured_faculty
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    MOIRA_LIST_OWNER mo ON mo.MOIRA_LIST_OWNER_KEY = mld.MOIRA_LIST_OWNER_KEY
JOIN 
    SE_PERSON sp ON sp.MIT_ID = mld.MOIRA_LIST_MEMBER_MIT_ID
WHERE 
    ml.IS_MOIRA_MAILING_LIST = 'Y' 
    AND ml.MOIRA_LIST_NAME LIKE 'R%' 
    AND mld.MOIRA_LIST_MEMBER_FULL_NAME = 'Hopkins, Ayden'
GROUP BY 
    ml.MOIRA_LIST_NAME, 
    ml.MOIRA_LIST_DESCRIPTION, 
    mo.OWNER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1136, 237
TOTAL                  : 138966, 127554, 11412
AVG                    : 2395.97, 2199.21, 196.76
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the 'kangaroo-inspire-yearn' email list, for each department present in the list, list the department name, the number of students in that department, and its percentage relative to the students in the mailing list.

(Hints: Schema Mapping Hints:
- ''kangaroo-inspire-yearn' email list' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'students' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (SE_PERSON.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QqPRk1JWN9EQWsEqeFZ0OtoYum', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    d.SIS_ADMIN_DEPARTMENT_NAME,\n    COUNT(sd.FULL_NAME) AS student_count,\n    COUNT(sd.FULL_NAME) * 100.0 / (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL WHERE MOIRA_LIST_KEY = 'kangaroo-inspire-yearn') AS percentage\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME\nJOIN \n    MIT_STUDENT_DIRECTORY sd ON sp.FULL_NAME = sd.FULL_NAME\nJOIN \n    SIS_ADMIN_DEPARTMENT d ON sd.DEPARTMENT = d.SIS_ADMIN_DEPARTMENT_CODE\nWHERE \n    ml.MOIRA_LIST_NAME = 'kangaroo-inspire-yearn'\nGROUP BY \n    d.SIS_ADMIN_DEPARTMENT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349864, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=191, prompt_tokens=1456, total_tokens=1647, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=191, prompt_tokens=1456, total_tokens=1647, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    d.SIS_ADMIN_DEPARTMENT_NAME,
    COUNT(sd.FULL_NAME) AS student_count,
    COUNT(sd.FULL_NAME) * 100.0 / (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL WHERE MOIRA_LIST_KEY = 'kangaroo-inspire-yearn') AS percentage
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME
JOIN 
    MIT_STUDENT_DIRECTORY sd ON sp.FULL_NAME = sd.FULL_NAME
JOIN 
    SIS_ADMIN_DEPARTMENT d ON sd.DEPARTMENT = d.SIS_ADMIN_DEPARTMENT_CODE
WHERE 
    ml.MOIRA_LIST_NAME = 'kangaroo-inspire-yearn'
GROUP BY 
    d.SIS_ADMIN_DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1456, 191
TOTAL                  : 140613, 129010, 11603
AVG                    : 2383.27, 2186.61, 196.66
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the building with the most floors, list the building name and the names of the mailing lists staring with a (case insensitive) that the building employees with kerberos starting with c (case insensitive) subscribe to.

(Hints: Schema Mapping Hints:
- 'floors' is related to FAC_FLOOR.LEVEL_ID
- 'building name' is related to FAC_BUILDING.BUILDING_NAME
- 'names of the mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'kerberos' is related to EMPLOYEE_DIRECTORY.KRB_NAME

Join Information: (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY), (FAC_ROOMS.FAC_ROOM_KEY = EMPLOYEE_DIRECTORY.OFFICE_LOCATION), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = EMPLOYEE_DIRECTORY.KRB_NAME), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QqZsUT2aiyVoB9hULI6pyYt07O', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT fb.BUILDING_NAME, ml.MOIRA_LIST_NAME\nFROM FAC_BUILDING fb\nJOIN FAC_FLOOR ff ON fb.FAC_BUILDING_KEY = ff.BUILDING_KEY\nJOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY\nJOIN EMPLOYEE_DIRECTORY ed ON fr.FAC_ROOM_KEY = ed.OFFICE_LOCATION\nJOIN MOIRA_LIST_DETAIL mld ON ed.KRB_NAME = mld.MOIRA_LIST_MEMBER\nJOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY\nWHERE ed.KRB_NAME LIKE 'c%'\nAND ml.MOIRA_LIST_NAME LIKE 'a%'\nAND fb.FAC_BUILDING_KEY = (\n    SELECT fb2.FAC_BUILDING_KEY\n    FROM FAC_BUILDING fb2\n    JOIN FAC_FLOOR ff2 ON fb2.FAC_BUILDING_KEY = ff2.BUILDING_KEY\n    GROUP BY fb2.FAC_BUILDING_KEY\n    ORDER BY COUNT(ff2.LEVEL_ID) DESC\n    LIMIT 1\n)\nORDER BY fb.BUILDING_NAME, ml.MOIRA_LIST_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349864, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=238, prompt_tokens=2960, total_tokens=3198, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=238, prompt_tokens=2960, total_tokens=3198, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT fb.BUILDING_NAME, ml.MOIRA_LIST_NAME
FROM FAC_BUILDING fb
JOIN FAC_FLOOR ff ON fb.FAC_BUILDING_KEY = ff.BUILDING_KEY
JOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY
JOIN EMPLOYEE_DIRECTORY ed ON fr.FAC_ROOM_KEY = ed.OFFICE_LOCATION
JOIN MOIRA_LIST_DETAIL mld ON ed.KRB_NAME = mld.MOIRA_LIST_MEMBER
JOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY
WHERE ed.KRB_NAME LIKE 'c%'
AND ml.MOIRA_LIST_NAME LIKE 'a%'
AND fb.FAC_BUILDING_KEY = (
    SELECT fb2.FAC_BUILDING_KEY
    FROM FAC_BUILDING fb2
    JOIN FAC_FLOOR ff2 ON fb2.FAC_BUILDING_KEY = ff2.BUILDING_KEY
    GROUP BY fb2.FAC_BUILDING_KEY
    ORDER BY COUNT(ff2.LEVEL_ID) DESC
    LIMIT 1
)
ORDER BY fb.BUILDING_NAME, ml.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2960, 238
TOTAL                  : 143811, 131970, 11841
AVG                    : 2396.85, 2199.50, 197.35
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For each course instructor in the 'keeper-zephyr' mailing list, provide the name of mailing lists they subscribe to, instructor name, earliest and latest publication years, and total number of enrolled students.

(Hints: Schema Mapping Hints:
- ''keeper-zephyr' mailing list' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'name of mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'instructor name' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'publication years' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME = SE_PERSON.FULL_NAME))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QoHElba12of3bjAX239ygUFfdj', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    ci.INSTRUCTOR_NAME, \n    MIN(rc.CATALOG_YEAR) AS Earliest_Publication_Year, \n    MAX(rc.CATALOG_YEAR) AS Latest_Publication_Year, \n    SUM(so.NUM_ENROLLED_STUDENTS) AS Total_Enrolled_Students\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME\nJOIN \n    LIBRARY_COURSE_INSTRUCTOR ci ON sp.FULL_NAME = ci.INSTRUCTOR_NAME\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL rmd ON ci.LIBRARY_COURSE_INSTRUCTOR_KEY = rmd.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG rc ON rmd.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_SUBJECT_OFFERED so ON rmd.LIBRARY_SUBJECT_OFFERED_KEY = so.LIBRARY_SUBJECT_OFFERED_KEY\nWHERE \n    ml.MOIRA_LIST_NAME = 'keeper-zephyr'\nGROUP BY \n    ml.MOIRA_LIST_NAME, ci.INSTRUCTOR_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349862, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=283, prompt_tokens=2571, total_tokens=2854, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=283, prompt_tokens=2571, total_tokens=2854, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    ci.INSTRUCTOR_NAME, 
    MIN(rc.CATALOG_YEAR) AS Earliest_Publication_Year, 
    MAX(rc.CATALOG_YEAR) AS Latest_Publication_Year, 
    SUM(so.NUM_ENROLLED_STUDENTS) AS Total_Enrolled_Students
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME
JOIN 
    LIBRARY_COURSE_INSTRUCTOR ci ON sp.FULL_NAME = ci.INSTRUCTOR_NAME
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL rmd ON ci.LIBRARY_COURSE_INSTRUCTOR_KEY = rmd.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG rc ON rmd.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_SUBJECT_OFFERED so ON rmd.LIBRARY_SUBJECT_OFFERED_KEY = so.LIBRARY_SUBJECT_OFFERED_KEY
WHERE 
    ml.MOIRA_LIST_NAME = 'keeper-zephyr'
GROUP BY 
    ml.MOIRA_LIST_NAME, ci.INSTRUCTOR_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2571, 283
TOTAL                  : 146665, 134541, 12124
AVG                    : 2404.34, 2205.59, 198.75
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Among the mailing lists subscribed by people with physical offices in building 24, provide the name of the most subscribed mailing list and the total number of subscribers.

(Hints: Schema Mapping Hints:
- 'physical offices in building 24' is related to EMPLOYEE_DIRECTORY.OFFICE_LOCATION
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subscribers' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (EMPLOYEE_DIRECTORY.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QsxLSCVCa9vbmjPWIRuHEY9BOe', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT ml.MOIRA_LIST_NAME, COUNT(mld.MOIRA_LIST_MEMBER) AS total_subscribers \nFROM MOIRA_LIST ml\nJOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN EMPLOYEE_DIRECTORY ed ON ed.KRB_NAME = mld.MOIRA_LIST_MEMBER\nWHERE ed.OFFICE_LOCATION LIKE '24%'\nGROUP BY ml.MOIRA_LIST_NAME\nORDER BY total_subscribers DESC\nLIMIT 1;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349866, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=104, prompt_tokens=1269, total_tokens=1373, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=104, prompt_tokens=1269, total_tokens=1373, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT ml.MOIRA_LIST_NAME, COUNT(mld.MOIRA_LIST_MEMBER) AS total_subscribers 
FROM MOIRA_LIST ml
JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN EMPLOYEE_DIRECTORY ed ON ed.KRB_NAME = mld.MOIRA_LIST_MEMBER
WHERE ed.OFFICE_LOCATION LIKE '24%'
GROUP BY ml.MOIRA_LIST_NAME
ORDER BY total_subscribers DESC
LIMIT 1;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1269, 104
TOTAL                  : 148038, 135810, 12228
AVG                    : 2387.71, 2190.48, 197.23
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For email lists subscribed by either support staff or faculty, list its name, the number of subscribers that are support staff, the number of subscribers that are faculty, as well as its active status.

(Hints: Schema Mapping Hints:
- 'support staff or faculty' is related to SE_PERSON.EMPLOYEE_TYPE
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subscribers' is related to SE_PERSON.EMPLOYEE_TYPE
- 'active status' is related to MOIRA_LIST.IS_ACTIVE

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qt4fLi6Zi4cX49daFHM2BKZYqV', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME,\n    COUNT(CASE WHEN sp.EMPLOYEE_TYPE = 'Support Staff' THEN 1 END) AS support_staff_count,\n    COUNT(CASE WHEN sp.EMPLOYEE_TYPE = 'Faculty' THEN 1 END) AS faculty_count,\n    ml.IS_ACTIVE\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER_MIT_ID = sp.MIT_ID\nWHERE \n    sp.EMPLOYEE_TYPE IN ('Support Staff', 'Faculty')\nGROUP BY \n    ml.MOIRA_LIST_NAME, ml.IS_ACTIVE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349867, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=154, prompt_tokens=924, total_tokens=1078, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=154, prompt_tokens=924, total_tokens=1078, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME,
    COUNT(CASE WHEN sp.EMPLOYEE_TYPE = 'Support Staff' THEN 1 END) AS support_staff_count,
    COUNT(CASE WHEN sp.EMPLOYEE_TYPE = 'Faculty' THEN 1 END) AS faculty_count,
    ml.IS_ACTIVE
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER_MIT_ID = sp.MIT_ID
WHERE 
    sp.EMPLOYEE_TYPE IN ('Support Staff', 'Faculty')
GROUP BY 
    ml.MOIRA_LIST_NAME, ml.IS_ACTIVE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 924, 154
TOTAL                  : 149116, 136734, 12382
AVG                    : 2366.92, 2170.38, 196.54
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: CIS_COURSE_CATALOG
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2003', '2002', '2007']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['097', '098', '090']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['N', 'Y', 'S']),
(DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:DATE, Examples: ['Electrical Eng & Computer Sci', 'Architecture', 'Chemistry']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1991FA', '1995FA', '1989FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['Y', 'N']),
(LECTURE_UNITS:VARCHAR2, Examples: [0, 3, 1]),
(LAB_UNITS:VARCHAR2, Examples: [0, 12, 4]),
(PREPARATION_UNITS:VARCHAR2, Examples: [0, 9, 5]),
(TOTAL_UNITS:VARCHAR2, Examples: [0, 12, 6]),
(DESIGN_UNITS:VARCHAR2, Examples: [0, 6, 8]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['R', 'J', 'N']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Can be repeated for credit', 'Continuing and Repeatable', 'Not repeatable for credit']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', 'H-LEVEL Grad Credit (except for Course 18 students)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['HD1', 'HE', 'HD5']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS-D, Category 1', 'HASS Elective', 'HASS-D, Category 5']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:NUMBER, Examples: ['RESH', 'NTRN', 'COOP']),
(TUITION_ATTRIBUTE_DESC:NUMBER, Examples: ['Pre-thesis Research Subject', 'Internship', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:NUMBER, Examples: ['WRT2', 'WRT1']),
(WRITE_REQ_ATTRIBUTE_DESC:NUMBER, Examples: ['Writing Requirement, Phase II', 'Writing Requirement, Phase I']),
(SUPERVISOR_ATTRIBUTE:NUMBER, Examples: ['UROP', 'THG', 'THU']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['UROP subject', 'Grad Thesis', 'Undergrad Thesis']),
(PREREQUISITES:VARCHAR2, Examples: ['Permission of instructor', '10.213', '12.120 and 12.103, or permission of instructor']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Crystal structures of mantle and core minerals, elastic and thermodynamic properties of materials at high pressure-temperature,', 'Investigates social conflict and distributional disputes in the public sector. While theoretical aspects of conflict are consid', 'Presents a framework for current landscape ecological theory, structured to encourage application in physical planning of lands']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.285J, 11.482J', '3.57J', '1.232J, 15.054J, 16.71J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE', '1.EPW, 3.EPW, 6.EPW, 10.EPW, 16.EPW, 20.EPW, 22.EPW', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['2.729J, EC.729J', 'EC.718J, WGS.277J', '21A.136J, 21G.026J']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['15.511, 15.515', '15.024', '15.414']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(STATUS_CHANGE:VARCHAR2, Examples: ['(2016: New number: 21G.110)', '(2016: New number: 21G.113)', '(2016: New number: 21G.142)']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['02-SEP-01', '12-JAN-06', '16-MAY-05']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.005']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HS', 'HA', 'HH']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Social Sciences', 'HASS Arts', 'HASS Humanities']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'Second Half Term Subject', 'First Half Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Asia', 'United States of America']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['China', 'Brazil|Uruguay|Vietnam|Russia|Australia', 'United States of America']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m2c.html', 'http://student.mit.edu/catalog/m3b.html'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED_SUMMARY
[
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese II', 'Eng 10A: British Writers', 'Biology of Cancer Cell']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0035, HAA.0036, HAA.0042, HAA.006', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0001, HAA.0002, HAA.0003, HAA.0004, HAA.0005, HAA.0006, HAA.0007, HAA.0008, HAA.0009, HAA.0010, HAA.0011, HAA.001']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Graduate program', 'Higher level graduate program']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'Architecture and Planning']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(TOTAL_UNITS:NUMBER, Examples: [15, 1, 24]),
(LECTURE_UNITS:NUMBER, Examples: [0, 6, 12]),
(LAB_UNITS:NUMBER, Examples: [15, 1, 24]),
(PREPARATION_UNITS:NUMBER, Examples: [0, 9, 8]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [195, 159, 170]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA'])
]

### Question ###
For Political Science courses with HASS attributes, for each attribute, list the name and description of the attribute, the number of unique subjects, average units, the total enrollment, the number of departments that grant degrees, and the subject code description.

(Hints: Schema Mapping Hints:
- 'Political Science' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'name' is related to CIS_COURSE_CATALOG.HASS_ATTRIBUTE
- 'description' is related to CIS_COURSE_CATALOG.HASS_ATTRIBUTE_DESC
- 'subjects' is related to CIS_COURSE_CATALOG.SUBJECT_ID
- 'units' is related to CIS_COURSE_CATALOG.TOTAL_UNITS
- 'enrollment' is related to SUBJECT_OFFERED_SUMMARY.NUM_ENROLLED_STUDENTS
- 'departments that grant degrees' is related to SIS_DEPARTMENT.IS_DEGREE_GRANTING
- 'subject code description' is related to SIS_SUBJECT_CODE.SUBJECT_CODE_DESC

Join Information: (CIS_COURSE_CATALOG.SUBJECT_CODE = SIS_SUBJECT_CODE.SUBJECT_CODE), (SUBJECT_OFFERED_SUMMARY.SUBJECT_ID = CIS_COURSE_CATALOG.SUBJECT_ID), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_SUBJECT_CODE.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qtvbng18XkrzVJM5d94fBGCTt8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    c.HASS_ATTRIBUTE AS name,\n    c.HASS_ATTRIBUTE_DESC AS description,\n    COUNT(DISTINCT c.SUBJECT_ID) AS unique_subjects,\n    AVG(c.TOTAL_UNITS) AS average_units,\n    SUM(s.NUM_ENROLLED_STUDENTS) AS total_enrollment,\n    COUNT(DISTINCT d.DEPARTMENT_CODE) AS departments_granting_degrees,\n    sc.SUBJECT_CODE_DESC AS subject_code_description\nFROM \n    CIS_COURSE_CATALOG c\nJOIN \n    SUBJECT_OFFERED_SUMMARY s ON c.SUBJECT_ID = s.SUBJECT_ID\nJOIN \n    SIS_SUBJECT_CODE sc ON c.SUBJECT_CODE = sc.SUBJECT_CODE\nJOIN \n    SIS_DEPARTMENT d ON sc.DEPARTMENT_CODE = d.DEPARTMENT_CODE\nWHERE \n    d.DEPARTMENT_NAME = 'Political Science' \nGROUP BY \n    c.HASS_ATTRIBUTE, c.HASS_ATTRIBUTE_DESC, sc.SUBJECT_CODE_DESC;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349867, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=206, prompt_tokens=3609, total_tokens=3815, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=206, prompt_tokens=3609, total_tokens=3815, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    c.HASS_ATTRIBUTE AS name,
    c.HASS_ATTRIBUTE_DESC AS description,
    COUNT(DISTINCT c.SUBJECT_ID) AS unique_subjects,
    AVG(c.TOTAL_UNITS) AS average_units,
    SUM(s.NUM_ENROLLED_STUDENTS) AS total_enrollment,
    COUNT(DISTINCT d.DEPARTMENT_CODE) AS departments_granting_degrees,
    sc.SUBJECT_CODE_DESC AS subject_code_description
FROM 
    CIS_COURSE_CATALOG c
JOIN 
    SUBJECT_OFFERED_SUMMARY s ON c.SUBJECT_ID = s.SUBJECT_ID
JOIN 
    SIS_SUBJECT_CODE sc ON c.SUBJECT_CODE = sc.SUBJECT_CODE
JOIN 
    SIS_DEPARTMENT d ON sc.DEPARTMENT_CODE = d.DEPARTMENT_CODE
WHERE 
    d.DEPARTMENT_NAME = 'Political Science' 
GROUP BY 
    c.HASS_ATTRIBUTE, c.HASS_ATTRIBUTE_DESC, sc.SUBJECT_CODE_DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3609, 206
TOTAL                  : 152931, 140343, 12588
AVG                    : 2389.55, 2192.86, 196.69
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED_SUMMARY
[
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese II', 'Eng 10A: British Writers', 'Biology of Cancer Cell']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0035, HAA.0036, HAA.0042, HAA.006', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0001, HAA.0002, HAA.0003, HAA.0004, HAA.0005, HAA.0006, HAA.0007, HAA.0008, HAA.0009, HAA.0010, HAA.0011, HAA.001']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Graduate program', 'Higher level graduate program']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'Architecture and Planning']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(TOTAL_UNITS:NUMBER, Examples: [15, 1, 24]),
(LECTURE_UNITS:NUMBER, Examples: [0, 6, 12]),
(LAB_UNITS:NUMBER, Examples: [15, 1, 24]),
(PREPARATION_UNITS:NUMBER, Examples: [0, 9, 8]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [195, 159, 170]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA'])
]

### Question ###
Group subjects by cluster type, department offering the subject, and the school name. For each group, list the cluster type, name of the department, school name, whether the department grants degrees, total number of subjects, total enrollment, and average enrollment. Exclude clusters or schools with no student data.

(Hints: Schema Mapping Hints:
- 'cluster type' is related to SUBJECT_OFFERED_SUMMARY.CLUSTER_TYPE
- 'name of the department' is related to SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'whether the department grants degrees' is related to SIS_DEPARTMENT.IS_DEGREE_GRANTING
- 'subjects' is related to SUBJECT_OFFERED_SUMMARY.SUBJECT_ID
- 'enrollment' is related to SUBJECT_OFFERED_SUMMARY.NUM_ENROLLED_STUDENTS

Join Information: (SUBJECT_OFFERED_SUMMARY.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QuyT3b5fqFXwQNnLk0lBsGaoOH', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    sos.CLUSTER_TYPE,\n    sos.OFFER_DEPT_NAME,\n    sd.SCHOOL_NAME,\n    sd.IS_DEGREE_GRANTING,\n    COUNT(sos.SUBJECT_ID) AS total_subjects,\n    SUM(sos.NUM_ENROLLED_STUDENTS) AS total_enrollment,\n    AVG(sos.NUM_ENROLLED_STUDENTS) AS average_enrollment\nFROM \n    SUBJECT_OFFERED_SUMMARY sos\nJOIN \n    SIS_DEPARTMENT sd ON sos.OFFER_DEPT_CODE = sd.DEPARTMENT_CODE\nWHERE \n    sos.NUM_ENROLLED_STUDENTS > 0\nGROUP BY \n    sos.CLUSTER_TYPE, sos.OFFER_DEPT_NAME, sd.SCHOOL_NAME, sd.IS_DEGREE_GRANTING\nHAVING \n    total_enrollment > 0\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349868, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_aa07c96156', usage=CompletionUsage(completion_tokens=172, prompt_tokens=2317, total_tokens=2489, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=172, prompt_tokens=2317, total_tokens=2489, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sos.CLUSTER_TYPE,
    sos.OFFER_DEPT_NAME,
    sd.SCHOOL_NAME,
    sd.IS_DEGREE_GRANTING,
    COUNT(sos.SUBJECT_ID) AS total_subjects,
    SUM(sos.NUM_ENROLLED_STUDENTS) AS total_enrollment,
    AVG(sos.NUM_ENROLLED_STUDENTS) AS average_enrollment
FROM 
    SUBJECT_OFFERED_SUMMARY sos
JOIN 
    SIS_DEPARTMENT sd ON sos.OFFER_DEPT_CODE = sd.DEPARTMENT_CODE
WHERE 
    sos.NUM_ENROLLED_STUDENTS > 0
GROUP BY 
    sos.CLUSTER_TYPE, sos.OFFER_DEPT_NAME, sd.SCHOOL_NAME, sd.IS_DEGREE_GRANTING
HAVING 
    total_enrollment > 0

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2317, 172
TOTAL                  : 155420, 142660, 12760
AVG                    : 2391.08, 2194.77, 196.31
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the 'ocean-apple' mailing list, identify the department with the highest student count. Provide the department name, phone number, and the total number of students subscribed to the mailing list from that department. If multiple departments have the same highest count, list each one separately.

(Hints: Schema Mapping Hints:
- ''ocean-apple' mailing list' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'phone number' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'students' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = SE_PERSON.KRB_NAME), (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QtUJqm7w9ZsrmkIcckGkjxrkUg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    SAD.SIS_ADMIN_DEPARTMENT_NAME, \n    SAD.DEPARTMENT_PHONE_NUMBER, \n    COUNT(MSD.FULL_NAME) AS student_count\nFROM \n    MOIRA_LIST ML \nJOIN \n    MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY \nJOIN \n    SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME \nJOIN \n    MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME \nJOIN \n    SIS_ADMIN_DEPARTMENT SAD ON MSD.DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE \nWHERE \n    ML.MOIRA_LIST_NAME = 'ocean-apple' \nGROUP BY \n    SAD.SIS_ADMIN_DEPARTMENT_NAME, SAD.DEPARTMENT_PHONE_NUMBER\nHAVING \n    COUNT(MSD.FULL_NAME) = (\n        SELECT MAX(student_count) \n        FROM (\n            SELECT COUNT(MSD.FULL_NAME) AS student_count\n            FROM \n                MOIRA_LIST ML \n            JOIN \n                MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY \n            JOIN \n                SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME \n            JOIN \n                MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME \n            WHERE \n                ML.MOIRA_LIST_NAME = 'ocean-apple' \n            GROUP BY \n                MSD.DEPARTMENT\n        )\n    )\n```\n", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349867, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=316, prompt_tokens=1482, total_tokens=1798, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=316, prompt_tokens=1482, total_tokens=1798, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    SAD.SIS_ADMIN_DEPARTMENT_NAME, 
    SAD.DEPARTMENT_PHONE_NUMBER, 
    COUNT(MSD.FULL_NAME) AS student_count
FROM 
    MOIRA_LIST ML 
JOIN 
    MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY 
JOIN 
    SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME 
JOIN 
    MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME 
JOIN 
    SIS_ADMIN_DEPARTMENT SAD ON MSD.DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE 
WHERE 
    ML.MOIRA_LIST_NAME = 'ocean-apple' 
GROUP BY 
    SAD.SIS_ADMIN_DEPARTMENT_NAME, SAD.DEPARTMENT_PHONE_NUMBER
HAVING 
    COUNT(MSD.FULL_NAME) = (
        SELECT MAX(student_count) 
        FROM (
            SELECT COUNT(MSD.FULL_NAME) AS student_count
            FROM 
                MOIRA_LIST ML 
            JOIN 
                MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY 
            JOIN 
                SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME 
            JOIN 
                MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME 
            WHERE 
                ML.MOIRA_LIST_NAME = 'ocean-apple' 
            GROUP BY 
                MSD.DEPARTMENT
        )
    )

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1482, 316
TOTAL                  : 157218, 144142, 13076
AVG                    : 2382.09, 2183.97, 198.12
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each mailing list, list its owner, owner type, the member visibility ('Public Members' if public, and 'Hidden Members' otherwise), and the number of members of this type of visibility. For each owner and owner type, include a grand total for all members in the format of (owner, owner type, null, total members).

(Hints: Schema Mapping Hints:
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'owner type' is related to MOIRA_LIST_OWNER.OWNER_TYPE
- 'member visibility' is related to MOIRA_LIST.IS_PUBLIC
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QtDQwWTwrVHZDPyfnIdTxP49YR', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    o.OWNER, \n    o.OWNER_TYPE, \n    CASE \n        WHEN l.IS_PUBLIC = 'Y' THEN 'Public Members' \n        ELSE 'Hidden Members' \n    END AS MEMBER_VISIBILITY, \n    COUNT(d.MOIRA_LIST_MEMBER) AS TOTAL_MEMBERS \nFROM \n    MOIRA_LIST l \nJOIN \n    MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY \nJOIN \n    MOIRA_LIST_OWNER o ON o.MOIRA_LIST_OWNER_KEY = d.MOIRA_LIST_OWNER_KEY \nWHERE \n    l.IS_MOIRA_MAILING_LIST = 'Y' \nGROUP BY \n    o.OWNER, \n    o.OWNER_TYPE, \n    l.IS_PUBLIC \n\nUNION ALL \n\nSELECT \n    o.OWNER, \n    o.OWNER_TYPE, \n    NULL AS MEMBER_VISIBILITY, \n    COUNT(d.MOIRA_LIST_MEMBER) AS TOTAL_MEMBERS \nFROM \n    MOIRA_LIST l \nJOIN \n    MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY \nJOIN \n    MOIRA_LIST_OWNER o ON o.MOIRA_LIST_OWNER_KEY = d.MOIRA_LIST_OWNER_KEY \nWHERE \n    l.IS_MOIRA_MAILING_LIST = 'Y' \nGROUP BY \n    o.OWNER, \n    o.OWNER_TYPE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349867, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=287, prompt_tokens=851, total_tokens=1138, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=287, prompt_tokens=851, total_tokens=1138, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    o.OWNER, 
    o.OWNER_TYPE, 
    CASE 
        WHEN l.IS_PUBLIC = 'Y' THEN 'Public Members' 
        ELSE 'Hidden Members' 
    END AS MEMBER_VISIBILITY, 
    COUNT(d.MOIRA_LIST_MEMBER) AS TOTAL_MEMBERS 
FROM 
    MOIRA_LIST l 
JOIN 
    MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY 
JOIN 
    MOIRA_LIST_OWNER o ON o.MOIRA_LIST_OWNER_KEY = d.MOIRA_LIST_OWNER_KEY 
WHERE 
    l.IS_MOIRA_MAILING_LIST = 'Y' 
GROUP BY 
    o.OWNER, 
    o.OWNER_TYPE, 
    l.IS_PUBLIC 

UNION ALL 

SELECT 
    o.OWNER, 
    o.OWNER_TYPE, 
    NULL AS MEMBER_VISIBILITY, 
    COUNT(d.MOIRA_LIST_MEMBER) AS TOTAL_MEMBERS 
FROM 
    MOIRA_LIST l 
JOIN 
    MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY 
JOIN 
    MOIRA_LIST_OWNER o ON o.MOIRA_LIST_OWNER_KEY = d.MOIRA_LIST_OWNER_KEY 
WHERE 
    l.IS_MOIRA_MAILING_LIST = 'Y' 
GROUP BY 
    o.OWNER, 
    o.OWNER_TYPE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 851, 287
TOTAL                  : 158356, 144993, 13363
AVG                    : 2363.52, 2164.07, 199.45
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each department in the library system, list the name of the department, total number of courses using library materials, the number of catalog items associated with those courses, and the average enrollment per course. Include a grand total across all departments (the corresponding department field should be 'Grand Total').

(Hints: Schema Mapping Hints:
- 'name of the department' is related to LIBRARY_COURSE_INSTRUCTOR.DEPARTMENT
- 'courses' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME
- 'catalog items' is related to LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY
- 'enrollment' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qyu6MR2CJr9E63USaUGPHmuT3Z', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    COALESCE(c.department, 'Grand Total') AS department,\n    COUNT(DISTINCT ci.course_name) AS total_courses,\n    COUNT(DISTINCT rc.library_reserve_catalog_key) AS total_catalog_items,\n    AVG(so.num_enrolled_students) AS avg_enrollment_per_course\nFROM \n    library_course_instructor ci\nLEFT JOIN \n    library_reserve_matrl_detail md ON ci.library_course_instructor_key = md.library_course_instructor_key\nLEFT JOIN \n    library_reserve_catalog rc ON md.library_reserve_catalog_key = rc.library_reserve_catalog_key\nLEFT JOIN \n    library_subject_offered so ON md.library_subject_offered_key = so.library_subject_offered_key\nGROUP BY \n    c.department WITH ROLLUP\nHAVING \n    department IS NOT NULL\nORDER BY \n    department;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349872, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=175, prompt_tokens=1896, total_tokens=2071, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=175, prompt_tokens=1896, total_tokens=2071, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    COALESCE(c.department, 'Grand Total') AS department,
    COUNT(DISTINCT ci.course_name) AS total_courses,
    COUNT(DISTINCT rc.library_reserve_catalog_key) AS total_catalog_items,
    AVG(so.num_enrolled_students) AS avg_enrollment_per_course
FROM 
    library_course_instructor ci
LEFT JOIN 
    library_reserve_matrl_detail md ON ci.library_course_instructor_key = md.library_course_instructor_key
LEFT JOIN 
    library_reserve_catalog rc ON md.library_reserve_catalog_key = rc.library_reserve_catalog_key
LEFT JOIN 
    library_subject_offered so ON md.library_subject_offered_key = so.library_subject_offered_key
GROUP BY 
    c.department WITH ROLLUP
HAVING 
    department IS NOT NULL
ORDER BY 
    department;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1896, 175
TOTAL                  : 160427, 146889, 13538
AVG                    : 2359.22, 2160.13, 199.09
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
Group classes that take place in buildings at MIT by the building name and course level. For each group, provide the name of the building, the course level ('Graduate' or 'Undergraduate'), the total number of unique courses of such level, and total instructors for these courses. Include subtotals for each building and course level and a grand total across all buildings and course levels.

(Hints: Schema Mapping Hints:
- 'buildings at MIT' is related to FAC_BUILDING.SITE
- 'name of the building' is related to FAC_BUILDING.BUILDING_NAME
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'courses' is related to SUBJECT_OFFERED_SUMMARY.SUBJECT_ID
- 'instructors' is related to SUBJECT_OFFERED_SUMMARY.RESPONSIBLE_FACULTY_NAME

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = SUBJECT_OFFERED.MEET_PLACE), (SUBJECT_OFFERED.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE), (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QvUavycxoV5IU0ihwb5TTuunVo', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CourseDetails AS (\n    SELECT \n        fb.BUILDING_NAME,\n        scd.COURSE_LEVEL,\n        so.SUBJECT_ID,\n        so.RESPONSIBLE_FACULTY_NAME\n    FROM \n        FAC_BUILDING fb\n    JOIN \n        SUBJECT_OFFERED so ON fb.FAC_BUILDING_KEY = so.MEET_PLACE\n    JOIN \n        SIS_COURSE_DESCRIPTION scd ON so.COURSE_NUMBER = scd.COURSE\n    WHERE \n        fb.SITE = 'MIT'\n),\nAggregatedData AS (\n    SELECT \n        BUILDING_NAME,\n        CASE \n            WHEN COURSE_LEVEL = 'G' THEN 'Graduate'\n            WHEN COURSE_LEVEL = 'U' THEN 'Undergraduate'\n        END AS Course_Level,\n        COUNT(DISTINCT SUBJECT_ID) AS Total_Courses,\n        COUNT(DISTINCT RESPONSIBLE_FACULTY_NAME) AS Total_Instructors\n    FROM \n        CourseDetails\n    GROUP BY \n        BUILDING_NAME, Course_Level\n)\nSELECT \n    BUILDING_NAME,\n    Course_Level,\n    Total_Courses,\n    Total_Instructors\nFROM \n    AggregatedData\nUNION ALL\nSELECT \n    'Subtotal' AS BUILDING_NAME,\n    Course_Level,\n    SUM(Total_Courses),\n    SUM(Total_Instructors)\nFROM \n    AggregatedData\nGROUP BY \n    Course_Level\nUNION ALL\nSELECT \n    'Grand Total' AS BUILDING_NAME,\n    NULL AS Course_Level,\n    SUM(Total_Courses),\n    SUM(Total_Instructors)\nFROM \n    AggregatedData;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349869, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=329, prompt_tokens=3492, total_tokens=3821, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=329, prompt_tokens=3492, total_tokens=3821, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH CourseDetails AS (
    SELECT 
        fb.BUILDING_NAME,
        scd.COURSE_LEVEL,
        so.SUBJECT_ID,
        so.RESPONSIBLE_FACULTY_NAME
    FROM 
        FAC_BUILDING fb
    JOIN 
        SUBJECT_OFFERED so ON fb.FAC_BUILDING_KEY = so.MEET_PLACE
    JOIN 
        SIS_COURSE_DESCRIPTION scd ON so.COURSE_NUMBER = scd.COURSE
    WHERE 
        fb.SITE = 'MIT'
),
AggregatedData AS (
    SELECT 
        BUILDING_NAME,
        CASE 
            WHEN COURSE_LEVEL = 'G' THEN 'Graduate'
            WHEN COURSE_LEVEL = 'U' THEN 'Undergraduate'
        END AS Course_Level,
        COUNT(DISTINCT SUBJECT_ID) AS Total_Courses,
        COUNT(DISTINCT RESPONSIBLE_FACULTY_NAME) AS Total_Instructors
    FROM 
        CourseDetails
    GROUP BY 
        BUILDING_NAME, Course_Level
)
SELECT 
    BUILDING_NAME,
    Course_Level,
    Total_Courses,
    Total_Instructors
FROM 
    AggregatedData
UNION ALL
SELECT 
    'Subtotal' AS BUILDING_NAME,
    Course_Level,
    SUM(Total_Courses),
    SUM(Total_Instructors)
FROM 
    AggregatedData
GROUP BY 
    Course_Level
UNION ALL
SELECT 
    'Grand Total' AS BUILDING_NAME,
    NULL AS Course_Level,
    SUM(Total_Courses),
    SUM(Total_Instructors)
FROM 
    AggregatedData;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3492, 329
TOTAL                  : 164248, 150381, 13867
AVG                    : 2380.41, 2179.43, 200.97
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED_SUMMARY
[
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese II', 'Eng 10A: British Writers', 'Biology of Cancer Cell']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0035, HAA.0036, HAA.0042, HAA.006', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0001, HAA.0002, HAA.0003, HAA.0004, HAA.0005, HAA.0006, HAA.0007, HAA.0008, HAA.0009, HAA.0010, HAA.0011, HAA.001']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Graduate program', 'Higher level graduate program']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'Architecture and Planning']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(TOTAL_UNITS:NUMBER, Examples: [15, 1, 24]),
(LECTURE_UNITS:NUMBER, Examples: [0, 6, 12]),
(LAB_UNITS:NUMBER, Examples: [15, 1, 24]),
(PREPARATION_UNITS:NUMBER, Examples: [0, 9, 8]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [195, 159, 170]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]

### Question ###
Group biology courses by cluster type and course level. For each group, list the name of the department, the course title, cluster type, total enrollments, average enrollment within its cluster, course level, number of unique course materials, average new and used prices for TIP materials, total material record count for TIP materials, number of unique library titles, and number of unique library ISBNs.

(Hints: Schema Mapping Hints:
- 'biology courses' is related to SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_NAME
- 'cluster type' is related to SUBJECT_OFFERED_SUMMARY.CLUSTER_TYPE
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'name of the department' is related to SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_NAME
- 'course title' is related to SUBJECT_OFFERED_SUMMARY.SUBJECT_TITLE
- 'enrollment' is related to SUBJECT_OFFERED_SUMMARY.NUM_ENROLLED_STUDENTS
- 'course materials' is related to TIP_MATERIAL.TITLE
- 'new price' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'use price' is related to TIP_MATERIAL.USED_SHELF_PRICE
- 'record count for TIP materials' is related to TIP_DETAIL.RECORD_COUNT
- 'library titles' is related to LIBRARY_RESERVE_CATALOG.CATALOG_TITLE
- 'library ISBNs' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN

Join Information: (SUBJECT_OFFERED_SUMMARY.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE), (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8Qtm3TiG1LBHiOE729Qgg76BJ1g', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    sos.OFFER_DEPT_NAME AS department_name,\n    sos.SUBJECT_TITLE AS course_title,\n    sos.CLUSTER_TYPE AS cluster_type,\n    SUM(sos.NUM_ENROLLED_STUDENTS) AS total_enrollments,\n    AVG(sos.NUM_ENROLLED_STUDENTS) OVER (PARTITION BY sos.CLUSTER_TYPE) AS average_enrollment_within_cluster,\n    scd.COURSE_LEVEL AS course_level,\n    COUNT(DISTINCT tm.TIP_MATERIAL_KEY) AS number_of_unique_course_materials,\n    AVG(tm.NEW_SHELF_PRICE) AS average_new_price,\n    AVG(tm.USED_SHELF_PRICE) AS average_used_price,\n    SUM(td.RECORD_COUNT) AS total_material_record_count,\n    COUNT(DISTINCT lrc.CATALOG_TITLE) AS number_of_unique_library_titles,\n    COUNT(DISTINCT lrc.CATALOG_ISBN) AS number_of_unique_library_isbns\nFROM \n    SUBJECT_OFFERED_SUMMARY sos\nJOIN \n    SIS_COURSE_DESCRIPTION scd ON sos.COURSE_NUMBER = scd.COURSE\nLEFT JOIN \n    TIP_DETAIL td ON sos.SUBJECT_ID = td.SUBJECT_ID\nLEFT JOIN \n    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY\nLEFT JOIN \n    LIBRARY_RESERVE_CATALOG lrc ON lrc.CATALOG_ISBN IN (SELECT tm.ISBN)\nWHERE \n    sos.SUBJECT_TITLE LIKE '%Biology%'\nGROUP BY \n    sos.OFFER_DEPT_NAME, sos.SUBJECT_TITLE, sos.CLUSTER_TYPE, scd.COURSE_LEVEL\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349867, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=336, prompt_tokens=3051, total_tokens=3387, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=336, prompt_tokens=3051, total_tokens=3387, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sos.OFFER_DEPT_NAME AS department_name,
    sos.SUBJECT_TITLE AS course_title,
    sos.CLUSTER_TYPE AS cluster_type,
    SUM(sos.NUM_ENROLLED_STUDENTS) AS total_enrollments,
    AVG(sos.NUM_ENROLLED_STUDENTS) OVER (PARTITION BY sos.CLUSTER_TYPE) AS average_enrollment_within_cluster,
    scd.COURSE_LEVEL AS course_level,
    COUNT(DISTINCT tm.TIP_MATERIAL_KEY) AS number_of_unique_course_materials,
    AVG(tm.NEW_SHELF_PRICE) AS average_new_price,
    AVG(tm.USED_SHELF_PRICE) AS average_used_price,
    SUM(td.RECORD_COUNT) AS total_material_record_count,
    COUNT(DISTINCT lrc.CATALOG_TITLE) AS number_of_unique_library_titles,
    COUNT(DISTINCT lrc.CATALOG_ISBN) AS number_of_unique_library_isbns
FROM 
    SUBJECT_OFFERED_SUMMARY sos
JOIN 
    SIS_COURSE_DESCRIPTION scd ON sos.COURSE_NUMBER = scd.COURSE
LEFT JOIN 
    TIP_DETAIL td ON sos.SUBJECT_ID = td.SUBJECT_ID
LEFT JOIN 
    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY
LEFT JOIN 
    LIBRARY_RESERVE_CATALOG lrc ON lrc.CATALOG_ISBN IN (SELECT tm.ISBN)
WHERE 
    sos.SUBJECT_TITLE LIKE '%Biology%'
GROUP BY 
    sos.OFFER_DEPT_NAME, sos.SUBJECT_TITLE, sos.CLUSTER_TYPE, scd.COURSE_LEVEL

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3051, 336
TOTAL                  : 167635, 153432, 14203
AVG                    : 2394.79, 2191.89, 202.90
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For subjects offered this year in either the Fall or Spring term, list its department name, school name, subject ID, subject title, course level, total units, the term it is offered ('Spring' for Spring term and 'Fall' for Fall term), term description, the number of distinct instructors teaching in the Fall, and the number of distinct instructors teaching in the Spring.

(Hints: Schema Mapping Hints:
- 'subjects offered this year' is related to COURSE_CATALOG_SUBJECT_OFFERED.IS_OFFERED_THIS_YEAR
- 'department name' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'subject ID' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'subject title' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'total units' is related to COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS
- 'term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS.TERM_DESCRIPTION
- 'instructors' is related to COURSE_CATALOG_SUBJECT_OFFERED.FALL_INSTRUCTORS, COURSE_CATALOG_SUBJECT_OFFERED.SPRING_INSTRUCTORS

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QtFKOFlZVKwHYpbVWrAkTmRvo8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    CDS.DEPARTMENT_NAME,\n    SD.SCHOOL_NAME,\n    CCO.SUBJECT_ID,\n    CCO.SUBJECT_TITLE,\n    SCD.COURSE_LEVEL,\n    CCO.TOTAL_UNITS,\n    CASE \n        WHEN CCO.IS_OFFERED_FALL_TERM = 'Y' THEN 'Fall' \n        WHEN CCO.IS_OFFERED_SPRING_TERM = 'Y' THEN 'Spring' \n    END AS TERM,\n    AT.TERM_DESCRIPTION,\n    COUNT(DISTINCT CASE WHEN CCO.IS_OFFERED_FALL_TERM = 'Y' THEN CCO.FALL_INSTRUCTORS END) AS FALL_INSTRUCTORS_COUNT,\n    COUNT(DISTINCT CASE WHEN CCO.IS_OFFERED_SPRING_TERM = 'Y' THEN CCO.SPRING_INSTRUCTORS END) AS SPRING_INSTRUCTORS_COUNT\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED CCO\nJOIN \n    ACADEMIC_TERMS AT ON CCO.TERM_CODE = AT.TERM_CODE\nJOIN \n    SIS_DEPARTMENT SD ON CCO.DEPARTMENT_CODE = SD.DEPARTMENT_CODE\nJOIN \n    SIS_COURSE_DESCRIPTION SCD ON CCO.SUBJECT_CODE = SCD.COURSE\nWHERE \n    CCO.IS_OFFERED_THIS_YEAR = 'Y' \n    AND (CCO.IS_OFFERED_FALL_TERM = 'Y' OR CCO.IS_OFFERED_SPRING_TERM = 'Y')\nGROUP BY \n    CDS.DEPARTMENT_NAME,\n    SD.SCHOOL_NAME,\n    CCO.SUBJECT_ID,\n    CCO.SUBJECT_TITLE,\n    SCD.COURSE_LEVEL,\n    CCO.TOTAL_UNITS,\n    AT.TERM_DESCRIPTION\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349867, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=363, prompt_tokens=4045, total_tokens=4408, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=363, prompt_tokens=4045, total_tokens=4408, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    CDS.DEPARTMENT_NAME,
    SD.SCHOOL_NAME,
    CCO.SUBJECT_ID,
    CCO.SUBJECT_TITLE,
    SCD.COURSE_LEVEL,
    CCO.TOTAL_UNITS,
    CASE 
        WHEN CCO.IS_OFFERED_FALL_TERM = 'Y' THEN 'Fall' 
        WHEN CCO.IS_OFFERED_SPRING_TERM = 'Y' THEN 'Spring' 
    END AS TERM,
    AT.TERM_DESCRIPTION,
    COUNT(DISTINCT CASE WHEN CCO.IS_OFFERED_FALL_TERM = 'Y' THEN CCO.FALL_INSTRUCTORS END) AS FALL_INSTRUCTORS_COUNT,
    COUNT(DISTINCT CASE WHEN CCO.IS_OFFERED_SPRING_TERM = 'Y' THEN CCO.SPRING_INSTRUCTORS END) AS SPRING_INSTRUCTORS_COUNT
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED CCO
JOIN 
    ACADEMIC_TERMS AT ON CCO.TERM_CODE = AT.TERM_CODE
JOIN 
    SIS_DEPARTMENT SD ON CCO.DEPARTMENT_CODE = SD.DEPARTMENT_CODE
JOIN 
    SIS_COURSE_DESCRIPTION SCD ON CCO.SUBJECT_CODE = SCD.COURSE
WHERE 
    CCO.IS_OFFERED_THIS_YEAR = 'Y' 
    AND (CCO.IS_OFFERED_FALL_TERM = 'Y' OR CCO.IS_OFFERED_SPRING_TERM = 'Y')
GROUP BY 
    CDS.DEPARTMENT_NAME,
    SD.SCHOOL_NAME,
    CCO.SUBJECT_ID,
    CCO.SUBJECT_TITLE,
    SCD.COURSE_LEVEL,
    CCO.TOTAL_UNITS,
    AT.TERM_DESCRIPTION

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4045, 363
TOTAL                  : 172043, 157477, 14566
AVG                    : 2423.14, 2217.99, 205.15
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_MAJOR_USE
[
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE:VARCHAR2, Examples: ['BLDG SRV', 'CIRCULAT', 'CLASSRMS']),
(DESCRIPTION:VARCHAR2, Examples: ['BLDG SERVICE AREA', 'CIRCULATION AREA', 'CLASSROOMS']),
(ASSIGNABLE:VARCHAR2, Examples: ['0', '1']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, provide the room number of course location, building name, building number, building city, building state, area, organization name, room usage, term code, course level, the total number of subjects, unique meeting times, and total units. Do not include meet place or meet times with NULL values.

(Hints: Schema Mapping Hints:
- 'room number' is related to COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE
- 'building name' is related to FAC_BUILDING.BUILDING_NAME
- 'building number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'building city' is related to FAC_BUILDING_ADDRESS.CITY
- 'building state' is related to FAC_BUILDING_ADDRESS.STATE
- 'area' is related to FAC_ROOMS.AREA
- 'organization name' is related to FAC_ROOMS.ORGANIZATION_NAME
- 'room usage' is related to FAC_MAJOR_USE.MAJOR_USE
- 'term code' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'meeting times' is related to COURSE_CATALOG_SUBJECT_OFFERED.MEET_TIME
- 'units' is related to COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS

Join Information: (FAC_ROOMS.FAC_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE), (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QwRzTW76VQcwZJadASTJg6pWUa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    FAC_ROOMS.ROOM AS room_number,\n    FAC_BUILDING.BUILDING_NAME AS building_name,\n    FAC_BUILDING.BUILDING_NUMBER AS building_number,\n    FAC_BUILDING_ADDRESS.CITY AS building_city,\n    FAC_BUILDING_ADDRESS.STATE AS building_state,\n    FAC_ROOMS.AREA AS area,\n    FAC_ROOMS.ORGANIZATION_NAME AS organization_name,\n    FAC_MAJOR_USE.MAJOR_USE AS room_usage,\n    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE AS term_code,\n    SIS_COURSE_DESCRIPTION.COURSE_LEVEL AS course_level,\n    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS total_subjects,\n    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.MEET_TIME) AS unique_meeting_times,\n    COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS AS total_units\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED\nJOIN \n    FAC_ROOMS ON FAC_ROOMS.FAC_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE\nJOIN \n    FAC_BUILDING ON FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY\nJOIN \n    FAC_BUILDING_ADDRESS ON FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY\nJOIN \n    FAC_MAJOR_USE ON FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY\nJOIN \n    SIS_COURSE_DESCRIPTION ON SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID\nWHERE \n    COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE IS NOT NULL\nGROUP BY \n    FAC_ROOMS.ROOM,\n    FAC_BUILDING.BUILDING_NAME,\n    FAC_BUILDING.BUILDING_NUMBER,\n    FAC_BUILDING_ADDRESS.CITY,\n    FAC_BUILDING_ADDRESS.STATE,\n    FAC_ROOMS.AREA,\n    FAC_ROOMS.ORGANIZATION_NAME,\n    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE,\n    SIS_COURSE_DESCRIPTION.COURSE_LEVEL,\n    COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349870, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=445, prompt_tokens=4703, total_tokens=5148, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1920)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=445, prompt_tokens=4703, total_tokens=5148, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1920))

***** FINAL SQL QUERY *****
SELECT 
    FAC_ROOMS.ROOM AS room_number,
    FAC_BUILDING.BUILDING_NAME AS building_name,
    FAC_BUILDING.BUILDING_NUMBER AS building_number,
    FAC_BUILDING_ADDRESS.CITY AS building_city,
    FAC_BUILDING_ADDRESS.STATE AS building_state,
    FAC_ROOMS.AREA AS area,
    FAC_ROOMS.ORGANIZATION_NAME AS organization_name,
    FAC_MAJOR_USE.MAJOR_USE AS room_usage,
    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE AS term_code,
    SIS_COURSE_DESCRIPTION.COURSE_LEVEL AS course_level,
    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS total_subjects,
    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.MEET_TIME) AS unique_meeting_times,
    COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS AS total_units
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED
JOIN 
    FAC_ROOMS ON FAC_ROOMS.FAC_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE
JOIN 
    FAC_BUILDING ON FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY
JOIN 
    FAC_BUILDING_ADDRESS ON FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY
JOIN 
    FAC_MAJOR_USE ON FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY
JOIN 
    SIS_COURSE_DESCRIPTION ON SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
WHERE 
    COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE IS NOT NULL
GROUP BY 
    FAC_ROOMS.ROOM,
    FAC_BUILDING.BUILDING_NAME,
    FAC_BUILDING.BUILDING_NUMBER,
    FAC_BUILDING_ADDRESS.CITY,
    FAC_BUILDING_ADDRESS.STATE,
    FAC_ROOMS.AREA,
    FAC_ROOMS.ORGANIZATION_NAME,
    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE,
    SIS_COURSE_DESCRIPTION.COURSE_LEVEL,
    COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4703, 445
TOTAL                  : 177191, 162180, 15011
AVG                    : 2460.99, 2252.50, 208.49
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each TIP material status, list the total number of unique materials associated with the status, the total number of records associated with the status, and the total student enrollment associated with the status. Any material status with null values should be displayed as 'No material status'. Additionally, include a grand total across all material status (the material status for this row should be displayed as 'Grand Total').

(Hints: Schema Mapping Hints:
- 'TIP material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'materials' is related to TIP_MATERIAL.TITLE
- 'records' is related to TIP_DETAIL.RECORD_COUNT
- 'student enrollment' is related to TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY), (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY), (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QzAM9pMMYB2iWNVYBfYYmLxyta', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    COALESCE(TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS, 'No material status') AS material_status,\n    COUNT(DISTINCT TIP_MATERIAL.ISBN) AS unique_materials_count,\n    SUM(TIP_DETAIL.RECORD_COUNT) AS total_records_count,\n    SUM(TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS) AS total_enrollment_count\nFROM \n    TIP_DETAIL\nLEFT JOIN \n    TIP_MATERIAL_STATUS ON TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY\nLEFT JOIN \n    TIP_MATERIAL ON TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY\nLEFT JOIN \n    TIP_SUBJECT_OFFERED ON TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY\nGROUP BY \n    TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS\nUNION ALL\nSELECT \n    'Grand Total' AS material_status,\n    COUNT(DISTINCT TIP_MATERIAL.ISBN) AS unique_materials_count,\n    SUM(TIP_DETAIL.RECORD_COUNT) AS total_records_count,\n    SUM(TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS) AS total_enrollment_count\nFROM \n    TIP_DETAIL\nLEFT JOIN \n    TIP_MATERIAL_STATUS ON TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY\nLEFT JOIN \n    TIP_MATERIAL ON TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY\nLEFT JOIN \n    TIP_SUBJECT_OFFERED ON TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349873, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=361, prompt_tokens=1576, total_tokens=1937, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=361, prompt_tokens=1576, total_tokens=1937, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    COALESCE(TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS, 'No material status') AS material_status,
    COUNT(DISTINCT TIP_MATERIAL.ISBN) AS unique_materials_count,
    SUM(TIP_DETAIL.RECORD_COUNT) AS total_records_count,
    SUM(TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS) AS total_enrollment_count
FROM 
    TIP_DETAIL
LEFT JOIN 
    TIP_MATERIAL_STATUS ON TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY
LEFT JOIN 
    TIP_MATERIAL ON TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY
LEFT JOIN 
    TIP_SUBJECT_OFFERED ON TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY
GROUP BY 
    TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
UNION ALL
SELECT 
    'Grand Total' AS material_status,
    COUNT(DISTINCT TIP_MATERIAL.ISBN) AS unique_materials_count,
    SUM(TIP_DETAIL.RECORD_COUNT) AS total_records_count,
    SUM(TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS) AS total_enrollment_count
FROM 
    TIP_DETAIL
LEFT JOIN 
    TIP_MATERIAL_STATUS ON TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY
LEFT JOIN 
    TIP_MATERIAL ON TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY
LEFT JOIN 
    TIP_SUBJECT_OFFERED ON TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1576, 361
TOTAL                  : 179128, 163756, 15372
AVG                    : 2453.81, 2243.23, 210.58
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each department and school offering courses with materials, list the department name, school name, number of unique course materials, number of courses, average new and used shelf prices of materials, total material records, and number of distinct material statuses. Include a grand total across all schools and departments (the corresponding school and department fields should be null).

(Hints: Schema Mapping Hints:
- 'courses with materials' is related to TIP_SUBJECT_OFFERED.IS_NO_COURSE_MATERIAL
- 'department name' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'course materials' is related to TIP_MATERIAL.TITLE
- 'courses' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE
- 'new' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'used' is related to TIP_MATERIAL.USED_SHELF_PRICE
- 'material records' is related to TIP_DETAIL.RECORD_COUNT
- 'material statuses' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY), (SIS_DEPARTMENT.DEPARTMENT_CODE = TIP_SUBJECT_OFFERED.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QyZlICgVwayOsKzE3iJZohr3B1', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH DepartmentCourseMaterials AS (\n    SELECT \n        d.DEPARTMENT_NAME,\n        d.SCHOOL_NAME,\n        COUNT(DISTINCT m.TITLE) AS unique_materials,\n        COUNT(DISTINCT so.SUBJECT_TITLE) AS courses,\n        AVG(m.NEW_SHELF_PRICE) AS avg_new_price,\n        AVG(m.USED_SHELF_PRICE) AS avg_used_price,\n        SUM(td.RECORD_COUNT) AS total_material_records,\n        COUNT(DISTINCT ms.TIP_MATERIAL_STATUS) AS distinct_material_statuses\n    FROM \n        SIS_DEPARTMENT d\n    JOIN \n        TIP_SUBJECT_OFFERED so ON d.DEPARTMENT_CODE = so.OFFER_DEPT_CODE\n    JOIN \n        TIP_DETAIL td ON so.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY\n    JOIN \n        TIP_MATERIAL m ON td.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY\n    JOIN \n        TIP_MATERIAL_STATUS ms ON td.TIP_MATERIAL_STATUS_KEY = ms.TIP_MATERIAL_STATUS_KEY\n    WHERE \n        so.IS_NO_COURSE_MATERIAL = 'N'\n    GROUP BY \n        d.DEPARTMENT_NAME, d.SCHOOL_NAME\n)\nSELECT \n    DEPARTMENT_NAME,\n    SCHOOL_NAME,\n    unique_materials,\n    courses,\n    avg_new_price,\n    avg_used_price,\n    total_material_records,\n    distinct_material_statuses\nFROM \n    DepartmentCourseMaterials\nUNION ALL\nSELECT \n    NULL AS DEPARTMENT_NAME,\n    NULL AS SCHOOL_NAME,\n    SUM(unique_materials) AS unique_materials,\n    SUM(courses) AS courses,\n    AVG(avg_new_price) AS avg_new_price,\n    AVG(avg_used_price) AS avg_used_price,\n    SUM(total_material_records) AS total_material_records,\n    SUM(distinct_material_statuses) AS distinct_material_statuses\nFROM \n    DepartmentCourseMaterials;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349872, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=398, prompt_tokens=2056, total_tokens=2454, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=398, prompt_tokens=2056, total_tokens=2454, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH DepartmentCourseMaterials AS (
    SELECT 
        d.DEPARTMENT_NAME,
        d.SCHOOL_NAME,
        COUNT(DISTINCT m.TITLE) AS unique_materials,
        COUNT(DISTINCT so.SUBJECT_TITLE) AS courses,
        AVG(m.NEW_SHELF_PRICE) AS avg_new_price,
        AVG(m.USED_SHELF_PRICE) AS avg_used_price,
        SUM(td.RECORD_COUNT) AS total_material_records,
        COUNT(DISTINCT ms.TIP_MATERIAL_STATUS) AS distinct_material_statuses
    FROM 
        SIS_DEPARTMENT d
    JOIN 
        TIP_SUBJECT_OFFERED so ON d.DEPARTMENT_CODE = so.OFFER_DEPT_CODE
    JOIN 
        TIP_DETAIL td ON so.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY
    JOIN 
        TIP_MATERIAL m ON td.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY
    JOIN 
        TIP_MATERIAL_STATUS ms ON td.TIP_MATERIAL_STATUS_KEY = ms.TIP_MATERIAL_STATUS_KEY
    WHERE 
        so.IS_NO_COURSE_MATERIAL = 'N'
    GROUP BY 
        d.DEPARTMENT_NAME, d.SCHOOL_NAME
)
SELECT 
    DEPARTMENT_NAME,
    SCHOOL_NAME,
    unique_materials,
    courses,
    avg_new_price,
    avg_used_price,
    total_material_records,
    distinct_material_statuses
FROM 
    DepartmentCourseMaterials
UNION ALL
SELECT 
    NULL AS DEPARTMENT_NAME,
    NULL AS SCHOOL_NAME,
    SUM(unique_materials) AS unique_materials,
    SUM(courses) AS courses,
    AVG(avg_new_price) AS avg_new_price,
    AVG(avg_used_price) AS avg_used_price,
    SUM(total_material_records) AS total_material_records,
    SUM(distinct_material_statuses) AS distinct_material_statuses
FROM 
    DepartmentCourseMaterials;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2056, 398
TOTAL                  : 181582, 165812, 15770
AVG                    : 2453.81, 2240.70, 213.11
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Consider only books cataloged on or after 2000. For each library material status and department, list the material status, department name, number of associated catalog items, and the total number of enrolled students in courses using those materials. Include subtotals for each material status and a grand total across all status (the corresponding status field is 'Grand Total').

(Hints: Schema Mapping Hints:
- 'cataloged on or after 2000' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'material status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'department name' is related to SIS_SUBJECT_CODE.DEPARTMENT_NAME
- 'catalog items' is related to LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_SUBJECT_OFFERED.COURSE_NUMBER = SIS_SUBJECT_CODE.COURSE_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8QxQbM9hKslX9VSxVDThPAtPeM5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CatalogData AS (\n    SELECT \n        LMS.LIBRARY_MATERIAL_STATUS AS MaterialStatus,\n        SSC.DEPARTMENT_NAME AS DepartmentName,\n        COUNT(DISTINCT LRC.LIBRARY_RESERVE_CATALOG_KEY) AS CatalogItemCount,\n        SUM(SO.NUM_ENROLLED_STUDENTS) AS TotalEnrolledStudents\n    FROM \n        LIBRARY_RESERVE_CATALOG LRC\n    JOIN \n        LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LRC.LIBRARY_RESERVE_CATALOG_KEY = LRMD.LIBRARY_RESERVE_CATALOG_KEY\n    JOIN \n        LIBRARY_MATERIAL_STATUS LMS ON LRMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY\n    JOIN \n        LIBRARY_SUBJECT_OFFERED SO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = SO.LIBRARY_SUBJECT_OFFERED_KEY\n    JOIN \n        SIS_SUBJECT_CODE SSC ON SO.COURSE_NUMBER = SSC.COURSE_NUMBER\n    WHERE \n        LRC.CATALOG_YEAR >= '2000'\n    GROUP BY \n        LMS.LIBRARY_MATERIAL_STATUS, SSC.DEPARTMENT_NAME\n),\nSubtotals AS (\n    SELECT \n        MaterialStatus,\n        DepartmentName,\n        CatalogItemCount,\n        TotalEnrolledStudents\n    FROM \n        CatalogData\n    UNION ALL\n    SELECT \n        MaterialStatus,\n        'Subtotal' AS DepartmentName,\n        SUM(CatalogItemCount) AS CatalogItemCount,\n        SUM(TotalEnrolledStudents) AS TotalEnrolledStudents\n    FROM \n        CatalogData\n    GROUP BY \n        MaterialStatus\n),\nGrandTotal AS (\n    SELECT \n        'Grand Total' AS MaterialStatus,\n        'Grand Total' AS DepartmentName,\n        SUM(CatalogItemCount) AS CatalogItemCount,\n        SUM(TotalEnrolledStudents) AS TotalEnrolledStudents\n    FROM \n        CatalogData\n)\nSELECT \n    MaterialStatus, \n    DepartmentName, \n    CatalogItemCount, \n    TotalEnrolledStudents\nFROM \n    Subtotals\nUNION ALL\nSELECT \n    MaterialStatus, \n    DepartmentName, \n    CatalogItemCount, \n    TotalEnrolledStudents\nFROM \n    GrandTotal\nORDER BY \n    MaterialStatus, DepartmentName;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349871, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=476, prompt_tokens=1943, total_tokens=2419, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=476, prompt_tokens=1943, total_tokens=2419, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH CatalogData AS (
    SELECT 
        LMS.LIBRARY_MATERIAL_STATUS AS MaterialStatus,
        SSC.DEPARTMENT_NAME AS DepartmentName,
        COUNT(DISTINCT LRC.LIBRARY_RESERVE_CATALOG_KEY) AS CatalogItemCount,
        SUM(SO.NUM_ENROLLED_STUDENTS) AS TotalEnrolledStudents
    FROM 
        LIBRARY_RESERVE_CATALOG LRC
    JOIN 
        LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LRC.LIBRARY_RESERVE_CATALOG_KEY = LRMD.LIBRARY_RESERVE_CATALOG_KEY
    JOIN 
        LIBRARY_MATERIAL_STATUS LMS ON LRMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY
    JOIN 
        LIBRARY_SUBJECT_OFFERED SO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = SO.LIBRARY_SUBJECT_OFFERED_KEY
    JOIN 
        SIS_SUBJECT_CODE SSC ON SO.COURSE_NUMBER = SSC.COURSE_NUMBER
    WHERE 
        LRC.CATALOG_YEAR >= '2000'
    GROUP BY 
        LMS.LIBRARY_MATERIAL_STATUS, SSC.DEPARTMENT_NAME
),
Subtotals AS (
    SELECT 
        MaterialStatus,
        DepartmentName,
        CatalogItemCount,
        TotalEnrolledStudents
    FROM 
        CatalogData
    UNION ALL
    SELECT 
        MaterialStatus,
        'Subtotal' AS DepartmentName,
        SUM(CatalogItemCount) AS CatalogItemCount,
        SUM(TotalEnrolledStudents) AS TotalEnrolledStudents
    FROM 
        CatalogData
    GROUP BY 
        MaterialStatus
),
GrandTotal AS (
    SELECT 
        'Grand Total' AS MaterialStatus,
        'Grand Total' AS DepartmentName,
        SUM(CatalogItemCount) AS CatalogItemCount,
        SUM(TotalEnrolledStudents) AS TotalEnrolledStudents
    FROM 
        CatalogData
)
SELECT 
    MaterialStatus, 
    DepartmentName, 
    CatalogItemCount, 
    TotalEnrolledStudents
FROM 
    Subtotals
UNION ALL
SELECT 
    MaterialStatus, 
    DepartmentName, 
    CatalogItemCount, 
    TotalEnrolledStudents
FROM 
    GrandTotal
ORDER BY 
    MaterialStatus, DepartmentName;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1943, 476
TOTAL                  : 184001, 167755, 16246
AVG                    : 2453.35, 2236.73, 216.61
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: ACADEMIC_TERM_PARAMETER
[
(TERM_PARAMETER:VARCHAR2, Examples: ['SIS_CURRENT_TERM', 'SIS_PREVIOUS_TERM', 'SIS_UPCOMING_TERM']),
(TERM_INDICATOR:VARCHAR2, Examples: ['C', 'P', 'F']),
(TERM_CODE:VARCHAR2, Examples: ['2024SU', '2025FA', '2025JA']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Fall Term 2024-2025', 'Summer Term 2024', 'January Term 2024-2025']),
(TERM_START_DATE:DATE, Examples: ['03-SEP-24', '10-JUN-24', '06-JAN-25']),
(TERM_END_DATE:DATE, Examples: ['20-DEC-24', '20-AUG-24', '31-JAN-25']),
(TERM_LAST_DAY_BEFORE_NEXT_TERM:DATE, Examples: ['05-JAN-25', '02-SEP-24', '31-JAN-25']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['Y', 'N'])
]
# Table: TIME_DAY
[
(FISCAL_PERIOD:VARCHAR2, Examples: ['195007', '195008', '195009']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1975 Period 6', 'FY 1987 Period 11', 'FY 1983 Period 12']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['197412', '198705', '198306']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['December 1974', 'May 1987', 'June 1983']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1974', '1987', '1983']),
(START_DATE:DATE, Examples: ['01-DEC-74', '01-MAY-87', '01-JUN-83']),
(END_DATE:DATE, Examples: ['31-DEC-74', '31-MAY-87', '30-JUN-83']),
(CALENDAR_DATE:DATE, Examples: ['01-APR-00', '01-APR-01', '01-APR-02']),
(DAY_OF_WEEK:VARCHAR2, Examples: ['Friday   ', 'Wednesday', 'Sunday   ']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['2021', '2002', '1994']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 2020-2021', 'Aid Year 2001-2002', 'Aid year 1993-94']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(ACADEMIC_TERM_CODE:VARCHAR2, Examples: ['1951SP', '1951SU', '1952SP']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1986-1987', 'Summer Term 1983', 'Summer Term 2020'])
]
# Table: TIME_MONTH
[
(TIME_MONTH_KEY:VARCHAR2, Examples: ['199602', '199601', '199607']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['199601', '199602', '199603']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1996 Period 2', 'FY 1996 Period 1', 'FY 1996 Period 7']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(FISCAL_YEAR_QUARTER:VARCHAR2, Examples: ['FY 1996 Quarter 1', 'FY 1996 Quarter 3', 'FY 1997 Quarter 1']),
(FY_QUARTER_CODE:VARCHAR2, Examples: ['FY1996Q1', 'FY1996Q2', 'FY1996Q3']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['199508', '199507', '199601']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['August 1995', 'July 1995', 'January 1996']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(START_DATE:VARCHAR2, Examples: ['01-AUG-95', '01-JUL-95', '01-JAN-96']),
(END_DATE:VARCHAR2, Examples: ['31-AUG-95', '31-JUL-95', '31-JAN-96']),
(CALENDAR_MONTH:VARCHAR2, Examples: ['8', '7', '1']),
(CALENDAR_MONTH_NAME:DATE, Examples: ['August', 'July', 'January']),
(IS_CURRENT_FISCAL_PERIOD:DATE, Examples: ['N', 'Y']),
(IS_PREVIOUS_FISCAL_PERIOD:VARCHAR2, Examples: ['N', 'Y']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_TERM:VARCHAR2, Examples: ['1995SU', '1996JA', '1996SU']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Summer Term 1995', 'January Term 1995-1996', 'Summer Term 1996']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 1995-96', 'Aid Year 1996-97', 'Aid Year 1997-98']),
(IS_CLOSING_PERIOD:VARCHAR2, Examples: ['N', 'Y']),
(FISCAL_PERIOD_SELECTOR:VARCHAR2, Examples: ['199602 -- August 1995', '199601 -- July 1995', '199607 -- January 1996']),
(IS_CURRENT_FISCAL_YEAR:VARCHAR2, Examples: ['N', 'Y'])
]
# Table: TIME_QUARTER
[
(FISCAL_YEAR:VARCHAR2, Examples: ['2000', '2001', '2002']),
(FY_QUARTER_CODE:VARCHAR2, Examples: ['FY2000Q1', 'FY2000Q2', 'FY2000Q3']),
(FY_QUARTER_NAME:VARCHAR2, Examples: ['FY 2014 Quarter 1', 'FY 2026 Quarter 3', 'FY 2026 Quarter 4']),
(CY_QUARTER_CODE:VARCHAR2, Examples: ['CY2013Q3', 'CY2026Q1', 'CY2026Q2']),
(CY_QUARTER_NAME:VARCHAR2, Examples: ['CY 2013 Quarter 3', 'CY 2026 Quarter 1', 'CY 2026 Quarter 2']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['2013', '2026', '2004']),
(QUARTER_START_DATE:DATE, Examples: ['01-JUL-13', '01-JAN-26', '01-APR-26']),
(QUARTER_END_DATE:DATE, Examples: ['30-SEP-13', '31-MAR-26', '30-JUN-26']),
(QUARTER_START_FP:VARCHAR2, Examples: ['201401', '202607', '202610']),
(QUARTER_END_FP:VARCHAR2, Examples: ['201403', '202609', '202612']),
(QUARTER_CERT_OPEN:DATE, Examples: ['01-OCT-13', '01-APR-26', '01-JUL-26']),
(QUARTER_CERT_EXPECTED:DATE, Examples: ['30-NOV-13', '31-MAY-26', '31-AUG-26']),
(QUARTER_CERT_DUE:DATE, Examples: ['31-DEC-13', '30-JUN-26', '30-SEP-26']),
(IS_CURRENT_QUARTER:VARCHAR2, Examples: ['N', 'Y']),
(IS_NEXT_QUARTER:VARCHAR2, Examples: ['N']),
(IS_PREVIOUS_QUARTER:VARCHAR2, Examples: ['N']),
(IS_PAST_QUARTER:VARCHAR2, Examples: ['Y', 'N']),
(IS_FUTURE_QUARTER:VARCHAR2, Examples: ['N', 'Y']),
(PAYROLL_EDACCA_CERT_SCHED_KEY:VARCHAR2, Examples: ['201401', '202603', '202604']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each financial aid year and academic year, list the number of fiscal periods, quarters, the start term date, the end term date, and number of distinct department-level term parameters.

(Hints: Schema Mapping Hints:
- 'financial aid year' is related to ACADEMIC_TERMS.FINANCIAL_AID_YEAR
- 'academic year' is related to ACADEMIC_TERMS.ACADEMIC_YEAR
- 'fiscal periods' is related to TIME_MONTH.FISCAL_PERIOD
- 'quarters' is related to TIME_QUARTER.FY_QUARTER_CODE
- 'start term date' is related to TIME_DAY.START_DATE
- 'end term date' is related to TIME_DAY.END_DATE
- 'department-level term parameters' is related to ACADEMIC_TERM_PARAMETER.TERM_PARAMETER

Join Information: (ACADEMIC_TERMS.TERM_START_DATE = TIME_DAY.CALENDAR_DATE), (TIME_DAY.FISCAL_PERIOD = TIME_MONTH.FISCAL_PERIOD), (TIME_QUARTER.FISCAL_YEAR = TIME_MONTH.FISCAL_YEAR), (ACADEMIC_TERM_PARAMETER.TERM_CODE = ACADEMIC_TERMS.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R1yP7pWJ0faYoEiaPxgjTOuaIh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    ACADEMIC_TERMS.FINANCIAL_AID_YEAR, \n    ACADEMIC_TERMS.ACADEMIC_YEAR, \n    COUNT(DISTINCT TIME_MONTH.FISCAL_PERIOD) AS fiscal_periods, \n    COUNT(DISTINCT TIME_QUARTER.FY_QUARTER_CODE) AS quarters, \n    MIN(TIME_DAY.START_DATE) AS start_term_date, \n    MAX(TIME_DAY.END_DATE) AS end_term_date, \n    COUNT(DISTINCT ACADEMIC_TERM_PARAMETER.TERM_PARAMETER) AS distinct_term_parameters\nFROM \n    ACADEMIC_TERMS\nJOIN \n    TIME_DAY ON ACADEMIC_TERMS.TERM_START_DATE = TIME_DAY.CALENDAR_DATE\nJOIN \n    TIME_MONTH ON TIME_DAY.FISCAL_PERIOD = TIME_MONTH.FISCAL_PERIOD\nJOIN \n    TIME_QUARTER ON TIME_MONTH.FISCAL_YEAR = TIME_QUARTER.FISCAL_YEAR\nJOIN \n    ACADEMIC_TERM_PARAMETER ON ACADEMIC_TERMS.TERM_CODE = ACADEMIC_TERM_PARAMETER.TERM_CODE\nGROUP BY \n    ACADEMIC_TERMS.FINANCIAL_AID_YEAR, \n    ACADEMIC_TERMS.ACADEMIC_YEAR;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349875, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=249, prompt_tokens=2855, total_tokens=3104, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=249, prompt_tokens=2855, total_tokens=3104, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ACADEMIC_TERMS.FINANCIAL_AID_YEAR, 
    ACADEMIC_TERMS.ACADEMIC_YEAR, 
    COUNT(DISTINCT TIME_MONTH.FISCAL_PERIOD) AS fiscal_periods, 
    COUNT(DISTINCT TIME_QUARTER.FY_QUARTER_CODE) AS quarters, 
    MIN(TIME_DAY.START_DATE) AS start_term_date, 
    MAX(TIME_DAY.END_DATE) AS end_term_date, 
    COUNT(DISTINCT ACADEMIC_TERM_PARAMETER.TERM_PARAMETER) AS distinct_term_parameters
FROM 
    ACADEMIC_TERMS
JOIN 
    TIME_DAY ON ACADEMIC_TERMS.TERM_START_DATE = TIME_DAY.CALENDAR_DATE
JOIN 
    TIME_MONTH ON TIME_DAY.FISCAL_PERIOD = TIME_MONTH.FISCAL_PERIOD
JOIN 
    TIME_QUARTER ON TIME_MONTH.FISCAL_YEAR = TIME_QUARTER.FISCAL_YEAR
JOIN 
    ACADEMIC_TERM_PARAMETER ON ACADEMIC_TERMS.TERM_CODE = ACADEMIC_TERM_PARAMETER.TERM_CODE
GROUP BY 
    ACADEMIC_TERMS.FINANCIAL_AID_YEAR, 
    ACADEMIC_TERMS.ACADEMIC_YEAR;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2855, 249
TOTAL                  : 187105, 170610, 16495
AVG                    : 2461.91, 2244.87, 217.04
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_FLOOR
[
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(EXT_GROSS_AREA:NUMBER, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:VARCHAR2, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each room, list its associated building name, floor number, room number, ownership type, organization name, number of rooms, area, and percentage of area relative to the building. Include subtotals across floors, subtotals across all floors for each building, and a grand total across all buildings. For the subtotal for each building and the grand total, the percentage of area should be relative to area of all buildings. All numeric values should be rounded to integers and formatted using commas as thousands separators except the relative percentages which should be rounded to two decimal places.

(Hints: Schema Mapping Hints:
- 'room' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'building name' is related to FCLT_BUILDING.BUILDING_NAME_LONG
- 'floor number' is related to FCLT_FLOOR.FLOOR
- 'room number' is related to FCLT_ROOMS.BUILDING_ROOM
- 'ownership type' is related to FCLT_BUILDING.OWNERSHIP_TYPE
- 'organization name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'number of rooms' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_FLOOR.FCLT_FLOOR_KEY = FCLT_ROOMS.FCLT_FLOOR_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_FLOOR.FCLT_BUILDING_KEY), (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FCLT_ROOMS.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R1ff2AicQDQjwzbdquH4E8ICqc', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nWITH RoomDetails AS (\n    SELECT \n        b.BUILDING_NAME_LONG,\n        f.FLOOR,\n        r.BUILDING_ROOM,\n        b.OWNERSHIP_TYPE,\n        o.ORGANIZATION_NAME,\n        COUNT(r.FCLT_ROOM_KEY) OVER (PARTITION BY f.FLOOR, b.BUILDING_NAME_LONG) AS NUM_OF_ROOMS,\n        ROUND(r.AREA) AS AREA,\n        SUM(r.AREA) OVER (PARTITION BY b.BUILDING_NAME_LONG) AS BUILDING_TOTAL_AREA\n    FROM \n        FCLT_ROOMS r\n    JOIN \n        FCLT_FLOOR f ON r.FCLT_FLOOR_KEY = f.FCLT_FLOOR_KEY\n    JOIN \n        FCLT_BUILDING b ON f.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY\n    JOIN \n        FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY\n),\nTotalArea AS (\n    SELECT \n        SUM(AREA) AS TOTAL_AREA\n    FROM \n        RoomDetails\n)\nSELECT \n    building_name,\n    floor,\n    building_room,\n    ownership_type,\n    organization_name,\n    num_of_rooms,\n    area,\n    ROUND((area * 100.0 / building_total_area), 2) AS percentage_area,\n    ROUND((SUM(area) OVER (PARTITION BY building_name)), 0) AS building_subtotal,\n    ROUND((SUM(area) OVER (PARTITION BY NULL)), 0) AS grand_total\nFROM \n    RoomDetails \nORDER BY \n    building_name, floor;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349875, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=343, prompt_tokens=2630, total_tokens=2973, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=343, prompt_tokens=2630, total_tokens=2973, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH RoomDetails AS (
    SELECT 
        b.BUILDING_NAME_LONG,
        f.FLOOR,
        r.BUILDING_ROOM,
        b.OWNERSHIP_TYPE,
        o.ORGANIZATION_NAME,
        COUNT(r.FCLT_ROOM_KEY) OVER (PARTITION BY f.FLOOR, b.BUILDING_NAME_LONG) AS NUM_OF_ROOMS,
        ROUND(r.AREA) AS AREA,
        SUM(r.AREA) OVER (PARTITION BY b.BUILDING_NAME_LONG) AS BUILDING_TOTAL_AREA
    FROM 
        FCLT_ROOMS r
    JOIN 
        FCLT_FLOOR f ON r.FCLT_FLOOR_KEY = f.FCLT_FLOOR_KEY
    JOIN 
        FCLT_BUILDING b ON f.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY
    JOIN 
        FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY
),
TotalArea AS (
    SELECT 
        SUM(AREA) AS TOTAL_AREA
    FROM 
        RoomDetails
)
SELECT 
    building_name,
    floor,
    building_room,
    ownership_type,
    organization_name,
    num_of_rooms,
    area,
    ROUND((area * 100.0 / building_total_area), 2) AS percentage_area,
    ROUND((SUM(area) OVER (PARTITION BY building_name)), 0) AS building_subtotal,
    ROUND((SUM(area) OVER (PARTITION BY NULL)), 0) AS grand_total
FROM 
    RoomDetails 
ORDER BY 
    building_name, floor;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2630, 343
TOTAL                  : 190078, 173240, 16838
AVG                    : 2468.55, 2249.87, 218.68
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each department, list the name of the department, the title of the TIP material associated with the department, author, ISBN, library term code, and whether it is available in the library reserves ('Available in Library' if yes and 'Not Available in Library' otherwise), the total number of instructors per library book for the department, the total number of materials available in the library for the department, and the total number of available materials across all departments.

(Hints: Schema Mapping Hints:
- 'name of the department' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'title of the TIP material' is related to TIP_MATERIAL.TITLE
- 'author' is related to TIP_MATERIAL.AUTHOR
- 'ISBN' is related to TIP_MATERIAL.ISBN
- 'library term code' is related to LIBRARY_RESERVE_MATRL_DETAIL.TERM_CODE
- 'available in the library reserves' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN
- 'instructors' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R3M8xC7XOex3GNS6hSvYP5bkxC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    tso.OFFER_DEPT_NAME AS department_name,\n    tm.TITLE AS material_title,\n    tm.AUTHOR,\n    tm.ISBN,\n    tso.TERM_CODE,\n    CASE \n        WHEN lrc.CATALOG_ISBN IS NOT NULL THEN 'Available in Library' \n        ELSE 'Not Available in Library' \n    END AS availability,\n    COUNT(DISTINCT lc.LIBRARY_COURSE_INSTRUCTOR_KEY) AS total_instructors_per_book,\n    COUNT(DISTINCT tm.TIP_MATERIAL_KEY) AS total_materials_per_dept,\n    (SELECT COUNT(DISTINCT tm_inner.TIP_MATERIAL_KEY) FROM TIP_MATERIAL tm_inner) AS total_available_materials\nFROM \n    TIP_SUBJECT_OFFERED tso\nJOIN \n    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY\nLEFT JOIN \n    LIBRARY_RESERVE_MATRL_DETAIL lrd ON td.TIP_SUBJECT_OFFERED_KEY = lrd.LIBRARY_SUBJECT_OFFERED_KEY\nLEFT JOIN \n    LIBRARY_RESERVE_CATALOG lrc ON lrd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY\nLEFT JOIN \n    LIBRARY_SUBJECT_OFFERED lso ON lrd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY\nLEFT JOIN \n    LIBRARY_COURSE_INSTRUCTOR lc ON lrd.LIBRARY_COURSE_INSTRUCTOR_KEY = lc.LIBRARY_COURSE_INSTRUCTOR_KEY\nGROUP BY \n    tso.OFFER_DEPT_NAME, \n    tm.TITLE, \n    tm.AUTHOR, \n    tm.ISBN, \n    tso.TERM_CODE, \n    lrc.CATALOG_ISBN\nORDER BY \n    tso.OFFER_DEPT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349877, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=410, prompt_tokens=2850, total_tokens=3260, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=410, prompt_tokens=2850, total_tokens=3260, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    tso.OFFER_DEPT_NAME AS department_name,
    tm.TITLE AS material_title,
    tm.AUTHOR,
    tm.ISBN,
    tso.TERM_CODE,
    CASE 
        WHEN lrc.CATALOG_ISBN IS NOT NULL THEN 'Available in Library' 
        ELSE 'Not Available in Library' 
    END AS availability,
    COUNT(DISTINCT lc.LIBRARY_COURSE_INSTRUCTOR_KEY) AS total_instructors_per_book,
    COUNT(DISTINCT tm.TIP_MATERIAL_KEY) AS total_materials_per_dept,
    (SELECT COUNT(DISTINCT tm_inner.TIP_MATERIAL_KEY) FROM TIP_MATERIAL tm_inner) AS total_available_materials
FROM 
    TIP_SUBJECT_OFFERED tso
JOIN 
    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY
JOIN 
    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY
LEFT JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL lrd ON td.TIP_SUBJECT_OFFERED_KEY = lrd.LIBRARY_SUBJECT_OFFERED_KEY
LEFT JOIN 
    LIBRARY_RESERVE_CATALOG lrc ON lrd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY
LEFT JOIN 
    LIBRARY_SUBJECT_OFFERED lso ON lrd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY
LEFT JOIN 
    LIBRARY_COURSE_INSTRUCTOR lc ON lrd.LIBRARY_COURSE_INSTRUCTOR_KEY = lc.LIBRARY_COURSE_INSTRUCTOR_KEY
GROUP BY 
    tso.OFFER_DEPT_NAME, 
    tm.TITLE, 
    tm.AUTHOR, 
    tm.ISBN, 
    tso.TERM_CODE, 
    lrc.CATALOG_ISBN
ORDER BY 
    tso.OFFER_DEPT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2850, 410
TOTAL                  : 193338, 176090, 17248
AVG                    : 2478.69, 2257.56, 221.13
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]

### Question ###
For each building that is not a subdivision, list the building number, full name, street address, building type, occupancy date, ownership type, and site location. You should also include three rows at the end showing the number of owned, leased, all buildings at MIT that are not subdivisions, in the format of (null, #building Buildings, null, null, null, null, null).

(Hints: Schema Mapping Hints:
- 'subdivision' is related to FAC_BUILDING.PARENT_BUILDING_NUMBER
- 'building number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'full name' is related to FAC_BUILDING.BUILDING_NAME_LONG
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'building type' is related to FAC_BUILDING.BUILDING_TYPE
- 'occupancy date' is related to FAC_BUILDING.DATE_OCCUPIED
- 'ownership type' is related to FAC_BUILDING.OWNERSHIP_TYPE
- 'site location' is related to FAC_BUILDING.SITE

Join Information: (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R4YlWTZAd4OdmbU72OEb25TLOu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    FB.BUILDING_NUMBER,\n    FB.BUILDING_NAME_LONG AS FULL_NAME,\n    B.BUILDING_STREET_ADDRESS,\n    FB.BUILDING_TYPE,\n    FB.DATE_OCCUPIED AS OCCUPANCY_DATE,\n    FB.OWNERSHIP_TYPE,\n    FB.SITE\nFROM \n    FAC_BUILDING FB\nJOIN \n    BUILDINGS B ON FB.FAC_BUILDING_KEY = B.BUILDING_KEY\nWHERE \n    FB.PARENT_BUILDING_NUMBER IS NULL\n\nUNION ALL\n\nSELECT \n    NULL,\n    COUNT(CASE WHEN FB.OWNERSHIP_TYPE = 'OWNED' THEN 1 END) AS TOTAL_OWNED,\n    NULL,\n    NULL,\n    NULL,\n    NULL,\n    NULL\nFROM \n    FAC_BUILDING FB\nWHERE \n    FB.PARENT_BUILDING_NUMBER IS NULL\n\nUNION ALL\n\nSELECT \n    NULL,\n    COUNT(CASE WHEN FB.OWNERSHIP_TYPE = 'LEASED' THEN 1 END) AS TOTAL_LEASED,\n    NULL,\n    NULL,\n    NULL,\n    NULL,\n    NULL\nFROM \n    FAC_BUILDING FB\nWHERE \n    FB.PARENT_BUILDING_NUMBER IS NULL\n\nUNION ALL\n\nSELECT \n    NULL,\n    COUNT(*) AS TOTAL_BUILDINGS,\n    NULL,\n    NULL,\n    NULL,\n    NULL,\n    NULL\nFROM \n    FAC_BUILDING FB\nWHERE \n    FB.PARENT_BUILDING_NUMBER IS NULL;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349878, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=300, prompt_tokens=1797, total_tokens=2097, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=300, prompt_tokens=1797, total_tokens=2097, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    FB.BUILDING_NUMBER,
    FB.BUILDING_NAME_LONG AS FULL_NAME,
    B.BUILDING_STREET_ADDRESS,
    FB.BUILDING_TYPE,
    FB.DATE_OCCUPIED AS OCCUPANCY_DATE,
    FB.OWNERSHIP_TYPE,
    FB.SITE
FROM 
    FAC_BUILDING FB
JOIN 
    BUILDINGS B ON FB.FAC_BUILDING_KEY = B.BUILDING_KEY
WHERE 
    FB.PARENT_BUILDING_NUMBER IS NULL

UNION ALL

SELECT 
    NULL,
    COUNT(CASE WHEN FB.OWNERSHIP_TYPE = 'OWNED' THEN 1 END) AS TOTAL_OWNED,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL
FROM 
    FAC_BUILDING FB
WHERE 
    FB.PARENT_BUILDING_NUMBER IS NULL

UNION ALL

SELECT 
    NULL,
    COUNT(CASE WHEN FB.OWNERSHIP_TYPE = 'LEASED' THEN 1 END) AS TOTAL_LEASED,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL
FROM 
    FAC_BUILDING FB
WHERE 
    FB.PARENT_BUILDING_NUMBER IS NULL

UNION ALL

SELECT 
    NULL,
    COUNT(*) AS TOTAL_BUILDINGS,
    NULL,
    NULL,
    NULL,
    NULL,
    NULL
FROM 
    FAC_BUILDING FB
WHERE 
    FB.PARENT_BUILDING_NUMBER IS NULL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1797, 300
TOTAL                  : 195435, 177887, 17548
AVG                    : 2473.86, 2251.73, 222.13
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]

### Question ###
For each owned building that is not a subdivision, list the construction start year, the building number, and the year of initial occupancy. Display the construction start year only if it differs from the previous row. If the year of initial occupancy or construction start year is unknown, display 'UNKNOWN'. You should also include a row at the end showing the total number of owned buildings that are not subdivisions, in the format of (null, #building Buildings, null).

(Hints: Schema Mapping Hints:
- 'subdivision' is related to FAC_BUILDING.PARENT_BUILDING_NUMBER
- 'construction start year' is related to FAC_BUILDING.DATE_BUILT
- 'building number' is related to FAC_BUILDING.PARENT_BUILDING_NUMBER
- 'year of initial occupancy' is related to FAC_BUILDING.DATE_OCCUPIED)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R5PppHYRjpsJCTLtyrbJyxs0sd', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH OwnedBuildings AS (\n    SELECT \n        CASE \n            WHEN DATE_BUILT IS NULL THEN 'UNKNOWN' \n            ELSE strftime('%Y', DATE_BUILT) \n        END AS ConstructionStartYear,\n        BUILDING_NUMBER,\n        CASE \n            WHEN DATE_OCCUPIED IS NULL THEN 'UNKNOWN' \n            ELSE strftime('%Y', DATE_OCCUPIED) \n        END AS YearOfInitialOccupancy\n    FROM \n        FAC_BUILDING\n    WHERE \n        OWNERSHIP_TYPE = 'OWNED' \n        AND PARENT_BUILDING_NUMBER IS NULL\n),\nFilteredBuildings AS (\n    SELECT \n        DISTINCT ConstructionStartYear,\n        BUILDING_NUMBER,\n        YearOfInitialOccupancy,\n        ROW_NUMBER() OVER (ORDER BY ConstructionStartYear, BUILDING_NUMBER) AS RowNum\n    FROM \n        OwnedBuildings\n)\nSELECT \n    CASE \n        WHEN ConstructionStartYear != LAG(ConstructionStartYear) OVER (ORDER BY RowNum) THEN ConstructionStartYear \n        ELSE NULL \n    END AS ConstructionStartYear,\n    BUILDING_NUMBER,\n    YearOfInitialOccupancy\nFROM \n    FilteredBuildings\nUNION ALL\nSELECT \n    NULL, \n    COUNT(*) || ' Buildings', \n    NULL \nFROM \n    OwnedBuildings;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349879, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=262, prompt_tokens=1157, total_tokens=1419, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=262, prompt_tokens=1157, total_tokens=1419, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH OwnedBuildings AS (
    SELECT 
        CASE 
            WHEN DATE_BUILT IS NULL THEN 'UNKNOWN' 
            ELSE strftime('%Y', DATE_BUILT) 
        END AS ConstructionStartYear,
        BUILDING_NUMBER,
        CASE 
            WHEN DATE_OCCUPIED IS NULL THEN 'UNKNOWN' 
            ELSE strftime('%Y', DATE_OCCUPIED) 
        END AS YearOfInitialOccupancy
    FROM 
        FAC_BUILDING
    WHERE 
        OWNERSHIP_TYPE = 'OWNED' 
        AND PARENT_BUILDING_NUMBER IS NULL
),
FilteredBuildings AS (
    SELECT 
        DISTINCT ConstructionStartYear,
        BUILDING_NUMBER,
        YearOfInitialOccupancy,
        ROW_NUMBER() OVER (ORDER BY ConstructionStartYear, BUILDING_NUMBER) AS RowNum
    FROM 
        OwnedBuildings
)
SELECT 
    CASE 
        WHEN ConstructionStartYear != LAG(ConstructionStartYear) OVER (ORDER BY RowNum) THEN ConstructionStartYear 
        ELSE NULL 
    END AS ConstructionStartYear,
    BUILDING_NUMBER,
    YearOfInitialOccupancy
FROM 
    FilteredBuildings
UNION ALL
SELECT 
    NULL, 
    COUNT(*) || ' Buildings', 
    NULL 
FROM 
    OwnedBuildings;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1157, 262
TOTAL                  : 196854, 179044, 17810
AVG                    : 2460.68, 2238.05, 222.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each building use, list the type, the number of distinct buildings (excluding subdivisions) of this use, the total gross square footage of these buildings, and the number of unique organizations associated with the rooms in these buildings. If the building is used as a residence, display the usage type as "RESIDENTIAL." You should also include a row at the end showing the total number of buildings, the gross square footage, and the number of organizations across all types of building use. All numerical values should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'building use' is related to FCLT_BUILDING.BUILDING_USE
- 'buildings' is related to FCLT_BUILDING.PARENT_BUILDING_NUMBER, FCLT_BUILDING.FCLT_BUILDING_KEY
- 'gross square footage' is related to FCLT_BUILDING.EXT_GROSS_AREA
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY

Join Information: (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R5ORTeGpF9h7RlRDNIlbb1Sq9M', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH BuildingStats AS (\n    SELECT \n        CASE \n            WHEN B.BUILDING_USE = 'RESIDENT' THEN 'RESIDENTIAL'\n            ELSE B.BUILDING_USE \n        END AS USAGE_TYPE,\n        COUNT(DISTINCT B.FCLT_BUILDING_KEY) AS DISTINCT_BUILDINGS,\n        SUM(B.EXT_GROSS_AREA) AS TOTAL_GROSS_SQ_FOOTAGE,\n        COUNT(DISTINCT R.FCLT_ORGANIZATION_KEY) AS UNIQUE_ORGANIZATIONS\n    FROM \n        FCLT_BUILDING B\n    LEFT JOIN \n        FCLT_ROOMS R ON B.FCLT_BUILDING_KEY = R.FCLT_BUILDING_KEY\n    WHERE \n        B.PARENT_BUILDING_NUMBER IS NULL\n    GROUP BY \n        USAGE_TYPE\n),\nTotalStats AS (\n    SELECT \n        COUNT(DISTINCT FCLT_BUILDING_KEY) AS TOTAL_BUILDINGS,\n        SUM(EXT_GROSS_AREA) AS TOTAL_GROSS_SQ_FOOTAGE,\n        COUNT(DISTINCT FCLT_ORGANIZATION_KEY) AS TOTAL_ORGANIZATIONS\n    FROM \n        FCLT_BUILDING B\n    LEFT JOIN \n        FCLT_ROOMS R ON B.FCLT_BUILDING_KEY = R.FCLT_BUILDING_KEY\n    WHERE \n        B.PARENT_BUILDING_NUMBER IS NULL\n)\nSELECT \n    USAGE_TYPE, \n    DISTINCT_BUILDINGS, \n    ROUND(TOTAL_GROSS_SQ_FOOTAGE) AS TOTAL_GROSS_SQ_FOOTAGE, \n    UNIQUE_ORGANIZATIONS \nFROM \n    BuildingStats\nUNION ALL\nSELECT \n    'Total' AS USAGE_TYPE, \n    TOTAL_BUILDINGS, \n    ROUND(TOTAL_GROSS_SQ_FOOTAGE) AS TOTAL_GROSS_SQ_FOOTAGE, \n    TOTAL_ORGANIZATIONS \nFROM \n    TotalStats;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349879, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=391, prompt_tokens=2281, total_tokens=2672, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=391, prompt_tokens=2281, total_tokens=2672, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH BuildingStats AS (
    SELECT 
        CASE 
            WHEN B.BUILDING_USE = 'RESIDENT' THEN 'RESIDENTIAL'
            ELSE B.BUILDING_USE 
        END AS USAGE_TYPE,
        COUNT(DISTINCT B.FCLT_BUILDING_KEY) AS DISTINCT_BUILDINGS,
        SUM(B.EXT_GROSS_AREA) AS TOTAL_GROSS_SQ_FOOTAGE,
        COUNT(DISTINCT R.FCLT_ORGANIZATION_KEY) AS UNIQUE_ORGANIZATIONS
    FROM 
        FCLT_BUILDING B
    LEFT JOIN 
        FCLT_ROOMS R ON B.FCLT_BUILDING_KEY = R.FCLT_BUILDING_KEY
    WHERE 
        B.PARENT_BUILDING_NUMBER IS NULL
    GROUP BY 
        USAGE_TYPE
),
TotalStats AS (
    SELECT 
        COUNT(DISTINCT FCLT_BUILDING_KEY) AS TOTAL_BUILDINGS,
        SUM(EXT_GROSS_AREA) AS TOTAL_GROSS_SQ_FOOTAGE,
        COUNT(DISTINCT FCLT_ORGANIZATION_KEY) AS TOTAL_ORGANIZATIONS
    FROM 
        FCLT_BUILDING B
    LEFT JOIN 
        FCLT_ROOMS R ON B.FCLT_BUILDING_KEY = R.FCLT_BUILDING_KEY
    WHERE 
        B.PARENT_BUILDING_NUMBER IS NULL
)
SELECT 
    USAGE_TYPE, 
    DISTINCT_BUILDINGS, 
    ROUND(TOTAL_GROSS_SQ_FOOTAGE) AS TOTAL_GROSS_SQ_FOOTAGE, 
    UNIQUE_ORGANIZATIONS 
FROM 
    BuildingStats
UNION ALL
SELECT 
    'Total' AS USAGE_TYPE, 
    TOTAL_BUILDINGS, 
    ROUND(TOTAL_GROSS_SQ_FOOTAGE) AS TOTAL_GROSS_SQ_FOOTAGE, 
    TOTAL_ORGANIZATIONS 
FROM 
    TotalStats;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2281, 391
TOTAL                  : 199526, 181325, 18201
AVG                    : 2463.28, 2238.58, 224.70
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MASTER_DEPT_HIERARCHY
[
(HIERARCHY_TYPE:VARCHAR2, Examples: ['Standard Hierarchy']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_CODE:VARCHAR2, Examples: ['D_DOF_CORE', 'D_DOF_RESERVE', 'D_DOF_RESIDENCE']),
(DLC_NAME:VARCHAR2, Examples: ['Facilities Building Core (hallways, stairs, etc.)', 'Facilities Provost Reserved', 'Facilities Residences']),
(MASTER_DEPT_HIER_LEVEL_1_CODE:VARCHAR2, Examples: ['D_ALL']),
(MASTER_DEPT_HIER_LEVEL_1_NAME:VARCHAR2, Examples: ['All Departments']),
(MASTER_DEPT_HIER_LEVEL_2_CODE:VARCHAR2, Examples: ['D_EXECVP_AREA', 'D_PROVOST_AREA', 'D_PRES_AREA']),
(MASTER_DEPT_HIER_LEVEL_2_NAME:VARCHAR2, Examples: ['Executive Vice President's Area', 'Provost Area', 'President's area']),
(MASTER_DEPT_HIER_LEVEL_3_CODE:VARCHAR2, Examples: ['D_FINANCE_AREA', 'D_TREAS_AREA', 'D_SC_ENVP']),
(MASTER_DEPT_HIER_LEVEL_3_NAME:VARCHAR2, Examples: ['VP Finance Area', 'Treasurer's Area', 'Senior Council and Environmental Programs']),
(MASTER_DEPT_HIER_LEVEL_4_CODE:VARCHAR2, Examples: ['D_SOURCING_AREA', 'D_OSATT_AREA']),
(MASTER_DEPT_HIER_LEVEL_4_NAME:VARCHAR2, Examples: ['Sourcing Area', 'Office of Strategic Alliances & Tech Transfer Area']),
(MASTER_DEPT_HIER_LEVEL_5_CODE:VARCHAR2),
(MASTER_DEPT_HIER_LEVEL_5_NAME:VARCHAR2)
]

### Question ###
For each organization except Cambridge-MIT Institute, list its ID, number, level, formatted name according to level (if level is 2, there should be 1 space before the name, if level is 3, there should be 2 space before the name, up to level 6), whether it is assignable ('ASSIGNABLE' if assignable, 'NON-ASSIGNABLE' otherwise), total area, number of rooms, and average room area. Area and number of rooms should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'Cambridge-MIT Institute' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'ID' is related to FCLT_ORGANIZATION.ORGANIZATION_ID
- 'number' is related to FCLT_ORGANIZATION.ORGANIZATION_NUMBER
- 'level' is related to FCLT_ORGANIZATION.ORGANIZATION_LEVEL
- 'name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'assignable' is related to FCLT_ORGANIZATION.ASSIGNABLE
- 'area' is related to FCLT_ROOMS.AREA
- 'rooms' is related to FCLT_ROOMS.ROOM
- 'room area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FCLT_ROOMS.FCLT_ORGANIZATION_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY), (FCLT_ORGANIZATION.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R6GXWFzExN04PcehghIyGRHSQA', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    fo.ORGANIZATION_ID,\n    fo.ORGANIZATION_NUMBER,\n    fo.ORGANIZATION_LEVEL,\n    CASE \n        WHEN fo.ORGANIZATION_LEVEL = '2' THEN ' ' || fo.ORGANIZATION_NAME\n        WHEN fo.ORGANIZATION_LEVEL = '3' THEN '  ' || fo.ORGANIZATION_NAME\n        WHEN fo.ORGANIZATION_LEVEL = '4' THEN '   ' || fo.ORGANIZATION_NAME\n        WHEN fo.ORGANIZATION_LEVEL = '5' THEN '    ' || fo.ORGANIZATION_NAME\n        WHEN fo.ORGANIZATION_LEVEL = '6' THEN '     ' || fo.ORGANIZATION_NAME\n        ELSE fo.ORGANIZATION_NAME\n    END AS formatted_name,\n    CASE \n        WHEN fo.ASSIGNABLE = '1' THEN 'ASSIGNABLE' \n        ELSE 'NON-ASSIGNABLE' \n    END AS assignable,\n    REPLACE(ROUND(SUM(fr.AREA)), ',', '') AS total_area,\n    COUNT(DISTINCT fr.ROOM) AS number_of_rooms,\n    ROUND(AVG(fr.AREA)) AS average_room_area\nFROM \n    FCLT_ORGANIZATION fo\nJOIN \n    FCLT_ROOMS fr ON fo.FCLT_ORGANIZATION_KEY = fr.FCLT_ORGANIZATION_KEY\nWHERE \n    fo.ORGANIZATION_NAME != 'Cambridge-MIT Institute'\nGROUP BY \n    fo.ORGANIZATION_ID, fo.ORGANIZATION_NUMBER, fo.ORGANIZATION_LEVEL, formatted_name, fo.ASSIGNABLE\nORDER BY \n    fo.ORGANIZATION_ID;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349880, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=330, prompt_tokens=1872, total_tokens=2202, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=330, prompt_tokens=1872, total_tokens=2202, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    fo.ORGANIZATION_ID,
    fo.ORGANIZATION_NUMBER,
    fo.ORGANIZATION_LEVEL,
    CASE 
        WHEN fo.ORGANIZATION_LEVEL = '2' THEN ' ' || fo.ORGANIZATION_NAME
        WHEN fo.ORGANIZATION_LEVEL = '3' THEN '  ' || fo.ORGANIZATION_NAME
        WHEN fo.ORGANIZATION_LEVEL = '4' THEN '   ' || fo.ORGANIZATION_NAME
        WHEN fo.ORGANIZATION_LEVEL = '5' THEN '    ' || fo.ORGANIZATION_NAME
        WHEN fo.ORGANIZATION_LEVEL = '6' THEN '     ' || fo.ORGANIZATION_NAME
        ELSE fo.ORGANIZATION_NAME
    END AS formatted_name,
    CASE 
        WHEN fo.ASSIGNABLE = '1' THEN 'ASSIGNABLE' 
        ELSE 'NON-ASSIGNABLE' 
    END AS assignable,
    REPLACE(ROUND(SUM(fr.AREA)), ',', '') AS total_area,
    COUNT(DISTINCT fr.ROOM) AS number_of_rooms,
    ROUND(AVG(fr.AREA)) AS average_room_area
FROM 
    FCLT_ORGANIZATION fo
JOIN 
    FCLT_ROOMS fr ON fo.FCLT_ORGANIZATION_KEY = fr.FCLT_ORGANIZATION_KEY
WHERE 
    fo.ORGANIZATION_NAME != 'Cambridge-MIT Institute'
GROUP BY 
    fo.ORGANIZATION_ID, fo.ORGANIZATION_NUMBER, fo.ORGANIZATION_LEVEL, formatted_name, fo.ASSIGNABLE
ORDER BY 
    fo.ORGANIZATION_ID;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1872, 330
TOTAL                  : 201728, 183197, 18531
AVG                    : 2460.10, 2234.11, 225.99
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each department and material status, list the name of the department, the material status, the number of TIP materials associated with this department and status, the number of library materials associated with this department and status, the total number of TIP and library materials associated with this department and status. Include a subtotal for each department and a grand total across all departments.

(Hints: Schema Mapping Hints:
- 'name of the department' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'TIP materials' is related to TIP_DETAIL.TIP_MATERIAL_KEY
- 'library materials' is related to LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY

Join Information: (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY), (TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY = TIP_DETAIL.TIP_MATERIAL_STATUS_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R3a8d0OKG6zWz4vwX9e2fhgXu6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nWITH TIP_COUNT AS (\n    SELECT \n        tso.OFFER_DEPT_NAME,\n        tms.TIP_MATERIAL_STATUS,\n        COUNT(DISTINCT td.TIP_MATERIAL_KEY) AS TIP_MATERIALS_COUNT\n    FROM \n        TIP_DETAIL td\n    JOIN \n        TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY\n    JOIN \n        TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY\n    GROUP BY \n        tso.OFFER_DEPT_NAME, tms.TIP_MATERIAL_STATUS\n),\nLIBRARY_COUNT AS (\n    SELECT \n        lso.OFFER_DEPT_NAME,\n        lms.LIBRARY_MATERIAL_STATUS,\n        COUNT(DISTINCT lrd.LIBRARY_RESERVE_CATALOG_KEY) AS LIBRARY_MATERIALS_COUNT\n    FROM \n        LIBRARY_RESERVE_MATRL_DETAIL lrd\n    JOIN \n        LIBRARY_SUBJECT_OFFERED lso ON lrd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY\n    JOIN \n        LIBRARY_MATERIAL_STATUS lms ON lrd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY\n    GROUP BY \n        lso.OFFER_DEPT_NAME, lms.LIBRARY_MATERIAL_STATUS\n)\nSELECT \n    COALESCE(t.OFFER_DEPT_NAME, l.OFFER_DEPT_NAME) AS DEPARTMENT,\n    COALESCE(t.TIP_MATERIAL_STATUS, l.LIBRARY_MATERIAL_STATUS) AS MATERIAL_STATUS,\n    COALESCE(t.TIP_MATERIALS_COUNT, 0) AS TIP_MATERIALS_COUNT,\n    COALESCE(l.LIBRARY_MATERIALS_COUNT, 0) AS LIBRARY_MATERIALS_COUNT,\n    COALESCE(t.TIP_MATERIALS_COUNT, 0) + COALESCE(l.LIBRARY_MATERIALS_COUNT, 0) AS TOTAL_MATERIALS\nFROM \n    TIP_COUNT t\nFULL JOIN \n    LIBRARY_COUNT l ON t.OFFER_DEPT_NAME = l.OFFER_DEPT_NAME AND t.TIP_MATERIAL_STATUS = l.LIBRARY_MATERIAL_STATUS\nORDER BY \n    DEPARTMENT, MATERIAL_STATUS;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349877, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=481, prompt_tokens=2185, total_tokens=2666, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=481, prompt_tokens=2185, total_tokens=2666, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH TIP_COUNT AS (
    SELECT 
        tso.OFFER_DEPT_NAME,
        tms.TIP_MATERIAL_STATUS,
        COUNT(DISTINCT td.TIP_MATERIAL_KEY) AS TIP_MATERIALS_COUNT
    FROM 
        TIP_DETAIL td
    JOIN 
        TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY
    JOIN 
        TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY
    GROUP BY 
        tso.OFFER_DEPT_NAME, tms.TIP_MATERIAL_STATUS
),
LIBRARY_COUNT AS (
    SELECT 
        lso.OFFER_DEPT_NAME,
        lms.LIBRARY_MATERIAL_STATUS,
        COUNT(DISTINCT lrd.LIBRARY_RESERVE_CATALOG_KEY) AS LIBRARY_MATERIALS_COUNT
    FROM 
        LIBRARY_RESERVE_MATRL_DETAIL lrd
    JOIN 
        LIBRARY_SUBJECT_OFFERED lso ON lrd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY
    JOIN 
        LIBRARY_MATERIAL_STATUS lms ON lrd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY
    GROUP BY 
        lso.OFFER_DEPT_NAME, lms.LIBRARY_MATERIAL_STATUS
)
SELECT 
    COALESCE(t.OFFER_DEPT_NAME, l.OFFER_DEPT_NAME) AS DEPARTMENT,
    COALESCE(t.TIP_MATERIAL_STATUS, l.LIBRARY_MATERIAL_STATUS) AS MATERIAL_STATUS,
    COALESCE(t.TIP_MATERIALS_COUNT, 0) AS TIP_MATERIALS_COUNT,
    COALESCE(l.LIBRARY_MATERIALS_COUNT, 0) AS LIBRARY_MATERIALS_COUNT,
    COALESCE(t.TIP_MATERIALS_COUNT, 0) + COALESCE(l.LIBRARY_MATERIALS_COUNT, 0) AS TOTAL_MATERIALS
FROM 
    TIP_COUNT t
FULL JOIN 
    LIBRARY_COUNT l ON t.OFFER_DEPT_NAME = l.OFFER_DEPT_NAME AND t.TIP_MATERIAL_STATUS = l.LIBRARY_MATERIAL_STATUS
ORDER BY 
    DEPARTMENT, MATERIAL_STATUS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2185, 481
TOTAL                  : 204394, 185382, 19012
AVG                    : 2462.58, 2233.52, 229.06
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_FLOOR
[
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(EXT_GROSS_AREA:NUMBER, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:VARCHAR2, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group buildings by campus sectors. For each group, list the campus sector, name of the building, city and state where the building is located, total number of floors, total assignable area, total number of rooms, total number of organizations, ownership type, and a rank column indicating the order (1-indexed) of this row within each sector based on the descending order of assignable area. Include subtotals for each sector and a grand total across all sectors. The subtotal and grand total only need to computed over the total number of floors and assignable area.

(Hints: Schema Mapping Hints:
- 'campus sector' is related to FCLT_BUILDING.CAMPUS_SECTOR
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME_LONG
- 'city' is related to FCLT_BUILDING_ADDRESS.CITY
- 'state' is related to FCLT_BUILDING_ADDRESS.STATE
- 'floors' is related to FCLT_FLOOR.FLOOR
- 'area' is related to FCLT_BUILDING.ASSIGNABLE_AREA
- 'rooms' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY
- 'ownership type' is related to FCLT_BUILDING.OWNERSHIP_TYPE

Join Information: (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_FLOOR.FCLT_BUILDING_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R2eXBIGUBrOqiiUa2HuiSpQHGo', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH BuildingData AS (\n    SELECT \n        FCLT_BUILDING.CAMPUS_SECTOR,\n        FCLT_BUILDING.BUILDING_NAME_LONG,\n        FCLT_BUILDING_ADDRESS.CITY,\n        FCLT_BUILDING_ADDRESS.STATE,\n        COUNT(DISTINCT FCLT_FLOOR.FLOOR) AS TOTAL_FLOORS,\n        SUM(FCLT_BUILDING.ASSIGNABLE_AREA) AS TOTAL_ASSIGNABLE_AREA,\n        COUNT(DISTINCT FCLT_ROOMS.FCLT_ROOM_KEY) AS TOTAL_ROOMS,\n        COUNT(DISTINCT FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY) AS TOTAL_ORGANIZATIONS,\n        FCLT_BUILDING.OWNERSHIP_TYPE\n    FROM \n        FCLT_BUILDING\n        JOIN FCLT_BUILDING_ADDRESS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY\n        JOIN FCLT_FLOOR ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_FLOOR.FCLT_BUILDING_KEY\n        JOIN FCLT_ROOMS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY\n        JOIN FCLT_ORGANIZATION ON FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY\n    GROUP BY \n        FCLT_BUILDING.CAMPUS_SECTOR,\n        FCLT_BUILDING.BUILDING_NAME_LONG,\n        FCLT_BUILDING_ADDRESS.CITY,\n        FCLT_BUILDING_ADDRESS.STATE,\n        FCLT_BUILDING.OWNERSHIP_TYPE\n),\nRankedData AS (\n    SELECT \n        CAMPUS_SECTOR,\n        BUILDING_NAME_LONG,\n        CITY,\n        STATE,\n        TOTAL_FLOORS,\n        TOTAL_ASSIGNABLE_AREA,\n        TOTAL_ROOMS,\n        TOTAL_ORGANIZATIONS,\n        OWNERSHIP_TYPE,\n        ROW_NUMBER() OVER (PARTITION BY CAMPUS_SECTOR ORDER BY TOTAL_ASSIGNABLE_AREA DESC) AS RANK\n    FROM \n        BuildingData\n),\nSubtotals AS (\n    SELECT \n        CAMPUS_SECTOR,\n        'Subtotal' AS BUILDING_NAME_LONG,\n        NULL AS CITY,\n        NULL AS STATE,\n        SUM(TOTAL_FLOORS) AS TOTAL_FLOORS,\n        SUM(TOTAL_ASSIGNABLE_AREA) AS TOTAL_ASSIGNABLE_AREA,\n        NULL AS TOTAL_ROOMS,\n        NULL AS TOTAL_ORGANIZATIONS,\n        NULL AS OWNERSHIP_TYPE,\n        NULL AS RANK\n    FROM \n        RankedData\n    GROUP BY \n        CAMPUS_SECTOR\n)\nSELECT \n    CAMPUS_SECTOR,\n    BUILDING_NAME_LONG,\n    CITY,\n    STATE,\n    TOTAL_FLOORS,\n    TOTAL_ASSIGNABLE_AREA,\n    TOTAL_ROOMS,\n    TOTAL_ORGANIZATIONS,\n    OWNERSHIP_TYPE,\n    RANK\nFROM \n    RankedData\nUNION ALL\nSELECT \n    CAMPUS_SECTOR,\n    BUILDING_NAME_LONG,\n    CITY,\n    STATE,\n    TOTAL_FLOORS,\n    TOTAL_ASSIGNABLE_AREA,\n    TOTAL_ROOMS,\n    TOTAL_ORGANIZATIONS,\n    OWNERSHIP_TYPE,\n    RANK\nFROM \n    Subtotals\nORDER BY \n    CAMPUS_SECTOR, \n    RANK;\n\nSELECT \n    'Grand Total' AS CAMPUS_SECTOR, \n    NULL AS BUILDING_NAME_LONG,\n    NULL AS CITY,\n    NULL AS STATE,\n    SUM(TOTAL_FLOORS) AS TOTAL_FLOORS,\n    SUM(TOTAL_ASSIGNABLE_AREA) AS TOTAL_ASSIGNABLE_AREA,\n    NULL AS TOTAL_ROOMS,\n    NULL AS TOTAL_ORGANIZATIONS,\n    NULL AS OWNERSHIP_TYPE\nFROM \n    RankedData;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349876, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=788, prompt_tokens=3008, total_tokens=3796, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=788, prompt_tokens=3008, total_tokens=3796, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH BuildingData AS (
    SELECT 
        FCLT_BUILDING.CAMPUS_SECTOR,
        FCLT_BUILDING.BUILDING_NAME_LONG,
        FCLT_BUILDING_ADDRESS.CITY,
        FCLT_BUILDING_ADDRESS.STATE,
        COUNT(DISTINCT FCLT_FLOOR.FLOOR) AS TOTAL_FLOORS,
        SUM(FCLT_BUILDING.ASSIGNABLE_AREA) AS TOTAL_ASSIGNABLE_AREA,
        COUNT(DISTINCT FCLT_ROOMS.FCLT_ROOM_KEY) AS TOTAL_ROOMS,
        COUNT(DISTINCT FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY) AS TOTAL_ORGANIZATIONS,
        FCLT_BUILDING.OWNERSHIP_TYPE
    FROM 
        FCLT_BUILDING
        JOIN FCLT_BUILDING_ADDRESS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY
        JOIN FCLT_FLOOR ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_FLOOR.FCLT_BUILDING_KEY
        JOIN FCLT_ROOMS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY
        JOIN FCLT_ORGANIZATION ON FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY
    GROUP BY 
        FCLT_BUILDING.CAMPUS_SECTOR,
        FCLT_BUILDING.BUILDING_NAME_LONG,
        FCLT_BUILDING_ADDRESS.CITY,
        FCLT_BUILDING_ADDRESS.STATE,
        FCLT_BUILDING.OWNERSHIP_TYPE
),
RankedData AS (
    SELECT 
        CAMPUS_SECTOR,
        BUILDING_NAME_LONG,
        CITY,
        STATE,
        TOTAL_FLOORS,
        TOTAL_ASSIGNABLE_AREA,
        TOTAL_ROOMS,
        TOTAL_ORGANIZATIONS,
        OWNERSHIP_TYPE,
        ROW_NUMBER() OVER (PARTITION BY CAMPUS_SECTOR ORDER BY TOTAL_ASSIGNABLE_AREA DESC) AS RANK
    FROM 
        BuildingData
),
Subtotals AS (
    SELECT 
        CAMPUS_SECTOR,
        'Subtotal' AS BUILDING_NAME_LONG,
        NULL AS CITY,
        NULL AS STATE,
        SUM(TOTAL_FLOORS) AS TOTAL_FLOORS,
        SUM(TOTAL_ASSIGNABLE_AREA) AS TOTAL_ASSIGNABLE_AREA,
        NULL AS TOTAL_ROOMS,
        NULL AS TOTAL_ORGANIZATIONS,
        NULL AS OWNERSHIP_TYPE,
        NULL AS RANK
    FROM 
        RankedData
    GROUP BY 
        CAMPUS_SECTOR
)
SELECT 
    CAMPUS_SECTOR,
    BUILDING_NAME_LONG,
    CITY,
    STATE,
    TOTAL_FLOORS,
    TOTAL_ASSIGNABLE_AREA,
    TOTAL_ROOMS,
    TOTAL_ORGANIZATIONS,
    OWNERSHIP_TYPE,
    RANK
FROM 
    RankedData
UNION ALL
SELECT 
    CAMPUS_SECTOR,
    BUILDING_NAME_LONG,
    CITY,
    STATE,
    TOTAL_FLOORS,
    TOTAL_ASSIGNABLE_AREA,
    TOTAL_ROOMS,
    TOTAL_ORGANIZATIONS,
    OWNERSHIP_TYPE,
    RANK
FROM 
    Subtotals
ORDER BY 
    CAMPUS_SECTOR, 
    RANK;

SELECT 
    'Grand Total' AS CAMPUS_SECTOR, 
    NULL AS BUILDING_NAME_LONG,
    NULL AS CITY,
    NULL AS STATE,
    SUM(TOTAL_FLOORS) AS TOTAL_FLOORS,
    SUM(TOTAL_ASSIGNABLE_AREA) AS TOTAL_ASSIGNABLE_AREA,
    NULL AS TOTAL_ROOMS,
    NULL AS TOTAL_ORGANIZATIONS,
    NULL AS OWNERSHIP_TYPE
FROM 
    RankedData;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3008, 788
TOTAL                  : 208190, 188390, 19800
AVG                    : 2478.45, 2242.74, 235.71
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_MAJOR_USE
[
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE:VARCHAR2, Examples: ['BLDG SRV', 'CIRCULAT', 'CLASSRMS']),
(DESCRIPTION:VARCHAR2, Examples: ['BLDG SERVICE AREA', 'CIRCULATION AREA', 'CLASSROOMS']),
(ASSIGNABLE:VARCHAR2, Examples: ['0', '1']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group all rooms into whether or not they are assignable and the major use descriptions. For each group, state "ASSIGNABLE" if the room is assignable and "NON-ASSIGNABLE" otherwise, the major use description, the total number of rooms, total area, and average area. Include subtotals for each group and a grand total across all groups. The assignable status and major use descriptions should only be displayed when they differ from the previous row. Do not include rooms whose major use or major use description starts with 'ZUSE.' The results should be sorted by assignable status and major use description. The subtotal and grand total rows should not include assignable status or major use description.

(Hints: Schema Mapping Hints:
- 'rooms' is related to FCLT_ROOMS.ROOM
- 'assignable' is related to FCLT_MAJOR_USE.ASSIGNABLE
- 'major use description' is related to FCLT_MAJOR_USE.MAJOR_USE, FCLT_ROOMS.MAJOR_USE_DESC, FCLT_MAJOR_USE.DESCRIPTION
- 'area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_ROOMS.FCLT_MAJOR_USE_KEY = FCLT_MAJOR_USE.FCLT_MAJOR_USE_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RAtHndTZieA7BCt2DEviP4ImoV', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH RoomStats AS (\n    SELECT \n        CASE WHEN FR.ASSIGNABLE = '1' THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END AS ASSIGNABLE_STATUS,\n        FMU.DESCRIPTION AS MAJOR_USE_DESCRIPTION,\n        COUNT(FR.ROOM) AS TOTAL_ROOMS,\n        SUM(FR.AREA) AS TOTAL_AREA,\n        AVG(FR.AREA) AS AVG_AREA\n    FROM \n        FCLT_ROOMS FR\n    JOIN \n        FCLT_MAJOR_USE FMU ON FR.FCLT_MAJOR_USE_KEY = FMU.FCLT_MAJOR_USE_KEY\n    WHERE \n        FMU.MAJOR_USE_DESC NOT LIKE 'ZUSE%'\n    GROUP BY \n        FMU.DESCRIPTION, FR.ASSIGNABLE\n),\n\nSubtotals AS (\n    SELECT \n        NULL AS ASSIGNABLE_STATUS,\n        NULL AS MAJOR_USE_DESCRIPTION,\n        SUM(TOTAL_ROOMS) AS TOTAL_ROOMS,\n        SUM(TOTAL_AREA) AS TOTAL_AREA,\n        AVG(AVG_AREA) AS AVG_AREA\n    FROM \n        RoomStats\n    GROUP BY \n        ASSIGNABLE_STATUS\n)\n\nSELECT \n    ASSIGNABLE_STATUS,\n    MAJOR_USE_DESCRIPTION,\n    TOTAL_ROOMS,\n    TOTAL_AREA,\n    AVG_AREA\nFROM \n    RoomStats\n\nUNION ALL\n\nSELECT \n    ASSIGNABLE_STATUS,\n    NULL AS MAJOR_USE_DESCRIPTION,\n    TOTAL_ROOMS,\n    TOTAL_AREA,\n    AVG_AREA\nFROM \n    Subtotals\n\nORDER BY \n    ASSIGNABLE_STATUS, MAJOR_USE_DESCRIPTION;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349884, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=324, prompt_tokens=1003, total_tokens=1327, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=324, prompt_tokens=1003, total_tokens=1327, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH RoomStats AS (
    SELECT 
        CASE WHEN FR.ASSIGNABLE = '1' THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END AS ASSIGNABLE_STATUS,
        FMU.DESCRIPTION AS MAJOR_USE_DESCRIPTION,
        COUNT(FR.ROOM) AS TOTAL_ROOMS,
        SUM(FR.AREA) AS TOTAL_AREA,
        AVG(FR.AREA) AS AVG_AREA
    FROM 
        FCLT_ROOMS FR
    JOIN 
        FCLT_MAJOR_USE FMU ON FR.FCLT_MAJOR_USE_KEY = FMU.FCLT_MAJOR_USE_KEY
    WHERE 
        FMU.MAJOR_USE_DESC NOT LIKE 'ZUSE%'
    GROUP BY 
        FMU.DESCRIPTION, FR.ASSIGNABLE
),

Subtotals AS (
    SELECT 
        NULL AS ASSIGNABLE_STATUS,
        NULL AS MAJOR_USE_DESCRIPTION,
        SUM(TOTAL_ROOMS) AS TOTAL_ROOMS,
        SUM(TOTAL_AREA) AS TOTAL_AREA,
        AVG(AVG_AREA) AS AVG_AREA
    FROM 
        RoomStats
    GROUP BY 
        ASSIGNABLE_STATUS
)

SELECT 
    ASSIGNABLE_STATUS,
    MAJOR_USE_DESCRIPTION,
    TOTAL_ROOMS,
    TOTAL_AREA,
    AVG_AREA
FROM 
    RoomStats

UNION ALL

SELECT 
    ASSIGNABLE_STATUS,
    NULL AS MAJOR_USE_DESCRIPTION,
    TOTAL_ROOMS,
    TOTAL_AREA,
    AVG_AREA
FROM 
    Subtotals

ORDER BY 
    ASSIGNABLE_STATUS, MAJOR_USE_DESCRIPTION;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1003, 324
TOTAL                  : 209517, 189393, 20124
AVG                    : 2464.91, 2228.15, 236.75
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING_HIST
[
(FCLT_BUILDING_HIST_KEY:VARCHAR2, Examples: ['14S-201505', '46-201505', 'E14-201505']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['201505', '201506', '201507']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['14S', '46', 'E14']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['14', 'W61', 'W70']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY', 'MACGREGOR HOUSE', 'NEW HOUSE']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library', 'Frank S MacGregor House', 'New West Campus Houses']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library (South Wing)', 'Brain & Cognitive Sciences Complex', 'Building E14']),
(EXT_GROSS_AREA:NUMBER, Examples: [48622.2, 418663.0, 173875.0]),
(ASSIGNABLE_AREA:NUMBER, Examples: [34500.5, 218519.0, 73792.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [10286.5, 152699.0, 83752.7]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHWEST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['(NULL)', 'UGBA3', 'UGBI2']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['136.4', '82.8', '88.3']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3623, 42.3605, 42.3615]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0916, -71.0873, -71.0879]),
(EASTING_X_SPCS:NUMBER, Examples: [766530.0, 767698.0, 767547.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2957330.0, 2956650.0, 2957020.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['14S', '46', 'E14']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['SEELY G. MUDD', 'HORACE SAYFORD FORD JR.', 'SEBASTIAN S. KRESGE']),
(BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY (S)', 'BCSC', 'BUILDING E14']),
(DATE_BUILT:VARCHAR2, Examples: ['04/25/2003', '12/31/1932', '12/31/1920']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['05/01/1961', '12/31/1955', '12/31/1939']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['09/01/2005', '03/06/1975', '10/01/1964']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-DEC-14', '01-JAN-15', '01-FEB-15']),
(NUM_OF_ROOMS:NUMBER, Examples: [118, 1403, 341])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group all buildings at MIT into either owned or leased. For each group, state the ownership type, usage type, number of buildings, gross square footage, number of rooms, and the number of associated organizations. Display the ownership type only if it differs from the previous row. Include subtotals for each group and a grand total across all groups. The subtotal and grand total rows should not include ownership type and usage type. Footage should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'buildings at MIT' is related to FCLT_BUILDING_HIST.SITE
- 'ownership type' is related to FCLT_BUILDING_HIST.OWNERSHIP_TYPE
- 'usage type' is related to FCLT_BUILDING_HIST.BUILDING_USE
- 'buildings' is related to FCLT_BUILDING_HIST.PARENT_BUILDING_NUMBER, FCLT_BUILDING_HIST.FCLT_BUILDING_KEY
- 'gross square footage' is related to FCLT_BUILDING_HIST.EXT_GROSS_AREA
- 'rooms' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY

Join Information: (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING_HIST.FCLT_BUILDING_KEY), (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FCLT_ROOMS.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8R6tco88znHpOiAqwLWigNTCquh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH BuildingCounts AS (\n    SELECT \n        FCLT_BUILDING_HIST.OWNERSHIP_TYPE,\n        FCLT_BUILDING_HIST.BUILDING_USE,\n        COUNT(DISTINCT FCLT_BUILDING_HIST.FCLT_BUILDING_KEY) AS num_buildings,\n        ROUND(SUM(FCLT_BUILDING_HIST.EXT_GROSS_AREA)) AS gross_sq_ft,\n        COUNT(DISTINCT FCLT_ROOMS.FCLT_ROOM_KEY) AS num_rooms,\n        COUNT(DISTINCT FCLT_ROOMS.FCLT_ORGANIZATION_KEY) AS num_organizations\n    FROM \n        FCLT_BUILDING_HIST\n    LEFT JOIN \n        FCLT_ROOMS ON FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING_HIST.FCLT_BUILDING_KEY\n    WHERE \n        FCLT_BUILDING_HIST.SITE = 'MIT'\n    GROUP BY \n        FCLT_BUILDING_HIST.OWNERSHIP_TYPE, FCLT_BUILDING_HIST.BUILDING_USE\n), Subtotals AS (\n    SELECT \n        OWNERSHIP_TYPE,\n        NULL AS BUILDING_USE,\n        SUM(num_buildings) AS num_buildings,\n        SUM(gross_sq_ft) AS gross_sq_ft,\n        SUM(num_rooms) AS num_rooms,\n        SUM(num_organizations) AS num_organizations\n    FROM \n        BuildingCounts\n    GROUP BY \n        OWNERSHIP_TYPE\n), GrandTotal AS (\n    SELECT \n        NULL AS OWNERSHIP_TYPE,\n        NULL AS BUILDING_USE,\n        SUM(num_buildings) AS num_buildings,\n        SUM(gross_sq_ft) AS gross_sq_ft,\n        SUM(num_rooms) AS num_rooms,\n        SUM(num_organizations) AS num_organizations\n    FROM \n        BuildingCounts\n)\nSELECT \n    b.OWNERSHIP_TYPE,\n    b.BUILDING_USE,\n    b.num_buildings,\n    printf('%,.0f', b.gross_sq_ft) AS gross_sq_ft,\n    b.num_rooms,\n    b.num_organizations\nFROM \n    BuildingCounts b\nUNION ALL\nSELECT \n    s.OWNERSHIP_TYPE,\n    s.BUILDING_USE,\n    s.num_buildings,\n    printf('%,.0f', s.gross_sq_ft) AS gross_sq_ft,\n    s.num_rooms,\n    s.num_organizations\nFROM \n    Subtotals s\nUNION ALL\nSELECT \n    g.OWNERSHIP_TYPE,\n    g.BUILDING_USE,\n    g.num_buildings,\n    printf('%,.0f', g.gross_sq_ft) AS gross_sq_ft,\n    g.num_rooms,\n    g.num_organizations\nFROM \n    GrandTotal g\nORDER BY \n    OWNERSHIP_TYPE, BUILDING_USE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349880, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=579, prompt_tokens=2346, total_tokens=2925, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=579, prompt_tokens=2346, total_tokens=2925, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH BuildingCounts AS (
    SELECT 
        FCLT_BUILDING_HIST.OWNERSHIP_TYPE,
        FCLT_BUILDING_HIST.BUILDING_USE,
        COUNT(DISTINCT FCLT_BUILDING_HIST.FCLT_BUILDING_KEY) AS num_buildings,
        ROUND(SUM(FCLT_BUILDING_HIST.EXT_GROSS_AREA)) AS gross_sq_ft,
        COUNT(DISTINCT FCLT_ROOMS.FCLT_ROOM_KEY) AS num_rooms,
        COUNT(DISTINCT FCLT_ROOMS.FCLT_ORGANIZATION_KEY) AS num_organizations
    FROM 
        FCLT_BUILDING_HIST
    LEFT JOIN 
        FCLT_ROOMS ON FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING_HIST.FCLT_BUILDING_KEY
    WHERE 
        FCLT_BUILDING_HIST.SITE = 'MIT'
    GROUP BY 
        FCLT_BUILDING_HIST.OWNERSHIP_TYPE, FCLT_BUILDING_HIST.BUILDING_USE
), Subtotals AS (
    SELECT 
        OWNERSHIP_TYPE,
        NULL AS BUILDING_USE,
        SUM(num_buildings) AS num_buildings,
        SUM(gross_sq_ft) AS gross_sq_ft,
        SUM(num_rooms) AS num_rooms,
        SUM(num_organizations) AS num_organizations
    FROM 
        BuildingCounts
    GROUP BY 
        OWNERSHIP_TYPE
), GrandTotal AS (
    SELECT 
        NULL AS OWNERSHIP_TYPE,
        NULL AS BUILDING_USE,
        SUM(num_buildings) AS num_buildings,
        SUM(gross_sq_ft) AS gross_sq_ft,
        SUM(num_rooms) AS num_rooms,
        SUM(num_organizations) AS num_organizations
    FROM 
        BuildingCounts
)
SELECT 
    b.OWNERSHIP_TYPE,
    b.BUILDING_USE,
    b.num_buildings,
    printf('%,.0f', b.gross_sq_ft) AS gross_sq_ft,
    b.num_rooms,
    b.num_organizations
FROM 
    BuildingCounts b
UNION ALL
SELECT 
    s.OWNERSHIP_TYPE,
    s.BUILDING_USE,
    s.num_buildings,
    printf('%,.0f', s.gross_sq_ft) AS gross_sq_ft,
    s.num_rooms,
    s.num_organizations
FROM 
    Subtotals s
UNION ALL
SELECT 
    g.OWNERSHIP_TYPE,
    g.BUILDING_USE,
    g.num_buildings,
    printf('%,.0f', g.gross_sq_ft) AS gross_sq_ft,
    g.num_rooms,
    g.num_organizations
FROM 
    GrandTotal g
ORDER BY 
    OWNERSHIP_TYPE, BUILDING_USE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2346, 579
TOTAL                  : 212442, 191739, 20703
AVG                    : 2470.26, 2229.52, 240.73
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List each building key and floor key within the department of facilities, the number of rooms, total area, average area per floor, building name, access level, zip code, and city. Include subtotals for each building and a grand total across all buildings. The subtotals and grand total should not include zip code or city. Numbers of rooms and area should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'building key' is related to FAC_ROOMS.BUILDING_KEY
- 'floor key' is related to FAC_ROOMS.FLOOR_KEY
- 'department' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY
- 'area' is related to FAC_ROOMS.AREA
- 'building name' is related to FAC_BUILDING.BUILDING_NAME_LONG
- 'access level' is related to FAC_BUILDING.ACCESS_LEVEL_NAME
- 'zip code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY

Join Information: (FAC_ORGANIZATION.ORGANIZATION_KEY = FAC_ROOMS.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RAyEdpmMnmMSqHknhFt6ZBbCSs', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH RoomStats AS (\n    SELECT \n        fr.BUILDING_KEY,\n        fr.FLOOR_KEY,\n        COUNT(fr.FAC_ROOM_KEY) AS num_of_rooms,\n        ROUND(SUM(fr.AREA)) AS total_area\n    FROM \n        FAC_ROOMS fr\n    JOIN \n        FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY\n    WHERE \n        fo.ORGANIZATION_NAME = 'FACILITIES'\n    GROUP BY \n        fr.BUILDING_KEY, \n        fr.FLOOR_KEY\n),\nBuildingInfo AS (\n    SELECT \n        fb.BUILDING_KEY,\n        fb.BUILDING_NAME_LONG,\n        fb.ACCESS_LEVEL_NAME,\n        fa.POSTAL_CODE,\n        fa.CITY\n    FROM \n        FAC_BUILDING fb\n    JOIN \n        FAC_BUILDING_ADDRESS fa ON fb.FAC_BUILDING_KEY = fa.BUILDING_KEY\n)\nSELECT \n    bi.BUILDING_KEY,\n    rs.FLOOR_KEY,\n    FORMAT(rs.num_of_rooms, 'N0') AS num_of_rooms,\n    FORMAT(rs.total_area, 'N0') AS total_area,\n    ROUND(rs.total_area / COUNT(DISTINCT rs.FLOOR_KEY)) AS avg_area_per_floor,\n    bi.BUILDING_NAME_LONG,\n    bi.ACCESS_LEVEL_NAME,\n    bi.POSTAL_CODE,\n    bi.CITY\nFROM \n    RoomStats rs\nJOIN \n    BuildingInfo bi ON rs.BUILDING_KEY = bi.BUILDING_KEY\nGROUP BY \n    bi.BUILDING_KEY, \n    rs.FLOOR_KEY, \n    rs.num_of_rooms, \n    rs.total_area,\n    bi.BUILDING_NAME_LONG,\n    bi.ACCESS_LEVEL_NAME,\n    bi.POSTAL_CODE,\n    bi.CITY\nWITH ROLLUP;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349884, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=369, prompt_tokens=2720, total_tokens=3089, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=369, prompt_tokens=2720, total_tokens=3089, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
WITH RoomStats AS (
    SELECT 
        fr.BUILDING_KEY,
        fr.FLOOR_KEY,
        COUNT(fr.FAC_ROOM_KEY) AS num_of_rooms,
        ROUND(SUM(fr.AREA)) AS total_area
    FROM 
        FAC_ROOMS fr
    JOIN 
        FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY
    WHERE 
        fo.ORGANIZATION_NAME = 'FACILITIES'
    GROUP BY 
        fr.BUILDING_KEY, 
        fr.FLOOR_KEY
),
BuildingInfo AS (
    SELECT 
        fb.BUILDING_KEY,
        fb.BUILDING_NAME_LONG,
        fb.ACCESS_LEVEL_NAME,
        fa.POSTAL_CODE,
        fa.CITY
    FROM 
        FAC_BUILDING fb
    JOIN 
        FAC_BUILDING_ADDRESS fa ON fb.FAC_BUILDING_KEY = fa.BUILDING_KEY
)
SELECT 
    bi.BUILDING_KEY,
    rs.FLOOR_KEY,
    FORMAT(rs.num_of_rooms, 'N0') AS num_of_rooms,
    FORMAT(rs.total_area, 'N0') AS total_area,
    ROUND(rs.total_area / COUNT(DISTINCT rs.FLOOR_KEY)) AS avg_area_per_floor,
    bi.BUILDING_NAME_LONG,
    bi.ACCESS_LEVEL_NAME,
    bi.POSTAL_CODE,
    bi.CITY
FROM 
    RoomStats rs
JOIN 
    BuildingInfo bi ON rs.BUILDING_KEY = bi.BUILDING_KEY
GROUP BY 
    bi.BUILDING_KEY, 
    rs.FLOOR_KEY, 
    rs.num_of_rooms, 
    rs.total_area,
    bi.BUILDING_NAME_LONG,
    bi.ACCESS_LEVEL_NAME,
    bi.POSTAL_CODE,
    bi.CITY
WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2720, 369
TOTAL                  : 215531, 194459, 21072
AVG                    : 2477.37, 2235.16, 242.21
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]

### Question ###
List each floor key and department name within the Stata building, as well as the number of rooms, total area, and average area per department on each floor. Include subtotals for each floor and a grand total across all floors. Sort the results by floor key and department name in ascending order. Exclude departments without any rooms in the building. Only the first row of each floor group should include the floor key, and the subtotal and grand total rows should not include floor key or department name. Number of rooms and area should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'floor key' is related to FAC_FLOOR.FLOOR_KEY
- 'department name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'Stata building' is related to BUILDINGS.BUILDING_NAME
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY
- 'area' is related to FAC_ROOMS.AREA

Join Information: (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FAC_ROOMS.ORGANIZATION_KEY), (BUILDINGS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RAPpIfMJandK5tTPYTBjZafglz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH RoomData AS (\n    SELECT \n        f.FLOOR_KEY,\n        org.ORGANIZATION_NAME,\n        COUNT(r.FAC_ROOM_KEY) AS NumberOfRooms,\n        ROUND(SUM(r.AREA)) AS TotalArea,\n        ROUND(AVG(r.AREA)) AS AvgAreaPerDepartment\n    FROM FAC_ROOMS r\n    JOIN FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY AND r.BUILDING_KEY = f.BUILDING_KEY\n    JOIN FCLT_ORGANIZATION org ON r.ORGANIZATION_KEY = org.FCLT_ORGANIZATION_KEY\n    JOIN BUILDINGS b ON r.BUILDING_KEY = b.BUILDING_KEY\n    WHERE b.BUILDING_NAME = 'Stata Building'\n    GROUP BY f.FLOOR_KEY, org.ORGANIZATION_NAME\n),\nFloorSubtotals AS (\n    SELECT \n        FLOOR_KEY, \n        NULL AS ORGANIZATION_NAME, \n        SUM(NumberOfRooms) AS NumberOfRooms, \n        SUM(TotalArea) AS TotalArea, \n        ROUND(AVG(AvgAreaPerDepartment)) AS AvgAreaPerDepartment\n    FROM RoomData\n    GROUP BY FLOOR_KEY\n),\nGrandTotal AS (\n    SELECT \n        NULL AS FLOOR_KEY,\n        NULL AS ORGANIZATION_NAME,\n        SUM(NumberOfRooms) AS NumberOfRooms,\n        SUM(TotalArea) AS TotalArea,\n        ROUND(AVG(AvgAreaPerDepartment)) AS AvgAreaPerDepartment\n    FROM RoomData\n)\nSELECT \n    FLOOR_KEY,\n    ORGANIZATION_NAME,\n    NumberOfRooms,\n    FORMAT(NumberOfRooms, 'N0') AS FormattedNumberOfRooms,\n    FORMAT(TotalArea, 'N0') AS FormattedTotalArea,\n    FORMAT(AvgAreaPerDepartment, 'N0') AS FormattedAvgAreaPerDepartment\nFROM RoomData\nUNION ALL\nSELECT \n    FLOOR_KEY,\n    ORGANIZATION_NAME,\n    NumberOfRooms,\n    NULL AS FormattedNumberOfRooms,\n    NULL AS FormattedTotalArea,\n    NULL AS FormattedAvgAreaPerDepartment\nFROM FloorSubtotals\nUNION ALL\nSELECT \n    NULL AS FLOOR_KEY,\n    NULL AS ORGANIZATION_NAME,\n    NumberOfRooms,\n    NULL AS FormattedNumberOfRooms,\n    NULL AS FormattedTotalArea,\n    NULL AS FormattedAvgAreaPerDepartment\nFROM GrandTotal\nORDER BY FLOOR_KEY, ORGANIZATION_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349884, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=502, prompt_tokens=1814, total_tokens=2316, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=502, prompt_tokens=1814, total_tokens=2316, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH RoomData AS (
    SELECT 
        f.FLOOR_KEY,
        org.ORGANIZATION_NAME,
        COUNT(r.FAC_ROOM_KEY) AS NumberOfRooms,
        ROUND(SUM(r.AREA)) AS TotalArea,
        ROUND(AVG(r.AREA)) AS AvgAreaPerDepartment
    FROM FAC_ROOMS r
    JOIN FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY AND r.BUILDING_KEY = f.BUILDING_KEY
    JOIN FCLT_ORGANIZATION org ON r.ORGANIZATION_KEY = org.FCLT_ORGANIZATION_KEY
    JOIN BUILDINGS b ON r.BUILDING_KEY = b.BUILDING_KEY
    WHERE b.BUILDING_NAME = 'Stata Building'
    GROUP BY f.FLOOR_KEY, org.ORGANIZATION_NAME
),
FloorSubtotals AS (
    SELECT 
        FLOOR_KEY, 
        NULL AS ORGANIZATION_NAME, 
        SUM(NumberOfRooms) AS NumberOfRooms, 
        SUM(TotalArea) AS TotalArea, 
        ROUND(AVG(AvgAreaPerDepartment)) AS AvgAreaPerDepartment
    FROM RoomData
    GROUP BY FLOOR_KEY
),
GrandTotal AS (
    SELECT 
        NULL AS FLOOR_KEY,
        NULL AS ORGANIZATION_NAME,
        SUM(NumberOfRooms) AS NumberOfRooms,
        SUM(TotalArea) AS TotalArea,
        ROUND(AVG(AvgAreaPerDepartment)) AS AvgAreaPerDepartment
    FROM RoomData
)
SELECT 
    FLOOR_KEY,
    ORGANIZATION_NAME,
    NumberOfRooms,
    FORMAT(NumberOfRooms, 'N0') AS FormattedNumberOfRooms,
    FORMAT(TotalArea, 'N0') AS FormattedTotalArea,
    FORMAT(AvgAreaPerDepartment, 'N0') AS FormattedAvgAreaPerDepartment
FROM RoomData
UNION ALL
SELECT 
    FLOOR_KEY,
    ORGANIZATION_NAME,
    NumberOfRooms,
    NULL AS FormattedNumberOfRooms,
    NULL AS FormattedTotalArea,
    NULL AS FormattedAvgAreaPerDepartment
FROM FloorSubtotals
UNION ALL
SELECT 
    NULL AS FLOOR_KEY,
    NULL AS ORGANIZATION_NAME,
    NumberOfRooms,
    NULL AS FormattedNumberOfRooms,
    NULL AS FormattedTotalArea,
    NULL AS FormattedAvgAreaPerDepartment
FROM GrandTotal
ORDER BY FLOOR_KEY, ORGANIZATION_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1814, 502
TOTAL                  : 217847, 196273, 21574
AVG                    : 2475.53, 2230.38, 245.16
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERM_PARAMETER
[
(TERM_PARAMETER:VARCHAR2, Examples: ['SIS_CURRENT_TERM', 'SIS_PREVIOUS_TERM', 'SIS_UPCOMING_TERM']),
(TERM_INDICATOR:VARCHAR2, Examples: ['C', 'P', 'F']),
(TERM_CODE:VARCHAR2, Examples: ['2024SU', '2025FA', '2025JA']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Fall Term 2024-2025', 'Summer Term 2024', 'January Term 2024-2025']),
(TERM_START_DATE:DATE, Examples: ['03-SEP-24', '10-JUN-24', '06-JAN-25']),
(TERM_END_DATE:DATE, Examples: ['20-DEC-24', '20-AUG-24', '31-JAN-25']),
(TERM_LAST_DAY_BEFORE_NEXT_TERM:DATE, Examples: ['05-JAN-25', '02-SEP-24', '31-JAN-25']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['Y', 'N'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the department, school, course number, subject title, total number of enrolled students, term code, and count of distinct catalog ISBNs. Add a summary row at the bottom showing the total number of students and distinct catalog ISBNs for the current term in the format of ('TOTAL:', null, null, null, total number of students, null, number of distinct catalog ISBNs).

(Hints: Schema Mapping Hints:
- 'department' is related to LIBRARY_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'school' is related to LIBRARY_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'course number' is related to LIBRARY_SUBJECT_OFFERED.COURSE_NUMBER
- 'subject title' is related to LIBRARY_SUBJECT_OFFERED.SUBJECT_TITLE
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'term code' is related to LIBRARY_SUBJECT_OFFERED.TERM_CODE
- 'catalog ISBNs' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (ACADEMIC_TERM_PARAMETER.TERM_CODE = LIBRARY_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RCDOEKj6ra677gSKns195yXXo5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    so.OFFER_DEPT_NAME AS department,\n    so.OFFER_SCHOOL_NAME AS school,\n    so.COURSE_NUMBER AS course_number,\n    so.SUBJECT_TITLE AS subject_title,\n    SUM(so.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,\n    so.TERM_CODE AS term_code,\n    COUNT(DISTINCT rc.CATALOG_ISBN) AS distinct_catalog_isbns\nFROM \n    LIBRARY_SUBJECT_OFFERED so\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL md ON so.LIBRARY_SUBJECT_OFFERED_KEY = md.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG rc ON md.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    ACADEMIC_TERM_PARAMETER tp ON so.TERM_CODE = tp.TERM_CODE\nWHERE \n    tp.IS_CURRENT_TERM = 'Y'\nGROUP BY \n    so.OFFER_DEPT_NAME, so.OFFER_SCHOOL_NAME, so.COURSE_NUMBER, so.SUBJECT_TITLE, so.TERM_CODE\nUNION ALL\nSELECT \n    'TOTAL:' AS department, \n    NULL AS school, \n    NULL AS course_number, \n    NULL AS subject_title, \n    SUM(so.NUM_ENROLLED_STUDENTS) AS total_enrolled_students, \n    NULL AS term_code, \n    COUNT(DISTINCT rc.CATALOG_ISBN) AS distinct_catalog_isbns\nFROM \n    LIBRARY_SUBJECT_OFFERED so\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL md ON so.LIBRARY_SUBJECT_OFFERED_KEY = md.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG rc ON md.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    ACADEMIC_TERM_PARAMETER tp ON so.TERM_CODE = tp.TERM_CODE\nWHERE \n    tp.IS_CURRENT_TERM = 'Y';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349886, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=420, prompt_tokens=1964, total_tokens=2384, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=420, prompt_tokens=1964, total_tokens=2384, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    so.OFFER_DEPT_NAME AS department,
    so.OFFER_SCHOOL_NAME AS school,
    so.COURSE_NUMBER AS course_number,
    so.SUBJECT_TITLE AS subject_title,
    SUM(so.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,
    so.TERM_CODE AS term_code,
    COUNT(DISTINCT rc.CATALOG_ISBN) AS distinct_catalog_isbns
FROM 
    LIBRARY_SUBJECT_OFFERED so
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL md ON so.LIBRARY_SUBJECT_OFFERED_KEY = md.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG rc ON md.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    ACADEMIC_TERM_PARAMETER tp ON so.TERM_CODE = tp.TERM_CODE
WHERE 
    tp.IS_CURRENT_TERM = 'Y'
GROUP BY 
    so.OFFER_DEPT_NAME, so.OFFER_SCHOOL_NAME, so.COURSE_NUMBER, so.SUBJECT_TITLE, so.TERM_CODE
UNION ALL
SELECT 
    'TOTAL:' AS department, 
    NULL AS school, 
    NULL AS course_number, 
    NULL AS subject_title, 
    SUM(so.NUM_ENROLLED_STUDENTS) AS total_enrolled_students, 
    NULL AS term_code, 
    COUNT(DISTINCT rc.CATALOG_ISBN) AS distinct_catalog_isbns
FROM 
    LIBRARY_SUBJECT_OFFERED so
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL md ON so.LIBRARY_SUBJECT_OFFERED_KEY = md.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG rc ON md.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    ACADEMIC_TERM_PARAMETER tp ON so.TERM_CODE = tp.TERM_CODE
WHERE 
    tp.IS_CURRENT_TERM = 'Y';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1964, 420
TOTAL                  : 220231, 198237, 21994
AVG                    : 2474.51, 2227.38, 247.12
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, list its title, name of the building of the course location, duration (in terms of days), and a running average of the duration (in terms of days) using a window of two preceding and two following courses (partitioned by academic year and sorted by course start date).

(Hints: Schema Mapping Hints:
- 'title' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME
- 'duration' is related to ACADEMIC_TERMS.TERM_END_DATE, ACADEMIC_TERMS.TERM_START_DATE

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.EFFECTIVE_TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RH4ROd3M4jvEgfdGEgCQ1raLJ8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    c.SUBJECT_TITLE AS title,\n    b.BUILDING_NAME AS building_name,\n    (julianday(t.TERM_END_DATE) - julianday(t.TERM_START_DATE)) AS duration,\n    AVG(julianday(t2.TERM_END_DATE) - julianday(t2.TERM_START_DATE)) OVER (PARTITION BY c.ACADEMIC_YEAR ORDER BY t.TERM_START_DATE ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS running_average_duration\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN \n    ACADEMIC_TERMS t ON c.EFFECTIVE_TERM_CODE = t.TERM_CODE\nJOIN \n    FCLT_ROOMS r ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY\nJOIN \n    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY\nORDER BY \n    t.TERM_START_DATE;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349891, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=202, prompt_tokens=4275, total_tokens=4477, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=202, prompt_tokens=4275, total_tokens=4477, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    c.SUBJECT_TITLE AS title,
    b.BUILDING_NAME AS building_name,
    (julianday(t.TERM_END_DATE) - julianday(t.TERM_START_DATE)) AS duration,
    AVG(julianday(t2.TERM_END_DATE) - julianday(t2.TERM_START_DATE)) OVER (PARTITION BY c.ACADEMIC_YEAR ORDER BY t.TERM_START_DATE ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS running_average_duration
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED c
JOIN 
    ACADEMIC_TERMS t ON c.EFFECTIVE_TERM_CODE = t.TERM_CODE
JOIN 
    FCLT_ROOMS r ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY
JOIN 
    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY
ORDER BY 
    t.TERM_START_DATE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4275, 202
TOTAL                  : 224708, 202512, 22196
AVG                    : 2496.76, 2250.13, 246.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each mailing list that involves subscribers that work in departments with names starting with 'Computer Science', state the ownership type, the list name, the number of owners, and the number of subscribers. Display the ownership type only if it differs from the previous entry. Include subtotals (the corresponding type field shoud be 'SUBTOTAL') for each ownership type and a grand total (the corresponding type field shoud be 'TOTAL') across all ownership types.

(Hints: Schema Mapping Hints:
- 'departments with names starting with 'Computer Science'' is related to EMPLOYEE_DIRECTORY.DEPARTMENT_NAME
- 'ownership type' is related to MOIRA_LIST_OWNER.OWNER_TYPE
- 'list name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'owners' is related to MOIRA_LIST_OWNER.OWNER
- 'subscribers' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (EMPLOYEE_DIRECTORY.MIT_ID = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8REdUIPVlH6BjuSqMjDsBQXevOU', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH DeptSubscribers AS (\n    SELECT \n        OWNER_TYPE,\n        MOIRA_LIST.MOIRA_LIST_NAME,\n        COUNT(DISTINCT MOIRA_LIST_OWNER.OWNER) AS number_of_owners,\n        COUNT(DISTINCT MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID) AS number_of_subscribers\n    FROM \n        MOIRA_LIST\n    JOIN \n        MOIRA_LIST_OWNER ON MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY\n    JOIN \n        MOIRA_LIST_DETAIL ON MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY\n    JOIN \n        EMPLOYEE_DIRECTORY ON EMPLOYEE_DIRECTORY.MIT_ID = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID\n    WHERE \n        EMPLOYEE_DIRECTORY.DEPARTMENT_NAME LIKE 'Computer Science%'\n    GROUP BY \n        OWNER_TYPE, MOIRA_LIST.MOIRA_LIST_NAME\n),\nOwnerTypeSubtotals AS (\n    SELECT \n        OWNER_TYPE,\n        NULL AS MOIRA_LIST_NAME,\n        COUNT(DISTINCT OWNER_TYPE) AS number_of_owners,\n        SUM(number_of_subscribers) AS number_of_subscribers\n    FROM \n        DeptSubscribers\n    GROUP BY \n        OWNER_TYPE\n),\nGrandTotal AS (\n    SELECT \n        'TOTAL' AS OWNER_TYPE,\n        NULL AS MOIRA_LIST_NAME,\n        COUNT(*) AS number_of_owners,\n        SUM(number_of_subscribers) AS number_of_subscribers\n    FROM \n        DeptSubscribers\n)\nSELECT \n    OWNER_TYPE, \n    MOIRA_LIST_NAME, \n    number_of_owners, \n    number_of_subscribers \nFROM \n    DeptSubscribers\n\nUNION ALL\n\nSELECT \n    OWNER_TYPE, \n    MOIRA_LIST_NAME, \n    number_of_owners, \n    number_of_subscribers \nFROM \n    OwnerTypeSubtotals\n\nUNION ALL\n\nSELECT \n    OWNER_TYPE, \n    MOIRA_LIST_NAME, \n    number_of_owners, \n    number_of_subscribers \nFROM \n    GrandTotal\n\nORDER BY \n    OWNER_TYPE, MOIRA_LIST_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349888, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_aa07c96156', usage=CompletionUsage(completion_tokens=436, prompt_tokens=1529, total_tokens=1965, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=436, prompt_tokens=1529, total_tokens=1965, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH DeptSubscribers AS (
    SELECT 
        OWNER_TYPE,
        MOIRA_LIST.MOIRA_LIST_NAME,
        COUNT(DISTINCT MOIRA_LIST_OWNER.OWNER) AS number_of_owners,
        COUNT(DISTINCT MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID) AS number_of_subscribers
    FROM 
        MOIRA_LIST
    JOIN 
        MOIRA_LIST_OWNER ON MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY
    JOIN 
        MOIRA_LIST_DETAIL ON MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY
    JOIN 
        EMPLOYEE_DIRECTORY ON EMPLOYEE_DIRECTORY.MIT_ID = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID
    WHERE 
        EMPLOYEE_DIRECTORY.DEPARTMENT_NAME LIKE 'Computer Science%'
    GROUP BY 
        OWNER_TYPE, MOIRA_LIST.MOIRA_LIST_NAME
),
OwnerTypeSubtotals AS (
    SELECT 
        OWNER_TYPE,
        NULL AS MOIRA_LIST_NAME,
        COUNT(DISTINCT OWNER_TYPE) AS number_of_owners,
        SUM(number_of_subscribers) AS number_of_subscribers
    FROM 
        DeptSubscribers
    GROUP BY 
        OWNER_TYPE
),
GrandTotal AS (
    SELECT 
        'TOTAL' AS OWNER_TYPE,
        NULL AS MOIRA_LIST_NAME,
        COUNT(*) AS number_of_owners,
        SUM(number_of_subscribers) AS number_of_subscribers
    FROM 
        DeptSubscribers
)
SELECT 
    OWNER_TYPE, 
    MOIRA_LIST_NAME, 
    number_of_owners, 
    number_of_subscribers 
FROM 
    DeptSubscribers

UNION ALL

SELECT 
    OWNER_TYPE, 
    MOIRA_LIST_NAME, 
    number_of_owners, 
    number_of_subscribers 
FROM 
    OwnerTypeSubtotals

UNION ALL

SELECT 
    OWNER_TYPE, 
    MOIRA_LIST_NAME, 
    number_of_owners, 
    number_of_subscribers 
FROM 
    GrandTotal

ORDER BY 
    OWNER_TYPE, MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1529, 436
TOTAL                  : 226673, 204041, 22632
AVG                    : 2490.91, 2242.21, 248.70
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_HIST
[
(FCLT_BUILDING_HIST_KEY:VARCHAR2, Examples: ['14S-201505', '46-201505', 'E14-201505']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['201505', '201506', '201507']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['14S', '46', 'E14']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['14', 'W61', 'W70']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY', 'MACGREGOR HOUSE', 'NEW HOUSE']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library', 'Frank S MacGregor House', 'New West Campus Houses']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library (South Wing)', 'Brain & Cognitive Sciences Complex', 'Building E14']),
(EXT_GROSS_AREA:NUMBER, Examples: [48622.2, 418663.0, 173875.0]),
(ASSIGNABLE_AREA:NUMBER, Examples: [34500.5, 218519.0, 73792.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [10286.5, 152699.0, 83752.7]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHWEST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['(NULL)', 'UGBA3', 'UGBI2']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['136.4', '82.8', '88.3']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3623, 42.3605, 42.3615]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0916, -71.0873, -71.0879]),
(EASTING_X_SPCS:NUMBER, Examples: [766530.0, 767698.0, 767547.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2957330.0, 2956650.0, 2957020.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['14S', '46', 'E14']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['SEELY G. MUDD', 'HORACE SAYFORD FORD JR.', 'SEBASTIAN S. KRESGE']),
(BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY (S)', 'BCSC', 'BUILDING E14']),
(DATE_BUILT:VARCHAR2, Examples: ['04/25/2003', '12/31/1932', '12/31/1920']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['05/01/1961', '12/31/1955', '12/31/1939']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['09/01/2005', '03/06/1975', '10/01/1964']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-DEC-14', '01-JAN-15', '01-FEB-15']),
(NUM_OF_ROOMS:NUMBER, Examples: [118, 1403, 341])
]

### Question ###
For each building type, list the name of the building type, the number of buildings that are not subdivisions, number of employees, number of unique building street address, number of unique city, number of unique state, number of unique postal code, and average gross square footage per employee. For building type of 'resident', display it as 'RESIDENTIAL'. Include a grand total across all building types (the corresponding type field is 'TOTAL').

(Hints: Schema Mapping Hints:
- 'name of the building type' is related to FCLT_BUILDING_HIST.BUILDING_TYPE
- 'buildings that are not subdivisions' is related to FCLT_BUILDING_HIST.FCLT_BUILDING_KEY, FCLT_BUILDING_HIST.PARENT_BUILDING_NUMBER
- 'employees' is related to EMPLOYEE_DIRECTORY.MIT_ID
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'postal code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'gross square footage' is related to FCLT_BUILDING_HIST.EXT_GROSS_AREA

Join Information: (FAC_BUILDING_ADDRESS.BUILDING_KEY = FCLT_BUILDING_HIST.FCLT_BUILDING_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (EMPLOYEE_DIRECTORY.OFFICE_LOCATION = FAC_ROOMS.FAC_ROOM_KEY), (FCLT_BUILDING_HIST.FCLT_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_ROOMS.FAC_ROOM_KEY = EMPLOYEE_DIRECTORY.OFFICE_LOCATION))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RG52J3Qe8trB07JMtd6RN3xA45', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH BuildingCounts AS (\n    SELECT\n        CASE \n            WHEN FCLT.BUILDING_TYPE = 'resident' THEN 'RESIDENTIAL'\n            ELSE FCLT.BUILDING_TYPE \n        END AS Building_Type,\n        COUNT(DISTINCT FCLT.FCLT_BUILDING_KEY) AS Total_Buildings,\n        COUNT(DISTINCT EMP.MIT_ID) AS Total_Employees,\n        COUNT(DISTINCT B.BUILDING_STREET_ADDRESS) AS Unique_Street_Addresses,\n        COUNT(DISTINCT A.CITY) AS Unique_Cities,\n        COUNT(DISTINCT A.STATE) AS Unique_States,\n        COUNT(DISTINCT A.POSTAL_CODE) AS Unique_Postal_Codes,\n        AVG(FCLT.EXT_GROSS_AREA) AS Avg_Gross_Square_Footage_Per_Employee\n    FROM \n        FCLT_BUILDING_HIST FCLT\n    LEFT JOIN \n        FAC_BUILDING_ADDRESS A ON FCLT.FCLT_BUILDING_KEY = A.BUILDING_KEY\n    LEFT JOIN \n        BUILDINGS B ON A.BUILDING_KEY = B.BUILDING_KEY\n    LEFT JOIN \n        FAC_ROOMS R ON B.BUILDING_KEY = R.BUILDING_KEY\n    LEFT JOIN \n        EMPLOYEE_DIRECTORY EMP ON R.FAC_ROOM_KEY = EMP.OFFICE_LOCATION\n    WHERE \n        FCLT.PARENT_BUILDING_NUMBER IS NULL\n    GROUP BY \n        Building_Type\n),\nGrandTotal AS (\n    SELECT\n        'TOTAL' AS Building_Type,\n        SUM(Total_Buildings) AS Total_Buildings,\n        SUM(Total_Employees) AS Total_Employees,\n        SUM(Unique_Street_Addresses) AS Unique_Street_Addresses,\n        SUM(Unique_Cities) AS Unique_Cities,\n        SUM(Unique_States) AS Unique_States,\n        SUM(Unique_Postal_Codes) AS Unique_Postal_Codes,\n        AVG(NULLIF(Avg_Gross_Square_Footage_Per_Employee, 0)) AS Avg_Gross_Square_Footage_Per_Employee\n    FROM \n        BuildingCounts\n)\nSELECT * FROM BuildingCounts\nUNION ALL\nSELECT * FROM GrandTotal;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349890, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=459, prompt_tokens=3004, total_tokens=3463, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1152)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=459, prompt_tokens=3004, total_tokens=3463, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1152))

***** FINAL SQL QUERY *****
WITH BuildingCounts AS (
    SELECT
        CASE 
            WHEN FCLT.BUILDING_TYPE = 'resident' THEN 'RESIDENTIAL'
            ELSE FCLT.BUILDING_TYPE 
        END AS Building_Type,
        COUNT(DISTINCT FCLT.FCLT_BUILDING_KEY) AS Total_Buildings,
        COUNT(DISTINCT EMP.MIT_ID) AS Total_Employees,
        COUNT(DISTINCT B.BUILDING_STREET_ADDRESS) AS Unique_Street_Addresses,
        COUNT(DISTINCT A.CITY) AS Unique_Cities,
        COUNT(DISTINCT A.STATE) AS Unique_States,
        COUNT(DISTINCT A.POSTAL_CODE) AS Unique_Postal_Codes,
        AVG(FCLT.EXT_GROSS_AREA) AS Avg_Gross_Square_Footage_Per_Employee
    FROM 
        FCLT_BUILDING_HIST FCLT
    LEFT JOIN 
        FAC_BUILDING_ADDRESS A ON FCLT.FCLT_BUILDING_KEY = A.BUILDING_KEY
    LEFT JOIN 
        BUILDINGS B ON A.BUILDING_KEY = B.BUILDING_KEY
    LEFT JOIN 
        FAC_ROOMS R ON B.BUILDING_KEY = R.BUILDING_KEY
    LEFT JOIN 
        EMPLOYEE_DIRECTORY EMP ON R.FAC_ROOM_KEY = EMP.OFFICE_LOCATION
    WHERE 
        FCLT.PARENT_BUILDING_NUMBER IS NULL
    GROUP BY 
        Building_Type
),
GrandTotal AS (
    SELECT
        'TOTAL' AS Building_Type,
        SUM(Total_Buildings) AS Total_Buildings,
        SUM(Total_Employees) AS Total_Employees,
        SUM(Unique_Street_Addresses) AS Unique_Street_Addresses,
        SUM(Unique_Cities) AS Unique_Cities,
        SUM(Unique_States) AS Unique_States,
        SUM(Unique_Postal_Codes) AS Unique_Postal_Codes,
        AVG(NULLIF(Avg_Gross_Square_Footage_Per_Employee, 0)) AS Avg_Gross_Square_Footage_Per_Employee
    FROM 
        BuildingCounts
)
SELECT * FROM BuildingCounts
UNION ALL
SELECT * FROM GrandTotal;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3004, 459
TOTAL                  : 230136, 207045, 23091
AVG                    : 2501.48, 2250.49, 250.99
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: HR_FACULTY_ROSTER
[
(MIT_ID:VARCHAR2, Examples: ['999319439', '927924992', '903738061']),
(LAST_NAME:VARCHAR2, Examples: ['Frederick', 'Hooper', 'Frost']),
(FIRST_NAME:VARCHAR2, Examples: ['Floyd', 'Kade', 'Matthew']),
(MIDDLE_NAME:VARCHAR2, Examples: ['W', 'G', 'Garrison']),
(TERMINAL_DEGREE:VARCHAR2, Examples: ['Doctoral Degree', 'Post-Doctoral Degree', 'Bachelor's Degree']),
(APPOINTMENT_TYPE:VARCHAR2, Examples: ['Primary Appointment', 'Dual Appointment']),
(JOB_TITLE:VARCHAR2, Examples: ['Associate Professor', 'Professor', 'Assistant Professor']),
(HR_ORG_UNIT_TITLE:VARCHAR2, Examples: ['Aeronautics and Astronautics', 'Anthropology Program', 'Architecture']),
(POSITION_TITLE:VARCHAR2),
(ADMIN_ORG_UNIT_TITLE:VARCHAR2),
(ADMIN_POSITION_TITLE:VARCHAR2),
(ADMIN_JOB_TITLE:VARCHAR2),
(DIRECTORY_ORG_UNIT_TITLE:VARCHAR2, Examples: ['Department of Mechanical Engineering', 'Department of Linguistics and Philosophy', 'Division of Comparative Medicine']),
(ENDOWED_CHAIR:VARCHAR2),
(EMERITUS_STATUS:CHAR, Examples: ['Emeritus']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: HR_ORG_UNIT
[
(HR_ORG_UNIT_KEY:VARCHAR2, Examples: ['O10000333', 'O10005059', 'O10004909']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['0', '10000000', '10000001']),
(HR_ORG_UNIT_TITLE:VARCHAR2, Examples: ['[MEDIA82] OXMAN /NERI', 'Abdul Latif Jameel Poverty Action Lab', 'Academic Media Production Services']),
(HR_ORG_UNIT_LEVEL:VARCHAR2, Examples: ['DEPARTMENTS', 'ORGANIZATION LEVEL', 'SUB DEPARTMENT']),
(HR_DEPARTMENT_ID:VARCHAR2, Examples: ['10000333', '10005059', '10004909']),
(HR_DEPARTMENT_CODE:VARCHAR2, Examples: ['HR-068100', 'HR-404511', 'HR-402400']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '121002']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'VPF - Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(HR_DEPARTMENT_NAME_LONG:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'VPF - Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(HR_DEPARTMENT_NAME_ALPHA:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'VPF - Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(ORG_HIER_SCHOOL_AREA_NAME:VARCHAR2, Examples: ['Schwarzman College of Computing Area', 'VP for Finance Area', 'VP Research']),
(ORG_HIER_TOP_LEVEL_NAME:VARCHAR2, Examples: ['Provost Area', 'Executive Vice President Area', 'President & Chair of the Corporation']),
(ORG_HIER_ROOT_NAME:VARCHAR2, Examples: ['MIT-All']),
(HR_ORG_LEVEL1_ID:VARCHAR2, Examples: ['10000000']),
(HR_ORG_LEVEL1_SORT:VARCHAR2, Examples: ['1']),
(HR_ORG_LEVEL1_NAME:VARCHAR2, Examples: ['MIT-All']),
(HR_ORG_LEVEL2_ID:VARCHAR2, Examples: ['10000001', '10000002', '10000003']),
(HR_ORG_LEVEL2_SORT:VARCHAR2, Examples: ['2', '3', '4']),
(HR_ORG_LEVEL2_NAME:VARCHAR2, Examples: ['Provost Area', 'Executive Vice President Area', 'President & Chair of the Corporation']),
(HR_ORG_LEVEL3_ID:VARCHAR2, Examples: ['10005758', '10003333', '10000032']),
(HR_ORG_LEVEL3_SORT:VARCHAR2, Examples: ['513', '326', '18']),
(HR_ORG_LEVEL3_NAME:VARCHAR2, Examples: ['Schwarzman College of Computing Area', 'VP for Finance Area', 'VP Research']),
(HR_ORG_LEVEL4_ID:VARCHAR2, Examples: ['10000333', '10005058', '10004909']),
(HR_ORG_LEVEL4_SORT:VARCHAR2, Examples: ['59', '425', '414']),
(HR_ORG_LEVEL4_NAME:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'Office of the Treasurer Area', 'MIT Environmental Solutions Initiative']),
(HR_ORG_LEVEL5_ID:VARCHAR2, Examples: ['10005059', '10005810', '10005668']),
(HR_ORG_LEVEL5_SORT:VARCHAR2, Examples: ['426', '517', '504']),
(HR_ORG_LEVEL5_NAME:VARCHAR2, Examples: ['VPF - Treasury and Planning', 'Strategic Alliances & Tech Transfer Area', 'Office of the First Year Area']),
(HR_ORG_LEVEL6_ID:VARCHAR2, Examples: ['10000671', '10002483', '10000289']),
(HR_ORG_LEVEL6_SORT:VARCHAR2, Examples: ['168', '272', '42']),
(HR_ORG_LEVEL6_NAME:VARCHAR2, Examples: ['OSATT-Corporate Relations', 'Concourse', 'Terrascope']),
(HR_ORG_LEVEL7_ID:VARCHAR2, Examples: ['10005113', '10005110', '10005109']),
(HR_ORG_LEVEL7_SORT:VARCHAR2, Examples: ['434', '431', '430']),
(HR_ORG_LEVEL7_NAME:VARCHAR2, Examples: ['Open Learning, Corp & Prof, MIT xPRO', 'Open Learning, ODL, K-12', 'Open Learning, Supporting Unit, Bus/Ops']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_NAME:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'Office of Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-DEC-24', '13-DEC-24'])
]
# Table: MASTER_DEPT_HIERARCHY
[
(HIERARCHY_TYPE:VARCHAR2, Examples: ['Standard Hierarchy']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_CODE:VARCHAR2, Examples: ['D_DOF_CORE', 'D_DOF_RESERVE', 'D_DOF_RESIDENCE']),
(DLC_NAME:VARCHAR2, Examples: ['Facilities Building Core (hallways, stairs, etc.)', 'Facilities Provost Reserved', 'Facilities Residences']),
(MASTER_DEPT_HIER_LEVEL_1_CODE:VARCHAR2, Examples: ['D_ALL']),
(MASTER_DEPT_HIER_LEVEL_1_NAME:VARCHAR2, Examples: ['All Departments']),
(MASTER_DEPT_HIER_LEVEL_2_CODE:VARCHAR2, Examples: ['D_EXECVP_AREA', 'D_PROVOST_AREA', 'D_PRES_AREA']),
(MASTER_DEPT_HIER_LEVEL_2_NAME:VARCHAR2, Examples: ['Executive Vice President's Area', 'Provost Area', 'President's area']),
(MASTER_DEPT_HIER_LEVEL_3_CODE:VARCHAR2, Examples: ['D_FINANCE_AREA', 'D_TREAS_AREA', 'D_SC_ENVP']),
(MASTER_DEPT_HIER_LEVEL_3_NAME:VARCHAR2, Examples: ['VP Finance Area', 'Treasurer's Area', 'Senior Council and Environmental Programs']),
(MASTER_DEPT_HIER_LEVEL_4_CODE:VARCHAR2, Examples: ['D_SOURCING_AREA', 'D_OSATT_AREA']),
(MASTER_DEPT_HIER_LEVEL_4_NAME:VARCHAR2, Examples: ['Sourcing Area', 'Office of Strategic Alliances & Tech Transfer Area']),
(MASTER_DEPT_HIER_LEVEL_5_CODE:VARCHAR2),
(MASTER_DEPT_HIER_LEVEL_5_NAME:VARCHAR2)
]

### Question ###
List each organization's break group, ID, name, and formatted name according to its level, along with whether its members are emeritus or non-emeritus. Also, include the organization number, level, employer count, and hierarchy type for each organization. Exclude organizations '139' and '250'. Sort the results by hierarchy type and ensure totals for employer counts are displayed.

(Hints: Schema Mapping Hints:
- 'break group' is related to FCLT_ORGANIZATION.ORGANIZATION_SORT
- 'ID' is related to FCLT_ORGANIZATION.ORGANIZATION_ID
- 'name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'level' is related to FCLT_ORGANIZATION.ORGANIZATION_LEVEL
- 'number' is related to FCLT_ORGANIZATION.ORGANIZATION_NUMBER
- 'employer' is related to HR_FACULTY_ROSTER.MIT_ID
- 'hierarchy type' is related to MASTER_DEPT_HIERARCHY.HIERARCHY_TYPE

Join Information: (FCLT_ORGANIZATION.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY), (FCLT_ORGANIZATION.DLC_KEY = HR_ORG_UNIT.DLC_KEY), (HR_ORG_UNIT.HR_ORG_UNIT_TITLE = HR_FACULTY_ROSTER.HR_ORG_UNIT_TITLE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RH5wHlgwiN6G3fhflWSQY0hZZx', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    FCLT_ORGANIZATION.ORGANIZATION_SORT AS break_group,\n    FCLT_ORGANIZATION.ORGANIZATION_ID AS ID,\n    FCLT_ORGANIZATION.ORGANIZATION_NAME AS name,\n    FCLT_ORGANIZATION.ORGANIZATION_LEVEL AS level,\n    FCLT_ORGANIZATION.ORGANIZATION_NUMBER AS number,\n    COUNT(DISTINCT HR_FACULTY_ROSTER.MIT_ID) AS employer_count,\n    MASTER_DEPT_HIERARCHY.HIERARCHY_TYPE\nFROM \n    FCLT_ORGANIZATION\nJOIN \n    MASTER_DEPT_HIERARCHY ON FCLT_ORGANIZATION.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY\nJOIN \n    HR_ORG_UNIT ON FCLT_ORGANIZATION.DLC_KEY = HR_ORG_UNIT.DLC_KEY\nJOIN \n    HR_FACULTY_ROSTER ON HR_ORG_UNIT.HR_ORG_UNIT_TITLE = HR_FACULTY_ROSTER.HR_ORG_UNIT_TITLE\nWHERE \n    FCLT_ORGANIZATION.ORGANIZATION_ID NOT IN ('139', '250')\nGROUP BY \n    FCLT_ORGANIZATION.ORGANIZATION_SORT,\n    FCLT_ORGANIZATION.ORGANIZATION_ID,\n    FCLT_ORGANIZATION.ORGANIZATION_NAME,\n    FCLT_ORGANIZATION.ORGANIZATION_LEVEL,\n    FCLT_ORGANIZATION.ORGANIZATION_NUMBER,\n    MASTER_DEPT_HIERARCHY.HIERARCHY_TYPE\nORDER BY \n    MASTER_DEPT_HIERARCHY.HIERARCHY_TYPE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349891, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=330, prompt_tokens=2632, total_tokens=2962, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=330, prompt_tokens=2632, total_tokens=2962, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    FCLT_ORGANIZATION.ORGANIZATION_SORT AS break_group,
    FCLT_ORGANIZATION.ORGANIZATION_ID AS ID,
    FCLT_ORGANIZATION.ORGANIZATION_NAME AS name,
    FCLT_ORGANIZATION.ORGANIZATION_LEVEL AS level,
    FCLT_ORGANIZATION.ORGANIZATION_NUMBER AS number,
    COUNT(DISTINCT HR_FACULTY_ROSTER.MIT_ID) AS employer_count,
    MASTER_DEPT_HIERARCHY.HIERARCHY_TYPE
FROM 
    FCLT_ORGANIZATION
JOIN 
    MASTER_DEPT_HIERARCHY ON FCLT_ORGANIZATION.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY
JOIN 
    HR_ORG_UNIT ON FCLT_ORGANIZATION.DLC_KEY = HR_ORG_UNIT.DLC_KEY
JOIN 
    HR_FACULTY_ROSTER ON HR_ORG_UNIT.HR_ORG_UNIT_TITLE = HR_FACULTY_ROSTER.HR_ORG_UNIT_TITLE
WHERE 
    FCLT_ORGANIZATION.ORGANIZATION_ID NOT IN ('139', '250')
GROUP BY 
    FCLT_ORGANIZATION.ORGANIZATION_SORT,
    FCLT_ORGANIZATION.ORGANIZATION_ID,
    FCLT_ORGANIZATION.ORGANIZATION_NAME,
    FCLT_ORGANIZATION.ORGANIZATION_LEVEL,
    FCLT_ORGANIZATION.ORGANIZATION_NUMBER,
    MASTER_DEPT_HIERARCHY.HIERARCHY_TYPE
ORDER BY 
    MASTER_DEPT_HIERARCHY.HIERARCHY_TYPE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2632, 330
TOTAL                  : 233098, 209677, 23421
AVG                    : 2506.43, 2254.59, 251.84
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, list its name, name of the building of the course location, and the cumulative number of courses, including the course itself, held in the same year or preceding years (partitioned by academic year and sorted in the ascending order of course start date).

(Hints: Schema Mapping Hints:
- 'name' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'academic year' is related to COURSE_CATALOG_SUBJECT_OFFERED.ACADEMIC_YEAR
- 'course start date' is related to ACADEMIC_TERMS.TERM_START_DATE

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.EFFECTIVE_TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FCLT_ROOMS.FCLT_ROOM_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RKjS05YTWy2XqjkAkHpXUiGlwO', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    c.SUBJECT_TITLE AS course_name, \n    b.BUILDING_NAME AS building_name, \n    COUNT(*) OVER (PARTITION BY c.ACADEMIC_YEAR ORDER BY t.TERM_START_DATE) AS cumulative_courses\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN \n    ACADEMIC_TERMS t ON c.EFFECTIVE_TERM_CODE = t.TERM_CODE\nJOIN \n    FCLT_ROOMS r ON c.MEET_PLACE = r.FCLT_ROOM_KEY\nJOIN \n    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY\nORDER BY \n    t.TERM_START_DATE;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349894, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=146, prompt_tokens=4302, total_tokens=4448, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=146, prompt_tokens=4302, total_tokens=4448, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    c.SUBJECT_TITLE AS course_name, 
    b.BUILDING_NAME AS building_name, 
    COUNT(*) OVER (PARTITION BY c.ACADEMIC_YEAR ORDER BY t.TERM_START_DATE) AS cumulative_courses
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED c
JOIN 
    ACADEMIC_TERMS t ON c.EFFECTIVE_TERM_CODE = t.TERM_CODE
JOIN 
    FCLT_ROOMS r ON c.MEET_PLACE = r.FCLT_ROOM_KEY
JOIN 
    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY
ORDER BY 
    t.TERM_START_DATE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4302, 146
TOTAL                  : 237546, 213979, 23567
AVG                    : 2527.09, 2276.37, 250.71
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each IAP category, list its name, number of unique sessions, total number of attendees, active period (in the format of 'beginning term code-end term code'), the most common sponsor name, and the most common session start time. Include a grand total row showing the total number of sessions and attendees across all categories in the format of ('TOTAL', number of sessions, number of attendees, null, null, null).

(Hints: Schema Mapping Hints:
- 'name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'attendees' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT
- 'active period' is related to IAP_SUBJECT_DETAIL.TERM_CODE
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'session start time' is related to IAP_SUBJECT_SESSION.SESSION_START_TIME

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY), (IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RFqsuWLqlyTFWupu0DE3x41tap', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    c.IAP_CATEGORY_NAME AS name,\n    COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS num_unique_sessions,\n    SUM(d.MAX_ENROLLMENT) AS total_attendees,\n    MIN(d.TERM_CODE) || '-' || MAX(d.TERM_CODE) AS active_period,\n    (SELECT SPONSOR_NAME \n     FROM IAP_SUBJECT_SPONSOR sp \n     JOIN IAP_SUBJECT_DETAIL d2 ON sp.IAP_SUBJECT_SPONSOR_KEY = d2.IAP_SUBJECT_SPONSOR_KEY \n     WHERE d2.IAP_SUBJECT_CATEGORY_KEY = c.IAP_SUBJECT_CATEGORY_KEY \n     GROUP BY SPONSOR_NAME \n     ORDER BY COUNT(*) DESC \n     LIMIT 1) AS most_common_sponsor_name,\n    (SELECT SESSION_START_TIME \n     FROM IAP_SUBJECT_SESSION s2 \n     JOIN IAP_SUBJECT_DETAIL d2 ON s2.IAP_SUBJECT_SESSION_KEY = d2.IAP_SUBJECT_SESSION_KEY \n     WHERE d2.IAP_SUBJECT_CATEGORY_KEY = c.IAP_SUBJECT_CATEGORY_KEY \n     GROUP BY SESSION_START_TIME \n     ORDER BY COUNT(*) DESC \n     LIMIT 1) AS most_common_session_start_time\nFROM \n    IAP_SUBJECT_CATEGORY c\nJOIN \n    IAP_SUBJECT_DETAIL d ON c.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY\nJOIN \n    IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY\nGROUP BY \n    c.IAP_CATEGORY_NAME\n\nUNION ALL\n\nSELECT \n    'TOTAL',\n    COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS num_unique_sessions,\n    SUM(d.MAX_ENROLLMENT) AS total_attendees,\n    NULL AS active_period,\n    NULL AS most_common_sponsor_name,\n    NULL AS most_common_session_start_time\nFROM \n    IAP_SUBJECT_DETAIL d\nJOIN \n    IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349889, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=425, prompt_tokens=1891, total_tokens=2316, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=425, prompt_tokens=1891, total_tokens=2316, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    c.IAP_CATEGORY_NAME AS name,
    COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS num_unique_sessions,
    SUM(d.MAX_ENROLLMENT) AS total_attendees,
    MIN(d.TERM_CODE) || '-' || MAX(d.TERM_CODE) AS active_period,
    (SELECT SPONSOR_NAME 
     FROM IAP_SUBJECT_SPONSOR sp 
     JOIN IAP_SUBJECT_DETAIL d2 ON sp.IAP_SUBJECT_SPONSOR_KEY = d2.IAP_SUBJECT_SPONSOR_KEY 
     WHERE d2.IAP_SUBJECT_CATEGORY_KEY = c.IAP_SUBJECT_CATEGORY_KEY 
     GROUP BY SPONSOR_NAME 
     ORDER BY COUNT(*) DESC 
     LIMIT 1) AS most_common_sponsor_name,
    (SELECT SESSION_START_TIME 
     FROM IAP_SUBJECT_SESSION s2 
     JOIN IAP_SUBJECT_DETAIL d2 ON s2.IAP_SUBJECT_SESSION_KEY = d2.IAP_SUBJECT_SESSION_KEY 
     WHERE d2.IAP_SUBJECT_CATEGORY_KEY = c.IAP_SUBJECT_CATEGORY_KEY 
     GROUP BY SESSION_START_TIME 
     ORDER BY COUNT(*) DESC 
     LIMIT 1) AS most_common_session_start_time
FROM 
    IAP_SUBJECT_CATEGORY c
JOIN 
    IAP_SUBJECT_DETAIL d ON c.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY
JOIN 
    IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY
GROUP BY 
    c.IAP_CATEGORY_NAME

UNION ALL

SELECT 
    'TOTAL',
    COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS num_unique_sessions,
    SUM(d.MAX_ENROLLMENT) AS total_attendees,
    NULL AS active_period,
    NULL AS most_common_sponsor_name,
    NULL AS most_common_session_start_time
FROM 
    IAP_SUBJECT_DETAIL d
JOIN 
    IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1891, 425
TOTAL                  : 239862, 215870, 23992
AVG                    : 2524.86, 2272.32, 252.55
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, list its name, name of the building of the course location, the start date, the name of the course before it, and the name of the course after it, access level of the building, and the assignable area of the room used for the course, sorted by the ascending order start date and course name.

(Hints: Schema Mapping Hints:
- 'name' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME_LONG
- 'start date' is related to ACADEMIC_TERMS.TERM_START_DATE
- 'name of the course' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'access level' is related to FCLT_BUILDING.ACCESS_LEVEL_NAME
- 'area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RJsVLiqiMlJ1VaII2tvOOJ4Ei2', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    c.SUBJECT_TITLE AS course_name,\n    b.BUILDING_NAME_LONG AS building_name,\n    t.TERM_START_DATE AS start_date,\n    LAG(c.SUBJECT_TITLE) OVER (ORDER BY t.TERM_START_DATE, c.SUBJECT_TITLE) AS previous_course,\n    LEAD(c.SUBJECT_TITLE) OVER (ORDER BY t.TERM_START_DATE, c.SUBJECT_TITLE) AS next_course,\n    b.ACCESS_LEVEL_NAME AS access_level,\n    r.AREA AS assignable_area\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN \n    ACADEMIC_TERMS t ON c.TERM_CODE = t.TERM_CODE\nJOIN \n    FCLT_ROOMS r ON r.BUILDING_ROOM = c.SUBJECT_CODE\nJOIN \n    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY\nORDER BY \n    t.TERM_START_DATE ASC, c.SUBJECT_TITLE ASC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349893, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=205, prompt_tokens=4304, total_tokens=4509, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3968)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=205, prompt_tokens=4304, total_tokens=4509, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3968))

***** FINAL SQL QUERY *****
SELECT 
    c.SUBJECT_TITLE AS course_name,
    b.BUILDING_NAME_LONG AS building_name,
    t.TERM_START_DATE AS start_date,
    LAG(c.SUBJECT_TITLE) OVER (ORDER BY t.TERM_START_DATE, c.SUBJECT_TITLE) AS previous_course,
    LEAD(c.SUBJECT_TITLE) OVER (ORDER BY t.TERM_START_DATE, c.SUBJECT_TITLE) AS next_course,
    b.ACCESS_LEVEL_NAME AS access_level,
    r.AREA AS assignable_area
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED c
JOIN 
    ACADEMIC_TERMS t ON c.TERM_CODE = t.TERM_CODE
JOIN 
    FCLT_ROOMS r ON r.BUILDING_ROOM = c.SUBJECT_CODE
JOIN 
    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY
ORDER BY 
    t.TERM_START_DATE ASC, c.SUBJECT_TITLE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4304, 205
TOTAL                  : 244371, 220174, 24197
AVG                    : 2545.53, 2293.48, 252.05
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_USAGE
[
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(SPACE_USAGE:VARCHAR2, Examples: ['ARC ROOM', 'TST ROOM', 'RSRC RM']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: ZPM_ROOMS_LOAD
[
(BUILDING_ROOM:VARCHAR2, Examples: ['1-073', '1-035', '1-061']),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['0', '1', '2']),
(SPACE_USAGE:VARCHAR2, Examples: ['DSGN STUDIO', 'ARC ROOM', 'DINING RM']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['121000', '150000', '151000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000267', '10000270', '10000272']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['3', '0', '2'])
]

### Question ###
Group spaces in the Stata building by the access level and usage type. For each group, state the access level, usage type, name of the space, the number of spaces, total area across all rooms in the space, and average area across all rooms in the space. Display the access level only if it differs from the previous entry. Include subtotals for each access level, usage type, and space name, subtotals for each access level, and a grand total across all access levels. Exclude usage type that includes "STORAGE". All numerical values should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'Stata building' is related to SPACE_DETAIL.BUILDING_KEY
- 'access level' is related to ZPM_ROOMS_LOAD.ACCESS_LEVEL
- 'usage type' is related to SPACE_USAGE.SPACE_USAGE
- 'name of the space' is related to FCLT_ORGANIZATION.DLC_NAME
- 'spaces' is related to SPACE_UNIT.SPACE_UNIT
- 'area' is related to SPACE_DETAIL.ROOM_SQUARE_FOOTAGE

Join Information: (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = SPACE_UNIT.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RGsvkldrgZtA69D7RxOwXR39MM', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH SpaceDetails AS (\n    SELECT \n        Z.BUILDING_ROOM,\n        Z.BUILDING_COMPONENT,\n        Z.FLOOR,\n        U.SPACE_USAGE,\n        O.DLC_NAME,\n        U.SPACE_UNIT AS SPACE_NAME,\n        D.ROOM_SQUARE_FOOTAGE\n    FROM \n        ZPM_ROOMS_LOAD Z\n    JOIN \n        SPACE_UNIT U ON Z.SPACE_UNIT_CODE = U.SPACE_UNIT_CODE\n    JOIN \n        SPACE_DETAIL D ON U.SPACE_UNIT_KEY = D.SPACE_UNIT_KEY\n    JOIN \n        SPACE_USAGE S ON S.SPACE_USAGE_KEY = D.SPACE_USAGE_KEY\n    JOIN \n        FCLT_ORGANIZATION O ON O.ORGANIZATION_ID = U.FCLT_ORGANIZATION_KEY\n    WHERE \n        Z.BUILDING_COMPONENT = '1' AND \n        S.SPACE_USAGE NOT LIKE '%STORAGE%'\n),\nAggregatedData AS (\n    SELECT \n        Z.ACCESS_LEVEL,\n        SD.SPACE_USAGE,\n        SD.SPACE_NAME,\n        COUNT(*) AS NumberOfSpaces,\n        SUM(SD.ROOM_SQUARE_FOOTAGE) AS TotalArea,\n        AVG(SD.ROOM_SQUARE_FOOTAGE) AS AvgArea\n    FROM \n        SpaceDetails SD\n    JOIN \n        ZPM_ROOMS_LOAD Z ON SD.BUILDING_ROOM = Z.BUILDING_ROOM\n    GROUP BY \n        Z.ACCESS_LEVEL, SD.SPACE_USAGE, SD.SPACE_NAME\n)\nSELECT \n    CASE \n        WHEN ACCESS_LEVEL <> LAG(ACCESS_LEVEL) OVER (ORDER BY ACCESS_LEVEL, SPACE_USAGE, SPACE_NAME) THEN ACCESS_LEVEL\n        ELSE NULL\n    END AS ACCESS_LEVEL,\n    SPACE_USAGE,\n    SPACE_NAME,\n    NumberOfSpaces,\n    totalArea AS TotalArea,\n    ROUND(totalArea) AS RoundedTotalArea,\n    ROUND(AvgArea) AS RoundedAvgArea\nFROM \n    AggregatedData\nORDER BY \n    ACCESS_LEVEL, SPACE_USAGE, SPACE_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349890, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=408, prompt_tokens=1469, total_tokens=1877, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=408, prompt_tokens=1469, total_tokens=1877, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH SpaceDetails AS (
    SELECT 
        Z.BUILDING_ROOM,
        Z.BUILDING_COMPONENT,
        Z.FLOOR,
        U.SPACE_USAGE,
        O.DLC_NAME,
        U.SPACE_UNIT AS SPACE_NAME,
        D.ROOM_SQUARE_FOOTAGE
    FROM 
        ZPM_ROOMS_LOAD Z
    JOIN 
        SPACE_UNIT U ON Z.SPACE_UNIT_CODE = U.SPACE_UNIT_CODE
    JOIN 
        SPACE_DETAIL D ON U.SPACE_UNIT_KEY = D.SPACE_UNIT_KEY
    JOIN 
        SPACE_USAGE S ON S.SPACE_USAGE_KEY = D.SPACE_USAGE_KEY
    JOIN 
        FCLT_ORGANIZATION O ON O.ORGANIZATION_ID = U.FCLT_ORGANIZATION_KEY
    WHERE 
        Z.BUILDING_COMPONENT = '1' AND 
        S.SPACE_USAGE NOT LIKE '%STORAGE%'
),
AggregatedData AS (
    SELECT 
        Z.ACCESS_LEVEL,
        SD.SPACE_USAGE,
        SD.SPACE_NAME,
        COUNT(*) AS NumberOfSpaces,
        SUM(SD.ROOM_SQUARE_FOOTAGE) AS TotalArea,
        AVG(SD.ROOM_SQUARE_FOOTAGE) AS AvgArea
    FROM 
        SpaceDetails SD
    JOIN 
        ZPM_ROOMS_LOAD Z ON SD.BUILDING_ROOM = Z.BUILDING_ROOM
    GROUP BY 
        Z.ACCESS_LEVEL, SD.SPACE_USAGE, SD.SPACE_NAME
)
SELECT 
    CASE 
        WHEN ACCESS_LEVEL <> LAG(ACCESS_LEVEL) OVER (ORDER BY ACCESS_LEVEL, SPACE_USAGE, SPACE_NAME) THEN ACCESS_LEVEL
        ELSE NULL
    END AS ACCESS_LEVEL,
    SPACE_USAGE,
    SPACE_NAME,
    NumberOfSpaces,
    totalArea AS TotalArea,
    ROUND(totalArea) AS RoundedTotalArea,
    ROUND(AvgArea) AS RoundedAvgArea
FROM 
    AggregatedData
ORDER BY 
    ACCESS_LEVEL, SPACE_USAGE, SPACE_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1469, 408
TOTAL                  : 246248, 221643, 24605
AVG                    : 2538.64, 2284.98, 253.66
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For students with last names starting with K, list their names, the phone numbers of departments they belong to, total number of mailing lists each student is in, and the average size of the mailing lists each student is in.

(Hints: Schema Mapping Hints:
- 'last names' is related to MIT_STUDENT_DIRECTORY.LAST_NAME
- 'names' is related to MIT_STUDENT_DIRECTORY.FULL_NAME
- 'phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'mailing lists' is related to MOIRA_LIST.MOIRA_LIST_KEY

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE), (MIT_STUDENT_DIRECTORY.FULL_NAME = SE_PERSON.FULL_NAME), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8ROQMGjPoQON5sH14U6PT2QJT3V', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    msd.FULL_NAME AS student_name,\n    sad.DEPARTMENT_PHONE_NUMBER AS department_phone,\n    COUNT(DISTINCT mld.MOIRA_LIST_KEY) AS mailing_list_count,\n    AVG(mld.COUNTER) AS average_mailing_list_size\nFROM \n    MIT_STUDENT_DIRECTORY msd\nJOIN \n    SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE\nJOIN \n    SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE\nJOIN \n    MOIRA_LIST_DETAIL mld ON msd.FULL_NAME = mld.MOIRA_LIST_MEMBER_FULL_NAME\nWHERE \n    msd.LAST_NAME LIKE 'K%'\nGROUP BY \n    msd.FULL_NAME, sad.DEPARTMENT_PHONE_NUMBER;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349898, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=173, prompt_tokens=1867, total_tokens=2040, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=173, prompt_tokens=1867, total_tokens=2040, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    msd.FULL_NAME AS student_name,
    sad.DEPARTMENT_PHONE_NUMBER AS department_phone,
    COUNT(DISTINCT mld.MOIRA_LIST_KEY) AS mailing_list_count,
    AVG(mld.COUNTER) AS average_mailing_list_size
FROM 
    MIT_STUDENT_DIRECTORY msd
JOIN 
    SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE
JOIN 
    SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE
JOIN 
    MOIRA_LIST_DETAIL mld ON msd.FULL_NAME = mld.MOIRA_LIST_MEMBER_FULL_NAME
WHERE 
    msd.LAST_NAME LIKE 'K%'
GROUP BY 
    msd.FULL_NAME, sad.DEPARTMENT_PHONE_NUMBER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1867, 173
TOTAL                  : 248288, 223510, 24778
AVG                    : 2533.55, 2280.71, 252.84
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]

### Question ###
List each academic year, the term code, and the number of newly introduced subjects in this term. Display the academic year only if it differs from the previous entry. Include a grand total (the corresponding year field should be 'TOTAL') stating the total number of subjects across all academic years.

(Hints: Schema Mapping Hints:
- 'academic year' is related to ACADEMIC_TERMS_ALL.ACADEMIC_YEAR
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RNOLWQJ8KL7AuiVe1pWUhRQKoh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    CASE WHEN academic_year = LAG(academic_year) OVER (ORDER BY academic_year) THEN NULL ELSE academic_year END AS academic_year,\n    term_code,\n    COUNT(DISTINCT subject_id) AS newly_introduced_subjects\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED\nJOIN \n    ACADEMIC_TERMS_ALL ON COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE\nGROUP BY \n    academic_year, term_code\nUNION ALL\nSELECT \n    'TOTAL' AS academic_year,\n    NULL AS term_code,\n    COUNT(DISTINCT subject_id) AS newly_introduced_subjects\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED\nJOIN \n    ACADEMIC_TERMS_ALL ON COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE\nORDER BY \n    academic_year;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349897, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=196, prompt_tokens=2772, total_tokens=2968, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=196, prompt_tokens=2772, total_tokens=2968, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    CASE WHEN academic_year = LAG(academic_year) OVER (ORDER BY academic_year) THEN NULL ELSE academic_year END AS academic_year,
    term_code,
    COUNT(DISTINCT subject_id) AS newly_introduced_subjects
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED
JOIN 
    ACADEMIC_TERMS_ALL ON COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE
GROUP BY 
    academic_year, term_code
UNION ALL
SELECT 
    'TOTAL' AS academic_year,
    NULL AS term_code,
    COUNT(DISTINCT subject_id) AS newly_introduced_subjects
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED
JOIN 
    ACADEMIC_TERMS_ALL ON COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE
ORDER BY 
    academic_year;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2772, 196
TOTAL                  : 251256, 226282, 24974
AVG                    : 2537.94, 2285.68, 252.26
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]
# Table: SUBJECT_SUMMARY
[
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese I', 'ESD Graduate Thesis', 'Advanced Organic Chemistry']),
(SUBJECT_OR_CLUSTER:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.004']),
(ULT_MASTER_SUBJECT_ID:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['J', 'S', 'M']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['Joint subject', 'SWE: School-Wide Electives', 'Meeting Together']),
(CLUSTER_LIST:VARCHAR2, Examples: ['3.43, 6.720', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012', '21A.344, STS.062']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['21F', 'ESD', '5']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Global Studies & Languages', 'Engineering Systems Division', 'Chemistry']),
(SCHOOL_CODE:VARCHAR2, Examples: ['H', 'E', 'S']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Hum, Arts & Social Sciences', 'Engineering', 'Science']),
(TOTAL_UNITS:NUMBER, Examples: [12, 1, 15]),
(LECTURE_UNITS:NUMBER, Examples: [4, 0, 3]),
(LAB_UNITS:NUMBER, Examples: [0, 1, 12]),
(PREP_UNITS:NUMBER, Examples: [8, 0, 9]),
(DESIGN_UNITS:NUMBER, Examples: [0, 4, 6]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [45, 203, 26]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [30, 235, 59]),
(SUBJECT_GROUP_ID:VARCHAR2, Examples: ['86CD64962C150327E0440003BACE90BC', 'F9E8CEBB9F5A7CCFE0433D2F091294A0', '86CD6495D8560327E0440003BACE90BC']),
(SUBJECT_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(CLUSTER_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(SUBJECT_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(CLUSTER_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(SUBJECT_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(SUBJECT_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(CLUSTER_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(SUBJECT_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(CLUSTER_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(SUBJECT_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(CLUSTER_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
Group courses in the biology and chemistry department by whether they are current or not and the department name. For each group, list the current status ('CURRENT' if yes and 'NON-CURRENT' otherwise), department name, the maximum duration of courses (in terms of days), the maximum units, average duration (in terms of days), and average units. Include subtotals for each current status (the corresponding current status field is 'SUBTOTAL') and a grand total across all current status (the corresponding current status field is 'TOTAL'). Do not repeat the current status if it is the same as the previous row. Sort the table by current status and department.

(Hints: Schema Mapping Hints:
- 'biology and chemistry department' is related to SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'current status' is related to ACADEMIC_TERMS_ALL.IS_CURRENT_TERM
- 'duration' is related to ACADEMIC_TERMS_ALL.TERM_END_DATE, ACADEMIC_TERMS_ALL.TERM_START_DATE
- 'units' is related to SUBJECT_SUMMARY.TOTAL_UNITS

Join Information: (ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_SUMMARY.TERM_CODE), (SUBJECT_SUMMARY.SUBJECT_ID = SUBJECT_OFFERED.SUBJECT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RMVkk21usHyNv2bNPbJNeJRu4T', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CourseDurations AS (\n    SELECT \n        A.IS_CURRENT_TERM,\n        S.DEPARTMENT_NAME,\n        JULIANDAY(A.TERM_END_DATE) - JULIANDAY(A.TERM_START_DATE) AS DURATION,\n        S.TOTAL_UNITS\n    FROM \n        ACADEMIC_TERMS_ALL A\n    JOIN \n        SUBJECT_SUMMARY S ON A.TERM_CODE = S.TERM_CODE\n    JOIN \n        SUBJECT_OFFERED O ON S.SUBJECT_ID = O.SUBJECT_ID\n    WHERE \n        O.OFFER_DEPT_NAME IN ('Biology', 'Chemistry')\n),\nAggregatedData AS (\n    SELECT \n        ISNULL(IS_CURRENT_TERM, 'SUBTOTAL') AS STATUS,\n        DEPARTMENT_NAME,\n        MAX(DURATION) AS MAX_DURATION,\n        MAX(TOTAL_UNITS) AS MAX_UNITS,\n        AVG(DURATION) AS AVG_DURATION,\n        AVG(TOTAL_UNITS) AS AVG_UNITS\n    FROM \n        CourseDurations\n    GROUP BY \n        IS_CURRENT_TERM, DEPARTMENT_NAME\n)\n\nSELECT \n    CASE \n        WHEN STATUS IS NULL THEN 'SUBTOTAL'\n        ELSE STATUS \n    END AS CURRENT_STATUS,\n    DEPARTMENT_NAME,\n    MAX_DURATION,\n    MAX_UNITS,\n    AVG_DURATION,\n    AVG_UNITS\nFROM \n    AggregatedData\n\nUNION ALL\n\nSELECT \n    'TOTAL' AS CURRENT_STATUS,\n    DEPARTMENT_NAME,\n    SUM(MAX_DURATION) AS MAX_DURATION,\n    SUM(MAX_UNITS) AS MAX_UNITS,\n    AVG(AVG_DURATION) AS AVG_DURATION,\n    AVG(AVG_UNITS) AS AVG_UNITS\nFROM \n    AggregatedData\nGROUP BY \n    DEPARTMENT_NAME\n\nORDER BY \n    CURRENT_STATUS, DEPARTMENT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349896, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=364, prompt_tokens=3518, total_tokens=3882, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=364, prompt_tokens=3518, total_tokens=3882, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH CourseDurations AS (
    SELECT 
        A.IS_CURRENT_TERM,
        S.DEPARTMENT_NAME,
        JULIANDAY(A.TERM_END_DATE) - JULIANDAY(A.TERM_START_DATE) AS DURATION,
        S.TOTAL_UNITS
    FROM 
        ACADEMIC_TERMS_ALL A
    JOIN 
        SUBJECT_SUMMARY S ON A.TERM_CODE = S.TERM_CODE
    JOIN 
        SUBJECT_OFFERED O ON S.SUBJECT_ID = O.SUBJECT_ID
    WHERE 
        O.OFFER_DEPT_NAME IN ('Biology', 'Chemistry')
),
AggregatedData AS (
    SELECT 
        ISNULL(IS_CURRENT_TERM, 'SUBTOTAL') AS STATUS,
        DEPARTMENT_NAME,
        MAX(DURATION) AS MAX_DURATION,
        MAX(TOTAL_UNITS) AS MAX_UNITS,
        AVG(DURATION) AS AVG_DURATION,
        AVG(TOTAL_UNITS) AS AVG_UNITS
    FROM 
        CourseDurations
    GROUP BY 
        IS_CURRENT_TERM, DEPARTMENT_NAME
)

SELECT 
    CASE 
        WHEN STATUS IS NULL THEN 'SUBTOTAL'
        ELSE STATUS 
    END AS CURRENT_STATUS,
    DEPARTMENT_NAME,
    MAX_DURATION,
    MAX_UNITS,
    AVG_DURATION,
    AVG_UNITS
FROM 
    AggregatedData

UNION ALL

SELECT 
    'TOTAL' AS CURRENT_STATUS,
    DEPARTMENT_NAME,
    SUM(MAX_DURATION) AS MAX_DURATION,
    SUM(MAX_UNITS) AS MAX_UNITS,
    AVG(AVG_DURATION) AS AVG_DURATION,
    AVG(AVG_UNITS) AS AVG_UNITS
FROM 
    AggregatedData
GROUP BY 
    DEPARTMENT_NAME

ORDER BY 
    CURRENT_STATUS, DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3518, 364
TOTAL                  : 255138, 229800, 25338
AVG                    : 2551.38, 2298.00, 253.38
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_SUMMARY
[
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese I', 'ESD Graduate Thesis', 'Advanced Organic Chemistry']),
(SUBJECT_OR_CLUSTER:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.004']),
(ULT_MASTER_SUBJECT_ID:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['J', 'S', 'M']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['Joint subject', 'SWE: School-Wide Electives', 'Meeting Together']),
(CLUSTER_LIST:VARCHAR2, Examples: ['3.43, 6.720', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012', '21A.344, STS.062']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['21F', 'ESD', '5']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Global Studies & Languages', 'Engineering Systems Division', 'Chemistry']),
(SCHOOL_CODE:VARCHAR2, Examples: ['H', 'E', 'S']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Hum, Arts & Social Sciences', 'Engineering', 'Science']),
(TOTAL_UNITS:NUMBER, Examples: [12, 1, 15]),
(LECTURE_UNITS:NUMBER, Examples: [4, 0, 3]),
(LAB_UNITS:NUMBER, Examples: [0, 1, 12]),
(PREP_UNITS:NUMBER, Examples: [8, 0, 9]),
(DESIGN_UNITS:NUMBER, Examples: [0, 4, 6]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [45, 203, 26]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [30, 235, 59]),
(SUBJECT_GROUP_ID:VARCHAR2, Examples: ['86CD64962C150327E0440003BACE90BC', 'F9E8CEBB9F5A7CCFE0433D2F091294A0', '86CD6495D8560327E0440003BACE90BC']),
(SUBJECT_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(CLUSTER_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(SUBJECT_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(CLUSTER_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(SUBJECT_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(SUBJECT_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(CLUSTER_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(SUBJECT_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(CLUSTER_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(SUBJECT_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(CLUSTER_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
Group courses in the biology and chemistry department by whether they are current or not and the cluster type. For each group, list the current status ('CURRENT' if yes and 'NON-CURRENT' otherwise), cluster type, the maximum duration of courses (in terms of days), the maximum units, average duration (in terms of days), and average units. Include subtotals for each current status (the corresponding current status field is 'SUBTOTAL') and a grand total across all current status (the corresponding current status field is 'TOTAL'). Do not repeat the current status if it is the same as the previous row. Sort the table by current status and cluster type.

(Hints: Schema Mapping Hints:
- 'biology and chemistry department' is related to SUBJECT_SUMMARY.DEPARTMENT_NAME
- 'current status' is related to ACADEMIC_TERMS_ALL.IS_CURRENT_TERM
- 'cluster type' is related to SUBJECT_SUMMARY.CLUSTER_TYPE
- 'duration' is related to ACADEMIC_TERMS_ALL.TERM_END_DATE, ACADEMIC_TERMS_ALL.TERM_START_DATE
- 'units' is related to SUBJECT_SUMMARY.TOTAL_UNITS

Join Information: (ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_SUMMARY.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RLbKYwJs4WHVENhcQuJzJH5ru8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CourseDurations AS (\n    SELECT \n        s.CLUSTER_TYPE,\n        a.IS_CURRENT_TERM,\n        MAX(julianday(a.TERM_END_DATE) - julianday(a.TERM_START_DATE)) AS max_duration,\n        AVG(julianday(a.TERM_END_DATE) - julianday(a.TERM_START_DATE)) AS avg_duration,\n        MAX(s.TOTAL_UNITS) AS max_units,\n        AVG(s.TOTAL_UNITS) AS avg_units\n    FROM \n        SUBJECT_SUMMARY s\n    JOIN \n        ACADEMIC_TERMS_ALL a ON s.TERM_CODE = a.TERM_CODE\n    WHERE \n        a.IS_CURRENT_TERM IN ('Y', 'N') AND \n        (s.DEPARTMENT_NAME = 'Biology' OR s.DEPARTMENT_NAME = 'Chemistry')\n    GROUP BY \n        s.CLUSTER_TYPE, a.IS_CURRENT_TERM\n), \nSubtotals AS (\n    SELECT \n        CASE WHEN IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END AS current_status,\n        CLUSTER_TYPE,\n        MAX(max_duration) AS max_duration,\n        MAX(max_units) AS max_units,\n        AVG(avg_duration) AS avg_duration,\n        AVG(avg_units) AS avg_units\n    FROM \n        CourseDurations\n    GROUP BY \n        current_status, CLUSTER_TYPE\n), \nGrandTotal AS (\n    SELECT \n        'TOTAL' AS current_status,\n        NULL AS CLUSTER_TYPE,\n        SUM(max_duration) AS max_duration,\n        SUM(max_units) AS max_units,\n        AVG(avg_duration) AS avg_duration,\n        AVG(avg_units) AS avg_units\n    FROM \n        Subtotals\n)\nSELECT * FROM Subtotals\nUNION ALL\nSELECT * FROM GrandTotal\nORDER BY current_status, CLUSTER_TYPE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349895, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=376, prompt_tokens=2092, total_tokens=2468, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=376, prompt_tokens=2092, total_tokens=2468, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH CourseDurations AS (
    SELECT 
        s.CLUSTER_TYPE,
        a.IS_CURRENT_TERM,
        MAX(julianday(a.TERM_END_DATE) - julianday(a.TERM_START_DATE)) AS max_duration,
        AVG(julianday(a.TERM_END_DATE) - julianday(a.TERM_START_DATE)) AS avg_duration,
        MAX(s.TOTAL_UNITS) AS max_units,
        AVG(s.TOTAL_UNITS) AS avg_units
    FROM 
        SUBJECT_SUMMARY s
    JOIN 
        ACADEMIC_TERMS_ALL a ON s.TERM_CODE = a.TERM_CODE
    WHERE 
        a.IS_CURRENT_TERM IN ('Y', 'N') AND 
        (s.DEPARTMENT_NAME = 'Biology' OR s.DEPARTMENT_NAME = 'Chemistry')
    GROUP BY 
        s.CLUSTER_TYPE, a.IS_CURRENT_TERM
), 
Subtotals AS (
    SELECT 
        CASE WHEN IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END AS current_status,
        CLUSTER_TYPE,
        MAX(max_duration) AS max_duration,
        MAX(max_units) AS max_units,
        AVG(avg_duration) AS avg_duration,
        AVG(avg_units) AS avg_units
    FROM 
        CourseDurations
    GROUP BY 
        current_status, CLUSTER_TYPE
), 
GrandTotal AS (
    SELECT 
        'TOTAL' AS current_status,
        NULL AS CLUSTER_TYPE,
        SUM(max_duration) AS max_duration,
        SUM(max_units) AS max_units,
        AVG(avg_duration) AS avg_duration,
        AVG(avg_units) AS avg_units
    FROM 
        Subtotals
)
SELECT * FROM Subtotals
UNION ALL
SELECT * FROM GrandTotal
ORDER BY current_status, CLUSTER_TYPE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2092, 376
TOTAL                  : 257606, 231892, 25714
AVG                    : 2550.55, 2295.96, 254.59
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For email lists with names starting with e (case insensitive), containing 10 to 20 members inclusive, and where over 75% are computer science students, provide the list name, owner, and member count.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'computer science' is related to MIT_STUDENT_DIRECTORY.DEPARTMENT
- 'owner' is related to MOIRA_LIST_OWNER.OWNER

Join Information: (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = SE_PERSON.KRB_NAME), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8ROzAK36WL5vvqMKldYa0IW5rxF', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    mlo.OWNER, \n    COUNT(mld.MOIRA_LIST_MEMBER) AS member_count\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    MOIRA_LIST_OWNER mlo ON mld.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY\nJOIN \n    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME\nJOIN \n    MIT_STUDENT_DIRECTORY msd ON sp.FULL_NAME = msd.FULL_NAME\nWHERE \n    LOWER(ml.MOIRA_LIST_NAME) LIKE 'e%' \nGROUP BY \n    ml.MOIRA_LIST_NAME, \n    mlo.OWNER\nHAVING \n    COUNT(mld.MOIRA_LIST_MEMBER) BETWEEN 10 AND 20 AND \n    SUM(CASE WHEN msd.DEPARTMENT = '11' THEN 1 ELSE 0 END) * 1.0 / COUNT(mld.MOIRA_LIST_MEMBER) > 0.75;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349898, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=238, prompt_tokens=1429, total_tokens=1667, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=238, prompt_tokens=1429, total_tokens=1667, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    mlo.OWNER, 
    COUNT(mld.MOIRA_LIST_MEMBER) AS member_count
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    MOIRA_LIST_OWNER mlo ON mld.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY
JOIN 
    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME
JOIN 
    MIT_STUDENT_DIRECTORY msd ON sp.FULL_NAME = msd.FULL_NAME
WHERE 
    LOWER(ml.MOIRA_LIST_NAME) LIKE 'e%' 
GROUP BY 
    ml.MOIRA_LIST_NAME, 
    mlo.OWNER
HAVING 
    COUNT(mld.MOIRA_LIST_MEMBER) BETWEEN 10 AND 20 AND 
    SUM(CASE WHEN msd.DEPARTMENT = '11' THEN 1 ELSE 0 END) * 1.0 / COUNT(mld.MOIRA_LIST_MEMBER) > 0.75;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1429, 238
TOTAL                  : 259273, 233321, 25952
AVG                    : 2541.89, 2287.46, 254.43
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group sessions by their current term status. For each group, state the status ('CURRENT' if is current term and 'NOT CURRENT' otherwise), name of the session, number of IAP sessions, total IAP session time in days, and average IAP session time in days. Show a subtotal for each current status and a grand total row across all status. Order the results by current status and cluster type. Display the the current status only if it differs from the previous entry.

(Hints: Schema Mapping Hints:
- 'current term status' is related to ACADEMIC_TERMS.IS_CURRENT_TERM
- 'name of the session' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'IAP sessions' is related to IAP_SUBJECT_SESSION.SESSION_DATE
- 'session time' is related to IAP_SUBJECT_SESSION.SESSION_START_TIME, IAP_SUBJECT_SESSION.SESSION_END_TIME

Join Information: (IAP_SUBJECT_DETAIL.TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RNGdriQpRow8OSWnxznwHBMupa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH SessionStatistics AS (\n    SELECT \n        CASE \n            WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT'\n            ELSE 'NOT CURRENT'\n        END AS Current_Status,\n        ISC.IAP_CATEGORY_NAME AS Session_Name,\n        COUNT(DISTINCT ISS.IAP_SUBJECT_SESSION_KEY) AS Number_of_IAP_Sessions,\n        JULIANDAY(MAX(ISS.SESSION_DATE)) - JULIANDAY(MIN(ISS.SESSION_DATE)) AS Total_Session_Time,\n        (JULIANDAY(MAX(ISS.SESSION_DATE)) - JULIANDAY(MIN(ISS.SESSION_DATE))) / COUNT(DISTINCT ISS.IAP_SUBJECT_SESSION_KEY) AS Average_Session_Time\n    FROM \n        ACADEMIC_TERMS AT\n    JOIN \n        IAP_SUBJECT_DETAIL ISD ON AT.TERM_CODE = ISD.TERM_CODE\n    JOIN \n        IAP_SUBJECT_SESSION ISS ON ISD.IAP_SUBJECT_SESSION_KEY = ISS.IAP_SUBJECT_SESSION_KEY\n    JOIN \n        IAP_SUBJECT_CATEGORY ISC ON ISD.IAP_SUBJECT_CATEGORY_KEY = ISC.IAP_SUBJECT_CATEGORY_KEY\n    GROUP BY \n        Current_Status, Session_Name\n),\nSubtotal AS (\n    SELECT \n        Current_Status,\n        NULL AS Session_Name,\n        SUM(Number_of_IAP_Sessions) AS Number_of_IAP_Sessions,\n        SUM(Total_Session_Time) AS Total_Session_Time,\n        AVG(Average_Session_Time) AS Average_Session_Time\n    FROM \n        SessionStatistics\n    GROUP BY \n        Current_Status\n)\nSELECT \n    Current_Status,\n    Session_Name,\n    Number_of_IAP_Sessions,\n    Total_Session_Time,\n    Average_Session_Time\nFROM \n    SessionStatistics\nUNION ALL\nSELECT \n    Current_Status,\n    Session_Name,\n    Number_of_IAP_Sessions,\n    Total_Session_Time,\n    Average_Session_Time\nFROM \n    Subtotal\nORDER BY \n    CASE Current_Status WHEN 'CURRENT' THEN 1 ELSE 2 END, Session_Name;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349897, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=426, prompt_tokens=2366, total_tokens=2792, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=426, prompt_tokens=2366, total_tokens=2792, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH SessionStatistics AS (
    SELECT 
        CASE 
            WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT'
            ELSE 'NOT CURRENT'
        END AS Current_Status,
        ISC.IAP_CATEGORY_NAME AS Session_Name,
        COUNT(DISTINCT ISS.IAP_SUBJECT_SESSION_KEY) AS Number_of_IAP_Sessions,
        JULIANDAY(MAX(ISS.SESSION_DATE)) - JULIANDAY(MIN(ISS.SESSION_DATE)) AS Total_Session_Time,
        (JULIANDAY(MAX(ISS.SESSION_DATE)) - JULIANDAY(MIN(ISS.SESSION_DATE))) / COUNT(DISTINCT ISS.IAP_SUBJECT_SESSION_KEY) AS Average_Session_Time
    FROM 
        ACADEMIC_TERMS AT
    JOIN 
        IAP_SUBJECT_DETAIL ISD ON AT.TERM_CODE = ISD.TERM_CODE
    JOIN 
        IAP_SUBJECT_SESSION ISS ON ISD.IAP_SUBJECT_SESSION_KEY = ISS.IAP_SUBJECT_SESSION_KEY
    JOIN 
        IAP_SUBJECT_CATEGORY ISC ON ISD.IAP_SUBJECT_CATEGORY_KEY = ISC.IAP_SUBJECT_CATEGORY_KEY
    GROUP BY 
        Current_Status, Session_Name
),
Subtotal AS (
    SELECT 
        Current_Status,
        NULL AS Session_Name,
        SUM(Number_of_IAP_Sessions) AS Number_of_IAP_Sessions,
        SUM(Total_Session_Time) AS Total_Session_Time,
        AVG(Average_Session_Time) AS Average_Session_Time
    FROM 
        SessionStatistics
    GROUP BY 
        Current_Status
)
SELECT 
    Current_Status,
    Session_Name,
    Number_of_IAP_Sessions,
    Total_Session_Time,
    Average_Session_Time
FROM 
    SessionStatistics
UNION ALL
SELECT 
    Current_Status,
    Session_Name,
    Number_of_IAP_Sessions,
    Total_Session_Time,
    Average_Session_Time
FROM 
    Subtotal
ORDER BY 
    CASE Current_Status WHEN 'CURRENT' THEN 1 ELSE 2 END, Session_Name;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2366, 426
TOTAL                  : 262065, 235687, 26378
AVG                    : 2544.32, 2288.22, 256.10
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each term and department, list the term, department, the number of courses, average number of equivalent subjects, the school name, and department phone number. Include subtotals for each term (the corresponding term field is 'SUBTOTAL') and a grand total across all terms (the corresponding term field is 'TOTAL'). Do not repeat the term if it is the same as the previous row. Sort the table by term and department.

(Hints: Schema Mapping Hints:
- 'term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'department' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'equivalent subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.EQUIVALENT_SUBJECTS
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'department phone number' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER

Join Information: (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RNc0YgYSnAPSCbxlUV84L2vPD2', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CourseStats AS (\n    SELECT \n        C.TERM_CODE,\n        C.DEPARTMENT_NAME,\n        COUNT(DISTINCT C.SUBJECT_ID) AS course_count,\n        AVG(CASE WHEN C.EQUIVALENT_SUBJECTS IS NOT NULL THEN 1 ELSE 0 END) AS avg_equivalent_subjects,\n        D.SCHOOL_NAME,\n        A.DEPARTMENT_PHONE_NUMBER\n    FROM \n        COURSE_CATALOG_SUBJECT_OFFERED C\n    JOIN \n        SIS_DEPARTMENT D ON C.DEPARTMENT_CODE = D.DEPARTMENT_CODE\n    JOIN \n        SIS_ADMIN_DEPARTMENT A ON A.SIS_ADMIN_DEPARTMENT_CODE = D.DEPARTMENT_CODE\n    GROUP BY \n        C.TERM_CODE, C.DEPARTMENT_NAME, D.SCHOOL_NAME, A.DEPARTMENT_PHONE_NUMBER\n),\nSubtotal AS (\n    SELECT \n        TERM_CODE,\n        DEPARTMENT_NAME,\n        SUM(course_count) AS course_count,\n        AVG(avg_equivalent_subjects) AS avg_equivalent_subjects,\n        SCHOOL_NAME,\n        DEPARTMENT_PHONE_NUMBER\n    FROM \n        CourseStats\n    GROUP BY \n        TERM_CODE, DEPARTMENT_NAME, SCHOOL_NAME, DEPARTMENT_PHONE_NUMBER\n),\nGrandTotal AS (\n    SELECT \n        'TOTAL' AS TERM_CODE,\n        NULL AS DEPARTMENT_NAME,\n        SUM(course_count) AS course_count,\n        AVG(avg_equivalent_subjects) AS avg_equivalent_subjects,\n        NULL AS SCHOOL_NAME,\n        NULL AS DEPARTMENT_PHONE_NUMBER\n    FROM \n        Subtotal\n)\n\nSELECT \n    TERM_CODE,\n    DEPARTMENT_NAME,\n    course_count,\n    avg_equivalent_subjects,\n    SCHOOL_NAME,\n    DEPARTMENT_PHONE_NUMBER\nFROM \n    Subtotal\n\nUNION ALL\n\nSELECT \n    TERM_CODE,\n    DEPARTMENT_NAME,\n    course_count,\n    avg_equivalent_subjects,\n    SCHOOL_NAME,\n    DEPARTMENT_PHONE_NUMBER\nFROM \n    GrandTotal\nORDER BY \n    TERM_CODE, DEPARTMENT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349897, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=415, prompt_tokens=2833, total_tokens=3248, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1920)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=415, prompt_tokens=2833, total_tokens=3248, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1920))

***** FINAL SQL QUERY *****
WITH CourseStats AS (
    SELECT 
        C.TERM_CODE,
        C.DEPARTMENT_NAME,
        COUNT(DISTINCT C.SUBJECT_ID) AS course_count,
        AVG(CASE WHEN C.EQUIVALENT_SUBJECTS IS NOT NULL THEN 1 ELSE 0 END) AS avg_equivalent_subjects,
        D.SCHOOL_NAME,
        A.DEPARTMENT_PHONE_NUMBER
    FROM 
        COURSE_CATALOG_SUBJECT_OFFERED C
    JOIN 
        SIS_DEPARTMENT D ON C.DEPARTMENT_CODE = D.DEPARTMENT_CODE
    JOIN 
        SIS_ADMIN_DEPARTMENT A ON A.SIS_ADMIN_DEPARTMENT_CODE = D.DEPARTMENT_CODE
    GROUP BY 
        C.TERM_CODE, C.DEPARTMENT_NAME, D.SCHOOL_NAME, A.DEPARTMENT_PHONE_NUMBER
),
Subtotal AS (
    SELECT 
        TERM_CODE,
        DEPARTMENT_NAME,
        SUM(course_count) AS course_count,
        AVG(avg_equivalent_subjects) AS avg_equivalent_subjects,
        SCHOOL_NAME,
        DEPARTMENT_PHONE_NUMBER
    FROM 
        CourseStats
    GROUP BY 
        TERM_CODE, DEPARTMENT_NAME, SCHOOL_NAME, DEPARTMENT_PHONE_NUMBER
),
GrandTotal AS (
    SELECT 
        'TOTAL' AS TERM_CODE,
        NULL AS DEPARTMENT_NAME,
        SUM(course_count) AS course_count,
        AVG(avg_equivalent_subjects) AS avg_equivalent_subjects,
        NULL AS SCHOOL_NAME,
        NULL AS DEPARTMENT_PHONE_NUMBER
    FROM 
        Subtotal
)

SELECT 
    TERM_CODE,
    DEPARTMENT_NAME,
    course_count,
    avg_equivalent_subjects,
    SCHOOL_NAME,
    DEPARTMENT_PHONE_NUMBER
FROM 
    Subtotal

UNION ALL

SELECT 
    TERM_CODE,
    DEPARTMENT_NAME,
    course_count,
    avg_equivalent_subjects,
    SCHOOL_NAME,
    DEPARTMENT_PHONE_NUMBER
FROM 
    GrandTotal
ORDER BY 
    TERM_CODE, DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2833, 415
TOTAL                  : 265313, 238520, 26793
AVG                    : 2551.09, 2293.46, 257.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Calculate the total assignable and non-assignable area for each building by summing up the respective areas of all its floors. For each building, list the building name, building number, total assignable area, total non-assignable area, and total room count, sorted in descending order of the total assignable area.

(Hints: Schema Mapping Hints:
- 'building name' is related to FAC_BUILDING.BUILDING_NAME
- 'building number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'assignable area' is related to FAC_FLOOR.ASSIGNABLE_AREA
- 'non-assignable area' is related to FAC_FLOOR.NON_ASSIGNABLE_AREA
- 'room' is related to FAC_ROOMS.FAC_ROOM_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_FLOOR.BUILDING_KEY), (FAC_FLOOR.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_FLOOR.FLOOR = FAC_ROOMS.FLOOR))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RRwEyK9OP1VKvHwzkPWhhJeMcm', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    b.BUILDING_NAME AS building_name,\n    b.BUILDING_NUMBER AS building_number,\n    SUM(f.ASSIGNABLE_AREA) AS total_assignable_area,\n    SUM(f.NON_ASSIGNABLE_AREA) AS total_non_assignable_area,\n    COUNT(r.FAC_ROOM_KEY) AS total_room_count\nFROM \n    FAC_BUILDING b\nJOIN \n    FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY\nJOIN \n    FAC_ROOMS r ON f.BUILDING_KEY = r.BUILDING_KEY AND f.FLOOR = r.FLOOR\nGROUP BY \n    b.BUILDING_NAME, b.BUILDING_NUMBER\nORDER BY \n    total_assignable_area DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349901, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_a460d7e2b7', usage=CompletionUsage(completion_tokens=155, prompt_tokens=1961, total_tokens=2116, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=155, prompt_tokens=1961, total_tokens=2116, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    b.BUILDING_NAME AS building_name,
    b.BUILDING_NUMBER AS building_number,
    SUM(f.ASSIGNABLE_AREA) AS total_assignable_area,
    SUM(f.NON_ASSIGNABLE_AREA) AS total_non_assignable_area,
    COUNT(r.FAC_ROOM_KEY) AS total_room_count
FROM 
    FAC_BUILDING b
JOIN 
    FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY
JOIN 
    FAC_ROOMS r ON f.BUILDING_KEY = r.BUILDING_KEY AND f.FLOOR = r.FLOOR
GROUP BY 
    b.BUILDING_NAME, b.BUILDING_NUMBER
ORDER BY 
    total_assignable_area DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1961, 155
TOTAL                  : 267429, 240481, 26948
AVG                    : 2546.94, 2290.30, 256.65
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_MAJOR_USE
[
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE:VARCHAR2, Examples: ['BLDG SRV', 'CIRCULAT', 'CLASSRMS']),
(DESCRIPTION:VARCHAR2, Examples: ['BLDG SERVICE AREA', 'CIRCULATION AREA', 'CLASSROOMS']),
(ASSIGNABLE:VARCHAR2, Examples: ['0', '1']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List all rooms in building 45, including their full name, area, major use, the organization that occupies them, the count of rooms per major use, and the total area occupied by rooms for each organization.

(Hints: Schema Mapping Hints:
- 'building 45' is related to FAC_ROOMS.BUILDING_KEY
- 'full name' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'area' is related to FAC_ROOMS.AREA
- 'major use' is related to FAC_MAJOR_USE.MAJOR_USE
- 'organization' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY

Join Information: (FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RSokQogzJ1t9iyafKquzCOgDif', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    r.ROOM_FULL_NAME, \n    r.AREA, \n    mu.MAJOR_USE, \n    org.ORGANIZATION_NAME, \n    COUNT(r.FAC_ROOM_KEY) OVER(PARTITION BY mu.MAJOR_USE) AS ROOM_COUNT_PER_MAJOR_USE, \n    SUM(r.AREA) OVER(PARTITION BY org.ORGANIZATION_NAME) AS TOTAL_AREA_OCCUPIED \nFROM \n    FAC_ROOMS r\nJOIN \n    FAC_MAJOR_USE mu ON r.MAJOR_USE_KEY = mu.MAJOR_USE_KEY\nJOIN \n    FAC_ORGANIZATION org ON r.ORGANIZATION_KEY = org.ORGANIZATION_KEY\nWHERE \n    r.BUILDING_KEY = '45';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349902, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=146, prompt_tokens=1310, total_tokens=1456, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=146, prompt_tokens=1310, total_tokens=1456, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    r.ROOM_FULL_NAME, 
    r.AREA, 
    mu.MAJOR_USE, 
    org.ORGANIZATION_NAME, 
    COUNT(r.FAC_ROOM_KEY) OVER(PARTITION BY mu.MAJOR_USE) AS ROOM_COUNT_PER_MAJOR_USE, 
    SUM(r.AREA) OVER(PARTITION BY org.ORGANIZATION_NAME) AS TOTAL_AREA_OCCUPIED 
FROM 
    FAC_ROOMS r
JOIN 
    FAC_MAJOR_USE mu ON r.MAJOR_USE_KEY = mu.MAJOR_USE_KEY
JOIN 
    FAC_ORGANIZATION org ON r.ORGANIZATION_KEY = org.ORGANIZATION_KEY
WHERE 
    r.BUILDING_KEY = '45';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1310, 146
TOTAL                  : 268885, 241791, 27094
AVG                    : 2536.65, 2281.05, 255.60
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List the name, number, construction date, and type of all buildings, along with the count of addresses associated with each building, the average gross area of the buildings, and the total number of rooms in each building. Sort the results by building name.

(Hints: Schema Mapping Hints:
- 'name' is related to FAC_BUILDING.BUILDING_NAME
- 'number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'construction date' is related to FAC_BUILDING.DATE_BUILT
- 'type' is related to FAC_BUILDING.BUILDING_TYPE
- 'addresses' is related to FAC_BUILDING_ADDRESS.BUILDING_ADDRESS_KEY
- 'gross area' is related to FAC_BUILDING.EXT_GROSS_AREA
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RSEFHDmITxgqaOrRMidjySndte', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    b.BUILDING_NAME AS name,\n    b.BUILDING_NUMBER AS number,\n    b.DATE_BUILT AS construction_date,\n    b.BUILDING_TYPE AS type,\n    COUNT(a.BUILDING_ADDRESS_KEY) AS address_count,\n    AVG(CAST(b.EXT_GROSS_AREA AS FLOAT)) AS average_gross_area,\n    COUNT(r.FAC_ROOM_KEY) AS total_rooms\nFROM \n    FAC_BUILDING b\nLEFT JOIN \n    FAC_BUILDING_ADDRESS a ON b.FAC_BUILDING_KEY = a.BUILDING_KEY\nLEFT JOIN \n    FAC_ROOMS r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY\nGROUP BY \n    b.BUILDING_NAME, b.BUILDING_NUMBER, b.DATE_BUILT, b.BUILDING_TYPE\nORDER BY \n    b.BUILDING_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349902, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=176, prompt_tokens=1928, total_tokens=2104, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=176, prompt_tokens=1928, total_tokens=2104, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    b.BUILDING_NAME AS name,
    b.BUILDING_NUMBER AS number,
    b.DATE_BUILT AS construction_date,
    b.BUILDING_TYPE AS type,
    COUNT(a.BUILDING_ADDRESS_KEY) AS address_count,
    AVG(CAST(b.EXT_GROSS_AREA AS FLOAT)) AS average_gross_area,
    COUNT(r.FAC_ROOM_KEY) AS total_rooms
FROM 
    FAC_BUILDING b
LEFT JOIN 
    FAC_BUILDING_ADDRESS a ON b.FAC_BUILDING_KEY = a.BUILDING_KEY
LEFT JOIN 
    FAC_ROOMS r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY
GROUP BY 
    b.BUILDING_NAME, b.BUILDING_NUMBER, b.DATE_BUILT, b.BUILDING_TYPE
ORDER BY 
    b.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1928, 176
TOTAL                  : 270989, 243719, 27270
AVG                    : 2532.61, 2277.75, 254.86
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
From the 100 email lists with the most number of subscribers, list their names, their total number of subscribers, their public status, the name of the department with the most presence in the list, and the number of students from this department in the list.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subscribers' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'public status' is related to MOIRA_LIST.IS_PUBLIC
- 'department' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'students' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (SIS_DEPARTMENT.DEPARTMENT_CODE = MIT_STUDENT_DIRECTORY.DEPARTMENT))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RRCuvptU6S3VS1VqkbLlBZid6s', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT ml.MOIRA_LIST_NAME, \n       COUNT(mld.MOIRA_LIST_MEMBER) AS total_subscribers, \n       ml.IS_PUBLIC, \n       sd.DEPARTMENT_NAME, \n       COUNT(DISTINCT ms.FULL_NAME) AS student_count\nFROM MOIRA_LIST ml\nJOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN MIT_STUDENT_DIRECTORY ms ON mld.MOIRA_LIST_MEMBER_MIT_ID = ms.FULL_NAME\nJOIN SIS_DEPARTMENT sd ON ms.DEPARTMENT = sd.DEPARTMENT_CODE\nGROUP BY ml.MOIRA_LIST_NAME, ml.IS_PUBLIC, sd.DEPARTMENT_NAME\nORDER BY total_subscribers DESC\nLIMIT 100;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349901, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=160, prompt_tokens=1684, total_tokens=1844, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=160, prompt_tokens=1684, total_tokens=1844, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT ml.MOIRA_LIST_NAME, 
       COUNT(mld.MOIRA_LIST_MEMBER) AS total_subscribers, 
       ml.IS_PUBLIC, 
       sd.DEPARTMENT_NAME, 
       COUNT(DISTINCT ms.FULL_NAME) AS student_count
FROM MOIRA_LIST ml
JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN MIT_STUDENT_DIRECTORY ms ON mld.MOIRA_LIST_MEMBER_MIT_ID = ms.FULL_NAME
JOIN SIS_DEPARTMENT sd ON ms.DEPARTMENT = sd.DEPARTMENT_CODE
GROUP BY ml.MOIRA_LIST_NAME, ml.IS_PUBLIC, sd.DEPARTMENT_NAME
ORDER BY total_subscribers DESC
LIMIT 100;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1684, 160
TOTAL                  : 272833, 245403, 27430
AVG                    : 2526.23, 2272.25, 253.98
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course title, list the title, the total number of reserved materials, and the count of distinct material status associated with those materials, sorted by the total number of reserved materials in descending order.

(Hints: Schema Mapping Hints:
- 'title' is related to LIBRARY_SUBJECT_OFFERED.SUBJECT_TITLE
- 'reserved materials' is related to LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY
- 'material status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RUM81bom6TOwoQlisfbMseRwYG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    SO.SUBJECT_TITLE, \n    COUNT(RD.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials, \n    COUNT(DISTINCT M.LIBRARY_MATERIAL_STATUS) AS distinct_material_status_count\nFROM \n    LIBRARY_SUBJECT_OFFERED SO\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL RD ON SO.LIBRARY_SUBJECT_OFFERED_KEY = RD.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_MATERIAL_STATUS M ON RD.LIBRARY_MATERIAL_STATUS_KEY = M.LIBRARY_MATERIAL_STATUS_KEY\nGROUP BY \n    SO.SUBJECT_TITLE\nORDER BY \n    total_reserved_materials DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349904, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=146, prompt_tokens=1199, total_tokens=1345, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=146, prompt_tokens=1199, total_tokens=1345, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    SO.SUBJECT_TITLE, 
    COUNT(RD.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials, 
    COUNT(DISTINCT M.LIBRARY_MATERIAL_STATUS) AS distinct_material_status_count
FROM 
    LIBRARY_SUBJECT_OFFERED SO
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL RD ON SO.LIBRARY_SUBJECT_OFFERED_KEY = RD.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_MATERIAL_STATUS M ON RD.LIBRARY_MATERIAL_STATUS_KEY = M.LIBRARY_MATERIAL_STATUS_KEY
GROUP BY 
    SO.SUBJECT_TITLE
ORDER BY 
    total_reserved_materials DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1199, 146
TOTAL                  : 274178, 246602, 27576
AVG                    : 2515.39, 2262.40, 252.99
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
Group master courses by department. For each group, state the name of the department, the master course code, the number of subjects, the total new shelf price of associated TIP materials, and the number of unique TIP materials. Display the department and master course only if it differs from the previous entry. Include subtotals for each department and a grand total across all departments. All numerical values should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'name of the department' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'master course code' is related to TIP_SUBJECT_OFFERED.MASTER_COURSE_NUMBER
- 'subjects' is related to TIP_SUBJECT_OFFERED.SUBJECT_ID
- 'new shelf price' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'TIP materials' is related to TIP_MATERIAL.ISBN

Join Information: (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RN4OV5ZWAO6CcyEgBG41BBsQUW', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH MaterialTotals AS (\n    SELECT \n        so.OFFER_DEPT_NAME,\n        so.MASTER_COURSE_NUMBER,\n        COUNT(DISTINCT so.SUBJECT_ID) AS num_subjects,\n        SUM(COALESCE(tm.NEW_SHELF_PRICE, 0)) AS total_new_shelf_price,\n        COUNT(DISTINCT tm.ISBN) AS unique_materials\n    FROM \n        TIP_SUBJECT_OFFERED so\n    LEFT JOIN \n        TIP_DETAIL td ON so.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY\n    LEFT JOIN \n        TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY\n    GROUP BY \n        so.OFFER_DEPT_NAME, so.MASTER_COURSE_NUMBER\n),\nDepartmentTotals AS (\n    SELECT \n        OFFER_DEPT_NAME,\n        SUM(num_subjects) AS total_subjects,\n        SUM(total_new_shelf_price) AS total_new_shelf_price,\n        SUM(unique_materials) AS total_unique_materials\n    FROM \n        MaterialTotals\n    GROUP BY \n        OFFER_DEPT_NAME\n)\nSELECT \n    DISTINCT mt.OFFER_DEPT_NAME,\n    mt.MASTER_COURSE_NUMBER,\n    mt.num_subjects,\n    CAST(mt.total_new_shelf_price AS INTEGER) AS total_new_shelf_price,\n    mt.unique_materials\nFROM \n    MaterialTotals mt\nJOIN \n    DepartmentTotals dt ON mt.OFFER_DEPT_NAME = dt.OFFER_DEPT_NAME\nORDER BY \n    mt.OFFER_DEPT_NAME, mt.MASTER_COURSE_NUMBER;\n\nSELECT \n    NULL AS OFFER_DEPT_NAME,\n    NULL AS MASTER_COURSE_NUMBER,\n    dt.total_subjects AS total_subjects,\n    CAST(dt.total_new_shelf_price AS INTEGER) AS total_new_shelf_price,\n    dt.total_unique_materials AS total_unique_materials\nFROM \n    DepartmentTotals dt;\n\nSELECT \n    'Grand Total' AS OFFER_DEPT_NAME,\n    NULL AS MASTER_COURSE_NUMBER,\n    COUNT(DISTINCT mt.SUBJECT_ID) AS grand_total_subjects,\n    CAST(SUM(mt.total_new_shelf_price) AS INTEGER) AS grand_total_new_shelf_price,\n    COUNT(DISTINCT mt.ISBN) AS grand_total_unique_materials\nFROM \n    MaterialTotals mt;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349897, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=482, prompt_tokens=1470, total_tokens=1952, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=482, prompt_tokens=1470, total_tokens=1952, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH MaterialTotals AS (
    SELECT 
        so.OFFER_DEPT_NAME,
        so.MASTER_COURSE_NUMBER,
        COUNT(DISTINCT so.SUBJECT_ID) AS num_subjects,
        SUM(COALESCE(tm.NEW_SHELF_PRICE, 0)) AS total_new_shelf_price,
        COUNT(DISTINCT tm.ISBN) AS unique_materials
    FROM 
        TIP_SUBJECT_OFFERED so
    LEFT JOIN 
        TIP_DETAIL td ON so.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY
    LEFT JOIN 
        TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY
    GROUP BY 
        so.OFFER_DEPT_NAME, so.MASTER_COURSE_NUMBER
),
DepartmentTotals AS (
    SELECT 
        OFFER_DEPT_NAME,
        SUM(num_subjects) AS total_subjects,
        SUM(total_new_shelf_price) AS total_new_shelf_price,
        SUM(unique_materials) AS total_unique_materials
    FROM 
        MaterialTotals
    GROUP BY 
        OFFER_DEPT_NAME
)
SELECT 
    DISTINCT mt.OFFER_DEPT_NAME,
    mt.MASTER_COURSE_NUMBER,
    mt.num_subjects,
    CAST(mt.total_new_shelf_price AS INTEGER) AS total_new_shelf_price,
    mt.unique_materials
FROM 
    MaterialTotals mt
JOIN 
    DepartmentTotals dt ON mt.OFFER_DEPT_NAME = dt.OFFER_DEPT_NAME
ORDER BY 
    mt.OFFER_DEPT_NAME, mt.MASTER_COURSE_NUMBER;

SELECT 
    NULL AS OFFER_DEPT_NAME,
    NULL AS MASTER_COURSE_NUMBER,
    dt.total_subjects AS total_subjects,
    CAST(dt.total_new_shelf_price AS INTEGER) AS total_new_shelf_price,
    dt.total_unique_materials AS total_unique_materials
FROM 
    DepartmentTotals dt;

SELECT 
    'Grand Total' AS OFFER_DEPT_NAME,
    NULL AS MASTER_COURSE_NUMBER,
    COUNT(DISTINCT mt.SUBJECT_ID) AS grand_total_subjects,
    CAST(SUM(mt.total_new_shelf_price) AS INTEGER) AS grand_total_new_shelf_price,
    COUNT(DISTINCT mt.ISBN) AS grand_total_unique_materials
FROM 
    MaterialTotals mt;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1470, 482
TOTAL                  : 276130, 248072, 28058
AVG                    : 2510.27, 2255.20, 255.07
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each sponsor, list the sponsor name, the number of IAP sessions hosted, and the number of unique subjects organized.

(Hints: Schema Mapping Hints:
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'IAP sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'subjects' is related to IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RVd5NY9X4GCagExsLxyaC8rzt4', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    s.SPONSOR_NAME,\n    COUNT(DISTINCT ses.IAP_SUBJECT_SESSION_KEY) AS session_count,\n    COUNT(DISTINCT det.IAP_SUBJECT_CATEGORY_KEY) AS subject_count\nFROM \n    IAP_SUBJECT_SPONSOR s\nLEFT JOIN \n    IAP_SUBJECT_DETAIL det ON s.IAP_SUBJECT_SPONSOR_KEY = det.IAP_SUBJECT_SPONSOR_KEY\nLEFT JOIN \n    IAP_SUBJECT_SESSION ses ON det.IAP_SUBJECT_SESSION_KEY = ses.IAP_SUBJECT_SESSION_KEY\nGROUP BY \n    s.SPONSOR_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349905, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=127, prompt_tokens=1535, total_tokens=1662, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=127, prompt_tokens=1535, total_tokens=1662, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    s.SPONSOR_NAME,
    COUNT(DISTINCT ses.IAP_SUBJECT_SESSION_KEY) AS session_count,
    COUNT(DISTINCT det.IAP_SUBJECT_CATEGORY_KEY) AS subject_count
FROM 
    IAP_SUBJECT_SPONSOR s
LEFT JOIN 
    IAP_SUBJECT_DETAIL det ON s.IAP_SUBJECT_SPONSOR_KEY = det.IAP_SUBJECT_SPONSOR_KEY
LEFT JOIN 
    IAP_SUBJECT_SESSION ses ON det.IAP_SUBJECT_SESSION_KEY = ses.IAP_SUBJECT_SESSION_KEY
GROUP BY 
    s.SPONSOR_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1535, 127
TOTAL                  : 277792, 249607, 28185
AVG                    : 2502.63, 2248.71, 253.92
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each IAP category, list the category name, the sponsor name, the number of activities offered, and the average fee per activity, sorted by the number of activities in descending order.

(Hints: Schema Mapping Hints:
- 'category name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'activities' is related to IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RUaKd1nYjVgHWIX2G3NOVmsXc5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    isc.IAP_CATEGORY_NAME,\n    iss.SPONSOR_NAME,\n    COUNT(isd.ACTIVITY_TITLE) AS number_of_activities,\n    AVG(isd.FEE) AS average_fee_per_activity\nFROM \n    IAP_SUBJECT_CATEGORY isc\nJOIN \n    IAP_SUBJECT_DETAIL isd ON isc.IAP_SUBJECT_CATEGORY_KEY = isd.IAP_SUBJECT_CATEGORY_KEY\nJOIN \n    IAP_SUBJECT_SPONSOR iss ON isd.IAP_SUBJECT_SPONSOR_KEY = iss.IAP_SUBJECT_SPONSOR_KEY\nGROUP BY \n    isc.IAP_CATEGORY_NAME, iss.SPONSOR_NAME\nORDER BY \n    number_of_activities DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349904, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=144, prompt_tokens=1424, total_tokens=1568, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=144, prompt_tokens=1424, total_tokens=1568, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    isc.IAP_CATEGORY_NAME,
    iss.SPONSOR_NAME,
    COUNT(isd.ACTIVITY_TITLE) AS number_of_activities,
    AVG(isd.FEE) AS average_fee_per_activity
FROM 
    IAP_SUBJECT_CATEGORY isc
JOIN 
    IAP_SUBJECT_DETAIL isd ON isc.IAP_SUBJECT_CATEGORY_KEY = isd.IAP_SUBJECT_CATEGORY_KEY
JOIN 
    IAP_SUBJECT_SPONSOR iss ON isd.IAP_SUBJECT_SPONSOR_KEY = iss.IAP_SUBJECT_SPONSOR_KEY
GROUP BY 
    isc.IAP_CATEGORY_NAME, iss.SPONSOR_NAME
ORDER BY 
    number_of_activities DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1424, 144
TOTAL                  : 279360, 251031, 28329
AVG                    : 2494.29, 2241.35, 252.94
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each department, list its name, number of unique courses offered, the number of unique reserved materials, and the number of unique instructors associated with those courses, sorted by the number of unique courses offered in descending order.

(Hints: Schema Mapping Hints:
- 'name' is related to LIBRARY_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'course' is related to LIBRARY_SUBJECT_OFFERED.MASTER_COURSE_NUMBER
- 'reserved materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_TITLE
- 'instructors' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME

Join Information: (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RSO4MoYM8ZZbCpjvWGRIllH0E6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    so.OFFER_DEPT_NAME AS department_name,\n    COUNT(DISTINCT so.MASTER_COURSE_NUMBER) AS unique_courses,\n    COUNT(DISTINCT rc.CATALOG_TITLE) AS unique_reserved_materials,\n    COUNT(DISTINCT ci.INSTRUCTOR_NAME) AS unique_instructors\nFROM \n    LIBRARY_SUBJECT_OFFERED so\nLEFT JOIN \n    LIBRARY_RESERVE_MATRL_DETAIL rmd ON so.LIBRARY_SUBJECT_OFFERED_KEY = rmd.LIBRARY_SUBJECT_OFFERED_KEY\nLEFT JOIN \n    LIBRARY_RESERVE_CATALOG rc ON rmd.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY\nLEFT JOIN \n    LIBRARY_COURSE_INSTRUCTOR ci ON rmd.LIBRARY_COURSE_INSTRUCTOR_KEY = ci.LIBRARY_COURSE_INSTRUCTOR_KEY\nGROUP BY \n    so.OFFER_DEPT_NAME\nORDER BY \n    unique_courses DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349902, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=203, prompt_tokens=1872, total_tokens=2075, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=203, prompt_tokens=1872, total_tokens=2075, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    so.OFFER_DEPT_NAME AS department_name,
    COUNT(DISTINCT so.MASTER_COURSE_NUMBER) AS unique_courses,
    COUNT(DISTINCT rc.CATALOG_TITLE) AS unique_reserved_materials,
    COUNT(DISTINCT ci.INSTRUCTOR_NAME) AS unique_instructors
FROM 
    LIBRARY_SUBJECT_OFFERED so
LEFT JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL rmd ON so.LIBRARY_SUBJECT_OFFERED_KEY = rmd.LIBRARY_SUBJECT_OFFERED_KEY
LEFT JOIN 
    LIBRARY_RESERVE_CATALOG rc ON rmd.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY
LEFT JOIN 
    LIBRARY_COURSE_INSTRUCTOR ci ON rmd.LIBRARY_COURSE_INSTRUCTOR_KEY = ci.LIBRARY_COURSE_INSTRUCTOR_KEY
GROUP BY 
    so.OFFER_DEPT_NAME
ORDER BY 
    unique_courses DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1872, 203
TOTAL                  : 281435, 252903, 28532
AVG                    : 2490.58, 2238.08, 252.50
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]

### Question ###
For each publication year, list the year, the total number of reserved materials, the average length of their titles, distinct number of status, and number of courses, sorted by publication year in descending order.

(Hints: Schema Mapping Hints:
- 'publication year' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'reserved materials' is related to LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY
- 'title' is related to LIBRARY_RESERVE_CATALOG.CATALOG_TITLE
- 'status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'courses' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME

Join Information: (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RU3PwWYj4x0KSlwNH0p9NtmEiB', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    CATALOG_YEAR,\n    COUNT(DISTINCT R.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials,\n    AVG(LENGTH(R.CATALOG_TITLE)) AS average_title_length,\n    COUNT(DISTINCT M.LIBRARY_MATERIAL_STATUS) AS distinct_status_count,\n    COUNT(DISTINCT I.COURSE_NAME) AS total_courses\nFROM \n    LIBRARY_RESERVE_CATALOG R\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL D ON R.LIBRARY_RESERVE_CATALOG_KEY = D.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_MATERIAL_STATUS M ON D.LIBRARY_MATERIAL_STATUS_KEY = M.LIBRARY_MATERIAL_STATUS_KEY\nJOIN \n    LIBRARY_COURSE_INSTRUCTOR I ON D.LIBRARY_COURSE_INSTRUCTOR_KEY = I.LIBRARY_COURSE_INSTRUCTOR_KEY\nGROUP BY \n    CATALOG_YEAR\nORDER BY \n    CATALOG_YEAR DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349904, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=202, prompt_tokens=1429, total_tokens=1631, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=202, prompt_tokens=1429, total_tokens=1631, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    CATALOG_YEAR,
    COUNT(DISTINCT R.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials,
    AVG(LENGTH(R.CATALOG_TITLE)) AS average_title_length,
    COUNT(DISTINCT M.LIBRARY_MATERIAL_STATUS) AS distinct_status_count,
    COUNT(DISTINCT I.COURSE_NAME) AS total_courses
FROM 
    LIBRARY_RESERVE_CATALOG R
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL D ON R.LIBRARY_RESERVE_CATALOG_KEY = D.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_MATERIAL_STATUS M ON D.LIBRARY_MATERIAL_STATUS_KEY = M.LIBRARY_MATERIAL_STATUS_KEY
JOIN 
    LIBRARY_COURSE_INSTRUCTOR I ON D.LIBRARY_COURSE_INSTRUCTOR_KEY = I.LIBRARY_COURSE_INSTRUCTOR_KEY
GROUP BY 
    CATALOG_YEAR
ORDER BY 
    CATALOG_YEAR DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1429, 202
TOTAL                  : 283066, 254332, 28734
AVG                    : 2483.04, 2230.98, 252.05
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]

### Question ###
For each instructor, list their name, the number of unique courses they teach, the total number of material assignments, average publication year, and number of distinct status, sorted by the number of unique courses in descending order.

(Hints: Schema Mapping Hints:
- 'name' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'course' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME
- 'material assignments' is related to LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY
- 'publication year' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS

Join Information: (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RUp8O6cjm1OZjDzPwV3nNXKwaL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    lci.INSTRUCTOR_NAME,\n    COUNT(DISTINCT lci.COURSE_NAME) AS unique_courses,\n    COUNT(lrm.LIBRARY_RESERVE_CATALOG_KEY) AS total_material_assignments,\n    AVG(CAST(lrc.CATALOG_YEAR AS INTEGER)) AS average_publication_year,\n    COUNT(DISTINCT lms.LIBRARY_MATERIAL_STATUS_KEY) AS distinct_status_count\nFROM \n    LIBRARY_COURSE_INSTRUCTOR lci\nLEFT JOIN \n    LIBRARY_RESERVE_MATRL_DETAIL lrm ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrm.LIBRARY_COURSE_INSTRUCTOR_KEY\nLEFT JOIN \n    LIBRARY_RESERVE_CATALOG lrc ON lrm.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY\nLEFT JOIN \n    LIBRARY_MATERIAL_STATUS lms ON lrm.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY\nGROUP BY \n    lci.INSTRUCTOR_NAME\nORDER BY \n    unique_courses DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349904, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=223, prompt_tokens=1435, total_tokens=1658, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=223, prompt_tokens=1435, total_tokens=1658, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    lci.INSTRUCTOR_NAME,
    COUNT(DISTINCT lci.COURSE_NAME) AS unique_courses,
    COUNT(lrm.LIBRARY_RESERVE_CATALOG_KEY) AS total_material_assignments,
    AVG(CAST(lrc.CATALOG_YEAR AS INTEGER)) AS average_publication_year,
    COUNT(DISTINCT lms.LIBRARY_MATERIAL_STATUS_KEY) AS distinct_status_count
FROM 
    LIBRARY_COURSE_INSTRUCTOR lci
LEFT JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL lrm ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrm.LIBRARY_COURSE_INSTRUCTOR_KEY
LEFT JOIN 
    LIBRARY_RESERVE_CATALOG lrc ON lrm.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY
LEFT JOIN 
    LIBRARY_MATERIAL_STATUS lms ON lrm.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY
GROUP BY 
    lci.INSTRUCTOR_NAME
ORDER BY 
    unique_courses DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1435, 223
TOTAL                  : 284724, 255767, 28957
AVG                    : 2475.86, 2224.06, 251.80
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_PERSON
[
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(PERSON_ROLE:VARCHAR2, Examples: ['Activity leader', 'Session leader', 'Contact person']),
(PERSON_MIT_AFFILIATION:VARCHAR2, Examples: ['Staff', 'Senior Lecturer', 'Other MIT']),
(PERSON_NAME:VARCHAR2, Examples: ['Willie Hewitt', 'Junaid Ochoa', 'Rufus Armstrong']),
(PERSON_LOCATION:VARCHAR2, Examples: ['Register for Zoom ID', 'NE48', 'E15-413']),
(PERSON_EMAIL:VARCHAR2, Examples: ['anac@worker.com', 'ec@worker.com', 'pv@worker.com']),
(PERSON_ORGANIZATION:VARCHAR2),
(PERSON_TITLE:VARCHAR2),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each person role and IAP category, list the role, the category name, the number of people in this role, and the average fee, sorted by the role count in descending order.

(Hints: Schema Mapping Hints:
- 'role' is related to IAP_SUBJECT_PERSON.PERSON_ROLE
- 'category name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'people' is related to IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE

Join Information: (IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_PERSON_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RVHzV5Bd4NXXPEKClyIN0UKmxo', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    sp.PERSON_ROLE, \n    sc.IAP_CATEGORY_NAME, \n    COUNT(sp.IAP_SUBJECT_PERSON_KEY) AS number_of_people, \n    AVG(sd.FEE) AS average_fee\nFROM \n    IAP_SUBJECT_PERSON sp\nJOIN \n    IAP_SUBJECT_DETAIL sd ON sp.IAP_SUBJECT_PERSON_KEY = sd.IAP_SUBJECT_PERSON_KEY\nJOIN \n    IAP_SUBJECT_CATEGORY sc ON sd.IAP_SUBJECT_CATEGORY_KEY = sc.IAP_SUBJECT_CATEGORY_KEY\nGROUP BY \n    sp.PERSON_ROLE, sc.IAP_CATEGORY_NAME\nORDER BY \n    number_of_people DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349905, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=135, prompt_tokens=1500, total_tokens=1635, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=135, prompt_tokens=1500, total_tokens=1635, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sp.PERSON_ROLE, 
    sc.IAP_CATEGORY_NAME, 
    COUNT(sp.IAP_SUBJECT_PERSON_KEY) AS number_of_people, 
    AVG(sd.FEE) AS average_fee
FROM 
    IAP_SUBJECT_PERSON sp
JOIN 
    IAP_SUBJECT_DETAIL sd ON sp.IAP_SUBJECT_PERSON_KEY = sd.IAP_SUBJECT_PERSON_KEY
JOIN 
    IAP_SUBJECT_CATEGORY sc ON sd.IAP_SUBJECT_CATEGORY_KEY = sc.IAP_SUBJECT_CATEGORY_KEY
GROUP BY 
    sp.PERSON_ROLE, sc.IAP_CATEGORY_NAME
ORDER BY 
    number_of_people DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1500, 135
TOTAL                  : 286359, 257267, 29092
AVG                    : 2468.61, 2217.82, 250.79
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]

### Question ###
For subjects offered in the summer term, list the subject titles, number of instructors, and the length of the longest instructor name.

(Hints: Schema Mapping Hints:
- 'summer term' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'subject titles' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'instructors' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'instructor name' is related to EMPLOYEE_DIRECTORY.FULL_NAME

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RXaoKWrTr23c3EG44hALgvXBAc', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    CCSO.SUBJECT_TITLE,\n    COUNT(ED.FULL_NAME) AS Number_of_Instructors,\n    MAX(LENGTH(ED.FULL_NAME)) AS Length_of_Longest_Instructor_Name\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED CCSO\nJOIN \n    EMPLOYEE_DIRECTORY ED ON CCSO.RESPONSIBLE_FACULTY_MIT_ID = ED.MIT_ID\nJOIN \n    ACADEMIC_TERMS_ALL ATA ON CCSO.TERM_CODE = ATA.TERM_CODE\nWHERE \n    ATA.TERM_CODE LIKE '%SU' \nGROUP BY \n    CCSO.SUBJECT_TITLE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349907, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=131, prompt_tokens=3412, total_tokens=3543, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3200)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=131, prompt_tokens=3412, total_tokens=3543, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3200))

***** FINAL SQL QUERY *****
SELECT 
    CCSO.SUBJECT_TITLE,
    COUNT(ED.FULL_NAME) AS Number_of_Instructors,
    MAX(LENGTH(ED.FULL_NAME)) AS Length_of_Longest_Instructor_Name
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED CCSO
JOIN 
    EMPLOYEE_DIRECTORY ED ON CCSO.RESPONSIBLE_FACULTY_MIT_ID = ED.MIT_ID
JOIN 
    ACADEMIC_TERMS_ALL ATA ON CCSO.TERM_CODE = ATA.TERM_CODE
WHERE 
    ATA.TERM_CODE LIKE '%SU' 
GROUP BY 
    CCSO.SUBJECT_TITLE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3412, 131
TOTAL                  : 289902, 260679, 29223
AVG                    : 2477.79, 2228.03, 249.77
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List the names of the buildings with the most floors. If there are ties, list each one separately.

(Hints: Schema Mapping Hints:
- 'name of the buildings' is related to FAC_BUILDING.BUILDING_NAME
- 'floors' is related to FAC_FLOOR.LEVEL_ID

Join Information: (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RWg4SJMlIbXIrIJSHg4cZonN7W', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT fb.BUILDING_NAME\nFROM FAC_BUILDING fb\nJOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY\nJOIN FAC_FLOOR ff ON fr.FLOOR_KEY = ff.FLOOR_KEY\nGROUP BY fb.BUILDING_NAME\nHAVING COUNT(DISTINCT ff.FLOOR) = (\n    SELECT MAX(floor_count)\n    FROM (\n        SELECT COUNT(DISTINCT ff2.FLOOR) AS floor_count\n        FROM FAC_BUILDING fb2\n        JOIN FAC_ROOMS fr2 ON fb2.FAC_BUILDING_KEY = fr2.BUILDING_KEY\n        JOIN FAC_FLOOR ff2 ON fr2.FLOOR_KEY = ff2.FLOOR_KEY\n        GROUP BY fb2.BUILDING_NAME\n    ) AS subquery\n);\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349906, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=173, prompt_tokens=1847, total_tokens=2020, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=173, prompt_tokens=1847, total_tokens=2020, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT fb.BUILDING_NAME
FROM FAC_BUILDING fb
JOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY
JOIN FAC_FLOOR ff ON fr.FLOOR_KEY = ff.FLOOR_KEY
GROUP BY fb.BUILDING_NAME
HAVING COUNT(DISTINCT ff.FLOOR) = (
    SELECT MAX(floor_count)
    FROM (
        SELECT COUNT(DISTINCT ff2.FLOOR) AS floor_count
        FROM FAC_BUILDING fb2
        JOIN FAC_ROOMS fr2 ON fb2.FAC_BUILDING_KEY = fr2.BUILDING_KEY
        JOIN FAC_FLOOR ff2 ON fr2.FLOOR_KEY = ff2.FLOOR_KEY
        GROUP BY fb2.BUILDING_NAME
    ) AS subquery
);

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1847, 173
TOTAL                  : 291922, 262526, 29396
AVG                    : 2473.92, 2224.80, 249.12
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the mailing list with owner key LIST69.377-keeper-xenon, list the owner, total number of mailing lists, and total number of members across all these mailing lists.

(Hints: Schema Mapping Hints:
- 'owner key' is related to MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'mailing lists' is related to MOIRA_LIST.MOIRA_LIST_KEY
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RXqsOaTXACrvsyWnKWDiZemwDo', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    o.OWNER, \n    COUNT(DISTINCT l.MOIRA_LIST_KEY) AS total_mailing_lists, \n    COUNT(d.MOIRA_LIST_MEMBER) AS total_members\nFROM \n    MOIRA_LIST_OWNER o\nJOIN \n    MOIRA_LIST l ON o.MOIRA_LIST_OWNER_KEY = l.MOIRA_LIST_KEY\nJOIN \n    MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY\nWHERE \n    o.MOIRA_LIST_OWNER_KEY = 'LIST69.377-keeper-xenon'\nGROUP BY \n    o.OWNER;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349907, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=129, prompt_tokens=827, total_tokens=956, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=129, prompt_tokens=827, total_tokens=956, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    o.OWNER, 
    COUNT(DISTINCT l.MOIRA_LIST_KEY) AS total_mailing_lists, 
    COUNT(d.MOIRA_LIST_MEMBER) AS total_members
FROM 
    MOIRA_LIST_OWNER o
JOIN 
    MOIRA_LIST l ON o.MOIRA_LIST_OWNER_KEY = l.MOIRA_LIST_KEY
JOIN 
    MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY
WHERE 
    o.MOIRA_LIST_OWNER_KEY = 'LIST69.377-keeper-xenon'
GROUP BY 
    o.OWNER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 827, 129
TOTAL                  : 292878, 263353, 29525
AVG                    : 2461.16, 2213.05, 248.11
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each department, list the department name, department phone number, number of students, and the length of the longest student full name in that department.

(Hints: Schema Mapping Hints:
- 'department name' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'department phone number' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'students' is related to MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS
- 'student full name' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RXOGTMXPZ51xhjl4xkM6CNRvef', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    SD.DEPARTMENT_NAME, \n    SAD.DEPARTMENT_PHONE_NUMBER, \n    COUNT(MSD.EMAIL_ADDRESS) AS number_of_students, \n    MAX(LENGTH(MSD.FULL_NAME)) AS longest_student_full_name_length\nFROM \n    SIS_DEPARTMENT SD\nJOIN \n    SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE\nLEFT JOIN \n    MIT_STUDENT_DIRECTORY MSD ON MSD.DEPARTMENT = SD.DEPARTMENT_CODE\nGROUP BY \n    SD.DEPARTMENT_NAME, \n    SAD.DEPARTMENT_PHONE_NUMBER;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349907, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_11f3029f6b', usage=CompletionUsage(completion_tokens=131, prompt_tokens=1136, total_tokens=1267, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=131, prompt_tokens=1136, total_tokens=1267, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    SD.DEPARTMENT_NAME, 
    SAD.DEPARTMENT_PHONE_NUMBER, 
    COUNT(MSD.EMAIL_ADDRESS) AS number_of_students, 
    MAX(LENGTH(MSD.FULL_NAME)) AS longest_student_full_name_length
FROM 
    SIS_DEPARTMENT SD
JOIN 
    SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE
LEFT JOIN 
    MIT_STUDENT_DIRECTORY MSD ON MSD.DEPARTMENT = SD.DEPARTMENT_CODE
GROUP BY 
    SD.DEPARTMENT_NAME, 
    SAD.DEPARTMENT_PHONE_NUMBER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1136, 131
TOTAL                  : 294145, 264489, 29656
AVG                    : 2451.21, 2204.07, 247.13
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each school, list the school name, total number of courses that appear in SIS subject code catalog, and the total number of degree-granting courses that appear in SIS subject code catalog.

(Hints: Schema Mapping Hints:
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'courses' is related to SIS_COURSE_DESCRIPTION.COURSE
- 'degree-granting courses' is related to SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING

Join Information: (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_COURSE_DESCRIPTION.COURSE = SIS_SUBJECT_CODE.COURSE_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Cl8RXHBed2Bzo4NhpnHQUUUOystqa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    sd.SCHOOL_NAME,\n    COUNT(DISTINCT sc.COURSE) AS total_courses,\n    COUNT(DISTINCT CASE WHEN scd.IS_DEGREE_GRANTING = 'Y' THEN sc.COURSE END) AS total_degree_granting_courses\nFROM \n    SIS_DEPARTMENT sd\nJOIN \n    SIS_COURSE_DESCRIPTION scd ON sd.DEPARTMENT_CODE = scd.DEPARTMENT\nJOIN \n    SIS_SUBJECT_CODE sc ON scd.COURSE = sc.COURSE_NUMBER\nGROUP BY \n    sd.SCHOOL_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1765349907, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_a460d7e2b7', usage=CompletionUsage(completion_tokens=124, prompt_tokens=1400, total_tokens=1524, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=124, prompt_tokens=1400, total_tokens=1524, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sd.SCHOOL_NAME,
    COUNT(DISTINCT sc.COURSE) AS total_courses,
    COUNT(DISTINCT CASE WHEN scd.IS_DEGREE_GRANTING = 'Y' THEN sc.COURSE END) AS total_degree_granting_courses
FROM 
    SIS_DEPARTMENT sd
JOIN 
    SIS_COURSE_DESCRIPTION scd ON sd.DEPARTMENT_CODE = scd.DEPARTMENT
JOIN 
    SIS_SUBJECT_CODE sc ON scd.COURSE = sc.COURSE_NUMBER
GROUP BY 
    sd.SCHOOL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1400, 124
TOTAL                  : 295669, 265889, 29780
AVG                    : 2443.55, 2197.43, 246.12
******************************************************************************************************************************************************
******************************************************************************************************************************************************

