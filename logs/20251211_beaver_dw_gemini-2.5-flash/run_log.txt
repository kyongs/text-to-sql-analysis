--- Log Session Started at 2025-12-11 13:36:14 ---

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_PERSON
[
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(PERSON_ROLE:VARCHAR2, Examples: ['Activity leader', 'Session leader', 'Contact person']),
(PERSON_MIT_AFFILIATION:VARCHAR2, Examples: ['Staff', 'Senior Lecturer', 'Other MIT']),
(PERSON_NAME:VARCHAR2, Examples: ['Willie Hewitt', 'Junaid Ochoa', 'Rufus Armstrong']),
(PERSON_LOCATION:VARCHAR2, Examples: ['Register for Zoom ID', 'NE48', 'E15-413']),
(PERSON_EMAIL:VARCHAR2, Examples: ['anac@worker.com', 'ec@worker.com', 'pv@worker.com']),
(PERSON_ORGANIZATION:VARCHAR2),
(PERSON_TITLE:VARCHAR2),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Show the unique activity titles, locations, term start date, and supervisor name for all independent activities, sorted by the ascending order of start date.

(Hints: Schema Mapping Hints:
- 'activity titles' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'locations' is related to IAP_SUBJECT_SESSION.SESSION_LOCATION
- 'term start date' is related to ACADEMIC_TERMS_ALL.TERM_START_DATE
- 'supervisor name' is related to IAP_SUBJECT_PERSON.PERSON_NAME, IAP_SUBJECT_PERSON.PERSON_ROLE

Join Information: (IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_PERSON_KEY), (ACADEMIC_TERMS_ALL.TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF4DFF0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4E020>

***** FINAL SQL QUERY *****
SELECT DISTINCT
  T1.ACTIVITY_TITLE,
  T3.SESSION_LOCATION,
  T2.TERM_START_DATE,
  T4.PERSON_NAME
FROM IAP_SUBJECT_DETAIL AS T1
INNER JOIN ACADEMIC_TERMS_ALL AS T2
  ON T1.TERM_CODE = T2.TERM_CODE
INNER JOIN IAP_SUBJECT_SESSION AS T3
  ON T1.IAP_SUBJECT_SESSION_KEY = T3.IAP_SUBJECT_SESSION_KEY
INNER JOIN IAP_SUBJECT_PERSON AS T4
  ON T1.IAP_SUBJECT_PERSON_KEY = T4.IAP_SUBJECT_PERSON_KEY
WHERE
  T4.PERSON_ROLE = 'Activity leader' AND T1.IS_MULTIPLE_SESSION = 'N'
ORDER BY
  T2.TERM_START_DATE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2855, 205
TOTAL                  : 3060, 2855, 205
AVG                    : 3060.00, 2855.00, 205.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What are the subject titles, their material titles, ISBN numbers, new shelf prices, and total costs of new materials for each subject title, sorted by individual item prices in ascending order?

(Hints: Schema Mapping Hints:
- 'subject titles' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE
- 'material titles' is related to TIP_MATERIAL.TITLE
- 'ISBN numbers' is related to TIP_MATERIAL.ISBN
- 'new shelf prices' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'cost of new materials' is related to TIP_MATERIAL.NEW_SHELF_PRICE

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_SUBJECT_OFFERED.SUBJECT_ID = TIP_DETAIL.SUBJECT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEF010>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DDE0>

***** FINAL SQL QUERY *****
SELECT
  T1.SUBJECT_TITLE,
  T2.TITLE,
  T2.ISBN,
  T2.NEW_SHELF_PRICE,
  SUM(T2.NEW_SHELF_PRICE) OVER (PARTITION BY T1.SUBJECT_TITLE) AS total_new_material_cost
FROM TIP_SUBJECT_OFFERED AS T1
JOIN TIP_DETAIL AS T3
  ON T1.SUBJECT_ID = T3.SUBJECT_ID
JOIN TIP_MATERIAL AS T2
  ON T3.TIP_MATERIAL_KEY = T2.TIP_MATERIAL_KEY
ORDER BY
  T2.NEW_SHELF_PRICE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1679, 155
TOTAL                  : 4894, 4534, 360
AVG                    : 2447.00, 2267.00, 180.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FCLT_BUILDING_HIST
[
(FCLT_BUILDING_HIST_KEY:VARCHAR2, Examples: ['14S-201505', '46-201505', 'E14-201505']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['201505', '201506', '201507']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['14S', '46', 'E14']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['14', 'W61', 'W70']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY', 'MACGREGOR HOUSE', 'NEW HOUSE']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library', 'Frank S MacGregor House', 'New West Campus Houses']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library (South Wing)', 'Brain & Cognitive Sciences Complex', 'Building E14']),
(EXT_GROSS_AREA:NUMBER, Examples: [48622.2, 418663.0, 173875.0]),
(ASSIGNABLE_AREA:NUMBER, Examples: [34500.5, 218519.0, 73792.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [10286.5, 152699.0, 83752.7]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHWEST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['(NULL)', 'UGBA3', 'UGBI2']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['136.4', '82.8', '88.3']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3623, 42.3605, 42.3615]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0916, -71.0873, -71.0879]),
(EASTING_X_SPCS:NUMBER, Examples: [766530.0, 767698.0, 767547.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2957330.0, 2956650.0, 2957020.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['14S', '46', 'E14']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['SEELY G. MUDD', 'HORACE SAYFORD FORD JR.', 'SEBASTIAN S. KRESGE']),
(BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY (S)', 'BCSC', 'BUILDING E14']),
(DATE_BUILT:VARCHAR2, Examples: ['04/25/2003', '12/31/1932', '12/31/1920']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['05/01/1961', '12/31/1955', '12/31/1939']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['09/01/2005', '03/06/1975', '10/01/1964']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-DEC-14', '01-JAN-15', '01-FEB-15']),
(NUM_OF_ROOMS:NUMBER, Examples: [118, 1403, 341])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the long names of buildings constructed before 1950 that have more than 100 employees, the built year of the building, and number of employees.

(Hints: Schema Mapping Hints:
- 'long names of buildings' is related to FCLT_BUILDING_HIST.BUILDING_NAME_LONG
- 'built year' is related to FCLT_BUILDING_HIST.DATE_BUILT
- 'employees' is related to EMPLOYEE_DIRECTORY.MIT_ID

Join Information: (EMPLOYEE_DIRECTORY.OFFICE_LOCATION = FCLT_ROOMS.BUILDING_ROOM))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF4DEA0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DED0>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NAME_LONG,
  SUBSTRING(T1.DATE_BUILT, 7, 4) AS built_year,
  COUNT(T3.MIT_ID) AS num_employees
FROM FCLT_BUILDING_HIST AS T1
INNER JOIN FCLT_ROOMS AS T2
  ON T1.FCLT_BUILDING_KEY = T2.FCLT_BUILDING_KEY
INNER JOIN EMPLOYEE_DIRECTORY AS T3
  ON T2.BUILDING_ROOM = T3.OFFICE_LOCATION
WHERE
  CAST(SUBSTRING(T1.DATE_BUILT, 7, 4) AS UNSIGNED) < 1950
GROUP BY
  T1.BUILDING_NAME_LONG,
  built_year
HAVING
  COUNT(T3.MIT_ID) > 100;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2774, 208
TOTAL                  : 7876, 7308, 568
AVG                    : 2625.33, 2436.00, 189.33
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]

### Question ###
List the name and floor of the building with the largest floor number.

(Hints: Schema Mapping Hints:
- 'name' is related to FAC_BUILDING.BUILDING_NAME
- 'floor' is related to FAC_FLOOR.FLOOR

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_FLOOR.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6F940>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DF00>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NAME,
  T2.FLOOR
FROM FAC_BUILDING AS T1
JOIN FAC_FLOOR AS T2
  ON T1.FAC_BUILDING_KEY = T2.BUILDING_KEY
ORDER BY
  CAST(T2.FLOOR AS UNSIGNED) DESC
LIMIT 1;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1648, 82
TOTAL                  : 9606, 8956, 650
AVG                    : 2401.50, 2239.00, 162.50
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORG_DLC_KEY
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MASTER_DEPT_HIERARCHY
[
(HIERARCHY_TYPE:VARCHAR2, Examples: ['Standard Hierarchy']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_CODE:VARCHAR2, Examples: ['D_DOF_CORE', 'D_DOF_RESERVE', 'D_DOF_RESIDENCE']),
(DLC_NAME:VARCHAR2, Examples: ['Facilities Building Core (hallways, stairs, etc.)', 'Facilities Provost Reserved', 'Facilities Residences']),
(MASTER_DEPT_HIER_LEVEL_1_CODE:VARCHAR2, Examples: ['D_ALL']),
(MASTER_DEPT_HIER_LEVEL_1_NAME:VARCHAR2, Examples: ['All Departments']),
(MASTER_DEPT_HIER_LEVEL_2_CODE:VARCHAR2, Examples: ['D_EXECVP_AREA', 'D_PROVOST_AREA', 'D_PRES_AREA']),
(MASTER_DEPT_HIER_LEVEL_2_NAME:VARCHAR2, Examples: ['Executive Vice President's Area', 'Provost Area', 'President's area']),
(MASTER_DEPT_HIER_LEVEL_3_CODE:VARCHAR2, Examples: ['D_FINANCE_AREA', 'D_TREAS_AREA', 'D_SC_ENVP']),
(MASTER_DEPT_HIER_LEVEL_3_NAME:VARCHAR2, Examples: ['VP Finance Area', 'Treasurer's Area', 'Senior Council and Environmental Programs']),
(MASTER_DEPT_HIER_LEVEL_4_CODE:VARCHAR2, Examples: ['D_SOURCING_AREA', 'D_OSATT_AREA']),
(MASTER_DEPT_HIER_LEVEL_4_NAME:VARCHAR2, Examples: ['Sourcing Area', 'Office of Strategic Alliances & Tech Transfer Area']),
(MASTER_DEPT_HIER_LEVEL_5_CODE:VARCHAR2),
(MASTER_DEPT_HIER_LEVEL_5_NAME:VARCHAR2)
]

### Question ###
What is the current building key, building street address, city, state, and postal code of the history department?

(Hints: Schema Mapping Hints:
- 'building key' is related to FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FCLT_BUILDING_ADDRESS.CITY
- 'state' is related to FCLT_BUILDING_ADDRESS.STATE
- 'postal code' is related to FCLT_BUILDING_ADDRESS.POSTAL_CODE
- 'history department' is related to MASTER_DEPT_HIERARCHY.DLC_NAME

Join Information: (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORG_DLC_KEY.FCLT_ORGANIZATION_KEY), (FCLT_ORG_DLC_KEY.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY), (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEF6A0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEF490>

***** FINAL SQL QUERY *****
SELECT DISTINCT
  B.BUILDING_KEY,
  B.BUILDING_STREET_ADDRESS,
  FBA.CITY,
  FBA.STATE,
  FBA.POSTAL_CODE
FROM MASTER_DEPT_HIERARCHY AS MDH
JOIN FCLT_ORG_DLC_KEY AS FODK
  ON MDH.DLC_KEY = FODK.DLC_KEY
JOIN FCLT_ROOMS AS FR
  ON FODK.FCLT_ORGANIZATION_KEY = FR.FCLT_ORGANIZATION_KEY
JOIN FCLT_BUILDING_ADDRESS AS FBA
  ON FR.FCLT_BUILDING_KEY = FBA.FCLT_BUILDING_KEY
JOIN BUILDINGS AS B
  ON FR.FCLT_BUILDING_KEY = B.BUILDING_KEY
WHERE
  MDH.DLC_NAME = 'History Department' AND FBA.ADDRESS_PURPOSE = 'STREET';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2220, 222
TOTAL                  : 12048, 11176, 872
AVG                    : 2409.60, 2235.20, 174.40
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: CIS_COURSE_CATALOG
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2003', '2002', '2007']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['097', '098', '090']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['N', 'Y', 'S']),
(DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:DATE, Examples: ['Electrical Eng & Computer Sci', 'Architecture', 'Chemistry']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1991FA', '1995FA', '1989FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['Y', 'N']),
(LECTURE_UNITS:VARCHAR2, Examples: [0, 3, 1]),
(LAB_UNITS:VARCHAR2, Examples: [0, 12, 4]),
(PREPARATION_UNITS:VARCHAR2, Examples: [0, 9, 5]),
(TOTAL_UNITS:VARCHAR2, Examples: [0, 12, 6]),
(DESIGN_UNITS:VARCHAR2, Examples: [0, 6, 8]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['R', 'J', 'N']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Can be repeated for credit', 'Continuing and Repeatable', 'Not repeatable for credit']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', 'H-LEVEL Grad Credit (except for Course 18 students)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['HD1', 'HE', 'HD5']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS-D, Category 1', 'HASS Elective', 'HASS-D, Category 5']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:NUMBER, Examples: ['RESH', 'NTRN', 'COOP']),
(TUITION_ATTRIBUTE_DESC:NUMBER, Examples: ['Pre-thesis Research Subject', 'Internship', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:NUMBER, Examples: ['WRT2', 'WRT1']),
(WRITE_REQ_ATTRIBUTE_DESC:NUMBER, Examples: ['Writing Requirement, Phase II', 'Writing Requirement, Phase I']),
(SUPERVISOR_ATTRIBUTE:NUMBER, Examples: ['UROP', 'THG', 'THU']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['UROP subject', 'Grad Thesis', 'Undergrad Thesis']),
(PREREQUISITES:VARCHAR2, Examples: ['Permission of instructor', '10.213', '12.120 and 12.103, or permission of instructor']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Crystal structures of mantle and core minerals, elastic and thermodynamic properties of materials at high pressure-temperature,', 'Investigates social conflict and distributional disputes in the public sector. While theoretical aspects of conflict are consid', 'Presents a framework for current landscape ecological theory, structured to encourage application in physical planning of lands']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.285J, 11.482J', '3.57J', '1.232J, 15.054J, 16.71J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE', '1.EPW, 3.EPW, 6.EPW, 10.EPW, 16.EPW, 20.EPW, 22.EPW', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['2.729J, EC.729J', 'EC.718J, WGS.277J', '21A.136J, 21G.026J']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['15.511, 15.515', '15.024', '15.414']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(STATUS_CHANGE:VARCHAR2, Examples: ['(2016: New number: 21G.110)', '(2016: New number: 21G.113)', '(2016: New number: 21G.142)']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['02-SEP-01', '12-JAN-06', '16-MAY-05']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.005']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HS', 'HA', 'HH']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Social Sciences', 'HASS Arts', 'HASS Humanities']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'Second Half Term Subject', 'First Half Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Asia', 'United States of America']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['China', 'Brazil|Uruguay|Vietnam|Russia|Australia', 'United States of America']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m2c.html', 'http://student.mit.edu/catalog/m3b.html'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each building key, what is the building name and the number of courses offered by the Center for International Studies?

(Hints: Schema Mapping Hints:
- 'building key' is related to FCLT_BUILDING.FCLT_BUILDING_KEY
- 'building name' is related to FCLT_BUILDING.BUILDING_NAME
- 'courses offered by the Center for International Studies' is related to CIS_COURSE_CATALOG.SUBJECT_ID

Join Information: (CIS_COURSE_CATALOG.SUBJECT_ID = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FCLT_ROOMS.FCLT_ROOM_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF4F610>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4F730>

***** FINAL SQL QUERY *****
```mysql
SELECT
  T1.FCLT_BUILDING_KEY,
  T1.BUILDING_NAME,
  COUNT(DISTINCT T3.SUBJECT_ID)
FROM FCLT_BUILDING AS T1
INNER JOIN FCLT_ROOMS AS T2
  ON T1.FCLT_BUILDING_KEY = T2.FCLT_BUILDING_KEY
INNER JOIN COURSE_CATALOG_SUBJECT_OFFERED AS T3
  ON T2.FCLT_ROOM_KEY = T3.MEET_PLACE
WHERE
  T3.DEPARTMENT_NAME = 'Center for International Studies'
GROUP BY
  T1.FCLT_BUILDING_KEY,
  T1.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 6199, 173
TOTAL                  : 18420, 17375, 1045
AVG                    : 3070.00, 2895.83, 174.17
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
List the unique term code, subject title, room, floor, building key, building street address, city, state, and postal code, formats, and number of enrolled students for all courses with more than 300 attendees.

(Hints: Schema Mapping Hints:
- 'term code' is related to SUBJECT_OFFERED.TERM_CODE
- 'subject title' is related to SUBJECT_OFFERED.SUBJECT_TITLE
- 'room' is related to FCLT_ROOMS.ROOM
- 'floor' is related to FCLT_ROOMS.FLOOR
- 'building key' is related to BUILDINGS.BUILDING_KEY
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FCLT_BUILDING_ADDRESS.CITY
- 'state' is related to FCLT_BUILDING_ADDRESS.STATE
- 'postal code' is related to FCLT_BUILDING_ADDRESS.POSTAL_CODE
- 'formats' is related to SUBJECT_OFFERED.FORM_TYPE
- 'number of enrolled students' is related to SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'attendees' is related to SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (FCLT_ROOMS.FCLT_ROOM_KEY = SUBJECT_OFFERED.MEET_PLACE), (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEFC70>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEEF20>

***** FINAL SQL QUERY *****
SELECT DISTINCT
  T1.TERM_CODE,
  T1.SUBJECT_TITLE,
  T2.ROOM,
  T2.FLOOR,
  T3.BUILDING_KEY,
  T3.BUILDING_STREET_ADDRESS,
  T4.CITY,
  T4.STATE,
  T4.POSTAL_CODE,
  T1.FORM_TYPE,
  T1.NUM_ENROLLED_STUDENTS
FROM SUBJECT_OFFERED AS T1
INNER JOIN FCLT_ROOMS AS T2
  ON T1.MEET_PLACE = T2.FCLT_ROOM_KEY
INNER JOIN BUILDINGS AS T3
  ON T2.FCLT_BUILDING_KEY = T3.BUILDING_KEY
INNER JOIN FCLT_BUILDING_ADDRESS AS T4
  ON T3.BUILDING_KEY = T4.FCLT_BUILDING_KEY
WHERE
  T1.NUM_ENROLLED_STUDENTS > 300 AND T4.ADDRESS_PURPOSE = 'STREET';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3551, 251
TOTAL                  : 22222, 20926, 1296
AVG                    : 3174.57, 2989.43, 185.14
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the unique full room names, their corresponding building names, street addresses, cities, states, postal codes, and building heights for rooms associated with subjects that Computer Science students can enroll in.

(Hints: Schema Mapping Hints:
- 'full room names' is related to FCLT_ROOMS.ROOM_FULL_NAME
- 'building names' is related to BUILDINGS.BUILDING_NAME
- 'street addresses' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'cities' is related to FCLT_BUILDING_ADDRESS.CITY
- 'states' is related to FCLT_BUILDING_ADDRESS.STATE
- 'postal codes' is related to FCLT_BUILDING_ADDRESS.POSTAL_CODE
- 'building heights' is related to FCLT_BUILDING.BUILDING_HEIGHT
- 'Computer Science' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FCLT_ROOMS.FCLT_ROOM_KEY), (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEE5F0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEE620>

***** FINAL SQL QUERY *****
```mysql
SELECT DISTINCT
  T1.ROOM_FULL_NAME,
  T3.BUILDING_NAME,
  T3.BUILDING_STREET_ADDRESS,
  T4.CITY,
  T4.STATE,
  T4.POSTAL_CODE,
  T2.BUILDING_HEIGHT
FROM FCLT_ROOMS AS T1
INNER JOIN FCLT_BUILDING AS T2
  ON T1.FCLT_BUILDING_KEY = T2.FCLT_BUILDING_KEY
INNER JOIN BUILDINGS AS T3
  ON T1.FCLT_BUILDING_KEY = T3.BUILDING_KEY
INNER JOIN FCLT_BUILDING_ADDRESS AS T4
  ON T1.FCLT_BUILDING_KEY = T4.FCLT_BUILDING_KEY
INNER JOIN COURSE_CATALOG_SUBJECT_OFFERED AS T5
  ON T1.FCLT_ROOM_KEY = T5.MEET_PLACE
WHERE
  T5.DEPARTMENT_NAME LIKE '%Computer Science%' AND T4.ADDRESS_PURPOSE = 'STREET';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5065, 258
TOTAL                  : 27545, 25991, 1554
AVG                    : 3443.12, 3248.88, 194.25
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the unique course instructor names, course titles, and the amount of material for each course instructor key and the key of subject offered.

(Hints: Schema Mapping Hints:
- 'course instructor names' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'course titles' is related to LIBRARY_SUBJECT_OFFERED.SUBJECT_TITLE
- 'amount of material' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN
- 'course instructor key' is related to LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY
- 'key of subject offered' is related to LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY

Join Information: (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEF3D0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DD50>

***** FINAL SQL QUERY *****
SELECT
  T1.INSTRUCTOR_NAME,
  T4.SUBJECT_TITLE,
  T1.LIBRARY_COURSE_INSTRUCTOR_KEY,
  T4.LIBRARY_SUBJECT_OFFERED_KEY,
  COUNT(DISTINCT T3.CATALOG_ISBN) AS amount_of_material
FROM LIBRARY_COURSE_INSTRUCTOR AS T1
INNER JOIN LIBRARY_RESERVE_MATRL_DETAIL AS T2
  ON T1.LIBRARY_COURSE_INSTRUCTOR_KEY = T2.LIBRARY_COURSE_INSTRUCTOR_KEY
INNER JOIN LIBRARY_RESERVE_CATALOG AS T3
  ON T2.LIBRARY_RESERVE_CATALOG_KEY = T3.LIBRARY_RESERVE_CATALOG_KEY
INNER JOIN LIBRARY_SUBJECT_OFFERED AS T4
  ON T2.LIBRARY_SUBJECT_OFFERED_KEY = T4.LIBRARY_SUBJECT_OFFERED_KEY
GROUP BY
  T1.INSTRUCTOR_NAME,
  T4.SUBJECT_TITLE,
  T1.LIBRARY_COURSE_INSTRUCTOR_KEY,
  T4.LIBRARY_SUBJECT_OFFERED_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2252, 263
TOTAL                  : 30060, 28243, 1817
AVG                    : 3340.00, 3138.11, 201.89
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the name of the building that accomodates the most students, and how many students does it accomodate?

(Hints: Schema Mapping Hints:
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME
- 'students' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (FCLT_ROOMS.BUILDING_ROOM = MIT_STUDENT_DIRECTORY.OFFICE_LOCATION), (FCLT_ROOMS.BUILDING_ROOM = MIT_STUDENT_DIRECTORY.OFFICE_LOCATION))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6FD90>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DE40>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NAME,
  COUNT(T3.FULL_NAME) AS num_students
FROM FCLT_BUILDING AS T1
INNER JOIN FCLT_ROOMS AS T2
  ON T1.FCLT_BUILDING_KEY = T2.FCLT_BUILDING_KEY
INNER JOIN MIT_STUDENT_DIRECTORY AS T3
  ON T2.BUILDING_ROOM = T3.OFFICE_LOCATION
GROUP BY
  T1.BUILDING_NAME
ORDER BY
  num_students DESC
LIMIT 1;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2306, 136
TOTAL                  : 32502, 30549, 1953
AVG                    : 3250.20, 3054.90, 195.30
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIME_DAY
[
(FISCAL_PERIOD:VARCHAR2, Examples: ['195007', '195008', '195009']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1975 Period 6', 'FY 1987 Period 11', 'FY 1983 Period 12']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['197412', '198705', '198306']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['December 1974', 'May 1987', 'June 1983']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1974', '1987', '1983']),
(START_DATE:DATE, Examples: ['01-DEC-74', '01-MAY-87', '01-JUN-83']),
(END_DATE:DATE, Examples: ['31-DEC-74', '31-MAY-87', '30-JUN-83']),
(CALENDAR_DATE:DATE, Examples: ['01-APR-00', '01-APR-01', '01-APR-02']),
(DAY_OF_WEEK:VARCHAR2, Examples: ['Friday   ', 'Wednesday', 'Sunday   ']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['2021', '2002', '1994']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 2020-2021', 'Aid Year 2001-2002', 'Aid year 1993-94']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(ACADEMIC_TERM_CODE:VARCHAR2, Examples: ['1951SP', '1951SU', '1952SP']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1986-1987', 'Summer Term 1983', 'Summer Term 2020'])
]

### Question ###
For each IAP category and academic year, list the category name, academic year, total fee collected, total number of IAP subjects, and the minimum and maximum enrollment.

(Hints: Schema Mapping Hints:
- 'category name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'academic year' is related to TIME_DAY.ACADEMIC_YEAR
- 'fee collected' is related to IAP_SUBJECT_DETAIL.FEE
- 'IAP subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY), (TIME_DAY.ACADEMIC_TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6FB80>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DE70>

***** FINAL SQL QUERY *****
SELECT
  T1.IAP_CATEGORY_NAME,
  T3.ACADEMIC_YEAR,
  SUM(T2.FEE),
  COUNT(T2.ACTIVITY_TITLE),
  MIN(T2.MAX_ENROLLMENT),
  MAX(T2.MAX_ENROLLMENT)
FROM IAP_SUBJECT_CATEGORY AS T1
INNER JOIN IAP_SUBJECT_DETAIL AS T2
  ON T1.IAP_SUBJECT_CATEGORY_KEY = T2.IAP_SUBJECT_CATEGORY_KEY
INNER JOIN TIME_DAY AS T3
  ON T2.TERM_CODE = T3.ACADEMIC_TERM_CODE
GROUP BY
  T1.IAP_CATEGORY_NAME,
  T3.ACADEMIC_YEAR;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2130, 180
TOTAL                  : 34812, 32679, 2133
AVG                    : 3164.73, 2970.82, 193.91
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
What is the room, floor, building key, building street address, city, state, and postal code of Professor Summer Haynes's office?

(Hints: Schema Mapping Hints:
- 'room' is related to FAC_ROOMS.ROOM
- 'floor' is related to FAC_ROOMS.FLOOR
- 'building key' is related to FAC_BUILDING_ADDRESS.BUILDING_KEY
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'postal code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'Professor Summer Haynes' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'office' is related to EMPLOYEE_DIRECTORY.OFFICE_LOCATION

Join Information: (EMPLOYEE_DIRECTORY.OFFICE_LOCATION = FAC_ROOMS.FAC_ROOM_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEF220>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DCC0>

***** FINAL SQL QUERY *****
SELECT
  T2.ROOM,
  T2.FLOOR,
  T3.BUILDING_KEY,
  T4.BUILDING_STREET_ADDRESS,
  T3.CITY,
  T3.STATE,
  T3.POSTAL_CODE
FROM EMPLOYEE_DIRECTORY AS T1
INNER JOIN FAC_ROOMS AS T2
  ON T1.OFFICE_LOCATION = T2.FAC_ROOM_KEY
INNER JOIN FAC_BUILDING_ADDRESS AS T3
  ON T2.BUILDING_KEY = T3.BUILDING_KEY
INNER JOIN BUILDINGS AS T4
  ON T3.BUILDING_KEY = T4.BUILDING_KEY
WHERE
  T1.FULL_NAME = 'Haynes, Summer' AND T3.ADDRESS_PURPOSE = 'STREET';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2256, 191
TOTAL                  : 37259, 34935, 2324
AVG                    : 3104.92, 2911.25, 193.67
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_PERSON
[
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(PERSON_ROLE:VARCHAR2, Examples: ['Activity leader', 'Session leader', 'Contact person']),
(PERSON_MIT_AFFILIATION:VARCHAR2, Examples: ['Staff', 'Senior Lecturer', 'Other MIT']),
(PERSON_NAME:VARCHAR2, Examples: ['Willie Hewitt', 'Junaid Ochoa', 'Rufus Armstrong']),
(PERSON_LOCATION:VARCHAR2, Examples: ['Register for Zoom ID', 'NE48', 'E15-413']),
(PERSON_EMAIL:VARCHAR2, Examples: ['anac@worker.com', 'ec@worker.com', 'pv@worker.com']),
(PERSON_ORGANIZATION:VARCHAR2),
(PERSON_TITLE:VARCHAR2),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIME_DAY
[
(FISCAL_PERIOD:VARCHAR2, Examples: ['195007', '195008', '195009']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1975 Period 6', 'FY 1987 Period 11', 'FY 1983 Period 12']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['197412', '198705', '198306']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['December 1974', 'May 1987', 'June 1983']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1974', '1987', '1983']),
(START_DATE:DATE, Examples: ['01-DEC-74', '01-MAY-87', '01-JUN-83']),
(END_DATE:DATE, Examples: ['31-DEC-74', '31-MAY-87', '30-JUN-83']),
(CALENDAR_DATE:DATE, Examples: ['01-APR-00', '01-APR-01', '01-APR-02']),
(DAY_OF_WEEK:VARCHAR2, Examples: ['Friday   ', 'Wednesday', 'Sunday   ']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['2021', '2002', '1994']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 2020-2021', 'Aid Year 2001-2002', 'Aid year 1993-94']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(ACADEMIC_TERM_CODE:VARCHAR2, Examples: ['1951SP', '1951SU', '1952SP']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1986-1987', 'Summer Term 1983', 'Summer Term 2020'])
]

### Question ###
What are the individual's email and name, academic year, total number of IAP subjects, the minimum and maximum fees, and the total course enrollment for each individual and academic year?

(Hints: Schema Mapping Hints:
- 'email' is related to IAP_SUBJECT_PERSON.PERSON_EMAIL
- 'name' is related to IAP_SUBJECT_PERSON.PERSON_NAME
- 'academic year' is related to TIME_DAY.ACADEMIC_YEAR
- 'IAP subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'fees' is related to IAP_SUBJECT_DETAIL.FEE
- 'course enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_PERSON_KEY = IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY), (TIME_DAY.ACADEMIC_TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF4F670>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEF280>

***** FINAL SQL QUERY *****
SELECT
  T2.PERSON_EMAIL,
  T2.PERSON_NAME,
  T3.ACADEMIC_YEAR,
  COUNT(T1.IAP_SUBJECT_PERSON_KEY) AS total_iap_subjects,
  MIN(T1.FEE) AS min_fee,
  MAX(T1.FEE) AS max_fee,
  SUM(T1.MAX_ENROLLMENT) AS total_course_enrollment
FROM IAP_SUBJECT_DETAIL AS T1
INNER JOIN IAP_SUBJECT_PERSON AS T2
  ON T1.IAP_SUBJECT_PERSON_KEY = T2.IAP_SUBJECT_PERSON_KEY
INNER JOIN TIME_DAY AS T3
  ON T1.TERM_CODE = T3.ACADEMIC_TERM_CODE
GROUP BY
  T2.PERSON_EMAIL,
  T2.PERSON_NAME,
  T3.ACADEMIC_YEAR;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2204, 218
TOTAL                  : 39681, 37139, 2542
AVG                    : 3052.38, 2856.85, 195.54
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the school code, school name, full name of the department, course level, total number of courses, and total number of degree-granting courses for each school code, department, and course level?

(Hints: Schema Mapping Hints:
- 'school code' is related to SIS_SUBJECT_CODE.SCHOOL_CODE
- 'school name' is related to SIS_SUBJECT_CODE.SCHOOL_NAME
- 'full name of the department' is related to SIS_DEPARTMENT.DEPARTMENT_FULL_NAME
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'courses' is related to SIS_COURSE_DESCRIPTION.COURSE
- 'degree-granting courses' is related to SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING

Join Information: (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_COURSE_DESCRIPTION.DEPARTMENT), (SIS_COURSE_DESCRIPTION.COURSE = SIS_SUBJECT_CODE.SUBJECT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6FF40>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DE10>

***** FINAL SQL QUERY *****
SELECT
  T3.SCHOOL_CODE,
  T3.SCHOOL_NAME,
  T2.DEPARTMENT_FULL_NAME,
  T1.COURSE_LEVEL,
  COUNT(T1.COURSE) AS total_number_of_courses,
  SUM(CASE WHEN T1.IS_DEGREE_GRANTING = 'Y' THEN 1 ELSE 0 END) AS total_number_of_degree_granting_courses
FROM SIS_COURSE_DESCRIPTION AS T1
INNER JOIN SIS_DEPARTMENT AS T2
  ON T1.DEPARTMENT = T2.DEPARTMENT_CODE
INNER JOIN SIS_SUBJECT_CODE AS T3
  ON T1.COURSE = T3.SUBJECT_CODE
GROUP BY
  T3.SCHOOL_CODE,
  T3.SCHOOL_NAME,
  T2.DEPARTMENT_FULL_NAME,
  T1.COURSE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1635, 202
TOTAL                  : 41518, 38774, 2744
AVG                    : 2965.57, 2769.57, 196.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is total number of subjects, the total fee, and the shortest and longest sessions, for all virtual IAP sessions?

(Hints: Schema Mapping Hints:
- 'subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'sessions' is related to IAP_SUBJECT_SESSION.SESSION_END_TIME, IAP_SUBJECT_SESSION.SESSION_START_TIME

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_SESSION.SESSION_LOCATION = BUILDINGS.BUILDING_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6EEF0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DDB0>

***** FINAL SQL QUERY *****
SELECT
  COUNT(DISTINCT T1.ACTIVITY_TITLE),
  SUM(T1.FEE),
  MIN(TIME_TO_SEC(TIMEDIFF(STR_TO_DATE(T2.SESSION_END_TIME, '%h%i%p'), STR_TO_DATE(T2.SESSION_START_TIME, '%h%i%p')))),
  MAX(TIME_TO_SEC(TIMEDIFF(STR_TO_DATE(T2.SESSION_END_TIME, '%h%i%p'), STR_TO_DATE(T2.SESSION_START_TIME, '%h%i%p'))))
FROM IAP_SUBJECT_DETAIL AS T1
INNER JOIN IAP_SUBJECT_SESSION AS T2
  ON T1.IAP_SUBJECT_SESSION_KEY = T2.IAP_SUBJECT_SESSION_KEY
WHERE
  T2.SESSION_LOCATION IN ('https://mit.zoom.us/', 'On line');

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1947, 220
TOTAL                  : 43685, 40721, 2964
AVG                    : 2912.33, 2714.73, 197.60
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the department name, total number of types of TIP subjects, total number of enrolled students, the minimum and maximum rental new price for each department?

(Hints: Schema Mapping Hints:
- 'department name' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'TIP subjects' is related to TIP_SUBJECT_OFFERED.SUBJECT_ID
- 'enrolled students' is related to TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'rental new price' is related to TIP_MATERIAL.RENTAL_NEW_PRICE

Join Information: (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6C4F0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DD80>

***** FINAL SQL QUERY *****
SELECT
  T1.OFFER_DEPT_NAME,
  COUNT(DISTINCT T1.SUBJECT_ID),
  SUM(T1.NUM_ENROLLED_STUDENTS),
  MIN(T3.RENTAL_NEW_PRICE),
  MAX(T3.RENTAL_NEW_PRICE)
FROM TIP_SUBJECT_OFFERED AS T1
JOIN TIP_DETAIL AS T2
  ON T1.TIP_SUBJECT_OFFERED_KEY = T2.TIP_SUBJECT_OFFERED_KEY
JOIN TIP_MATERIAL AS T3
  ON T2.TIP_MATERIAL_KEY = T3.TIP_MATERIAL_KEY
GROUP BY
  T1.OFFER_DEPT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1686, 168
TOTAL                  : 45539, 42407, 3132
AVG                    : 2846.19, 2650.44, 195.75
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the school code, school name, DLC key, the graduate level, total number of SIS subjects, the minimum and maximum course numbers, and the total number of departments offering subjects for each school?

(Hints: Schema Mapping Hints:
- 'school code' is related to SIS_SUBJECT_CODE.SCHOOL_CODE
- 'school name' is related to SIS_SUBJECT_CODE.SCHOOL_NAME
- 'DLC key' is related to SIS_DEPARTMENT.DLC_KEY
- 'graduate level' is related to SIS_COURSE_DESCRIPTION.GRADUATE_LEVEL
- 'SIS subjects' is related to SIS_SUBJECT_CODE.SUBJECT_CODE
- 'course numbers' is related to SIS_SUBJECT_CODE.COURSE_NUMBER
- 'departments' is related to SIS_DEPARTMENT.DEPARTMENT_CODE

Join Information: (SIS_SUBJECT_CODE.SUBJECT_CODE = SIS_COURSE_DESCRIPTION.COURSE), (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEF790>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DD20>

***** FINAL SQL QUERY *****
SELECT
  T1.SCHOOL_CODE,
  T1.SCHOOL_NAME,
  GROUP_CONCAT(DISTINCT T3.DLC_KEY) AS DLC_keys,
  GROUP_CONCAT(DISTINCT T2.GRADUATE_LEVEL) AS graduate_levels,
  COUNT(DISTINCT T1.SUBJECT_CODE) AS total_number_of_SIS_subjects,
  MIN(T1.COURSE_NUMBER) AS minimum_course_numbers,
  MAX(T1.COURSE_NUMBER) AS maximum_course_numbers,
  COUNT(DISTINCT T3.DEPARTMENT_CODE) AS total_number_of_departments_offering_subjects
FROM SIS_SUBJECT_CODE AS T1
JOIN SIS_COURSE_DESCRIPTION AS T2
  ON T1.SUBJECT_CODE = T2.COURSE
JOIN SIS_DEPARTMENT AS T3
  ON T2.DEPARTMENT = T3.DEPARTMENT_CODE
GROUP BY
  T1.SCHOOL_CODE,
  T1.SCHOOL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1641, 231
TOTAL                  : 47411, 44048, 3363
AVG                    : 2788.88, 2591.06, 197.82
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the name of the building, total number of subjects, total fee, and shortest and longest sessions for each physical IAP session location?

(Hints: Schema Mapping Hints:
- 'name of the building' is related to BUILDINGS.BUILDING_NAME
- 'subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'sessions' is related to IAP_SUBJECT_SESSION.SESSION_END_TIME, IAP_SUBJECT_SESSION.SESSION_START_TIME

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_SESSION.SESSION_LOCATION = BUILDINGS.BUILDING_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEE710>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEE9E0>

***** FINAL SQL QUERY *****
```mysql
SELECT
  T3.BUILDING_NAME,
  COUNT(DISTINCT T1.ACTIVITY_TITLE) AS total_subjects,
  SUM(T1.FEE) AS total_fee,
  MIN(TIME_TO_SEC(TIMEDIFF(STR_TO_DATE(T2.SESSION_END_TIME, '%h%i%p'), STR_TO_DATE(T2.SESSION_START_TIME, '%h%i%p')))) AS shortest_session_seconds,
  MAX(TIME_TO_SEC(TIMEDIFF(STR_TO_DATE(T2.SESSION_END_TIME, '%h%i%p'), STR_TO_DATE(T2.SESSION_START_TIME, '%h%i%p')))) AS longest_session_seconds
FROM IAP_SUBJECT_DETAIL AS T1
JOIN IAP_SUBJECT_SESSION AS T2
  ON T1.IAP_SUBJECT_SESSION_KEY = T2.IAP_SUBJECT_SESSION_KEY
JOIN BUILDINGS AS T3
  ON T2.SESSION_LOCATION = T3.BUILDING_NUMBER
GROUP BY
  T3.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1969, 265
TOTAL                  : 49645, 46017, 3628
AVG                    : 2758.06, 2556.50, 201.56
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What are the different schools and departments that offer SIS courses? List their school code, school name, department code, department name, the total number of phone numbers, and the most common course level.

(Hints: Schema Mapping Hints:
- 'school code' is related to SIS_SUBJECT_CODE.SCHOOL_CODE
- 'school name' is related to SIS_SUBJECT_CODE.SCHOOL_NAME
- 'department code' is related to SIS_DEPARTMENT.DEPARTMENT_CODE
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL

Join Information: (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_COURSE_DESCRIPTION.DEPARTMENT), (SIS_SUBJECT_CODE.SUBJECT_CODE = SIS_COURSE_DESCRIPTION.COURSE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6F550>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6F880>

***** FINAL SQL QUERY *****
WITH DepartmentCourseLevelCounts AS (
    SELECT
        T1.SCHOOL_CODE,
        T1.SCHOOL_NAME,
        T2.DEPARTMENT_CODE,
        T3.SIS_ADMIN_DEPARTMENT_NAME,
        T4.COURSE_LEVEL,
        COUNT(T4.COURSE_LEVEL) AS level_frequency
    FROM
        SIS_SUBJECT_CODE AS T1
    JOIN
        SIS_COURSE_DESCRIPTION AS T4
        ON T1.SUBJECT_CODE = T4.COURSE
    JOIN
        SIS_DEPARTMENT AS T2
        ON T4.DEPARTMENT = T2.DEPARTMENT_CODE
    JOIN
        SIS_ADMIN_DEPARTMENT AS T3
        ON T2.DEPARTMENT_CODE = T3.SIS_ADMIN_DEPARTMENT_CODE
    GROUP BY
        T1.SCHOOL_CODE,
        T1.SCHOOL_NAME,
        T2.DEPARTMENT_CODE,
        T3.SIS_ADMIN_DEPARTMENT_NAME,
        T4.COURSE_LEVEL
),
MostCommonCourseLevel AS (
    SELECT
        SCHOOL_CODE,
        SCHOOL_NAME,
        DEPARTMENT_CODE,
        SIS_ADMIN_DEPARTMENT_NAME,
        COURSE_LEVEL AS most_common_course_level
    FROM (
        SELECT
            SCHOOL_CODE,
            SCHOOL_NAME,
            DEPARTMENT_CODE,
            SIS_ADMIN_DEPARTMENT_NAME,
            COURSE_LEVEL,
            ROW_NUMBER() OVER (PARTITION BY SCHOOL_CODE, SCHOOL_NAME, DEPARTMENT_CODE, SIS_ADMIN_DEPARTMENT_NAME ORDER BY level_frequency DESC, COURSE_LEVEL ASC) AS rn
        FROM
            DepartmentCourseLevelCounts
    ) AS RankedLevels
    WHERE
        rn = 1
)
SELECT
    T1.SCHOOL_CODE,
    T1.SCHOOL_NAME,
    T2.DEPARTMENT_CODE,
    T3.SIS_ADMIN_DEPARTMENT_NAME,
    COUNT(DISTINCT T3.DEPARTMENT_PHONE_NUMBER) AS total_phone_numbers,
    MCL.most_common_course_level
FROM
    SIS_SUBJECT_CODE AS T1
JOIN
    SIS_COURSE_DESCRIPTION AS T4
    ON T1.SUBJECT_CODE = T4.COURSE
JOIN
    SIS_DEPARTMENT AS T2
    ON T4.DEPARTMENT = T2.DEPARTMENT_CODE
JOIN
    SIS_ADMIN_DEPARTMENT AS T3
    ON T2.DEPARTMENT_CODE = T3.SIS_ADMIN_DEPARTMENT_CODE
JOIN
    MostCommonCourseLevel AS MCL
    ON T1.SCHOOL_CODE = MCL.SCHOOL_CODE AND T1.SCHOOL_NAME = MCL.SCHOOL_NAME AND T2.DEPARTMENT_CODE = MCL.DEPARTMENT_CODE AND T3.SIS_ADMIN_DEPARTMENT_NAME = MCL.SIS_ADMIN_DEPARTMENT_NAME
GROUP BY
    T1.SCHOOL_CODE,
    T1.SCHOOL_NAME,
    T2.DEPARTMENT_CODE,
    T3.SIS_ADMIN_DEPARTMENT_NAME,
    MCL.most_common_course_level
ORDER BY
    T1.SCHOOL_CODE,
    T1.SCHOOL_NAME,
    T2.DEPARTMENT_CODE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1877, 720
TOTAL                  : 52242, 47894, 4348
AVG                    : 2749.58, 2520.74, 228.84
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the term code, term description, total number of IAP sessions, total fee collected, and minimum and maximum enrollment for each term code?

(Hints: Schema Mapping Hints:
- 'term code' is related to IAP_SUBJECT_DETAIL.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'IAP sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (ACADEMIC_TERMS_ALL.TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEE9B0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEE5C0>

***** FINAL SQL QUERY *****
SELECT
  T1.TERM_CODE,
  T1.TERM_DESCRIPTION,
  COUNT(DISTINCT T3.IAP_SUBJECT_SESSION_KEY) AS total_iap_sessions,
  SUM(T2.FEE) AS total_fee_collected,
  MIN(T2.MAX_ENROLLMENT) AS minimum_enrollment,
  MAX(T2.MAX_ENROLLMENT) AS maximum_enrollment
FROM ACADEMIC_TERMS_ALL AS T1
JOIN IAP_SUBJECT_DETAIL AS T2
  ON T1.TERM_CODE = T2.TERM_CODE
JOIN IAP_SUBJECT_SESSION AS T3
  ON T2.IAP_SUBJECT_SESSION_KEY = T3.IAP_SUBJECT_SESSION_KEY
GROUP BY
  T1.TERM_CODE,
  T1.TERM_DESCRIPTION;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2532, 201
TOTAL                  : 54975, 50426, 4549
AVG                    : 2748.75, 2521.30, 227.45
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each sponsor of the independent activity periods, list the sponsor name, number of sessions held, the total number of enrollment, the minimum and maximum fee, the number of sessions with info, and the number of sessions without info.

(Hints: Schema Mapping Hints:
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'info' is related to IAP_SUBJECT_SESSION.HAS_SESSION_INFO

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAC9BC340>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEEC50>

***** FINAL SQL QUERY *****
WITH detail_agg AS (
  SELECT
    IAP_SUBJECT_SPONSOR_KEY,
    SUM(MAX_ENROLLMENT) AS total_enrollment,
    MIN(FEE) AS min_fee,
    MAX(FEE) AS max_fee
  FROM IAP_SUBJECT_DETAIL
  GROUP BY
    IAP_SUBJECT_SPONSOR_KEY
), session_agg AS (
  SELECT
    isd.IAP_SUBJECT_SPONSOR_KEY,
    COUNT(*) AS num_sessions_held,
    SUM(CASE WHEN issn.HAS_SESSION_INFO = 'Y' THEN 1 ELSE 0 END) AS sessions_with_info,
    SUM(CASE WHEN issn.HAS_SESSION_INFO = 'N' THEN 1 ELSE 0 END) AS sessions_without_info
  FROM IAP_SUBJECT_DETAIL AS isd
  JOIN IAP_SUBJECT_SESSION AS issn
    ON isd.IAP_SUBJECT_SESSION_KEY = issn.IAP_SUBJECT_SESSION_KEY
  GROUP BY
    isd.IAP_SUBJECT_SPONSOR_KEY
)
SELECT
  iss.SPONSOR_NAME,
  COALESCE(da.total_enrollment, 0) AS total_enrollment,
  da.min_fee,
  da.max_fee,
  COALESCE(sa.num_sessions_held, 0) AS num_sessions_held,
  COALESCE(sa.sessions_with_info, 0) AS sessions_with_info,
  COALESCE(sa.sessions_without_info, 0) AS sessions_without_info
FROM IAP_SUBJECT_SPONSOR AS iss
LEFT JOIN detail_agg AS da
  ON iss.IAP_SUBJECT_SPONSOR_KEY = da.IAP_SUBJECT_SPONSOR_KEY
LEFT JOIN session_agg AS sa
  ON iss.IAP_SUBJECT_SPONSOR_KEY = sa.IAP_SUBJECT_SPONSOR_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1979, 466
TOTAL                  : 57420, 52405, 5015
AVG                    : 2734.29, 2495.48, 238.81
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: STUDENT_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Ctr for Transportation Studies', 'Foreign Study Program', 'Center for Adv Eng Studies']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['CTS-Ctr for Transportation Studies', 'FOR-Foreign Study Program', 'EN-Center for Adv Eng Studies']),
(SCHOOL_CODE:VARCHAR2, Examples: ['E', 'Y', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'MIT, academic', 'Hum, Arts & Social Sciences'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the author, school name, material status, total record counts, and total number of types of courses for each author and school?

(Hints: Schema Mapping Hints:
- 'author' is related to TIP_MATERIAL.AUTHOR
- 'school name' is related to STUDENT_DEPARTMENT.SCHOOL_NAME
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'record counts' is related to TIP_DETAIL.RECORD_COUNT
- 'courses' is related to TIP_DETAIL.SUBJECT_ID

Join Information: (TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY = TIP_DETAIL.TIP_MATERIAL_STATUS_KEY), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (STUDENT_DEPARTMENT.DEPARTMENT_CODE = TIP_SUBJECT_OFFERED.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF4E500>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEF760>

***** FINAL SQL QUERY *****
SELECT
  T3.AUTHOR,
  T4.SCHOOL_NAME,
  T2.TIP_MATERIAL_STATUS,
  SUM(T1.RECORD_COUNT),
  COUNT(DISTINCT T1.SUBJECT_ID)
FROM TIP_DETAIL AS T1
INNER JOIN TIP_MATERIAL_STATUS AS T2
  ON T1.TIP_MATERIAL_STATUS_KEY = T2.TIP_MATERIAL_STATUS_KEY
INNER JOIN TIP_MATERIAL AS T3
  ON T1.TIP_MATERIAL_KEY = T3.TIP_MATERIAL_KEY
INNER JOIN TIP_SUBJECT_OFFERED AS T5
  ON T1.TIP_SUBJECT_OFFERED_KEY = T5.TIP_SUBJECT_OFFERED_KEY
INNER JOIN STUDENT_DEPARTMENT AS T4
  ON T5.OFFER_DEPT_CODE = T4.DEPARTMENT_CODE
GROUP BY
  T3.AUTHOR,
  T4.SCHOOL_NAME,
  T2.TIP_MATERIAL_STATUS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1963, 229
TOTAL                  : 59612, 54368, 5244
AVG                    : 2709.64, 2471.27, 238.36
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
What are the details of courses offered in the current academic term, including the academic year, term code, hgn code, the total number of types of courses, the average number of units, the department name, the name and email address of the person in charge?

(Hints: Schema Mapping Hints:
- 'current academic term' is related to ACADEMIC_TERMS.IS_CURRENT_TERM
- 'academic year' is related to COURSE_CATALOG_SUBJECT_OFFERED.ACADEMIC_YEAR
- 'term code' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'hgn code' is related to SUBJECT_OFFERED.HGN_CODE
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'number of units' is related to COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS
- 'department name' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME
- 'name' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'email address' is related to EMPLOYEE_DIRECTORY.EMAIL_ADDRESS

Join Information: (SUBJECT_OFFERED.SUBJECT_ID = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (EMPLOYEE_DIRECTORY.MIT_ID = SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6D030>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6EDD0>

***** FINAL SQL QUERY *****
SELECT
  T2.ACADEMIC_YEAR,
  T2.TERM_CODE,
  T3.HGN_CODE,
  COUNT(DISTINCT T2.SUBJECT_ID) AS total_course_types,
  AVG(T2.TOTAL_UNITS) AS average_units,
  T2.DEPARTMENT_NAME,
  T4.FULL_NAME,
  T4.EMAIL_ADDRESS
FROM ACADEMIC_TERMS AS T1
INNER JOIN COURSE_CATALOG_SUBJECT_OFFERED AS T2
  ON T1.TERM_CODE = T2.TERM_CODE
INNER JOIN SUBJECT_OFFERED AS T3
  ON T2.SUBJECT_ID = T3.SUBJECT_ID AND T2.TERM_CODE = T3.TERM_CODE
INNER JOIN EMPLOYEE_DIRECTORY AS T4
  ON T3.RESPONSIBLE_FACULTY_MIT_ID = T4.MIT_ID
WHERE
  T1.IS_CURRENT_TERM = 'Y'
GROUP BY
  T2.ACADEMIC_YEAR,
  T2.TERM_CODE,
  T3.HGN_CODE,
  T2.DEPARTMENT_NAME,
  T4.FULL_NAME,
  T4.EMAIL_ADDRESS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 6107, 292
TOTAL                  : 66011, 60475, 5536
AVG                    : 2870.04, 2629.35, 240.70
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: ACADEMIC_TERM_PARAMETER
[
(TERM_PARAMETER:VARCHAR2, Examples: ['SIS_CURRENT_TERM', 'SIS_PREVIOUS_TERM', 'SIS_UPCOMING_TERM']),
(TERM_INDICATOR:VARCHAR2, Examples: ['C', 'P', 'F']),
(TERM_CODE:VARCHAR2, Examples: ['2024SU', '2025FA', '2025JA']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Fall Term 2024-2025', 'Summer Term 2024', 'January Term 2024-2025']),
(TERM_START_DATE:DATE, Examples: ['03-SEP-24', '10-JUN-24', '06-JAN-25']),
(TERM_END_DATE:DATE, Examples: ['20-DEC-24', '20-AUG-24', '31-JAN-25']),
(TERM_LAST_DAY_BEFORE_NEXT_TERM:DATE, Examples: ['05-JAN-25', '02-SEP-24', '31-JAN-25']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['Y', 'N'])
]
# Table: CIS_COURSE_CATALOG
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2003', '2002', '2007']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['097', '098', '090']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['N', 'Y', 'S']),
(DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:DATE, Examples: ['Electrical Eng & Computer Sci', 'Architecture', 'Chemistry']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1991FA', '1995FA', '1989FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['Y', 'N']),
(LECTURE_UNITS:VARCHAR2, Examples: [0, 3, 1]),
(LAB_UNITS:VARCHAR2, Examples: [0, 12, 4]),
(PREPARATION_UNITS:VARCHAR2, Examples: [0, 9, 5]),
(TOTAL_UNITS:VARCHAR2, Examples: [0, 12, 6]),
(DESIGN_UNITS:VARCHAR2, Examples: [0, 6, 8]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['R', 'J', 'N']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Can be repeated for credit', 'Continuing and Repeatable', 'Not repeatable for credit']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', 'H-LEVEL Grad Credit (except for Course 18 students)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['HD1', 'HE', 'HD5']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS-D, Category 1', 'HASS Elective', 'HASS-D, Category 5']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:NUMBER, Examples: ['RESH', 'NTRN', 'COOP']),
(TUITION_ATTRIBUTE_DESC:NUMBER, Examples: ['Pre-thesis Research Subject', 'Internship', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:NUMBER, Examples: ['WRT2', 'WRT1']),
(WRITE_REQ_ATTRIBUTE_DESC:NUMBER, Examples: ['Writing Requirement, Phase II', 'Writing Requirement, Phase I']),
(SUPERVISOR_ATTRIBUTE:NUMBER, Examples: ['UROP', 'THG', 'THU']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['UROP subject', 'Grad Thesis', 'Undergrad Thesis']),
(PREREQUISITES:VARCHAR2, Examples: ['Permission of instructor', '10.213', '12.120 and 12.103, or permission of instructor']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Crystal structures of mantle and core minerals, elastic and thermodynamic properties of materials at high pressure-temperature,', 'Investigates social conflict and distributional disputes in the public sector. While theoretical aspects of conflict are consid', 'Presents a framework for current landscape ecological theory, structured to encourage application in physical planning of lands']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.285J, 11.482J', '3.57J', '1.232J, 15.054J, 16.71J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE', '1.EPW, 3.EPW, 6.EPW, 10.EPW, 16.EPW, 20.EPW, 22.EPW', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['2.729J, EC.729J', 'EC.718J, WGS.277J', '21A.136J, 21G.026J']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['15.511, 15.515', '15.024', '15.414']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(STATUS_CHANGE:VARCHAR2, Examples: ['(2016: New number: 21G.110)', '(2016: New number: 21G.113)', '(2016: New number: 21G.142)']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['02-SEP-01', '12-JAN-06', '16-MAY-05']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.005']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HS', 'HA', 'HH']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Social Sciences', 'HASS Arts', 'HASS Humanities']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'Second Half Term Subject', 'First Half Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Asia', 'United States of America']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['China', 'Brazil|Uruguay|Vietnam|Russia|Australia', 'United States of America']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m2c.html', 'http://student.mit.edu/catalog/m3b.html'])
]

### Question ###
For each term, list the term code, the term description, whether the term is current or not, and the total number of types of CIS courses.

(Hints: Schema Mapping Hints:
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'term is current or not' is related to ACADEMIC_TERM_PARAMETER.IS_CURRENT_TERM
- 'CIS courses' is related to CIS_COURSE_CATALOG.SUBJECT_ID)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6E890>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6F9A0>

***** FINAL SQL QUERY *****
SELECT
  T1.TERM_CODE,
  T1.TERM_DESCRIPTION,
  T1.IS_CURRENT_TERM,
  COUNT(DISTINCT T2.SUBJECT_ID) AS total_cis_course_types
FROM ACADEMIC_TERMS_ALL AS T1
LEFT JOIN CIS_COURSE_CATALOG AS T2
  ON T1.TERM_CODE = T2.EFFECTIVE_TERM_CODE
GROUP BY
  T1.TERM_CODE,
  T1.TERM_DESCRIPTION,
  T1.IS_CURRENT_TERM;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3254, 132
TOTAL                  : 69397, 63729, 5668
AVG                    : 2891.54, 2655.38, 236.17
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Show the department names, the corresponding SIS subject code, subject code descriptions, graduate level, and the total number of courses per department.

(Hints: Schema Mapping Hints:
- 'department names' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'SIS subject code' is related to SIS_SUBJECT_CODE.SUBJECT_CODE
- 'subject code descriptions' is related to SIS_SUBJECT_CODE.SUBJECT_CODE_DESC
- 'graduate level' is related to SIS_COURSE_DESCRIPTION.GRADUATE_LEVEL
- 'courses' is related to SIS_SUBJECT_CODE.COURSE_NUMBER

Join Information: (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_SUBJECT_CODE.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEE680>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEE800>

***** FINAL SQL QUERY *****
SELECT
  T1.DEPARTMENT_NAME,
  T3.SUBJECT_CODE,
  T3.SUBJECT_CODE_DESC,
  T2.GRADUATE_LEVEL,
  COUNT(DISTINCT T2.COURSE) AS total_courses
FROM SIS_DEPARTMENT AS T1
INNER JOIN SIS_COURSE_DESCRIPTION AS T2
  ON T1.DEPARTMENT_CODE = T2.DEPARTMENT
INNER JOIN SIS_SUBJECT_CODE AS T3
  ON T2.COURSE = T3.COURSE_NUMBER
GROUP BY
  T1.DEPARTMENT_NAME,
  T3.SUBJECT_CODE,
  T3.SUBJECT_CODE_DESC,
  T2.GRADUATE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1597, 162
TOTAL                  : 71156, 65326, 5830
AVG                    : 2846.24, 2613.04, 233.20
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: STUDENT_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Ctr for Transportation Studies', 'Foreign Study Program', 'Center for Adv Eng Studies']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['CTS-Ctr for Transportation Studies', 'FOR-Foreign Study Program', 'EN-Center for Adv Eng Studies']),
(SCHOOL_CODE:VARCHAR2, Examples: ['E', 'Y', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'MIT, academic', 'Hum, Arts & Social Sciences'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is material status, the total number of materials, the total number of subjects, the total number of schools, and the most recent publication year for each material status?

(Hints: Schema Mapping Hints:
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'materials' is related to TIP_DETAIL.TIP_MATERIAL_KEY
- 'subjects' is related to TIP_DETAIL.SUBJECT_ID
- 'schools' is related to STUDENT_DEPARTMENT.SCHOOL_NAME
- 'publication year' is related to TIP_MATERIAL.YEAR

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY = TIP_DETAIL.TIP_MATERIAL_STATUS_KEY), (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY), (STUDENT_DEPARTMENT.DEPARTMENT_CODE = TIP_SUBJECT_OFFERED.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6C2E0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4FAC0>

***** FINAL SQL QUERY *****
SELECT
  T1.TIP_MATERIAL_STATUS,
  COUNT(DISTINCT T2.TIP_MATERIAL_KEY),
  COUNT(DISTINCT T2.SUBJECT_ID),
  COUNT(DISTINCT T5.SCHOOL_NAME),
  MAX(T3.YEAR)
FROM TIP_MATERIAL_STATUS AS T1
INNER JOIN TIP_DETAIL AS T2
  ON T1.TIP_MATERIAL_STATUS_KEY = T2.TIP_MATERIAL_STATUS_KEY
INNER JOIN TIP_MATERIAL AS T3
  ON T2.TIP_MATERIAL_KEY = T3.TIP_MATERIAL_KEY
INNER JOIN TIP_SUBJECT_OFFERED AS T4
  ON T2.TIP_SUBJECT_OFFERED_KEY = T4.TIP_SUBJECT_OFFERED_KEY
INNER JOIN STUDENT_DEPARTMENT AS T5
  ON T4.OFFER_DEPT_CODE = T5.DEPARTMENT_CODE
GROUP BY
  T1.TIP_MATERIAL_STATUS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1991, 223
TOTAL                  : 73370, 67317, 6053
AVG                    : 2821.92, 2589.12, 232.81
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the course number, subject title, material status, the total, min, and max new shelf price, the total, min, and max used shelf price, total number of schools and the total number of materials for each TIP subject and material status?

(Hints: Schema Mapping Hints:
- 'course number' is related to TIP_SUBJECT_OFFERED.COURSE_NUMBER
- 'subject title' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'new shelf price' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'used shelf price' is related to TIP_MATERIAL.USED_SHELF_PRICE
- 'schools' is related to TIP_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'materials' is related to TIP_DETAIL.TIP_MATERIAL_KEY
- 'TIP subject' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE

Join Information: (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY), (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY), (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF4FF10>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEEBC0>

***** FINAL SQL QUERY *****
SELECT
  T3.COURSE_NUMBER,
  T3.SUBJECT_TITLE,
  T2.TIP_MATERIAL_STATUS,
  SUM(T1.NEW_SHELF_PRICE) AS total_new_shelf_price,
  MIN(T1.NEW_SHELF_PRICE) AS min_new_shelf_price,
  MAX(T1.NEW_SHELF_PRICE) AS max_new_shelf_price,
  SUM(T1.USED_SHELF_PRICE) AS total_used_shelf_price,
  MIN(T1.USED_SHELF_PRICE) AS min_used_shelf_price,
  MAX(T1.USED_SHELF_PRICE) AS max_used_shelf_price,
  COUNT(DISTINCT T3.OFFER_SCHOOL_NAME) AS total_number_of_schools,
  COUNT(DISTINCT T4.TIP_MATERIAL_KEY) AS total_number_of_materials
FROM TIP_MATERIAL AS T1
INNER JOIN TIP_DETAIL AS T4
  ON T1.TIP_MATERIAL_KEY = T4.TIP_MATERIAL_KEY
INNER JOIN TIP_MATERIAL_STATUS AS T2
  ON T4.TIP_MATERIAL_STATUS_KEY = T2.TIP_MATERIAL_STATUS_KEY
INNER JOIN TIP_SUBJECT_OFFERED AS T3
  ON T4.TIP_SUBJECT_OFFERED_KEY = T3.TIP_SUBJECT_OFFERED_KEY
GROUP BY
  T3.COURSE_NUMBER,
  T3.SUBJECT_TITLE,
  T2.TIP_MATERIAL_STATUS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1915, 366
TOTAL                  : 75651, 69232, 6419
AVG                    : 2801.89, 2564.15, 237.74
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the term description, whether the term is current or not, total number of types of TIP subjects offered and materials needed, the minimum and maximum number of enrolled students, the total number of schools offering subjects, and the total number of records for each term code?

(Hints: Schema Mapping Hints:
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'term is current or not' is related to ACADEMIC_TERMS_ALL.IS_CURRENT_TERM
- 'TIP subjects' is related to TIP_SUBJECT_OFFERED.COURSE_NUMBER
- 'materials' is related to TIP_MATERIAL.ISBN
- 'enrolled students' is related to TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'schools' is related to TIP_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'number of records' is related to TIP_DETAIL.RECORD_COUNT
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE

Join Information: (ACADEMIC_TERMS_ALL.TERM_CODE = TIP_SUBJECT_OFFERED.TERM_CODE), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY), (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6CE50>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6EF20>

***** FINAL SQL QUERY *****
SELECT
  T1.TERM_DESCRIPTION,
  T1.IS_CURRENT_TERM,
  COUNT(DISTINCT T2.COURSE_NUMBER) AS total_tip_subjects_offered,
  COUNT(DISTINCT T4.ISBN) AS total_materials_needed,
  MIN(T2.NUM_ENROLLED_STUDENTS) AS min_enrolled_students,
  MAX(T2.NUM_ENROLLED_STUDENTS) AS max_enrolled_students,
  COUNT(DISTINCT T2.OFFER_SCHOOL_NAME) AS total_schools_offering_subjects,
  SUM(T3.RECORD_COUNT) AS total_records_for_term
FROM ACADEMIC_TERMS_ALL AS T1
JOIN TIP_SUBJECT_OFFERED AS T2
  ON T1.TERM_CODE = T2.TERM_CODE
JOIN TIP_DETAIL AS T3
  ON T2.TIP_SUBJECT_OFFERED_KEY = T3.TIP_SUBJECT_OFFERED_KEY
JOIN TIP_MATERIAL AS T4
  ON T3.TIP_MATERIAL_KEY = T4.TIP_MATERIAL_KEY
GROUP BY
  T1.TERM_CODE,
  T1.TERM_DESCRIPTION,
  T1.IS_CURRENT_TERM;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2745, 297
TOTAL                  : 78693, 71977, 6716
AVG                    : 2810.46, 2570.61, 239.86
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Show the details of rooms including the full name of the rooms, the building names, floor numbers, the organizations occupying them, name of the departments occupying them, and the percentage of the room area over the assignable floor area and building.

(Hints: Schema Mapping Hints:
- 'full name of the rooms' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'floor numbers' is related to FAC_FLOOR.FLOOR
- 'organizations' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'name of the departments' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'room area' is related to FAC_ROOMS.AREA
- 'assignable floor area' is related to FAC_FLOOR.ASSIGNABLE_AREA

Join Information: (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_ROOMS.FLOOR_KEY = FAC_FLOOR.FLOOR_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6E140>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4FA90>

***** FINAL SQL QUERY *****
SELECT
  T1.ROOM_FULL_NAME,
  T2.BUILDING_NAME,
  T3.FLOOR,
  T4.ORGANIZATION_NAME,
  T4.HR_DEPARTMENT_NAME,
  (CAST(T1.AREA AS DECIMAL (10, 2)) / CAST(T3.ASSIGNABLE_AREA AS DECIMAL (10, 2))) * 100 AS room_area_percentage_of_floor_area,
  (CAST(T1.AREA AS DECIMAL (10, 2)) / CAST(T2.ASSIGNABLE_AREA AS DECIMAL (10, 2))) * 100 AS room_area_percentage_of_building_area
FROM FAC_ROOMS AS T1
INNER JOIN FAC_BUILDING AS T2
  ON T1.BUILDING_KEY = T2.FAC_BUILDING_KEY
INNER JOIN FAC_FLOOR AS T3
  ON T1.FLOOR_KEY = T3.FLOOR_KEY
INNER JOIN FAC_ORGANIZATION AS T4
  ON T1.ORGANIZATION_KEY = T4.ORGANIZATION_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2916, 261
TOTAL                  : 81870, 74893, 6977
AVG                    : 2823.10, 2582.52, 240.59
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
What are the academic year, and instructors names for courses offered in the academic year 2022, along with the total number of types of courses per instructor?

(Hints: Schema Mapping Hints:
- 'academic year' is related to ACADEMIC_TERMS_ALL.ACADEMIC_YEAR
- 'instructors names' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'courses' is related to SUBJECT_OFFERED.COURSE_NUMBER

Join Information: (SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE), (SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6E230>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6D4E0>

***** FINAL SQL QUERY *****
SELECT
  T1.ACADEMIC_YEAR,
  T3.FULL_NAME,
  COUNT(DISTINCT T2.COURSE_NUMBER) AS total_course_types
FROM ACADEMIC_TERMS_ALL AS T1
INNER JOIN SUBJECT_OFFERED AS T2
  ON T1.TERM_CODE = T2.TERM_CODE
INNER JOIN EMPLOYEE_DIRECTORY AS T3
  ON T2.RESPONSIBLE_FACULTY_MIT_ID = T3.MIT_ID
WHERE
  T1.ACADEMIC_YEAR = '2022'
GROUP BY
  T1.ACADEMIC_YEAR,
  T3.FULL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3559, 160
TOTAL                  : 85589, 78452, 7137
AVG                    : 2852.97, 2615.07, 237.90
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Retrieve information about the IAP subjects, including their titles, categories, session titles, session start time, session end time, sponsor names, and total number of sessions.

(Hints: Schema Mapping Hints:
- 'titles' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'categories' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'session titles' is related to IAP_SUBJECT_SESSION.SESSION_TITLE
- 'session start time' is related to IAP_SUBJECT_SESSION.SESSION_START_TIME
- 'session end time' is related to IAP_SUBJECT_SESSION.SESSION_END_TIME
- 'sponsor names' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY

Join Information: (IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6D8A0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4DCF0>

***** FINAL SQL QUERY *****
SELECT
  T1.ACTIVITY_TITLE,
  T2.IAP_CATEGORY_NAME,
  T3.SESSION_TITLE,
  T3.SESSION_START_TIME,
  T3.SESSION_END_TIME,
  T4.SPONSOR_NAME,
  COUNT(T1.IAP_SUBJECT_SESSION_KEY) OVER (PARTITION BY T1.ACTIVITY_TITLE) AS total_sessions
FROM IAP_SUBJECT_DETAIL AS T1
INNER JOIN IAP_SUBJECT_CATEGORY AS T2
  ON T1.IAP_SUBJECT_CATEGORY_KEY = T2.IAP_SUBJECT_CATEGORY_KEY
INNER JOIN IAP_SUBJECT_SESSION AS T3
  ON T1.IAP_SUBJECT_SESSION_KEY = T3.IAP_SUBJECT_SESSION_KEY
INNER JOIN IAP_SUBJECT_SPONSOR AS T4
  ON T1.IAP_SUBJECT_SPONSOR_KEY = T4.IAP_SUBJECT_SPONSOR_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2289, 233
TOTAL                  : 88111, 80741, 7370
AVG                    : 2842.29, 2604.55, 237.74
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_FLOOR
[
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR_NAME:VARCHAR2, Examples: ['0 Floor', '00 Floor', '000 Floor']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_SUPERVISOR_USAGE
[
(MIT_ID:VARCHAR2, Examples: ['932464132', '989998641', '904031741']),
(DEPT_COUNT:NUMBER, Examples: [1, 2, 4]),
(DEPT_NAMES:VARCHAR2, Examples: ['D_ACT', 'D_ACT,D_RESDEV', 'D_ADM']),
(NUM_OF_SUPERVISEES:NUMBER, Examples: [1, 4, 2]),
(SQFT:NUMBER, Examples: [0.0, 103.0, 162.0]),
(RESEARCH_VOLUME:NUMBER, Examples: [0.0, 1350070.0, 56280.0]),
(SQFT_PER_SUPERVISEE:NUMBER, Examples: [0.0, 103.0, 162.0]),
(SQFT_PER_RES_VOL:NUMBER, Examples: [0.0, -18.0, 5.0]),
(RES_VOL_PER_SQFT:NUMBER, Examples: [0.0, 522.0, 253.0])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the DLC key, name of the DLC, total number of floors, total square footage, total number of facility organizations, total number of supervisors, total number of supervisees, and total building heights for each DLC?

(Hints: Schema Mapping Hints:
- 'DLC key' is related to SPACE_UNIT.DLC_KEY
- 'name of the DLC' is related to FCLT_ORGANIZATION.DLC_NAME
- 'floors' is related to SPACE_FLOOR.FLOOR
- 'square footage' is related to SPACE_DETAIL.ROOM_SQUARE_FOOTAGE
- 'facility organizations' is related to SPACE_UNIT.FCLT_ORGANIZATION_KEY
- 'supervisors' is related to SPACE_SUPERVISOR_USAGE.MIT_ID
- 'supervisees' is related to SPACE_SUPERVISOR_USAGE.NUM_OF_SUPERVISEES
- 'building heights' is related to FCLT_BUILDING.BUILDING_HEIGHT

Join Information: (SPACE_UNIT.DLC_KEY = SPACE_SUPERVISOR_USAGE.DEPT_NAMES))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6E9E0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6FD60>

***** FINAL SQL QUERY *****
SELECT
  T1.DLC_KEY AS `DLC key`,
  T2.DLC_NAME AS `name of the DLC`,
  COUNT(DISTINCT T4.FLOOR) AS `total number of floors`,
  SUM(T3.ROOM_SQUARE_FOOTAGE) AS `total square footage`,
  COUNT(DISTINCT T1.FCLT_ORGANIZATION_KEY) AS `total number of facility organizations`,
  COUNT(DISTINCT T6.MIT_ID) AS `total number of supervisors`,
  SUM(T6.NUM_OF_SUPERVISEES) AS `total number of supervisees`,
  SUM(DISTINCT CAST(T5.BUILDING_HEIGHT AS DECIMAL(10, 2))) AS `total building heights`
FROM SPACE_UNIT AS T1
LEFT JOIN FCLT_ORGANIZATION AS T2
  ON T1.FCLT_ORGANIZATION_KEY = T2.FCLT_ORGANIZATION_KEY
LEFT JOIN SPACE_DETAIL AS T3
  ON T1.SPACE_UNIT_KEY = T3.SPACE_UNIT_KEY
LEFT JOIN SPACE_FLOOR AS T4
  ON T3.FLOOR_KEY = T4.FLOOR_KEY
LEFT JOIN FCLT_BUILDING AS T5
  ON T3.BUILDING_KEY = T5.FCLT_BUILDING_KEY
LEFT JOIN SPACE_SUPERVISOR_USAGE AS T6
  ON T1.DLC_KEY = T6.DEPT_NAMES
GROUP BY
  T1.DLC_KEY,
  T2.DLC_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2920, 362
TOTAL                  : 91393, 83661, 7732
AVG                    : 2856.03, 2614.41, 241.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_FLOOR
[
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR_NAME:VARCHAR2, Examples: ['0 Floor', '00 Floor', '000 Floor']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_SUPERVISOR_USAGE
[
(MIT_ID:VARCHAR2, Examples: ['932464132', '989998641', '904031741']),
(DEPT_COUNT:NUMBER, Examples: [1, 2, 4]),
(DEPT_NAMES:VARCHAR2, Examples: ['D_ACT', 'D_ACT,D_RESDEV', 'D_ADM']),
(NUM_OF_SUPERVISEES:NUMBER, Examples: [1, 4, 2]),
(SQFT:NUMBER, Examples: [0.0, 103.0, 162.0]),
(RESEARCH_VOLUME:NUMBER, Examples: [0.0, 1350070.0, 56280.0]),
(SQFT_PER_SUPERVISEE:NUMBER, Examples: [0.0, 103.0, 162.0]),
(SQFT_PER_RES_VOL:NUMBER, Examples: [0.0, -18.0, 5.0]),
(RES_VOL_PER_SQFT:NUMBER, Examples: [0.0, 522.0, 253.0])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the building component, name of the building, square footage for all rooms, total number of floors, total number of rooms, total number of facility organizations, total number of supervisors, and total number of supervisees for each building component?

(Hints: Schema Mapping Hints:
- 'building component' is related to SPACE_DETAIL.BUILDING_COMPONENT
- 'name of the building' is related to BUILDINGS.BUILDING_NAME
- 'square footage' is related to SPACE_DETAIL.ROOM_SQUARE_FOOTAGE
- 'rooms' is related to SPACE_DETAIL.BUILDING_ROOM
- 'floors' is related to SPACE_FLOOR.FLOOR
- 'facility organizations' is related to SPACE_UNIT.FCLT_ORGANIZATION_KEY
- 'supervisors' is related to SPACE_SUPERVISOR_USAGE.MIT_ID
- 'supervisees' is related to SPACE_SUPERVISOR_USAGE.NUM_OF_SUPERVISEES

Join Information: (SPACE_SUPERVISOR_USAGE.DEPT_NAMES = SPACE_UNIT.DLC_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6D330>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6D300>

***** FINAL SQL QUERY *****
```mysql
WITH ComponentDLCs AS (
  SELECT DISTINCT
    SD.BUILDING_COMPONENT,
    SU.DLC_KEY
  FROM SPACE_DETAIL AS SD
  JOIN SPACE_UNIT AS SU
    ON SD.SPACE_UNIT_KEY = SU.SPACE_UNIT_KEY
  WHERE
    SU.DLC_KEY IS NOT NULL
), SupervisorAggregates AS (
  SELECT
    CD.BUILDING_COMPONENT,
    COUNT(DISTINCT SSU.MIT_ID) AS total_supervisors,
    SUM(SSU.NUM_OF_SUPERVISEES) AS total_supervisees
  FROM ComponentDLCs AS CD
  JOIN SPACE_SUPERVISOR_USAGE AS SSU
    ON CD.DLC_KEY = SSU.DEPT_NAMES
  GROUP BY
    CD.BUILDING_COMPONENT
)
SELECT
  SD.BUILDING_COMPONENT,
  ANY_VALUE(B.BUILDING_NAME) AS building_name,
  SUM(SD.ROOM_SQUARE_FOOTAGE) AS total_room_square_footage,
  COUNT(DISTINCT SD.FLOOR_KEY) AS total_number_of_floors,
  COUNT(DISTINCT SD.BUILDING_ROOM) AS total_number_of_rooms,
  COUNT(DISTINCT SU.FCLT_ORGANIZATION_KEY) AS total_number_of_facility_organizations,
  COALESCE(SA.total_supervisors, 0) AS total_number_of_supervisors,
  COALESCE(SA.total_supervisees, 0) AS total_number_of_supervisees
FROM SPACE_DETAIL AS SD
LEFT JOIN BUILDINGS AS B
  ON SD.BUILDING_KEY = B.BUILDING_KEY
LEFT JOIN SPACE_UNIT AS SU
  ON SD.SPACE_UNIT_KEY = SU.SPACE_UNIT_KEY
LEFT JOIN SupervisorAggregates AS SA
  ON SD.BUILDING_COMPONENT = SA.BUILDING_COMPONENT
GROUP BY
  SD.BUILDING_COMPONENT;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1501, 464
TOTAL                  : 93358, 85162, 8196
AVG                    : 2829.03, 2580.67, 248.36
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
What are the building names, department names, organizations, their highest and lowest floor number, along with the total number of rooms per each building key?

(Hints: Schema Mapping Hints:
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'department names' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'organizations' is related to FAC_ORGANIZATION.ORGANIZATION
- 'floor number' is related to FAC_FLOOR.LEVEL_ID
- 'room' is related to FAC_ROOMS.FAC_ROOM_KEY
- 'building key' is related to FAC_BUILDING.FAC_BUILDING_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY), (FAC_ORGANIZATION.ORGANIZATION_KEY = FAC_ROOMS.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6C0A0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6E500>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NAME,
  T3.HR_DEPARTMENT_NAME,
  T3.ORGANIZATION,
  MIN(T4.LEVEL_ID) AS highest_floor_number,
  MAX(T4.LEVEL_ID) AS lowest_floor_number,
  COUNT(T2.FAC_ROOM_KEY) AS total_rooms_per_building_key
FROM FAC_BUILDING AS T1
INNER JOIN FAC_ROOMS AS T2
  ON T1.FAC_BUILDING_KEY = T2.BUILDING_KEY
INNER JOIN FAC_ORGANIZATION AS T3
  ON T2.ORGANIZATION_KEY = T3.ORGANIZATION_KEY
INNER JOIN FAC_FLOOR AS T4
  ON T2.FLOOR_KEY = T4.FLOOR_KEY
GROUP BY
  T1.FAC_BUILDING_KEY,
  T1.BUILDING_NAME,
  T3.HR_DEPARTMENT_NAME,
  T3.ORGANIZATION;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2876, 233
TOTAL                  : 96467, 88038, 8429
AVG                    : 2837.26, 2589.35, 247.91
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Provide the complete information for students with the first name Kevin, including their full names, email addresses, department names, department phone numbers, school names, and the total student count per department and school. If a student is associated with more than one department, list a separate row for each department.

(Hints: Schema Mapping Hints:
- 'first name' is related to MIT_STUDENT_DIRECTORY.FIRST_NAME
- 'full names' is related to MIT_STUDENT_DIRECTORY.FULL_NAME
- 'email addresses' is related to MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS
- 'department names' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'department phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'school names' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'student' is related to MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS
- 'department' is related to SIS_DEPARTMENT.DEPARTMENT_CODE
- 'school' is related to SIS_DEPARTMENT.SCHOOL_CODE

Join Information: (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6F670>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6C6D0>

***** FINAL SQL QUERY *****
SELECT
  T1.FULL_NAME,
  T1.EMAIL_ADDRESS,
  T2.DEPARTMENT_NAME,
  T3.DEPARTMENT_PHONE_NUMBER,
  T2.SCHOOL_NAME,
  COUNT(T1.EMAIL_ADDRESS) OVER (PARTITION BY T2.DEPARTMENT_NAME) AS student_count_per_department,
  COUNT(T1.EMAIL_ADDRESS) OVER (PARTITION BY T2.SCHOOL_NAME) AS student_count_per_school
FROM MIT_STUDENT_DIRECTORY AS T1
INNER JOIN SIS_DEPARTMENT AS T2
  ON T1.DEPARTMENT = T2.DEPARTMENT_CODE
INNER JOIN SIS_ADMIN_DEPARTMENT AS T3
  ON T2.DEPARTMENT_CODE = T3.SIS_ADMIN_DEPARTMENT_CODE
WHERE
  T1.FIRST_NAME = 'Kevin';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1417, 195
TOTAL                  : 98079, 89455, 8624
AVG                    : 2802.26, 2555.86, 246.40
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Show the details of rooms including the full name of the rooms, the building names, floor numbers, the organizations occupying them, name of the departments occupying them, and the percentage of the room area over the floor area and building.

(Hints: Schema Mapping Hints:
- 'full name' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'floor numbers' is related to FAC_FLOOR.FLOOR
- 'organizations' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'departments' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'room area' is related to FAC_ROOMS.AREA
- 'floor area' is related to FAC_ROOMS.AREA, FAC_ROOMS.FLOOR_KEY)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF4FFD0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4F160>

***** FINAL SQL QUERY *****
SELECT
  T1.ROOM_FULL_NAME,
  T2.BUILDING_NAME,
  T3.FLOOR,
  T4.ORGANIZATION_NAME,
  T4.HR_DEPARTMENT_NAME,
  (
    CAST(T1.AREA AS DECIMAL(10, 2)) / SUM(CAST(T1.AREA AS DECIMAL(10, 2))) OVER (PARTITION BY
      T1.BUILDING_KEY,
      T1.FLOOR_KEY
    )
  ) * 100 AS Room_Area_Percentage_Of_Floor,
  (
    CAST(T1.AREA AS DECIMAL(10, 2)) / SUM(CAST(T1.AREA AS DECIMAL(10, 2))) OVER (PARTITION BY
      T1.BUILDING_KEY
    )
  ) * 100 AS Room_Area_Percentage_Of_Building
FROM FAC_ROOMS AS T1
JOIN FAC_BUILDING AS T2
  ON T1.BUILDING_KEY = T2.FAC_BUILDING_KEY
JOIN FAC_FLOOR AS T3
  ON T1.BUILDING_KEY = T3.BUILDING_KEY AND T1.FLOOR_KEY = T3.FLOOR_KEY
LEFT JOIN FAC_ORGANIZATION AS T4
  ON T1.ORGANIZATION_KEY = T4.ORGANIZATION_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2845, 323
TOTAL                  : 101247, 92300, 8947
AVG                    : 2812.42, 2563.89, 248.53
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List all buildings with their names, building numbers, building height, street address, city, state, HR department name, assignable square footage, total and average square footage, ordered in descending order of assignable, total, and average square footage.

(Hints: Schema Mapping Hints:
- 'names' is related to BUILDINGS.BUILDING_NAME
- 'building numbers' is related to BUILDINGS.BUILDING_NUMBER
- 'building height' is related to FAC_BUILDING.BUILDING_HEIGHT
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'HR department name' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'assignable square footage' is related to BUILDINGS.BLDG_ASSIGNABLE_SQUARE_FOOTAGE
- 'square footage' is related to FAC_ROOMS.AREA

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = BUILDINGS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6DC00>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6F5B0>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NAME,
  T1.BUILDING_NUMBER,
  T2.BUILDING_HEIGHT,
  T1.BUILDING_STREET_ADDRESS,
  T3.CITY,
  T3.STATE,
  GROUP_CONCAT(DISTINCT T5.HR_DEPARTMENT_NAME ORDER BY T5.HR_DEPARTMENT_NAME SEPARATOR ', ') AS HR_DEPARTMENT_NAME,
  T1.BLDG_ASSIGNABLE_SQUARE_FOOTAGE,
  SUM(CAST(T4.AREA AS DECIMAL(10, 2))) AS TotalSquareFootage,
  AVG(CAST(T4.AREA AS DECIMAL(10, 2))) AS AverageSquareFootage
FROM BUILDINGS AS T1
LEFT JOIN FAC_BUILDING AS T2
  ON T1.BUILDING_KEY = T2.FAC_BUILDING_KEY
LEFT JOIN FAC_BUILDING_ADDRESS AS T3
  ON T1.BUILDING_KEY = T3.BUILDING_KEY
  AND T3.ADDRESS_PURPOSE = 'STREET'
LEFT JOIN FAC_ROOMS AS T4
  ON T1.BUILDING_KEY = T4.BUILDING_KEY
LEFT JOIN FAC_ORGANIZATION AS T5
  ON T4.ORGANIZATION_KEY = T5.ORGANIZATION_KEY
GROUP BY
  T1.BUILDING_KEY,
  T1.BUILDING_NAME,
  T1.BUILDING_NUMBER,
  T2.BUILDING_HEIGHT,
  T1.BUILDING_STREET_ADDRESS,
  T3.CITY,
  T3.STATE,
  T1.BLDG_ASSIGNABLE_SQUARE_FOOTAGE
ORDER BY
  T1.BLDG_ASSIGNABLE_SQUARE_FOOTAGE DESC,
  TotalSquareFootage DESC,
  AverageSquareFootage DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3179, 428
TOTAL                  : 104854, 95479, 9375
AVG                    : 2833.89, 2580.51, 253.38
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: CIS_HASS_ATTRIBUTE
[
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HA,HS']),
(DESCRIPTION_ON_FORM:VARCHAR2, Examples: ['HASS Elective', '1/2 HASS Social Sciences', 'HASS-D, Category 1']),
(DESCRIPTION_IN_BULLETIN:VARCHAR2, Examples: ['HASS-E', 'HASS-S/2', 'HASS-D 1']),
(CIS_ATTRIBUTE_GROUP:VARCHAR2, Examples: ['H', 'G']),
(CIS_ATTRIBUTE_GROUP_NOTE:VARCHAR2, Examples: ['HASS_ATTRIBUTE, for students entering in Fall 2010 or later', 'GIR_ATTRIBUTE, for students entering prior to Fall 2010']),
(ICON_GIF_NAME:VARCHAR2, Examples: ['hassT.gif', 'hass1.gif', 'hass2.gif']),
(ICON_HEIGHT:VARCHAR2, Examples: ['16']),
(ICON_WIDTH:VARCHAR2, Examples: ['16', '35']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['05-MAR-10', '22-FEB-12', '26-APR-10']),
(LAST_UPDATE_USER:VARCHAR2, Examples: ['PETECHOI']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each term code, list the term description, attribute desciption, department name, school name, and the number of subjects in the area of humanities, arts and social sciences.

(Hints: Schema Mapping Hints:
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'attribute desciption' is related to COURSE_CATALOG_SUBJECT_OFFERED.HASS_ATTRIBUTE_DESC
- 'department name' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'area of humanities, arts and social studies' is related to CIS_HASS_ATTRIBUTE.CIS_ATTRIBUTE_GROUP

Join Information: (CIS_HASS_ATTRIBUTE.HASS_ATTRIBUTE = COURSE_CATALOG_SUBJECT_OFFERED.HASS_ATTRIBUTE), (COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE), (ACADEMIC_TERMS_ALL.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6E110>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6F4F0>

***** FINAL SQL QUERY *****
SELECT
  T1.TERM_CODE,
  T1.TERM_DESCRIPTION,
  T3.HASS_ATTRIBUTE_DESC,
  T4.DEPARTMENT_NAME,
  T4.SCHOOL_NAME,
  COUNT(T3.SUBJECT_ID) AS num_subjects
FROM ACADEMIC_TERMS_ALL AS T1
INNER JOIN COURSE_CATALOG_SUBJECT_OFFERED AS T3
  ON T1.TERM_CODE = T3.TERM_CODE
INNER JOIN SIS_DEPARTMENT AS T4
  ON T3.DEPARTMENT_CODE = T4.DEPARTMENT_CODE
INNER JOIN CIS_HASS_ATTRIBUTE AS T2
  ON T3.HASS_ATTRIBUTE = T2.HASS_ATTRIBUTE
WHERE
  T2.CIS_ATTRIBUTE_GROUP = 'H'
GROUP BY
  T1.TERM_CODE,
  T1.TERM_DESCRIPTION,
  T3.HASS_ATTRIBUTE_DESC,
  T4.DEPARTMENT_NAME,
  T4.SCHOOL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4221, 236
TOTAL                  : 109311, 99700, 9611
AVG                    : 2876.61, 2623.68, 252.92
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]

### Question ###
For the 2023 Fall term, what are the unique term descriptions, subject titles along with their prerequisites, total number of types of subjects per term code, instructor of this course, and the number of types of courses ever taught by the instructor?

(Hints: Schema Mapping Hints:
- '2023 Fall term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'term descriptions' is related to ACADEMIC_TERMS.TERM_DESCRIPTION
- 'subject titles' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'prerequisites' is related to COURSE_CATALOG_SUBJECT_OFFERED.PREREQUISITES
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'term code' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'instructor' is related to COURSE_CATALOG_SUBJECT_OFFERED.FALL_INSTRUCTORS
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6C970>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEE590>

***** FINAL SQL QUERY *****
```mysql
WITH InstructorCourseCounts AS (
    SELECT
        FALL_INSTRUCTORS,
        COUNT(DISTINCT SUBJECT_ID) AS num_courses_ever_taught
    FROM
        COURSE_CATALOG_SUBJECT_OFFERED
    WHERE
        FALL_INSTRUCTORS IS NOT NULL AND FALL_INSTRUCTORS != ''
    GROUP BY
        FALL_INSTRUCTORS
)
SELECT
    AT.TERM_DESCRIPTION,
    CCSO.SUBJECT_TITLE,
    CCSO.PREREQUISITES,
    (
        SELECT
            COUNT(DISTINCT SUBJECT_ID)
        FROM
            COURSE_CATALOG_SUBJECT_OFFERED
        WHERE
            TERM_CODE = '2023FA'
    ) AS total_types_of_subjects_in_2023_fall,
    CCSO.FALL_INSTRUCTORS,
    ICC.num_courses_ever_taught
FROM
    ACADEMIC_TERMS AS AT
JOIN
    COURSE_CATALOG_SUBJECT_OFFERED AS CCSO
ON
    AT.TERM_CODE = CCSO.TERM_CODE
LEFT JOIN
    InstructorCourseCounts AS ICC
ON
    CCSO.FALL_INSTRUCTORS = ICC.FALL_INSTRUCTORS
WHERE
    CCSO.TERM_CODE = '2023FA';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3546, 301
TOTAL                  : 113158, 103246, 9912
AVG                    : 2901.49, 2647.33, 254.15
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: CIP
[
(PROGRAM_CODE:VARCHAR2, Examples: ['010000', '010100', '010101']),
(PROGRAM_TITLE:VARCHAR2, Examples: ['Agriculture, General', 'Agricultural Business and Management', 'Agricultural Business and Management, General']),
(CATEGORY_CODE:VARCHAR2, Examples: ['1', '2', '3']),
(CATEGORY_TITLE:VARCHAR2, Examples: ['AGRICULTURAL/ANIMAL/PLANT/VETERINARY SCIENCE AND RELATED FIELDS', 'AGRICULTURAL BUSINESS AND PRODUCTION', 'AGRICULTURE, AGRICULTURE OPERATIONS, AND RELATED SCIENCES']),
(FOUR_DIGIT_CODE:VARCHAR2, Examples: ['0100', '0101', '0102']),
(FOUR_DIGIT_TITLE:VARCHAR2, Examples: ['Agriculture, General', 'Agricultural Business and Management', 'Agricultural Mechanization']),
(NOTE:VARCHAR2, Examples: ['(2020) No substantive changes ', '(2020) No substantive changes- CIP text change ', 'New in 2020']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['17-MAY-23', '11-JUN-14']),
(VERSION:VARCHAR2, Examples: ['2020', '1990', '2010'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the category title, version, department name, school name, total number of courses for each course level, and the total number of degree-granting courses for each CIP category code?

(Hints: Schema Mapping Hints:
- 'category title' is related to CIP.CATEGORY_TITLE
- 'version' is related to CIP.VERSION
- 'department name' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'degree-granting courses' is related to SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING
- 'CIP category code' is related to CIP.CATEGORY_CODE

Join Information: (SIS_COURSE_DESCRIPTION.CIP_PROGRAM_CODE = CIP.PROGRAM_CODE), (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6E920>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4FEE0>

***** FINAL SQL QUERY *****
SELECT
  T1.CATEGORY_TITLE,
  T1.VERSION,
  T3.DEPARTMENT_NAME,
  T3.SCHOOL_NAME,
  SUM(CASE WHEN T2.COURSE_LEVEL = 'G' THEN 1 ELSE 0 END) AS Graduate_Courses,
  SUM(CASE WHEN T2.COURSE_LEVEL = 'U' THEN 1 ELSE 0 END) AS Undergraduate_Courses,
  SUM(CASE WHEN T2.IS_DEGREE_GRANTING = 'Y' THEN 1 ELSE 0 END) AS Degree_Granting_Courses
FROM CIP AS T1
INNER JOIN SIS_COURSE_DESCRIPTION AS T2
  ON T1.PROGRAM_CODE = T2.CIP_PROGRAM_CODE
INNER JOIN SIS_DEPARTMENT AS T3
  ON T2.DEPARTMENT = T3.DEPARTMENT_CODE
GROUP BY
  T1.CATEGORY_CODE,
  T1.CATEGORY_TITLE,
  T1.VERSION,
  T3.DEPARTMENT_NAME,
  T3.SCHOOL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1723, 237
TOTAL                  : 115118, 104969, 10149
AVG                    : 2877.95, 2624.22, 253.72
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]

### Question ###
What are the unique titles of subjects offered in the fall term along with their instructor names, instructor emails, and the total number of types of subjects per instructor?

(Hints: Schema Mapping Hints:
- 'titles' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'fall term' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'instructor names' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'instructor emails' is related to EMPLOYEE_DIRECTORY.EMAIL_ADDRESS

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6C940>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6D8D0>

***** FINAL SQL QUERY *****
SELECT DISTINCT
  T1.SUBJECT_TITLE,
  T2.FULL_NAME,
  T2.EMAIL_ADDRESS,
  COUNT(DISTINCT T1.SUBJECT_ID) OVER (PARTITION BY T1.RESPONSIBLE_FACULTY_MIT_ID) AS total_subjects_per_instructor
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
JOIN EMPLOYEE_DIRECTORY AS T2
  ON T1.RESPONSIBLE_FACULTY_MIT_ID = T2.MIT_ID
WHERE
  T1.IS_OFFERED_FALL_TERM = 'Y';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4084, 141
TOTAL                  : 119343, 109053, 10290
AVG                    : 2910.80, 2659.83, 250.98
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Retrieve the titles of subjects offered in the summer term along with their descriptions, responsible faculty names, email address, building name, room name, floor level, building street address, and the total number of types of courses per departmnet.

(Hints: Schema Mapping Hints:
- 'titles of subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'summer term' is related to ACADEMIC_TERMS.TERM_CODE
- 'descriptions' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_DESCRIPTION
- 'responsible faculty names' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_NAME
- 'email address' is related to EMPLOYEE_DIRECTORY.EMAIL_ADDRESS
- 'building name' is related to BUILDINGS.BUILDING_NAME
- 'room name' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'floor level' is related to FAC_FLOOR.LEVEL_ID
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'department' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID), (ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE), (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FAC_ROOMS.FAC_ROOM_KEY), (FAC_ROOMS.FLOOR_KEY = FAC_FLOOR.FLOOR_KEY), (FAC_ROOMS.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF4F9A0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6D720>

***** FINAL SQL QUERY *****
SELECT
  T1.SUBJECT_TITLE,
  T1.SUBJECT_DESCRIPTION,
  T1.RESPONSIBLE_FACULTY_NAME,
  T3.EMAIL_ADDRESS,
  T5.BUILDING_NAME,
  T4.ROOM_FULL_NAME,
  T6.LEVEL_ID AS floor_level,
  T5.BUILDING_STREET_ADDRESS,
  COUNT(DISTINCT T1.SUBJECT_ID) OVER (PARTITION BY T1.DEPARTMENT_CODE) AS total_course_types_per_department
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
INNER JOIN ACADEMIC_TERMS AS T2
  ON T1.TERM_CODE = T2.TERM_CODE
LEFT JOIN EMPLOYEE_DIRECTORY AS T3
  ON T1.RESPONSIBLE_FACULTY_MIT_ID = T3.MIT_ID
LEFT JOIN FAC_ROOMS AS T4
  ON T1.MEET_PLACE = T4.FAC_ROOM_KEY
LEFT JOIN BUILDINGS AS T5
  ON T4.BUILDING_KEY = T5.BUILDING_KEY
LEFT JOIN FAC_FLOOR AS T6
  ON T4.FLOOR_KEY = T6.FLOOR_KEY
WHERE
  T2.TERM_DESCRIPTION LIKE '%Summer Term%';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5969, 303
TOTAL                  : 125615, 115022, 10593
AVG                    : 2990.83, 2738.62, 252.21
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each distinct mailing list containing more than 1000 people and with a name starting with A (case insensitive), provide its name, whether it is a mailing list, whether it is a moira group, whether it is a NFS group, the owner of the mailing list, and the number of people in the list.

(Hints: Schema Mapping Hints:
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'mailing list' is related to MOIRA_LIST.IS_MOIRA_MAILING_LIST
- 'moira group' is related to MOIRA_LIST.IS_MOIRA_GROUP
- 'NFS group' is related to MOIRA_LIST.IS_NFS_GROUP
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'people' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6CAC0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6D780>

***** FINAL SQL QUERY *****
SELECT
  T1.MOIRA_LIST_NAME AS name,
  T1.IS_MOIRA_MAILING_LIST AS 'whether it is a mailing list',
  T1.IS_MOIRA_GROUP AS 'whether it is a moira group',
  T1.IS_NFS_GROUP AS 'whether it is a NFS group',
  T3.OWNER AS 'the owner of the mailing list',
  COUNT(DISTINCT T2.MOIRA_LIST_MEMBER) AS 'the number of people in the list'
FROM MOIRA_LIST AS T1
INNER JOIN MOIRA_LIST_DETAIL AS T2
  ON T1.MOIRA_LIST_KEY = T2.MOIRA_LIST_KEY
INNER JOIN MOIRA_LIST_OWNER AS T3
  ON T2.MOIRA_LIST_OWNER_KEY = T3.MOIRA_LIST_OWNER_KEY
WHERE
  LOWER(T1.MOIRA_LIST_NAME) LIKE 'a%'
GROUP BY
  T1.MOIRA_LIST_KEY,
  T1.MOIRA_LIST_NAME,
  T1.IS_MOIRA_MAILING_LIST,
  T1.IS_MOIRA_GROUP,
  T1.IS_NFS_GROUP,
  T3.OWNER
HAVING
  COUNT(DISTINCT T2.MOIRA_LIST_MEMBER) > 1000;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1035, 332
TOTAL                  : 126982, 116057, 10925
AVG                    : 2953.07, 2699.00, 254.07
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]

### Question ###
What is the total number of library materials, the minimum and maximum publication years, and the total number of materials status for each course name?

(Hints: Schema Mapping Hints:
- 'library materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_SYSTEM_NUMBER
- 'publication years' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'materials status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'course name' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCCDC0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCCB80>

***** FINAL SQL QUERY *****
SELECT
  T1.COURSE_NAME,
  COUNT(DISTINCT T3.CATALOG_SYSTEM_NUMBER) AS total_library_materials,
  MIN(T3.CATALOG_YEAR) AS min_publication_year,
  MAX(T3.CATALOG_YEAR) AS max_publication_year,
  COUNT(T4.LIBRARY_MATERIAL_STATUS) AS total_materials_status
FROM LIBRARY_COURSE_INSTRUCTOR AS T1
JOIN LIBRARY_RESERVE_MATRL_DETAIL AS T2
  ON T1.LIBRARY_COURSE_INSTRUCTOR_KEY = T2.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN LIBRARY_RESERVE_CATALOG AS T3
  ON T2.LIBRARY_RESERVE_CATALOG_KEY = T3.LIBRARY_RESERVE_CATALOG_KEY
JOIN LIBRARY_MATERIAL_STATUS AS T4
  ON T2.LIBRARY_MATERIAL_STATUS_KEY = T4.LIBRARY_MATERIAL_STATUS_KEY
GROUP BY
  T1.COURSE_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1673, 236
TOTAL                  : 128891, 117730, 11161
AVG                    : 2929.34, 2675.68, 253.66
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List building names, their height, street address, city, state, postal code, their gross and assignable square footage, the smallest and largest floor level and the total area of all rooms for each building key.

(Hints: Schema Mapping Hints:
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'height' is related to FAC_BUILDING.BUILDING_HEIGHT
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'postal code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'gross square footage' is related to FAC_BUILDING.EXT_GROSS_AREA
- 'assignable square footage' is related to FAC_BUILDING.ASSIGNABLE_AREA
- 'floor level' is related to FAC_FLOOR.LEVEL_ID
- 'area' is related to FAC_ROOMS.AREA
- 'building key' is related to FAC_BUILDING.FAC_BUILDING_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_FLOOR.BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = BUILDINGS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCE410>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6DF60>

***** FINAL SQL QUERY *****
WITH FloorStats AS (
    SELECT
        BUILDING_KEY,
        MIN(CAST(LEVEL_ID AS UNSIGNED)) AS smallest_floor_level,
        MAX(CAST(LEVEL_ID AS UNSIGNED)) AS largest_floor_level
    FROM FAC_FLOOR
    GROUP BY BUILDING_KEY
),
RoomAreaStats AS (
    SELECT
        BUILDING_KEY,
        SUM(CAST(AREA AS DECIMAL(10, 2))) AS total_room_area
    FROM FAC_ROOMS
    GROUP BY BUILDING_KEY
)
SELECT
    fb.BUILDING_NAME AS `building names`,
    fb.BUILDING_HEIGHT AS `height`,
    b.BUILDING_STREET_ADDRESS AS `street address`,
    fba.CITY AS `city`,
    fba.STATE AS `state`,
    fba.POSTAL_CODE AS `postal code`,
    CAST(fb.EXT_GROSS_AREA AS DECIMAL(15, 2)) AS `gross square footage`,
    CAST(fb.ASSIGNABLE_AREA AS DECIMAL(15, 2)) AS `assignable square footage`,
    fs.smallest_floor_level AS `smallest floor level`,
    fs.largest_floor_level AS `largest floor level`,
    ras.total_room_area AS `total area of all rooms`
FROM
    FAC_BUILDING AS fb
LEFT JOIN
    BUILDINGS AS b
    ON fb.FAC_BUILDING_KEY = b.BUILDING_KEY
LEFT JOIN
    FAC_BUILDING_ADDRESS AS fba
    ON fb.FAC_BUILDING_KEY = fba.BUILDING_KEY AND fba.ADDRESS_PURPOSE = 'STREET'
LEFT JOIN
    FloorStats AS fs
    ON fb.FAC_BUILDING_KEY = fs.BUILDING_KEY
LEFT JOIN
    RoomAreaStats AS ras
    ON fb.FAC_BUILDING_KEY = ras.BUILDING_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3079, 443
TOTAL                  : 132413, 120809, 11604
AVG                    : 2942.51, 2684.64, 257.87
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_FLOOR
[
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR_NAME:VARCHAR2, Examples: ['0 Floor', '00 Floor', '000 Floor']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_USAGE
[
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(SPACE_USAGE:VARCHAR2, Examples: ['ARC ROOM', 'TST ROOM', 'RSRC RM']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For building 36, list all space units, their floor and building name, building street address, their space usage, and the number of organizations and space units on the same building and floor.

(Hints: Schema Mapping Hints:
- 'building 36' is related to BUILDINGS.BUILDING_NUMBER
- 'space units' is related to SPACE_UNIT.SPACE_UNIT
- 'floor' is related to SPACE_FLOOR.FLOOR
- 'building name' is related to BUILDINGS.BUILDING_NAME
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'space usage' is related to SPACE_USAGE.SPACE_USAGE
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY

Join Information: (SPACE_DETAIL.SPACE_UNIT_KEY = SPACE_UNIT.SPACE_UNIT_KEY), (SPACE_USAGE.SPACE_USAGE_KEY = SPACE_DETAIL.SPACE_USAGE_KEY), (SPACE_DETAIL.FLOOR_KEY = SPACE_FLOOR.FLOOR_KEY), (SPACE_DETAIL.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = SPACE_UNIT.FCLT_ORGANIZATION_KEY), (BUILDINGS.BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6C130>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6C550>

***** FINAL SQL QUERY *****
SELECT
  T3.SPACE_UNIT,
  T5.FLOOR,
  T1.BUILDING_NAME,
  T1.BUILDING_STREET_ADDRESS,
  T6.SPACE_USAGE,
  COUNT(DISTINCT T4.FCLT_ORGANIZATION_KEY) OVER (PARTITION BY T1.BUILDING_KEY, T5.FLOOR_KEY) AS num_organizations_on_floor,
  COUNT(DISTINCT T3.SPACE_UNIT_KEY) OVER (PARTITION BY T1.BUILDING_KEY, T5.FLOOR_KEY) AS num_space_units_on_floor
FROM BUILDINGS AS T1
JOIN SPACE_DETAIL AS T2
  ON T1.BUILDING_KEY = T2.BUILDING_KEY
JOIN SPACE_UNIT AS T3
  ON T2.SPACE_UNIT_KEY = T3.SPACE_UNIT_KEY
JOIN FCLT_ORGANIZATION AS T4
  ON T3.FCLT_ORGANIZATION_KEY = T4.FCLT_ORGANIZATION_KEY
JOIN SPACE_FLOOR AS T5
  ON T2.FLOOR_KEY = T5.FLOOR_KEY
JOIN SPACE_USAGE AS T6
  ON T2.SPACE_USAGE_KEY = T6.SPACE_USAGE_KEY
WHERE
  T1.BUILDING_NUMBER = '36';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2353, 318
TOTAL                  : 135084, 123162, 11922
AVG                    : 2936.61, 2677.43, 259.17
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the material status, term description, total number of courses and materials, occurences in departments and school, and the total number of instructors for each library material status code and term code?

(Hints: Schema Mapping Hints:
- 'material status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'courses' is related to LIBRARY_SUBJECT_OFFERED.COURSE_NUMBER
- 'materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_SYSTEM_NUMBER
- 'departments' is related to LIBRARY_SUBJECT_OFFERED.OFFER_DEPT_CODE
- 'school' is related to LIBRARY_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'instructors' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'library material status code' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_CODE
- 'term code' is related to LIBRARY_SUBJECT_OFFERED.TERM_CODE

Join Information: (LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (ACADEMIC_TERMS_ALL.TERM_CODE = LIBRARY_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCCEE0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEE740>

***** FINAL SQL QUERY *****
SELECT
  T1.LIBRARY_MATERIAL_STATUS,
  T6.TERM_DESCRIPTION,
  T1.LIBRARY_MATERIAL_STATUS_CODE,
  T4.TERM_CODE,
  COUNT(DISTINCT T4.COURSE_NUMBER) AS total_number_of_courses,
  COUNT(DISTINCT T3.CATALOG_SYSTEM_NUMBER) AS total_number_of_materials,
  COUNT(DISTINCT T4.OFFER_DEPT_CODE) AS occurrences_in_departments,
  COUNT(DISTINCT T4.OFFER_SCHOOL_NAME) AS occurrences_in_school,
  COUNT(DISTINCT T2.INSTRUCTOR_NAME) AS total_number_of_instructors
FROM LIBRARY_RESERVE_MATRL_DETAIL AS T5
JOIN LIBRARY_MATERIAL_STATUS AS T1
  ON T5.LIBRARY_MATERIAL_STATUS_KEY = T1.LIBRARY_MATERIAL_STATUS_KEY
JOIN LIBRARY_SUBJECT_OFFERED AS T4
  ON T5.LIBRARY_SUBJECT_OFFERED_KEY = T4.LIBRARY_SUBJECT_OFFERED_KEY
JOIN LIBRARY_COURSE_INSTRUCTOR AS T2
  ON T5.LIBRARY_COURSE_INSTRUCTOR_KEY = T2.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN LIBRARY_RESERVE_CATALOG AS T3
  ON T5.LIBRARY_RESERVE_CATALOG_KEY = T3.LIBRARY_RESERVE_CATALOG_KEY
JOIN ACADEMIC_TERMS_ALL AS T6
  ON T4.TERM_CODE = T6.TERM_CODE
GROUP BY
  T1.LIBRARY_MATERIAL_STATUS_CODE,
  T4.TERM_CODE,
  T1.LIBRARY_MATERIAL_STATUS,
  T6.TERM_DESCRIPTION;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3305, 408
TOTAL                  : 138797, 126467, 12330
AVG                    : 2953.13, 2690.79, 262.34
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List the building names, names of HR departments occupying them, the total gross square footage, the total and average assignable square footage, and the built year per building key.

(Hints: Schema Mapping Hints:
- 'building names' is related to BUILDINGS.BUILDING_NAME
- 'names of HR departments' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'gross square footage' is related to BUILDINGS.BLDG_GROSS_SQUARE_FOOTAGE
- 'assignable square footage' is related to BUILDINGS.BLDG_ASSIGNABLE_SQUARE_FOOTAGE
- 'built year' is related to FAC_BUILDING.DATE_BUILT
- 'building key' is related to BUILDINGS.BUILDING_KEY

Join Information: (BUILDINGS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCD600>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCD240>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NAME,
  GROUP_CONCAT(DISTINCT T4.HR_DEPARTMENT_NAME ORDER BY T4.HR_DEPARTMENT_NAME SEPARATOR ', ') AS HR_Department_Names,
  MAX(T1.BLDG_GROSS_SQUARE_FOOTAGE) AS Total_Gross_Square_Footage,
  MAX(T1.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS Total_Assignable_Square_Footage,
  MAX(T1.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS Average_Assignable_Square_Footage,
  YEAR(STR_TO_DATE(T2.DATE_BUILT, '%m/%d/%Y')) AS Built_Year
FROM BUILDINGS AS T1
JOIN FAC_BUILDING AS T2
  ON T1.BUILDING_KEY = T2.FAC_BUILDING_KEY
LEFT JOIN FAC_ROOMS AS T3
  ON T1.BUILDING_KEY = T3.BUILDING_KEY
LEFT JOIN FAC_ORGANIZATION AS T4
  ON T3.ORGANIZATION_KEY = T4.ORGANIZATION_KEY
GROUP BY
  T1.BUILDING_KEY,
  T1.BUILDING_NAME,
  T2.DATE_BUILT
ORDER BY
  T1.BUILDING_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2769, 307
TOTAL                  : 141873, 129236, 12637
AVG                    : 2955.69, 2692.42, 263.27
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For email lists with names starting with C (case insensitive) and containing faculty who teach courses in the summer in financial aid years after 2001, provide the name of the list, the number of people in the list, and the number of faculty in the list.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'faculty' is related to EMPLOYEE_DIRECTORY.MIT_ID
- 'courses in the summer' is related to ACADEMIC_TERMS.TERM_CODE
- 'financial aid years' is related to ACADEMIC_TERMS.FINANCIAL_AID_YEAR
- 'people' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (EMPLOYEE_DIRECTORY.MIT_ID = COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID), (ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCEDD0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6D930>

***** FINAL SQL QUERY *****
WITH SummerFaculty AS (
  SELECT DISTINCT
      CCSO.RESPONSIBLE_FACULTY_MIT_ID AS mit_id
  FROM
      COURSE_CATALOG_SUBJECT_OFFERED AS CCSO
  JOIN
      ACADEMIC_TERMS AS AT ON CCSO.TERM_CODE = AT.TERM_CODE
  WHERE
      CCSO.IS_OFFERED_SUMMER_TERM = 'Y'
      AND AT.FINANCIAL_AID_YEAR > '2001'
      AND CCSO.RESPONSIBLE_FACULTY_MIT_ID IS NOT NULL
)
SELECT
  ML.MOIRA_LIST_NAME,
  COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER) AS number_of_people_in_list,
  COUNT(DISTINCT SF.mit_id) AS number_of_faculty_in_list
FROM
  MOIRA_LIST AS ML
JOIN
  MOIRA_LIST_DETAIL AS MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
LEFT JOIN
  SummerFaculty AS SF ON MLD.MOIRA_LIST_MEMBER_MIT_ID = SF.mit_id
WHERE
  LOWER(ML.MOIRA_LIST_NAME) LIKE 'c%'
GROUP BY
  ML.MOIRA_LIST_NAME
HAVING
  COUNT(DISTINCT SF.mit_id) > 0;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4701, 325
TOTAL                  : 146899, 133937, 12962
AVG                    : 2997.94, 2733.41, 264.53
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the mailing lists with the largest number of members and the least number of members, including their names, owners, public status, hidden status, and number of members in the list. If a mailing list has multiple owners, create a separate entry for each owner. Similarly, if multiple lists share the minimum or maximum member count, include all those lists.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'owners' is related to MOIRA_LIST_OWNER.OWNER
- 'public status' is related to MOIRA_LIST.IS_PUBLIC
- 'hidden status' is related to MOIRA_LIST.IS_HIDDEN
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF4F460>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6D510>

***** FINAL SQL QUERY *****
WITH ListMemberCounts AS (
  SELECT
    MOIRA_LIST_KEY,
    COUNT(MOIRA_LIST_MEMBER) AS member_count
  FROM MOIRA_LIST_DETAIL
  GROUP BY
    MOIRA_LIST_KEY
), ListOwners AS (
  SELECT DISTINCT
    mld.MOIRA_LIST_KEY,
    mlo.OWNER
  FROM MOIRA_LIST_DETAIL AS mld
  JOIN MOIRA_LIST_OWNER AS mlo
    ON mld.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY
), MailingListDetailsWithOwnersAndCounts AS (
  SELECT
    ml.MOIRA_LIST_NAME,
    lo.OWNER,
    ml.IS_PUBLIC,
    ml.IS_HIDDEN,
    lmc.member_count
  FROM MOIRA_LIST AS ml
  JOIN ListMemberCounts AS lmc
    ON ml.MOIRA_LIST_KEY = lmc.MOIRA_LIST_KEY
  JOIN ListOwners AS lo
    ON ml.MOIRA_LIST_KEY = lo.MOIRA_LIST_KEY
  WHERE
    ml.IS_MOIRA_MAILING_LIST = 'Y'
), MinMaxMemberCounts AS (
  SELECT
    MIN(member_count) AS min_val,
    MAX(member_count) AS max_val
  FROM MailingListDetailsWithOwnersAndCounts
)
SELECT
  mld.MOIRA_LIST_NAME,
  mld.OWNER,
  mld.IS_PUBLIC,
  mld.IS_HIDDEN,
  mld.member_count
FROM MailingListDetailsWithOwnersAndCounts AS mld, MinMaxMemberCounts AS mmc
WHERE
  mld.member_count = mmc.min_val OR mld.member_count = mmc.max_val
ORDER BY
  mld.MOIRA_LIST_NAME,
  mld.OWNER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1009, 456
TOTAL                  : 148364, 134946, 13418
AVG                    : 2967.28, 2698.92, 268.36
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For each course instructor in the 'keeper-zephyr' mailing list, provide the name of mailing lists they subscribe to, instructor name, earliest and latest publication years, and total number of enrolled students.

(Hints: Schema Mapping Hints:
- ''keeper-zephyr' mailing list' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'name of mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'instructor name' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'publication years' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME = SE_PERSON.FULL_NAME))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCED10>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6E410>

***** FINAL SQL QUERY *****
```mysql
WITH KeeperZephyrMembers AS (
  SELECT
    mld.MOIRA_LIST_MEMBER_FULL_NAME AS instructor_full_name
  FROM MOIRA_LIST AS ml
  JOIN MOIRA_LIST_DETAIL AS mld
    ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
  WHERE
    ml.MOIRA_LIST_NAME = 'keeper-zephyr'
), AggregatedInstructorDetails AS (
  SELECT
    kzm.instructor_full_name,
    MIN(CAST(lrc.CATALOG_YEAR AS UNSIGNED)) AS earliest_publication_year,
    MAX(CAST(lrc.CATALOG_YEAR AS UNSIGNED)) AS latest_publication_year,
    SUM(lso.NUM_ENROLLED_STUDENTS) AS total_enrolled_students
  FROM KeeperZephyrMembers AS kzm
  JOIN LIBRARY_COURSE_INSTRUCTOR AS lci
    ON kzm.instructor_full_name = lci.INSTRUCTOR_NAME
  JOIN LIBRARY_RESERVE_MATRL_DETAIL AS lrmd
    ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY
  JOIN LIBRARY_RESERVE_CATALOG AS lrc
    ON lrmd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY
  JOIN LIBRARY_SUBJECT_OFFERED AS lso
    ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY
  GROUP BY
    kzm.instructor_full_name
)
SELECT
  GROUP_CONCAT(DISTINCT ml.MOIRA_LIST_NAME ORDER BY ml.MOIRA_LIST_NAME SEPARATOR ', ') AS mailing_list_names,
  aid.instructor_full_name AS instructor_name,
  aid.earliest_publication_year,
  aid.latest_publication_year,
  aid.total_enrolled_students
FROM AggregatedInstructorDetails AS aid
JOIN MOIRA_LIST_DETAIL AS mld
  ON aid.instructor_full_name = mld.MOIRA_LIST_MEMBER_FULL_NAME
JOIN MOIRA_LIST AS ml
  ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY
GROUP BY
  aid.instructor_full_name,
  aid.earliest_publication_year,
  aid.latest_publication_year,
  aid.total_enrolled_students;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3081, 581
TOTAL                  : 152026, 138027, 13999
AVG                    : 2980.90, 2706.41, 274.49
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the building with the most floors, list the building name and the names of the mailing lists staring with a (case insensitive) that the building employees with kerberos starting with c (case insensitive) subscribe to.

(Hints: Schema Mapping Hints:
- 'floors' is related to FAC_FLOOR.LEVEL_ID
- 'building name' is related to FAC_BUILDING.BUILDING_NAME
- 'names of the mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'kerberos' is related to EMPLOYEE_DIRECTORY.KRB_NAME

Join Information: (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY), (FAC_ROOMS.FAC_ROOM_KEY = EMPLOYEE_DIRECTORY.OFFICE_LOCATION), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = EMPLOYEE_DIRECTORY.KRB_NAME), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCEE00>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCDE10>

***** FINAL SQL QUERY *****
SELECT DISTINCT
  T2.BUILDING_NAME,
  T5.MOIRA_LIST_NAME
FROM EMPLOYEE_DIRECTORY AS T1
JOIN FAC_ROOMS AS T3
  ON T1.OFFICE_LOCATION = T3.FAC_ROOM_KEY
JOIN FAC_BUILDING AS T2
  ON T3.BUILDING_KEY = T2.FAC_BUILDING_KEY
JOIN MOIRA_LIST_DETAIL AS T4
  ON T1.KRB_NAME = T4.MOIRA_LIST_MEMBER
JOIN MOIRA_LIST AS T5
  ON T4.MOIRA_LIST_KEY = T5.MOIRA_LIST_KEY
WHERE
  T2.FAC_BUILDING_KEY = (
    SELECT
      BUILDING_KEY
    FROM FAC_FLOOR
    GROUP BY
      BUILDING_KEY
    ORDER BY
      COUNT(DISTINCT LEVEL_ID) DESC
    LIMIT 1
  ) AND LOWER(T1.KRB_NAME) LIKE 'c%' AND LOWER(T5.MOIRA_LIST_NAME) LIKE 'a%';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3566, 253
TOTAL                  : 155845, 141593, 14252
AVG                    : 2997.02, 2722.94, 274.08
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the email list with name 'date-destiny', list the name of the list, department name, the number of students from the Management department, and the percentage of students who are from the Management department, rounded to two decimal places.

(Hints: Schema Mapping Hints:
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'students' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'Management department' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME

Join Information: (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (SE_PERSON.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCE740>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCD990>

***** FINAL SQL QUERY *****
SELECT
  ML.MOIRA_LIST_NAME,
  'Management' AS department_name,
  COUNT(DISTINCT CASE WHEN SAD.SIS_ADMIN_DEPARTMENT_NAME = 'Management' THEN MLD.MOIRA_LIST_MEMBER END) AS num_management_students,
  ROUND(
    COUNT(DISTINCT CASE WHEN SAD.SIS_ADMIN_DEPARTMENT_NAME = 'Management' THEN MLD.MOIRA_LIST_MEMBER END) * 100.0 / NULLIF(COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER), 0),
    2
  ) AS percentage_management_students
FROM MOIRA_LIST AS ML
JOIN MOIRA_LIST_DETAIL AS MLD
  ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
JOIN SE_PERSON AS SP
  ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME
JOIN MIT_STUDENT_DIRECTORY AS MSD
  ON SP.FULL_NAME = MSD.FULL_NAME
JOIN SIS_ADMIN_DEPARTMENT AS SAD
  ON MSD.DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE
WHERE
  ML.MOIRA_LIST_NAME = 'date-destiny'
GROUP BY
  ML.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1743, 296
TOTAL                  : 157884, 143336, 14548
AVG                    : 2978.94, 2704.45, 274.49
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For faculty who are responsible for courses in 2023 fall term, list the name of mailing lists with ten members that they subscribe to, the number of faculty in these lists, and the number of courses associated with those faculty.

(Hints: Schema Mapping Hints:
- 'faculty' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID
- '2023 fall term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'name of mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE

Join Information: (employee_directory.MIT_ID = COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID), (employee_directory.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCE950>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6C670>

***** FINAL SQL QUERY *****
SELECT
  ML.MOIRA_LIST_NAME,
  COUNT(DISTINCT F23FA.faculty_mit_id) AS num_faculty_in_list,
  COUNT(DISTINCT CCS.SUBJECT_TITLE) AS num_courses_associated
FROM MOIRA_LIST AS ML
JOIN (
  SELECT
    MLD_SUB.MOIRA_LIST_KEY
  FROM MOIRA_LIST_DETAIL AS MLD_SUB
  JOIN MOIRA_LIST AS ML_SUB
    ON MLD_SUB.MOIRA_LIST_KEY = ML_SUB.MOIRA_LIST_KEY
  WHERE
    ML_SUB.IS_MOIRA_MAILING_LIST = 'Y'
  GROUP BY
    MLD_SUB.MOIRA_LIST_KEY
  HAVING
    COUNT(DISTINCT MLD_SUB.MOIRA_LIST_MEMBER) = 10
) AS TenMemberLists
  ON ML.MOIRA_LIST_KEY = TenMemberLists.MOIRA_LIST_KEY
JOIN MOIRA_LIST_DETAIL AS MLD
  ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
JOIN (
  SELECT DISTINCT
    CCSO_SUB.RESPONSIBLE_FACULTY_MIT_ID AS faculty_mit_id,
    ED_SUB.KRB_NAME AS faculty_krb_name
  FROM COURSE_CATALOG_SUBJECT_OFFERED AS CCSO_SUB
  JOIN EMPLOYEE_DIRECTORY AS ED_SUB
    ON CCSO_SUB.RESPONSIBLE_FACULTY_MIT_ID = ED_SUB.MIT_ID
  WHERE
    CCSO_SUB.TERM_CODE = '2023FA'
) AS F23FA
  ON MLD.MOIRA_LIST_MEMBER = F23FA.faculty_krb_name
JOIN COURSE_CATALOG_SUBJECT_OFFERED AS CCS
  ON F23FA.faculty_mit_id = CCS.RESPONSIBLE_FACULTY_MIT_ID
WHERE
  CCS.TERM_CODE = '2023FA'
GROUP BY
  ML.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3840, 489
TOTAL                  : 162213, 147176, 15037
AVG                    : 3003.94, 2725.48, 278.46
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Regarding the mailing list about duo users, provide the number of students in this list, and the number of departments and schools associated with these students.

(Hints: Schema Mapping Hints:
- 'duo users' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'students' is related to SE_PERSON.MIT_ID
- 'departments' is related to SIS_DEPARTMENT.DEPARTMENT_CODE
- 'schools' is related to SIS_DEPARTMENT.SCHOOL_CODE

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCEB00>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCE110>

***** FINAL SQL QUERY *****
SELECT
  COUNT(DISTINCT T3.MIT_ID) AS number_of_students,
  COUNT(DISTINCT T4.DEPARTMENT) AS number_of_departments,
  COUNT(DISTINCT T5.SCHOOL_CODE) AS number_of_schools
FROM MOIRA_LIST AS T1
JOIN MOIRA_LIST_DETAIL AS T2
  ON T1.MOIRA_LIST_KEY = T2.MOIRA_LIST_KEY
JOIN SE_PERSON AS T3
  ON T2.MOIRA_LIST_MEMBER_MIT_ID = T3.MIT_ID
JOIN MIT_STUDENT_DIRECTORY AS T4
  ON T3.FULL_NAME = T4.FULL_NAME
JOIN SIS_DEPARTMENT AS T5
  ON T4.DEPARTMENT = T5.DEPARTMENT_CODE
WHERE
  T1.MOIRA_LIST_NAME = 'duo users' AND T3.EMPLOYEE_TYPE = 'Student';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1870, 217
TOTAL                  : 164300, 149046, 15254
AVG                    : 2987.27, 2709.93, 277.35
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For each mailing list with a name beginning with R (case insensitive), and that Professor Ayden Hopkins is subscribed to, list its name, description, owner, number of people in the list, and number of tenured faculty in the list.

(Hints: Schema Mapping Hints:
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'Professor Ayden Hopkins' is related to SE_PERSON.FULL_NAME
- 'description' is related to MOIRA_LIST.MOIRA_LIST_DESCRIPTION
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'people' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'tenured faculty' is related to SE_PERSON.PAYROLL_RANK, MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCEC80>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCEC50>

***** FINAL SQL QUERY *****
SELECT
  ML.MOIRA_LIST_NAME,
  ML.MOIRA_LIST_DESCRIPTION,
  GROUP_CONCAT(DISTINCT MLO.OWNER ORDER BY MLO.OWNER SEPARATOR ', ') AS owner,
  COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER) AS number_of_people,
  COUNT(DISTINCT CASE WHEN SP.PAYROLL_RANK LIKE '%Professor%' OR SP.PAYROLL_RANK LIKE '%Associate Professor%' THEN SP.MIT_ID ELSE NULL END) AS number_of_tenured_faculty
FROM MOIRA_LIST AS ML
JOIN MOIRA_LIST_DETAIL AS MLD
  ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
LEFT JOIN MOIRA_LIST_OWNER AS MLO
  ON MLD.MOIRA_LIST_OWNER_KEY = MLO.MOIRA_LIST_OWNER_KEY
LEFT JOIN SE_PERSON AS SP
  ON MLD.MOIRA_LIST_MEMBER_MIT_ID = SP.MIT_ID
WHERE
  LOWER(ML.MOIRA_LIST_NAME) LIKE 'r%' AND ML.IS_MOIRA_MAILING_LIST = 'Y' AND ML.MOIRA_LIST_KEY IN (
    SELECT DISTINCT
      MLD_AH.MOIRA_LIST_KEY
    FROM MOIRA_LIST_DETAIL AS MLD_AH
    JOIN SE_PERSON AS SP_AH
      ON MLD_AH.MOIRA_LIST_MEMBER_MIT_ID = SP_AH.MIT_ID
    WHERE
      SP_AH.FULL_NAME = 'Hopkins, Ayden'
  )
GROUP BY
  ML.MOIRA_LIST_KEY,
  ML.MOIRA_LIST_NAME,
  ML.MOIRA_LIST_DESCRIPTION
ORDER BY
  ML.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1328, 428
TOTAL                  : 166056, 150374, 15682
AVG                    : 2965.29, 2685.25, 280.04
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the total number of library reserve materials, the minimum and maximum publication years, and the total number of enrolled students for each course instructor?

(Hints: Schema Mapping Hints:
- 'library reserve materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_SYSTEM_NUMBER
- 'publication years' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'course instructor' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCE890>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6C100>

***** FINAL SQL QUERY *****
WITH InstructorSubjectEnrollment AS (
  SELECT
    T1.INSTRUCTOR_NAME,
    SUM(T4.NUM_ENROLLED_STUDENTS) AS total_enrolled_students
  FROM LIBRARY_COURSE_INSTRUCTOR AS T1
  JOIN (
    SELECT DISTINCT
      LIBRARY_COURSE_INSTRUCTOR_KEY,
      LIBRARY_SUBJECT_OFFERED_KEY
    FROM LIBRARY_RESERVE_MATRL_DETAIL
  ) AS T2_Distinct
    ON T1.LIBRARY_COURSE_INSTRUCTOR_KEY = T2_Distinct.LIBRARY_COURSE_INSTRUCTOR_KEY
  JOIN LIBRARY_SUBJECT_OFFERED AS T4
    ON T2_Distinct.LIBRARY_SUBJECT_OFFERED_KEY = T4.LIBRARY_SUBJECT_OFFERED_KEY
  GROUP BY
    T1.INSTRUCTOR_NAME
)
SELECT
  T1.INSTRUCTOR_NAME,
  COUNT(DISTINCT T3.CATALOG_SYSTEM_NUMBER) AS total_materials,
  MIN(CAST(T3.CATALOG_YEAR AS UNSIGNED)) AS min_publication_year,
  MAX(CAST(T3.CATALOG_YEAR AS UNSIGNED)) AS max_publication_year,
  ISE.total_enrolled_students
FROM LIBRARY_COURSE_INSTRUCTOR AS T1
JOIN LIBRARY_RESERVE_MATRL_DETAIL AS T2
  ON T1.LIBRARY_COURSE_INSTRUCTOR_KEY = T2.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN LIBRARY_RESERVE_CATALOG AS T3
  ON T2.LIBRARY_RESERVE_CATALOG_KEY = T3.LIBRARY_RESERVE_CATALOG_KEY
JOIN InstructorSubjectEnrollment AS ISE
  ON T1.INSTRUCTOR_NAME = ISE.INSTRUCTOR_NAME
GROUP BY
  T1.INSTRUCTOR_NAME,
  ISE.total_enrolled_students;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2230, 430
TOTAL                  : 168716, 152604, 16112
AVG                    : 2959.93, 2677.26, 282.67
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Among the mailing lists subscribed by people with physical offices in building 24, provide the name of the most subscribed mailing list and the total number of subscribers.

(Hints: Schema Mapping Hints:
- 'physical offices in building 24' is related to EMPLOYEE_DIRECTORY.OFFICE_LOCATION
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subscribers' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (EMPLOYEE_DIRECTORY.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCE980>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCD750>

***** FINAL SQL QUERY *****
SELECT
  T1.MOIRA_LIST_NAME,
  COUNT(DISTINCT T3.MIT_ID) AS TotalSubscribers
FROM MOIRA_LIST AS T1
INNER JOIN MOIRA_LIST_DETAIL AS T2
  ON T1.MOIRA_LIST_KEY = T2.MOIRA_LIST_KEY
INNER JOIN EMPLOYEE_DIRECTORY AS T3
  ON T2.MOIRA_LIST_MEMBER = T3.KRB_NAME
WHERE
  T3.OFFICE_LOCATION LIKE '24%'
GROUP BY
  T1.MOIRA_LIST_NAME
ORDER BY
  TotalSubscribers DESC
LIMIT 1;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1476, 153
TOTAL                  : 170345, 154080, 16265
AVG                    : 2936.98, 2656.55, 280.43
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For students with last names starting with H who are subscribed to mailing list 'beacon-date-date', list the names of the students, the phone numbers of departments they belong to, and the size of the mailing list 'beacon-date-date' that they are subscribed to.

(Hints: Schema Mapping Hints:
- 'last names' is related to MIT_STUDENT_DIRECTORY.LAST_NAME
- 'mailing list 'beacon-date-date'' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'names' is related to MIT_STUDENT_DIRECTORY.FULL_NAME
- 'phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'size of the mailing list' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE), (MIT_STUDENT_DIRECTORY.FULL_NAME = SE_PERSON.FULL_NAME), (SE_PERSON.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCED40>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCCAF0>

***** FINAL SQL QUERY *****
SELECT
  T1.FULL_NAME,
  T5.DEPARTMENT_PHONE_NUMBER,
  (
    SELECT
        COUNT(DISTINCT T_MLD_sub.MOIRA_LIST_MEMBER)
    FROM
        MOIRA_LIST AS T_ML_sub
    INNER JOIN
        MOIRA_LIST_DETAIL AS T_MLD_sub
    ON
        T_ML_sub.MOIRA_LIST_KEY = T_MLD_sub.MOIRA_LIST_KEY
    WHERE
        T_ML_sub.MOIRA_LIST_NAME = 'beacon-date-date'
  ) AS mailing_list_size
FROM
  MIT_STUDENT_DIRECTORY AS T1
INNER JOIN
  SE_PERSON AS T2
ON
  T1.FULL_NAME = T2.FULL_NAME
INNER JOIN
  MOIRA_LIST_DETAIL AS T3
ON
  T2.KRB_NAME = T3.MOIRA_LIST_MEMBER
INNER JOIN
  MOIRA_LIST AS T4
ON
  T3.MOIRA_LIST_KEY = T4.MOIRA_LIST_KEY
INNER JOIN
  SIS_DEPARTMENT AS T6
ON
  T1.DEPARTMENT = T6.DEPARTMENT_CODE
INNER JOIN
  SIS_ADMIN_DEPARTMENT AS T5
ON
  T6.DEPARTMENT_CODE = T5.SIS_ADMIN_DEPARTMENT_CODE
WHERE
  T1.LAST_NAME LIKE 'H%' AND T4.MOIRA_LIST_NAME = 'beacon-date-date';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2261, 356
TOTAL                  : 172962, 156341, 16621
AVG                    : 2931.56, 2649.85, 281.71
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
Give the count of mailing lists with names starting with B that include members from the Electrical Engineering and Computer Science department, along with the name of the list starting with B that have the highest number of members from that department and the corresponding member count.

(Hints: Schema Mapping Hints:
- 'mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'members' is related to SE_PERSON.MIT_ID
- 'Electrical Engineering and Computer Science department' is related to SE_PERSON.ORGANIZATION

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = SE_PERSON.KRB_NAME))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCF400>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCC520>

***** FINAL SQL QUERY *****
WITH EECS_Member_Counts AS (
    SELECT
        ML.MOIRA_LIST_NAME,
        COUNT(DISTINCT SP.KRB_NAME) AS department_member_count
    FROM
        MOIRA_LIST AS ML
    JOIN
        MOIRA_LIST_DETAIL AS MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
    JOIN
        SE_PERSON AS SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME
    WHERE
        ML.IS_MOIRA_MAILING_LIST = 'Y'
        AND ML.MOIRA_LIST_NAME LIKE 'B%'
        AND SP.ORGANIZATION = 'Electrical Engineering and Computer Science'
    GROUP BY
        ML.MOIRA_LIST_NAME
)
SELECT
    (SELECT COUNT(*) FROM EECS_Member_Counts) AS total_b_eecs_lists,
    (SELECT MOIRA_LIST_NAME FROM EECS_Member_Counts ORDER BY department_member_count DESC, MOIRA_LIST_NAME ASC LIMIT 1) AS highest_member_list_name,
    (SELECT department_member_count FROM EECS_Member_Counts ORDER BY department_member_count DESC, MOIRA_LIST_NAME ASC LIMIT 1) AS highest_member_count;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1094, 300
TOTAL                  : 174356, 157435, 16921
AVG                    : 2905.93, 2623.92, 282.02
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For email lists subscribed by either support staff or faculty, list its name, the number of subscribers that are support staff, the number of subscribers that are faculty, as well as its active status.

(Hints: Schema Mapping Hints:
- 'support staff or faculty' is related to SE_PERSON.EMPLOYEE_TYPE
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subscribers' is related to SE_PERSON.EMPLOYEE_TYPE
- 'active status' is related to MOIRA_LIST.IS_ACTIVE

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCF040>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCF010>

***** FINAL SQL QUERY *****
SELECT
  T1.MOIRA_LIST_NAME,
  COUNT(DISTINCT CASE WHEN T3.EMPLOYEE_TYPE = 'Support Staff' THEN T3.MIT_ID ELSE NULL END) AS num_support_staff_subscribers,
  COUNT(DISTINCT CASE WHEN T3.EMPLOYEE_TYPE = 'Faculty' THEN T3.MIT_ID ELSE NULL END) AS num_faculty_subscribers,
  T1.IS_ACTIVE
FROM MOIRA_LIST AS T1
INNER JOIN MOIRA_LIST_DETAIL AS T2
  ON T1.MOIRA_LIST_KEY = T2.MOIRA_LIST_KEY
INNER JOIN SE_PERSON AS T3
  ON T2.MOIRA_LIST_MEMBER_MIT_ID = T3.MIT_ID
WHERE
  T1.IS_MOIRA_MAILING_LIST = 'Y' AND T3.EMPLOYEE_TYPE IN ('Support Staff', 'Faculty')
GROUP BY
  T1.MOIRA_LIST_KEY,
  T1.MOIRA_LIST_NAME,
  T1.IS_ACTIVE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1058, 253
TOTAL                  : 175667, 158493, 17174
AVG                    : 2879.79, 2598.25, 281.54
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the 'ocean-apple' mailing list, identify the department with the highest student count. Provide the department name, phone number, and the total number of students subscribed to the mailing list from that department. If multiple departments have the same highest count, list each one separately.

(Hints: Schema Mapping Hints:
- ''ocean-apple' mailing list' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'phone number' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'students' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = SE_PERSON.KRB_NAME), (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF6DD80>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6F370>

***** FINAL SQL QUERY *****
WITH DepartmentStudentCounts AS (
  SELECT
    T5.SIS_ADMIN_DEPARTMENT_NAME,
    T5.DEPARTMENT_PHONE_NUMBER,
    COUNT(DISTINCT T4.FULL_NAME) AS student_count
  FROM MOIRA_LIST AS T1
  JOIN MOIRA_LIST_DETAIL AS T2
    ON T1.MOIRA_LIST_KEY = T2.MOIRA_LIST_KEY
  JOIN SE_PERSON AS T3
    ON T2.MOIRA_LIST_MEMBER = T3.KRB_NAME
  JOIN MIT_STUDENT_DIRECTORY AS T4
    ON T3.FULL_NAME = T4.FULL_NAME
  JOIN SIS_ADMIN_DEPARTMENT AS T5
    ON T4.DEPARTMENT = T5.SIS_ADMIN_DEPARTMENT_CODE
  WHERE
    T1.MOIRA_LIST_NAME = 'ocean-apple'
  GROUP BY
    T5.SIS_ADMIN_DEPARTMENT_NAME,
    T5.DEPARTMENT_PHONE_NUMBER
)
SELECT
  DSC.SIS_ADMIN_DEPARTMENT_NAME,
  DSC.DEPARTMENT_PHONE_NUMBER,
  DSC.student_count
FROM DepartmentStudentCounts AS DSC
WHERE
  DSC.student_count = (
    SELECT
      MAX(student_count)
    FROM DepartmentStudentCounts
  );

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1749, 304
TOTAL                  : 177720, 160242, 17478
AVG                    : 2866.45, 2584.55, 281.90
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the 'kangaroo-inspire-yearn' email list, for each department present in the list, list the department name, the number of students in that department, and its percentage relative to the students in the mailing list.

(Hints: Schema Mapping Hints:
- ''kangaroo-inspire-yearn' email list' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'students' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (SE_PERSON.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCF340>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCF310>

***** FINAL SQL QUERY *****
WITH ListMembers AS (
    SELECT DISTINCT T2.MOIRA_LIST_MEMBER
    FROM MOIRA_LIST AS T1
    JOIN MOIRA_LIST_DETAIL AS T2
        ON T1.MOIRA_LIST_KEY = T2.MOIRA_LIST_KEY
    WHERE T1.MOIRA_LIST_NAME = 'kangaroo-inspire-yearn'
),
StudentsInList AS (
    SELECT DISTINCT
        T4.DEPARTMENT AS student_department_code,
        T4.FULL_NAME
    FROM ListMembers AS lm
    JOIN SE_PERSON AS T3
        ON lm.MOIRA_LIST_MEMBER = T3.KRB_NAME
    JOIN MIT_STUDENT_DIRECTORY AS T4
        ON T3.FULL_NAME = T4.FULL_NAME
),
TotalStudentsInList AS (
    SELECT COUNT(FULL_NAME) AS total_count
    FROM StudentsInList
)
SELECT
    T5.SIS_ADMIN_DEPARTMENT_NAME AS department_name,
    COUNT(sil.FULL_NAME) AS number_of_students,
    CAST(COUNT(sil.FULL_NAME) * 100.0 / (SELECT total_count FROM TotalStudentsInList) AS DECIMAL(5, 2)) AS percentage_of_students
FROM StudentsInList AS sil
JOIN SIS_ADMIN_DEPARTMENT AS T5
    ON sil.student_department_code = T5.SIS_ADMIN_DEPARTMENT_CODE
GROUP BY T5.SIS_ADMIN_DEPARTMENT_NAME
ORDER BY department_name;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1728, 356
TOTAL                  : 179804, 161970, 17834
AVG                    : 2854.03, 2570.95, 283.08
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the email lists subscribed by faculty members with last names begin with Y, list the names of the lists, the total number of subjects managed by faculty in those mailing lists, and the number of such faculty in the lists.

(Hints: Schema Mapping Hints:
- 'last names' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_NAME
- 'names of the lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'faculty' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_NAME

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCEE90>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF4E4D0>

***** FINAL SQL QUERY *****
WITH Y_Faculty_MIT_IDs AS (
    SELECT MIT_ID
    FROM EMPLOYEE_DIRECTORY
    WHERE LAST_NAME LIKE 'Y%'
),
Target_Moira_Lists AS (
    SELECT DISTINCT
        MLD.MOIRA_LIST_KEY,
        ML.MOIRA_LIST_NAME
    FROM MOIRA_LIST_DETAIL AS MLD
    JOIN Y_Faculty_MIT_IDs AS YFI
        ON MLD.MOIRA_LIST_MEMBER_MIT_ID = YFI.MIT_ID
    JOIN MOIRA_LIST AS ML
        ON MLD.MOIRA_LIST_KEY = ML.MOIRA_LIST_KEY
    WHERE ML.IS_MOIRA_MAILING_LIST = 'Y'
),
All_Faculty_In_Target_Lists AS (
    SELECT
        TML.MOIRA_LIST_KEY,
        TML.MOIRA_LIST_NAME,
        MLD.MOIRA_LIST_MEMBER_MIT_ID AS Faculty_MIT_ID
    FROM Target_Moira_Lists AS TML
    JOIN MOIRA_LIST_DETAIL AS MLD
        ON TML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
    WHERE MLD.MOIRA_LIST_MEMBER_MIT_ID IS NOT NULL
)
SELECT
    AFTL.MOIRA_LIST_NAME,
    COUNT(DISTINCT CCSO.SUBJECT_ID) AS total_subjects_managed_by_faculty_in_list,
    COUNT(DISTINCT AFTL.Faculty_MIT_ID) AS number_of_faculty_in_list
FROM All_Faculty_In_Target_Lists AS AFTL
LEFT JOIN COURSE_CATALOG_SUBJECT_OFFERED AS CCSO
    ON AFTL.Faculty_MIT_ID = CCSO.RESPONSIBLE_FACULTY_MIT_ID
GROUP BY
    AFTL.MOIRA_LIST_NAME
ORDER BY
    AFTL.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3763, 460
TOTAL                  : 184027, 165733, 18294
AVG                    : 2875.42, 2589.58, 285.84
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED_SUMMARY
[
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese II', 'Eng 10A: British Writers', 'Biology of Cancer Cell']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0035, HAA.0036, HAA.0042, HAA.006', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0001, HAA.0002, HAA.0003, HAA.0004, HAA.0005, HAA.0006, HAA.0007, HAA.0008, HAA.0009, HAA.0010, HAA.0011, HAA.001']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Graduate program', 'Higher level graduate program']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'Architecture and Planning']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(TOTAL_UNITS:NUMBER, Examples: [15, 1, 24]),
(LECTURE_UNITS:NUMBER, Examples: [0, 6, 12]),
(LAB_UNITS:NUMBER, Examples: [15, 1, 24]),
(PREPARATION_UNITS:NUMBER, Examples: [0, 9, 8]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [195, 159, 170]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA'])
]

### Question ###
Group subjects by cluster type, department offering the subject, and the school name. For each group, list the cluster type, name of the department, school name, whether the department grants degrees, total number of subjects, total enrollment, and average enrollment. Exclude clusters or schools with no student data.

(Hints: Schema Mapping Hints:
- 'cluster type' is related to SUBJECT_OFFERED_SUMMARY.CLUSTER_TYPE
- 'name of the department' is related to SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'whether the department grants degrees' is related to SIS_DEPARTMENT.IS_DEGREE_GRANTING
- 'subjects' is related to SUBJECT_OFFERED_SUMMARY.SUBJECT_ID
- 'enrollment' is related to SUBJECT_OFFERED_SUMMARY.NUM_ENROLLED_STUDENTS

Join Information: (SUBJECT_OFFERED_SUMMARY.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCF880>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCC1C0>

***** FINAL SQL QUERY *****
SELECT
  T1.CLUSTER_TYPE,
  T1.OFFER_DEPT_NAME,
  T2.SCHOOL_NAME,
  T2.IS_DEGREE_GRANTING,
  COUNT(DISTINCT T1.SUBJECT_ID) AS total_subjects,
  SUM(T1.NUM_ENROLLED_STUDENTS) AS total_enrollment,
  AVG(T1.NUM_ENROLLED_STUDENTS) AS average_enrollment
FROM SUBJECT_OFFERED_SUMMARY AS T1
INNER JOIN SIS_DEPARTMENT AS T2
  ON T1.OFFER_DEPT_CODE = T2.DEPARTMENT_CODE
GROUP BY
  T1.CLUSTER_TYPE,
  T1.OFFER_DEPT_NAME,
  T2.SCHOOL_NAME,
  T2.IS_DEGREE_GRANTING
HAVING
  SUM(T1.NUM_ENROLLED_STUDENTS) > 0;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2756, 221
TOTAL                  : 187004, 168489, 18515
AVG                    : 2876.98, 2592.14, 284.85
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: CIS_COURSE_CATALOG
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2003', '2002', '2007']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['097', '098', '090']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['N', 'Y', 'S']),
(DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:DATE, Examples: ['Electrical Eng & Computer Sci', 'Architecture', 'Chemistry']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1991FA', '1995FA', '1989FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['Y', 'N']),
(LECTURE_UNITS:VARCHAR2, Examples: [0, 3, 1]),
(LAB_UNITS:VARCHAR2, Examples: [0, 12, 4]),
(PREPARATION_UNITS:VARCHAR2, Examples: [0, 9, 5]),
(TOTAL_UNITS:VARCHAR2, Examples: [0, 12, 6]),
(DESIGN_UNITS:VARCHAR2, Examples: [0, 6, 8]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['R', 'J', 'N']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Can be repeated for credit', 'Continuing and Repeatable', 'Not repeatable for credit']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', 'H-LEVEL Grad Credit (except for Course 18 students)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['HD1', 'HE', 'HD5']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS-D, Category 1', 'HASS Elective', 'HASS-D, Category 5']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:NUMBER, Examples: ['RESH', 'NTRN', 'COOP']),
(TUITION_ATTRIBUTE_DESC:NUMBER, Examples: ['Pre-thesis Research Subject', 'Internship', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:NUMBER, Examples: ['WRT2', 'WRT1']),
(WRITE_REQ_ATTRIBUTE_DESC:NUMBER, Examples: ['Writing Requirement, Phase II', 'Writing Requirement, Phase I']),
(SUPERVISOR_ATTRIBUTE:NUMBER, Examples: ['UROP', 'THG', 'THU']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['UROP subject', 'Grad Thesis', 'Undergrad Thesis']),
(PREREQUISITES:VARCHAR2, Examples: ['Permission of instructor', '10.213', '12.120 and 12.103, or permission of instructor']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Crystal structures of mantle and core minerals, elastic and thermodynamic properties of materials at high pressure-temperature,', 'Investigates social conflict and distributional disputes in the public sector. While theoretical aspects of conflict are consid', 'Presents a framework for current landscape ecological theory, structured to encourage application in physical planning of lands']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.285J, 11.482J', '3.57J', '1.232J, 15.054J, 16.71J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE', '1.EPW, 3.EPW, 6.EPW, 10.EPW, 16.EPW, 20.EPW, 22.EPW', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['2.729J, EC.729J', 'EC.718J, WGS.277J', '21A.136J, 21G.026J']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['15.511, 15.515', '15.024', '15.414']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(STATUS_CHANGE:VARCHAR2, Examples: ['(2016: New number: 21G.110)', '(2016: New number: 21G.113)', '(2016: New number: 21G.142)']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['02-SEP-01', '12-JAN-06', '16-MAY-05']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.005']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HS', 'HA', 'HH']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Social Sciences', 'HASS Arts', 'HASS Humanities']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'Second Half Term Subject', 'First Half Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Asia', 'United States of America']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['China', 'Brazil|Uruguay|Vietnam|Russia|Australia', 'United States of America']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m2c.html', 'http://student.mit.edu/catalog/m3b.html'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED_SUMMARY
[
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese II', 'Eng 10A: British Writers', 'Biology of Cancer Cell']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0035, HAA.0036, HAA.0042, HAA.006', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0001, HAA.0002, HAA.0003, HAA.0004, HAA.0005, HAA.0006, HAA.0007, HAA.0008, HAA.0009, HAA.0010, HAA.0011, HAA.001']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Graduate program', 'Higher level graduate program']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'Architecture and Planning']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(TOTAL_UNITS:NUMBER, Examples: [15, 1, 24]),
(LECTURE_UNITS:NUMBER, Examples: [0, 6, 12]),
(LAB_UNITS:NUMBER, Examples: [15, 1, 24]),
(PREPARATION_UNITS:NUMBER, Examples: [0, 9, 8]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [195, 159, 170]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA'])
]

### Question ###
For Political Science courses with HASS attributes, for each attribute, list the name and description of the attribute, the number of unique subjects, average units, the total enrollment, the number of departments that grant degrees, and the subject code description.

(Hints: Schema Mapping Hints:
- 'Political Science' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'name' is related to CIS_COURSE_CATALOG.HASS_ATTRIBUTE
- 'description' is related to CIS_COURSE_CATALOG.HASS_ATTRIBUTE_DESC
- 'subjects' is related to CIS_COURSE_CATALOG.SUBJECT_ID
- 'units' is related to CIS_COURSE_CATALOG.TOTAL_UNITS
- 'enrollment' is related to SUBJECT_OFFERED_SUMMARY.NUM_ENROLLED_STUDENTS
- 'departments that grant degrees' is related to SIS_DEPARTMENT.IS_DEGREE_GRANTING
- 'subject code description' is related to SIS_SUBJECT_CODE.SUBJECT_CODE_DESC

Join Information: (CIS_COURSE_CATALOG.SUBJECT_CODE = SIS_SUBJECT_CODE.SUBJECT_CODE), (SUBJECT_OFFERED_SUMMARY.SUBJECT_ID = CIS_COURSE_CATALOG.SUBJECT_ID), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_SUBJECT_CODE.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCF640>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCF610>

***** FINAL SQL QUERY *****
SELECT
  T1.HASS_ATTRIBUTE,
  T1.HASS_ATTRIBUTE_DESC,
  COUNT(DISTINCT T1.SUBJECT_ID) AS num_unique_subjects,
  AVG(CAST(T1.TOTAL_UNITS AS DECIMAL)) AS average_units,
  SUM(T2.NUM_ENROLLED_STUDENTS) AS total_enrollment,
  COUNT(DISTINCT CASE WHEN T4.IS_DEGREE_GRANTING = 'Y' THEN T4.DEPARTMENT_CODE ELSE NULL END) AS num_degree_granting_departments,
  T3.SUBJECT_CODE_DESC
FROM CIS_COURSE_CATALOG AS T1
INNER JOIN SUBJECT_OFFERED_SUMMARY AS T2
  ON T1.SUBJECT_ID = T2.SUBJECT_ID
INNER JOIN SIS_SUBJECT_CODE AS T3
  ON T1.SUBJECT_CODE = T3.SUBJECT_CODE
INNER JOIN SIS_DEPARTMENT AS T4
  ON T3.DEPARTMENT_CODE = T4.DEPARTMENT_CODE
WHERE
  T4.DEPARTMENT_NAME = 'Political Science' AND T1.HASS_ATTRIBUTE IS NOT NULL
GROUP BY
  T1.HASS_ATTRIBUTE,
  T1.HASS_ATTRIBUTE_DESC,
  T3.SUBJECT_CODE_DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4275, 298
TOTAL                  : 191577, 172764, 18813
AVG                    : 2902.68, 2617.64, 285.05
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each mailing list, list its owner, owner type, the member visibility ('Public Members' if public, and 'Hidden Members' otherwise), and the number of members of this type of visibility. For each owner and owner type, include a grand total for all members in the format of (owner, owner type, null, total members).

(Hints: Schema Mapping Hints:
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'owner type' is related to MOIRA_LIST_OWNER.OWNER_TYPE
- 'member visibility' is related to MOIRA_LIST.IS_PUBLIC
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCCA60>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCEBC0>

***** FINAL SQL QUERY *****
WITH MemberVisibility AS (
    SELECT
        mlo.OWNER,
        mlo.OWNER_TYPE,
        CASE
            WHEN ml.IS_PUBLIC = 'Y' THEN 'Public Members'
            WHEN ml.IS_PUBLIC = 'N' THEN 'Hidden Members'
        END AS visibility_type,
        mld.MOIRA_LIST_MEMBER AS member_id
    FROM
        MOIRA_LIST_DETAIL AS mld
    JOIN
        MOIRA_LIST AS ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY
    JOIN
        MOIRA_LIST_OWNER AS mlo ON mld.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY
)
SELECT
    mv.OWNER,
    mv.OWNER_TYPE,
    CASE
        WHEN GROUPING(mv.visibility_type) = 1 THEN NULL
        ELSE mv.visibility_type
    END AS `member_visibility`,
    COUNT(mv.member_id) AS `number_of_members`
FROM
    MemberVisibility AS mv
GROUP BY
    mv.OWNER,
    mv.OWNER_TYPE,
    mv.visibility_type WITH ROLLUP
HAVING
    GROUPING(mv.OWNER) = 0
    AND GROUPING(mv.OWNER_TYPE) = 0
ORDER BY
    mv.OWNER,
    mv.OWNER_TYPE,
    `member_visibility` IS NULL DESC, `member_visibility`;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 991, 356
TOTAL                  : 192924, 173755, 19169
AVG                    : 2879.46, 2593.36, 286.10
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
Group classes that take place in buildings at MIT by the building name and course level. For each group, provide the name of the building, the course level ('Graduate' or 'Undergraduate'), the total number of unique courses of such level, and total instructors for these courses. Include subtotals for each building and course level and a grand total across all buildings and course levels.

(Hints: Schema Mapping Hints:
- 'buildings at MIT' is related to FAC_BUILDING.SITE
- 'name of the building' is related to FAC_BUILDING.BUILDING_NAME
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'courses' is related to SUBJECT_OFFERED_SUMMARY.SUBJECT_ID
- 'instructors' is related to SUBJECT_OFFERED_SUMMARY.RESPONSIBLE_FACULTY_NAME

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = SUBJECT_OFFERED.MEET_PLACE), (SUBJECT_OFFERED.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE), (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCF910>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6F460>

***** FINAL SQL QUERY *****
SELECT
  COALESCE(FB.BUILDING_NAME, 'Grand Total') AS Building_Name,
  CASE
    WHEN SCD.COURSE_LEVEL = 'G' THEN 'Graduate'
    WHEN SCD.COURSE_LEVEL = 'U' THEN 'Undergraduate'
    WHEN SCD.COURSE_LEVEL IS NULL AND FB.BUILDING_NAME IS NOT NULL THEN 'Subtotal'
    WHEN SCD.COURSE_LEVEL IS NULL AND FB.BUILDING_NAME IS NULL THEN 'Grand Total'
    ELSE NULL
  END AS Course_Level,
  COUNT(DISTINCT SO.SUBJECT_ID) AS Total_Unique_Courses,
  COUNT(DISTINCT SO.RESPONSIBLE_FACULTY_NAME) AS Total_Instructors
FROM FAC_BUILDING AS FB
JOIN SUBJECT_OFFERED AS SO
  ON FB.FAC_BUILDING_KEY = SO.MEET_PLACE
JOIN SIS_COURSE_DESCRIPTION AS SCD
  ON SO.COURSE_NUMBER = SCD.COURSE
WHERE
  FB.SITE = 'MIT' AND SCD.COURSE_LEVEL IN ('G', 'U')
GROUP BY
  FB.BUILDING_NAME,
  SCD.COURSE_LEVEL WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4244, 270
TOTAL                  : 197438, 177999, 19439
AVG                    : 2903.50, 2617.63, 285.87
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each TIP material status, list the total number of unique materials associated with the status, the total number of records associated with the status, and the total student enrollment associated with the status. Any material status with null values should be displayed as 'No material status'. Additionally, include a grand total across all material status (the material status for this row should be displayed as 'Grand Total').

(Hints: Schema Mapping Hints:
- 'TIP material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'materials' is related to TIP_MATERIAL.TITLE
- 'records' is related to TIP_DETAIL.RECORD_COUNT
- 'student enrollment' is related to TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY), (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY), (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCDC90>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCD3C0>

***** FINAL SQL QUERY *****
SELECT
  IF(GROUPING(tms.TIP_MATERIAL_STATUS), 'Grand Total', IFNULL(tms.TIP_MATERIAL_STATUS, 'No material status')) AS `Material Status`,
  COUNT(DISTINCT tm.TITLE) AS `Total Unique Materials`,
  SUM(td.RECORD_COUNT) AS `Total Records`,
  SUM(tso.NUM_ENROLLED_STUDENTS) AS `Total Student Enrollment`
FROM TIP_DETAIL AS td
LEFT JOIN TIP_MATERIAL_STATUS AS tms
  ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY
LEFT JOIN TIP_MATERIAL AS tm
  ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY
LEFT JOIN TIP_SUBJECT_OFFERED AS tso
  ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY
GROUP BY
  tms.TIP_MATERIAL_STATUS WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1856, 225
TOTAL                  : 199519, 179855, 19664
AVG                    : 2891.58, 2606.59, 284.99
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Consider only books cataloged on or after 2000. For each library material status and department, list the material status, department name, number of associated catalog items, and the total number of enrolled students in courses using those materials. Include subtotals for each material status and a grand total across all status (the corresponding status field is 'Grand Total').

(Hints: Schema Mapping Hints:
- 'cataloged on or after 2000' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'material status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'department name' is related to SIS_SUBJECT_CODE.DEPARTMENT_NAME
- 'catalog items' is related to LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_SUBJECT_OFFERED.COURSE_NUMBER = SIS_SUBJECT_CODE.COURSE_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCEEC0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCDA50>

***** FINAL SQL QUERY *****
SELECT
  CASE
    WHEN GROUPING(T1.LIBRARY_MATERIAL_STATUS) = 1
    THEN 'Grand Total'
    ELSE T1.LIBRARY_MATERIAL_STATUS
  END AS material_status,
  T5.DEPARTMENT_NAME AS department_name,
  COUNT(DISTINCT T2.LIBRARY_RESERVE_CATALOG_KEY) AS num_associated_catalog_items,
  SUM(T4.NUM_ENROLLED_STUDENTS) AS total_enrolled_students
FROM LIBRARY_MATERIAL_STATUS AS T1
JOIN LIBRARY_RESERVE_MATRL_DETAIL AS T3
  ON T1.LIBRARY_MATERIAL_STATUS_KEY = T3.LIBRARY_MATERIAL_STATUS_KEY
JOIN LIBRARY_RESERVE_CATALOG AS T2
  ON T3.LIBRARY_RESERVE_CATALOG_KEY = T2.LIBRARY_RESERVE_CATALOG_KEY
JOIN LIBRARY_SUBJECT_OFFERED AS T4
  ON T3.LIBRARY_SUBJECT_OFFERED_KEY = T4.LIBRARY_SUBJECT_OFFERED_KEY
JOIN SIS_SUBJECT_CODE AS T5
  ON T4.COURSE_NUMBER = T5.COURSE_NUMBER
WHERE
  T2.CATALOG_YEAR >= '2000'
GROUP BY
  T1.LIBRARY_MATERIAL_STATUS,
  T5.DEPARTMENT_NAME WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2305, 321
TOTAL                  : 202145, 182160, 19985
AVG                    : 2887.79, 2602.29, 285.50
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_MAJOR_USE
[
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE:VARCHAR2, Examples: ['BLDG SRV', 'CIRCULAT', 'CLASSRMS']),
(DESCRIPTION:VARCHAR2, Examples: ['BLDG SERVICE AREA', 'CIRCULATION AREA', 'CLASSROOMS']),
(ASSIGNABLE:VARCHAR2, Examples: ['0', '1']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, provide the room number of course location, building name, building number, building city, building state, area, organization name, room usage, term code, course level, the total number of subjects, unique meeting times, and total units. Do not include meet place or meet times with NULL values.

(Hints: Schema Mapping Hints:
- 'room number' is related to COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE
- 'building name' is related to FAC_BUILDING.BUILDING_NAME
- 'building number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'building city' is related to FAC_BUILDING_ADDRESS.CITY
- 'building state' is related to FAC_BUILDING_ADDRESS.STATE
- 'area' is related to FAC_ROOMS.AREA
- 'organization name' is related to FAC_ROOMS.ORGANIZATION_NAME
- 'room usage' is related to FAC_MAJOR_USE.MAJOR_USE
- 'term code' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'meeting times' is related to COURSE_CATALOG_SUBJECT_OFFERED.MEET_TIME
- 'units' is related to COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS

Join Information: (FAC_ROOMS.FAC_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE), (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCF700>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCDFC0>

***** FINAL SQL QUERY *****
SELECT
  T2.ROOM,
  T3.BUILDING_NAME,
  T3.BUILDING_NUMBER,
  T4.CITY,
  T4.STATE,
  T2.AREA,
  T2.ORGANIZATION_NAME,
  T5.MAJOR_USE,
  T1.TERM_CODE,
  T6.COURSE_LEVEL,
  COUNT(T1.SUBJECT_ID) AS total_subjects,
  COUNT(DISTINCT T1.MEET_TIME) AS unique_meeting_times,
  SUM(T1.TOTAL_UNITS) AS total_units
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
INNER JOIN FAC_ROOMS AS T2
  ON T1.MEET_PLACE = T2.FAC_ROOM_KEY
INNER JOIN FAC_BUILDING AS T3
  ON T2.BUILDING_KEY = T3.FAC_BUILDING_KEY
INNER JOIN FAC_BUILDING_ADDRESS AS T4
  ON T3.FAC_BUILDING_KEY = T4.BUILDING_KEY
INNER JOIN FAC_MAJOR_USE AS T5
  ON T2.MAJOR_USE_KEY = T5.MAJOR_USE_KEY
LEFT JOIN SIS_COURSE_DESCRIPTION AS T6
  ON T1.SUBJECT_ID = T6.COURSE
WHERE
  T1.MEET_PLACE IS NOT NULL AND T1.MEET_TIME IS NOT NULL
GROUP BY
  T2.ROOM,
  T3.BUILDING_NAME,
  T3.BUILDING_NUMBER,
  T4.CITY,
  T4.STATE,
  T2.AREA,
  T2.ORGANIZATION_NAME,
  T5.MAJOR_USE,
  T1.TERM_CODE,
  T6.COURSE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5597, 419
TOTAL                  : 208161, 187757, 20404
AVG                    : 2931.85, 2644.46, 287.38
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each department and school offering courses with materials, list the department name, school name, number of unique course materials, number of courses, average new and used shelf prices of materials, total material records, and number of distinct material statuses. Include a grand total across all schools and departments (the corresponding school and department fields should be null).

(Hints: Schema Mapping Hints:
- 'courses with materials' is related to TIP_SUBJECT_OFFERED.IS_NO_COURSE_MATERIAL
- 'department name' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'course materials' is related to TIP_MATERIAL.TITLE
- 'courses' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE
- 'new' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'used' is related to TIP_MATERIAL.USED_SHELF_PRICE
- 'material records' is related to TIP_DETAIL.RECORD_COUNT
- 'material statuses' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY), (SIS_DEPARTMENT.DEPARTMENT_CODE = TIP_SUBJECT_OFFERED.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCFC40>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCFC10>

***** FINAL SQL QUERY *****
SELECT
  TSO.OFFER_DEPT_NAME AS department_name,
  SD.SCHOOL_NAME AS school_name,
  COUNT(DISTINCT TM.TITLE) AS num_unique_course_materials,
  COUNT(DISTINCT TSO.SUBJECT_TITLE) AS num_courses,
  AVG(TM.NEW_SHELF_PRICE) AS avg_new_shelf_price,
  AVG(TM.USED_SHELF_PRICE) AS avg_used_shelf_price,
  SUM(TD.RECORD_COUNT) AS total_material_records,
  COUNT(DISTINCT TMS.TIP_MATERIAL_STATUS) AS num_distinct_material_statuses
FROM TIP_SUBJECT_OFFERED AS TSO
JOIN TIP_DETAIL AS TD
  ON TSO.TIP_SUBJECT_OFFERED_KEY = TD.TIP_SUBJECT_OFFERED_KEY
JOIN TIP_MATERIAL AS TM
  ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY
JOIN TIP_MATERIAL_STATUS AS TMS
  ON TD.TIP_MATERIAL_STATUS_KEY = TMS.TIP_MATERIAL_STATUS_KEY
JOIN SIS_DEPARTMENT AS SD
  ON TSO.OFFER_DEPT_CODE = SD.DEPARTMENT_CODE
WHERE
  TSO.IS_NO_COURSE_MATERIAL = 'N'
GROUP BY
  TSO.OFFER_DEPT_NAME,
  SD.SCHOOL_NAME WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2409, 328
TOTAL                  : 210898, 190166, 20732
AVG                    : 2929.14, 2641.19, 287.94
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each department in the library system, list the name of the department, total number of courses using library materials, the number of catalog items associated with those courses, and the average enrollment per course. Include a grand total across all departments (the corresponding department field should be 'Grand Total').

(Hints: Schema Mapping Hints:
- 'name of the department' is related to LIBRARY_COURSE_INSTRUCTOR.DEPARTMENT
- 'courses' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME
- 'catalog items' is related to LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY
- 'enrollment' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCFD00>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCFCD0>

***** FINAL SQL QUERY *****
```mysql
WITH CourseEnrollmentAverages AS (
    SELECT
        LCI.DEPARTMENT,
        LCI.COURSE_NAME,
        AVG(LSO.NUM_ENROLLED_STUDENTS) AS AvgCourseEnrollment
    FROM
        LIBRARY_COURSE_INSTRUCTOR AS LCI
    JOIN
        LIBRARY_RESERVE_MATRL_DETAIL AS LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
    JOIN
        LIBRARY_SUBJECT_OFFERED AS LSO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY
    GROUP BY
        LCI.DEPARTMENT,
        LCI.COURSE_NAME
)
SELECT
    COALESCE(LCI.DEPARTMENT, 'Grand Total') AS department_name,
    COUNT(DISTINCT LCI.COURSE_NAME) AS total_courses_using_library_materials,
    COUNT(DISTINCT LRC.LIBRARY_RESERVE_CATALOG_KEY) AS number_of_catalog_items,
    AVG(CEA.AvgCourseEnrollment) AS average_enrollment_per_course
FROM
    LIBRARY_COURSE_INSTRUCTOR AS LCI
JOIN
    LIBRARY_RESERVE_MATRL_DETAIL AS LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN
    LIBRARY_RESERVE_CATALOG AS LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY
LEFT JOIN
    CourseEnrollmentAverages AS CEA ON LCI.DEPARTMENT = CEA.DEPARTMENT AND LCI.COURSE_NAME = CEA.COURSE_NAME
GROUP BY
    LCI.DEPARTMENT WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2256, 407
TOTAL                  : 213561, 192422, 21139
AVG                    : 2925.49, 2635.92, 289.58
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED_SUMMARY
[
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese II', 'Eng 10A: British Writers', 'Biology of Cancer Cell']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0035, HAA.0036, HAA.0042, HAA.006', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0001, HAA.0002, HAA.0003, HAA.0004, HAA.0005, HAA.0006, HAA.0007, HAA.0008, HAA.0009, HAA.0010, HAA.0011, HAA.001']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Graduate program', 'Higher level graduate program']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'Architecture and Planning']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(TOTAL_UNITS:NUMBER, Examples: [15, 1, 24]),
(LECTURE_UNITS:NUMBER, Examples: [0, 6, 12]),
(LAB_UNITS:NUMBER, Examples: [15, 1, 24]),
(PREPARATION_UNITS:NUMBER, Examples: [0, 9, 8]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [195, 159, 170]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]

### Question ###
Group biology courses by cluster type and course level. For each group, list the name of the department, the course title, cluster type, total enrollments, average enrollment within its cluster, course level, number of unique course materials, average new and used prices for TIP materials, total material record count for TIP materials, number of unique library titles, and number of unique library ISBNs.

(Hints: Schema Mapping Hints:
- 'biology courses' is related to SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_NAME
- 'cluster type' is related to SUBJECT_OFFERED_SUMMARY.CLUSTER_TYPE
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'name of the department' is related to SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_NAME
- 'course title' is related to SUBJECT_OFFERED_SUMMARY.SUBJECT_TITLE
- 'enrollment' is related to SUBJECT_OFFERED_SUMMARY.NUM_ENROLLED_STUDENTS
- 'course materials' is related to TIP_MATERIAL.TITLE
- 'new price' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'use price' is related to TIP_MATERIAL.USED_SHELF_PRICE
- 'record count for TIP materials' is related to TIP_DETAIL.RECORD_COUNT
- 'library titles' is related to LIBRARY_RESERVE_CATALOG.CATALOG_TITLE
- 'library ISBNs' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN

Join Information: (SUBJECT_OFFERED_SUMMARY.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE), (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCF7C0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCE440>

***** FINAL SQL QUERY *****
SELECT
  GROUP_CONCAT(DISTINCT T1.OFFER_DEPT_NAME SEPARATOR '; ') AS department_name,
  GROUP_CONCAT(DISTINCT T1.SUBJECT_TITLE SEPARATOR '; ') AS course_title,
  T1.CLUSTER_TYPE,
  SUM(T1.NUM_ENROLLED_STUDENTS) AS total_enrollments,
  T5.cluster_avg_enrollment,
  T2.COURSE_LEVEL,
  COUNT(DISTINCT T4.TITLE) AS num_unique_course_materials,
  AVG(T4.NEW_SHELF_PRICE) AS avg_new_price,
  AVG(T4.USED_SHELF_PRICE) AS avg_used_price,
  SUM(T3.RECORD_COUNT) AS total_material_record_count,
  COUNT(DISTINCT T6.CATALOG_TITLE) AS num_unique_library_titles,
  COUNT(DISTINCT T6.CATALOG_ISBN) AS num_unique_library_isbns
FROM SUBJECT_OFFERED_SUMMARY AS T1
LEFT JOIN SIS_COURSE_DESCRIPTION AS T2
  ON T1.COURSE_NUMBER = T2.COURSE
LEFT JOIN TIP_DETAIL AS T3
  ON T1.SUBJECT_ID = T3.SUBJECT_ID AND T1.TERM_CODE = T3.TERM_CODE
LEFT JOIN TIP_MATERIAL AS T4
  ON T3.TIP_MATERIAL_KEY = T4.TIP_MATERIAL_KEY
LEFT JOIN LIBRARY_RESERVE_CATALOG AS T6
  ON T3.ISBN = T6.CATALOG_ISBN
LEFT JOIN (
  SELECT
    CLUSTER_TYPE,
    AVG(NUM_ENROLLED_STUDENTS) AS cluster_avg_enrollment
  FROM SUBJECT_OFFERED_SUMMARY
  WHERE
    OFFER_DEPT_NAME LIKE '%Biology%'
  GROUP BY
    CLUSTER_TYPE
) AS T5
  ON T1.CLUSTER_TYPE = T5.CLUSTER_TYPE
WHERE
  T1.OFFER_DEPT_NAME LIKE '%Biology%'
GROUP BY
  T1.CLUSTER_TYPE,
  T2.COURSE_LEVEL,
  T5.cluster_avg_enrollment
ORDER BY
  T1.CLUSTER_TYPE,
  T2.COURSE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3724, 533
TOTAL                  : 217818, 196146, 21672
AVG                    : 2943.49, 2650.62, 292.86
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: ACADEMIC_TERM_PARAMETER
[
(TERM_PARAMETER:VARCHAR2, Examples: ['SIS_CURRENT_TERM', 'SIS_PREVIOUS_TERM', 'SIS_UPCOMING_TERM']),
(TERM_INDICATOR:VARCHAR2, Examples: ['C', 'P', 'F']),
(TERM_CODE:VARCHAR2, Examples: ['2024SU', '2025FA', '2025JA']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Fall Term 2024-2025', 'Summer Term 2024', 'January Term 2024-2025']),
(TERM_START_DATE:DATE, Examples: ['03-SEP-24', '10-JUN-24', '06-JAN-25']),
(TERM_END_DATE:DATE, Examples: ['20-DEC-24', '20-AUG-24', '31-JAN-25']),
(TERM_LAST_DAY_BEFORE_NEXT_TERM:DATE, Examples: ['05-JAN-25', '02-SEP-24', '31-JAN-25']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['Y', 'N'])
]
# Table: TIME_DAY
[
(FISCAL_PERIOD:VARCHAR2, Examples: ['195007', '195008', '195009']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1975 Period 6', 'FY 1987 Period 11', 'FY 1983 Period 12']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['197412', '198705', '198306']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['December 1974', 'May 1987', 'June 1983']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1974', '1987', '1983']),
(START_DATE:DATE, Examples: ['01-DEC-74', '01-MAY-87', '01-JUN-83']),
(END_DATE:DATE, Examples: ['31-DEC-74', '31-MAY-87', '30-JUN-83']),
(CALENDAR_DATE:DATE, Examples: ['01-APR-00', '01-APR-01', '01-APR-02']),
(DAY_OF_WEEK:VARCHAR2, Examples: ['Friday   ', 'Wednesday', 'Sunday   ']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['2021', '2002', '1994']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 2020-2021', 'Aid Year 2001-2002', 'Aid year 1993-94']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(ACADEMIC_TERM_CODE:VARCHAR2, Examples: ['1951SP', '1951SU', '1952SP']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1986-1987', 'Summer Term 1983', 'Summer Term 2020'])
]
# Table: TIME_MONTH
[
(TIME_MONTH_KEY:VARCHAR2, Examples: ['199602', '199601', '199607']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['199601', '199602', '199603']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1996 Period 2', 'FY 1996 Period 1', 'FY 1996 Period 7']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(FISCAL_YEAR_QUARTER:VARCHAR2, Examples: ['FY 1996 Quarter 1', 'FY 1996 Quarter 3', 'FY 1997 Quarter 1']),
(FY_QUARTER_CODE:VARCHAR2, Examples: ['FY1996Q1', 'FY1996Q2', 'FY1996Q3']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['199508', '199507', '199601']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['August 1995', 'July 1995', 'January 1996']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(START_DATE:VARCHAR2, Examples: ['01-AUG-95', '01-JUL-95', '01-JAN-96']),
(END_DATE:VARCHAR2, Examples: ['31-AUG-95', '31-JUL-95', '31-JAN-96']),
(CALENDAR_MONTH:VARCHAR2, Examples: ['8', '7', '1']),
(CALENDAR_MONTH_NAME:DATE, Examples: ['August', 'July', 'January']),
(IS_CURRENT_FISCAL_PERIOD:DATE, Examples: ['N', 'Y']),
(IS_PREVIOUS_FISCAL_PERIOD:VARCHAR2, Examples: ['N', 'Y']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_TERM:VARCHAR2, Examples: ['1995SU', '1996JA', '1996SU']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Summer Term 1995', 'January Term 1995-1996', 'Summer Term 1996']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 1995-96', 'Aid Year 1996-97', 'Aid Year 1997-98']),
(IS_CLOSING_PERIOD:VARCHAR2, Examples: ['N', 'Y']),
(FISCAL_PERIOD_SELECTOR:VARCHAR2, Examples: ['199602 -- August 1995', '199601 -- July 1995', '199607 -- January 1996']),
(IS_CURRENT_FISCAL_YEAR:VARCHAR2, Examples: ['N', 'Y'])
]
# Table: TIME_QUARTER
[
(FISCAL_YEAR:VARCHAR2, Examples: ['2000', '2001', '2002']),
(FY_QUARTER_CODE:VARCHAR2, Examples: ['FY2000Q1', 'FY2000Q2', 'FY2000Q3']),
(FY_QUARTER_NAME:VARCHAR2, Examples: ['FY 2014 Quarter 1', 'FY 2026 Quarter 3', 'FY 2026 Quarter 4']),
(CY_QUARTER_CODE:VARCHAR2, Examples: ['CY2013Q3', 'CY2026Q1', 'CY2026Q2']),
(CY_QUARTER_NAME:VARCHAR2, Examples: ['CY 2013 Quarter 3', 'CY 2026 Quarter 1', 'CY 2026 Quarter 2']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['2013', '2026', '2004']),
(QUARTER_START_DATE:DATE, Examples: ['01-JUL-13', '01-JAN-26', '01-APR-26']),
(QUARTER_END_DATE:DATE, Examples: ['30-SEP-13', '31-MAR-26', '30-JUN-26']),
(QUARTER_START_FP:VARCHAR2, Examples: ['201401', '202607', '202610']),
(QUARTER_END_FP:VARCHAR2, Examples: ['201403', '202609', '202612']),
(QUARTER_CERT_OPEN:DATE, Examples: ['01-OCT-13', '01-APR-26', '01-JUL-26']),
(QUARTER_CERT_EXPECTED:DATE, Examples: ['30-NOV-13', '31-MAY-26', '31-AUG-26']),
(QUARTER_CERT_DUE:DATE, Examples: ['31-DEC-13', '30-JUN-26', '30-SEP-26']),
(IS_CURRENT_QUARTER:VARCHAR2, Examples: ['N', 'Y']),
(IS_NEXT_QUARTER:VARCHAR2, Examples: ['N']),
(IS_PREVIOUS_QUARTER:VARCHAR2, Examples: ['N']),
(IS_PAST_QUARTER:VARCHAR2, Examples: ['Y', 'N']),
(IS_FUTURE_QUARTER:VARCHAR2, Examples: ['N', 'Y']),
(PAYROLL_EDACCA_CERT_SCHED_KEY:VARCHAR2, Examples: ['201401', '202603', '202604']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each financial aid year and academic year, list the number of fiscal periods, quarters, the start term date, the end term date, and number of distinct department-level term parameters.

(Hints: Schema Mapping Hints:
- 'financial aid year' is related to ACADEMIC_TERMS.FINANCIAL_AID_YEAR
- 'academic year' is related to ACADEMIC_TERMS.ACADEMIC_YEAR
- 'fiscal periods' is related to TIME_MONTH.FISCAL_PERIOD
- 'quarters' is related to TIME_QUARTER.FY_QUARTER_CODE
- 'start term date' is related to TIME_DAY.START_DATE
- 'end term date' is related to TIME_DAY.END_DATE
- 'department-level term parameters' is related to ACADEMIC_TERM_PARAMETER.TERM_PARAMETER

Join Information: (ACADEMIC_TERMS.TERM_START_DATE = TIME_DAY.CALENDAR_DATE), (TIME_DAY.FISCAL_PERIOD = TIME_MONTH.FISCAL_PERIOD), (TIME_QUARTER.FISCAL_YEAR = TIME_MONTH.FISCAL_YEAR), (ACADEMIC_TERM_PARAMETER.TERM_CODE = ACADEMIC_TERMS.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC1C0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCE8C0>

***** FINAL SQL QUERY *****
```mysql
SELECT
  T1.FINANCIAL_AID_YEAR,
  T1.ACADEMIC_YEAR,
  T1.TERM_START_DATE,
  T1.TERM_END_DATE,
  COUNT(DISTINCT T4.FISCAL_PERIOD) AS number_of_fiscal_periods,
  COUNT(DISTINCT T5.FY_QUARTER_CODE) AS number_of_quarters,
  COUNT(DISTINCT T2.TERM_PARAMETER) AS number_of_distinct_department_level_term_parameters
FROM ACADEMIC_TERMS AS T1
LEFT JOIN ACADEMIC_TERM_PARAMETER AS T2
  ON T1.TERM_CODE = T2.TERM_CODE
LEFT JOIN TIME_DAY AS T3
  ON T1.TERM_START_DATE = T3.CALENDAR_DATE
LEFT JOIN TIME_MONTH AS T4
  ON T3.FISCAL_PERIOD = T4.FISCAL_PERIOD
LEFT JOIN TIME_QUARTER AS T5
  ON T4.FISCAL_YEAR = T5.FISCAL_YEAR
GROUP BY
  T1.FINANCIAL_AID_YEAR,
  T1.ACADEMIC_YEAR,
  T1.TERM_START_DATE,
  T1.TERM_END_DATE
ORDER BY
  T1.FINANCIAL_AID_YEAR,
  T1.ACADEMIC_YEAR;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3646, 320
TOTAL                  : 221784, 199792, 21992
AVG                    : 2957.12, 2663.89, 293.23
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For subjects offered this year in either the Fall or Spring term, list its department name, school name, subject ID, subject title, course level, total units, the term it is offered ('Spring' for Spring term and 'Fall' for Fall term), term description, the number of distinct instructors teaching in the Fall, and the number of distinct instructors teaching in the Spring.

(Hints: Schema Mapping Hints:
- 'subjects offered this year' is related to COURSE_CATALOG_SUBJECT_OFFERED.IS_OFFERED_THIS_YEAR
- 'department name' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'subject ID' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'subject title' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'total units' is related to COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS
- 'term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS.TERM_DESCRIPTION
- 'instructors' is related to COURSE_CATALOG_SUBJECT_OFFERED.FALL_INSTRUCTORS, COURSE_CATALOG_SUBJECT_OFFERED.SPRING_INSTRUCTORS

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCF580>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCC580>

***** FINAL SQL QUERY *****
(
SELECT
  T1.DEPARTMENT_NAME,
  T2.SCHOOL_NAME,
  T1.SUBJECT_ID,
  T1.SUBJECT_TITLE,
  GROUP_CONCAT(DISTINCT T3.COURSE_LEVEL SEPARATOR ', ') AS COURSE_LEVEL,
  T1.TOTAL_UNITS,
  'Fall' AS term_offered,
  T4.TERM_DESCRIPTION AS term_description,
  CASE
    WHEN T1.FALL_INSTRUCTORS IS NULL OR TRIM(T1.FALL_INSTRUCTORS) = ''
    THEN 0
    ELSE LENGTH(T1.FALL_INSTRUCTORS) - LENGTH(REPLACE(T1.FALL_INSTRUCTORS, ',', '')) + 1
  END AS num_fall_instructors,
  0 AS num_spring_instructors
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
LEFT JOIN SIS_DEPARTMENT AS T2
  ON T1.DEPARTMENT_CODE = T2.DEPARTMENT_CODE
LEFT JOIN SIS_COURSE_DESCRIPTION AS T3
  ON T1.SUBJECT_CODE = T3.COURSE
LEFT JOIN ACADEMIC_TERMS AS T4
  ON T1.TERM_CODE = T4.TERM_CODE
WHERE
  T1.IS_OFFERED_THIS_YEAR = 'Y' AND T1.IS_OFFERED_FALL_TERM = 'Y' AND T1.TERM_CODE LIKE '%FA'
GROUP BY
  T1.DEPARTMENT_NAME,
  T2.SCHOOL_NAME,
  T1.SUBJECT_ID,
  T1.SUBJECT_TITLE,
  T1.TOTAL_UNITS,
  term_offered,
  T4.TERM_DESCRIPTION,
  num_fall_instructors
)
UNION ALL
(
SELECT
  T1.DEPARTMENT_NAME,
  T2.SCHOOL_NAME,
  T1.SUBJECT_ID,
  T1.SUBJECT_TITLE,
  GROUP_CONCAT(DISTINCT T3.COURSE_LEVEL SEPARATOR ', ') AS COURSE_LEVEL,
  T1.TOTAL_UNITS,
  'Spring' AS term_offered,
  T4.TERM_DESCRIPTION AS term_description,
  0 AS num_fall_instructors,
  CASE
    WHEN T1.SPRING_INSTRUCTORS IS NULL OR TRIM(T1.SPRING_INSTRUCTORS) = ''
    THEN 0
    ELSE LENGTH(T1.SPRING_INSTRUCTORS) - LENGTH(REPLACE(T1.SPRING_INSTRUCTORS, ',', '')) + 1
  END AS num_spring_instructors
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
LEFT JOIN SIS_DEPARTMENT AS T2
  ON T1.DEPARTMENT_CODE = T2.DEPARTMENT_CODE
LEFT JOIN SIS_COURSE_DESCRIPTION AS T3
  ON T1.SUBJECT_CODE = T3.COURSE
LEFT JOIN ACADEMIC_TERMS AS T4
  ON T1.TERM_CODE = T4.TERM_CODE
WHERE
  T1.IS_OFFERED_THIS_YEAR = 'Y' AND T1.IS_OFFERED_SPRING_TERM = 'Y' AND T1.TERM_CODE LIKE '%SP'
GROUP BY
  T1.DEPARTMENT_NAME,
  T2.SCHOOL_NAME,
  T1.SUBJECT_ID,
  T1.SUBJECT_TITLE,
  T1.TOTAL_UNITS,
  term_offered,
  T4.TERM_DESCRIPTION,
  num_spring_instructors
);

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4779, 819
TOTAL                  : 227382, 204571, 22811
AVG                    : 2991.87, 2691.72, 300.14
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each department and material status, list the name of the department, the material status, the number of TIP materials associated with this department and status, the number of library materials associated with this department and status, the total number of TIP and library materials associated with this department and status. Include a subtotal for each department and a grand total across all departments.

(Hints: Schema Mapping Hints:
- 'name of the department' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'TIP materials' is related to TIP_DETAIL.TIP_MATERIAL_KEY
- 'library materials' is related to LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY

Join Information: (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY), (TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY = TIP_DETAIL.TIP_MATERIAL_STATUS_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC100>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC0D0>

***** FINAL SQL QUERY *****
SELECT
  COALESCE(department_name, 'Grand Total') AS `Department Name`,
  COALESCE(material_status, 'Department Total') AS `Material Status`,
  SUM(tip_materials_count) AS `Number of TIP Materials`,
  SUM(library_materials_count) AS `Number of Library Materials`,
  SUM(tip_materials_count) + SUM(library_materials_count) AS `Total Materials`
FROM
  (
    SELECT
      TSO.OFFER_DEPT_NAME AS department_name,
      TMS.TIP_MATERIAL_STATUS AS material_status,
      COUNT(TD.TIP_MATERIAL_KEY) AS tip_materials_count,
      0 AS library_materials_count
    FROM TIP_DETAIL AS TD
    JOIN TIP_SUBJECT_OFFERED AS TSO
      ON TD.TIP_SUBJECT_OFFERED_KEY = TSO.TIP_SUBJECT_OFFERED_KEY
    JOIN TIP_MATERIAL_STATUS AS TMS
      ON TD.TIP_MATERIAL_STATUS_KEY = TMS.TIP_MATERIAL_STATUS_KEY
    GROUP BY
      TSO.OFFER_DEPT_NAME,
      TMS.TIP_MATERIAL_STATUS
    UNION ALL
    SELECT
      LSO.OFFER_DEPT_NAME AS department_name,
      LMS.LIBRARY_MATERIAL_STATUS AS material_status,
      0 AS tip_materials_count,
      COUNT(LRMD.LIBRARY_RESERVE_CATALOG_KEY) AS library_materials_count
    FROM LIBRARY_RESERVE_MATRL_DETAIL AS LRMD
    JOIN LIBRARY_SUBJECT_OFFERED AS LSO
      ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY
    JOIN LIBRARY_MATERIAL_STATUS AS LMS
      ON LRMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY
    GROUP BY
      LSO.OFFER_DEPT_NAME,
      LMS.LIBRARY_MATERIAL_STATUS
  ) AS CombinedMaterials
GROUP BY
  department_name,
  material_status WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2608, 489
TOTAL                  : 230479, 207179, 23300
AVG                    : 2993.23, 2690.64, 302.60
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]

### Question ###
For each building that is not a subdivision, list the building number, full name, street address, building type, occupancy date, ownership type, and site location. You should also include three rows at the end showing the number of owned, leased, all buildings at MIT that are not subdivisions, in the format of (null, #building Buildings, null, null, null, null, null).

(Hints: Schema Mapping Hints:
- 'subdivision' is related to FAC_BUILDING.PARENT_BUILDING_NUMBER
- 'building number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'full name' is related to FAC_BUILDING.BUILDING_NAME_LONG
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'building type' is related to FAC_BUILDING.BUILDING_TYPE
- 'occupancy date' is related to FAC_BUILDING.DATE_OCCUPIED
- 'ownership type' is related to FAC_BUILDING.OWNERSHIP_TYPE
- 'site location' is related to FAC_BUILDING.SITE

Join Information: (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC040>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCFFD0>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NUMBER,
  T1.BUILDING_NAME_LONG,
  T3.BUILDING_STREET_ADDRESS,
  T1.BUILDING_TYPE,
  T1.DATE_OCCUPIED,
  T1.OWNERSHIP_TYPE,
  T1.SITE
FROM FAC_BUILDING AS T1
JOIN FAC_BUILDING_ADDRESS AS T2
  ON T1.FAC_BUILDING_KEY = T2.BUILDING_KEY
JOIN BUILDINGS AS T3
  ON T2.BUILDING_KEY = T3.BUILDING_KEY
WHERE
  T1.PARENT_BUILDING_NUMBER IS NULL
UNION ALL
SELECT
  NULL,
  CONCAT(COUNT(CASE WHEN T1.OWNERSHIP_TYPE = 'OWNED' THEN 1 END), ' Owned Buildings'),
  NULL,
  NULL,
  NULL,
  NULL,
  NULL
FROM FAC_BUILDING AS T1
WHERE
  T1.PARENT_BUILDING_NUMBER IS NULL AND T1.SITE = 'MIT'
UNION ALL
SELECT
  NULL,
  CONCAT(COUNT(CASE WHEN T1.OWNERSHIP_TYPE = 'LEASED' THEN 1 END), ' Leased Buildings'),
  NULL,
  NULL,
  NULL,
  NULL,
  NULL
FROM FAC_BUILDING AS T1
WHERE
  T1.PARENT_BUILDING_NUMBER IS NULL AND T1.SITE = 'MIT'
UNION ALL
SELECT
  NULL,
  CONCAT(COUNT(*), ' All Buildings'),
  NULL,
  NULL,
  NULL,
  NULL,
  NULL
FROM FAC_BUILDING AS T1
WHERE
  T1.PARENT_BUILDING_NUMBER IS NULL AND T1.SITE = 'MIT';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2170, 414
TOTAL                  : 233063, 209349, 23714
AVG                    : 2987.99, 2683.96, 304.03
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each department, list the name of the department, the title of the TIP material associated with the department, author, ISBN, library term code, and whether it is available in the library reserves ('Available in Library' if yes and 'Not Available in Library' otherwise), the total number of instructors per library book for the department, the total number of materials available in the library for the department, and the total number of available materials across all departments.

(Hints: Schema Mapping Hints:
- 'name of the department' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'title of the TIP material' is related to TIP_MATERIAL.TITLE
- 'author' is related to TIP_MATERIAL.AUTHOR
- 'ISBN' is related to TIP_MATERIAL.ISBN
- 'library term code' is related to LIBRARY_RESERVE_MATRL_DETAIL.TERM_CODE
- 'available in the library reserves' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN
- 'instructors' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCFE80>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCFE50>

***** FINAL SQL QUERY *****
WITH LibraryISBNInfo AS (
    SELECT
        LRC.CATALOG_ISBN AS ISBN,
        GROUP_CONCAT(DISTINCT LRMD.TERM_CODE ORDER BY LRMD.TERM_CODE SEPARATOR ', ') AS library_term_code,
        COUNT(DISTINCT LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY) AS num_instructors_for_isbn
    FROM
        LIBRARY_RESERVE_CATALOG AS LRC
    LEFT JOIN
        LIBRARY_RESERVE_MATRL_DETAIL AS LRMD
        ON LRC.LIBRARY_RESERVE_CATALOG_KEY = LRMD.LIBRARY_RESERVE_CATALOG_KEY
    GROUP BY
        LRC.CATALOG_ISBN
)
SELECT
    TSO.OFFER_DEPT_NAME,
    TM.TITLE,
    TM.AUTHOR,
    TM.ISBN,
    LII.library_term_code,
    CASE
        WHEN LII.ISBN IS NOT NULL THEN 'Available in Library'
        ELSE 'Not Available in Library'
    END AS availability_status,
    IFNULL(LII.num_instructors_for_isbn, 0) AS total_instructors_per_library_book_for_department,
    COUNT(DISTINCT CASE WHEN LII.ISBN IS NOT NULL THEN TM.ISBN END) OVER (PARTITION BY TSO.OFFER_DEPT_NAME) AS total_materials_available_in_department,
    COUNT(DISTINCT CASE WHEN LII.ISBN IS NOT NULL THEN TM.ISBN END) OVER () AS total_materials_available_across_all_departments
FROM
    TIP_SUBJECT_OFFERED AS TSO
JOIN
    TIP_DETAIL AS TD ON TSO.TIP_SUBJECT_OFFERED_KEY = TD.TIP_SUBJECT_OFFERED_KEY
JOIN
    TIP_MATERIAL AS TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY
LEFT JOIN
    LibraryISBNInfo AS LII ON TM.ISBN = LII.ISBN;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3436, 458
TOTAL                  : 236957, 212785, 24172
AVG                    : 2999.46, 2693.48, 305.97
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MASTER_DEPT_HIERARCHY
[
(HIERARCHY_TYPE:VARCHAR2, Examples: ['Standard Hierarchy']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_CODE:VARCHAR2, Examples: ['D_DOF_CORE', 'D_DOF_RESERVE', 'D_DOF_RESIDENCE']),
(DLC_NAME:VARCHAR2, Examples: ['Facilities Building Core (hallways, stairs, etc.)', 'Facilities Provost Reserved', 'Facilities Residences']),
(MASTER_DEPT_HIER_LEVEL_1_CODE:VARCHAR2, Examples: ['D_ALL']),
(MASTER_DEPT_HIER_LEVEL_1_NAME:VARCHAR2, Examples: ['All Departments']),
(MASTER_DEPT_HIER_LEVEL_2_CODE:VARCHAR2, Examples: ['D_EXECVP_AREA', 'D_PROVOST_AREA', 'D_PRES_AREA']),
(MASTER_DEPT_HIER_LEVEL_2_NAME:VARCHAR2, Examples: ['Executive Vice President's Area', 'Provost Area', 'President's area']),
(MASTER_DEPT_HIER_LEVEL_3_CODE:VARCHAR2, Examples: ['D_FINANCE_AREA', 'D_TREAS_AREA', 'D_SC_ENVP']),
(MASTER_DEPT_HIER_LEVEL_3_NAME:VARCHAR2, Examples: ['VP Finance Area', 'Treasurer's Area', 'Senior Council and Environmental Programs']),
(MASTER_DEPT_HIER_LEVEL_4_CODE:VARCHAR2, Examples: ['D_SOURCING_AREA', 'D_OSATT_AREA']),
(MASTER_DEPT_HIER_LEVEL_4_NAME:VARCHAR2, Examples: ['Sourcing Area', 'Office of Strategic Alliances & Tech Transfer Area']),
(MASTER_DEPT_HIER_LEVEL_5_CODE:VARCHAR2),
(MASTER_DEPT_HIER_LEVEL_5_NAME:VARCHAR2)
]

### Question ###
For each organization except Cambridge-MIT Institute, list its ID, number, level, formatted name according to level (if level is 2, there should be 1 space before the name, if level is 3, there should be 2 space before the name, up to level 6), whether it is assignable ('ASSIGNABLE' if assignable, 'NON-ASSIGNABLE' otherwise), total area, number of rooms, and average room area. Area and number of rooms should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'Cambridge-MIT Institute' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'ID' is related to FCLT_ORGANIZATION.ORGANIZATION_ID
- 'number' is related to FCLT_ORGANIZATION.ORGANIZATION_NUMBER
- 'level' is related to FCLT_ORGANIZATION.ORGANIZATION_LEVEL
- 'name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'assignable' is related to FCLT_ORGANIZATION.ASSIGNABLE
- 'area' is related to FCLT_ROOMS.AREA
- 'rooms' is related to FCLT_ROOMS.ROOM
- 'room area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FCLT_ROOMS.FCLT_ORGANIZATION_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY), (FCLT_ORGANIZATION.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC580>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC550>

***** FINAL SQL QUERY *****
SELECT
  T1.ORGANIZATION_ID AS ID,
  T1.ORGANIZATION_NUMBER AS number,
  T1.ORGANIZATION_LEVEL AS level,
  CONCAT(REPEAT(' ', CAST(T1.ORGANIZATION_LEVEL AS UNSIGNED) - 1), T1.ORGANIZATION_NAME) AS formatted_name,
  CASE
    WHEN T1.ASSIGNABLE = '1'
    THEN 'ASSIGNABLE'
    ELSE 'NON-ASSIGNABLE'
  END AS assignable,
  FORMAT(COALESCE(SUM(T2.AREA), 0), 0) AS total_area,
  FORMAT(COALESCE(COUNT(DISTINCT T2.ROOM), 0), 0) AS number_of_rooms,
  COALESCE(AVG(T2.AREA), 0) AS average_room_area
FROM FCLT_ORGANIZATION AS T1
LEFT JOIN FCLT_ROOMS AS T2
  ON T1.FCLT_ORGANIZATION_KEY = T2.FCLT_ORGANIZATION_KEY
WHERE
  T1.ORGANIZATION_NAME <> 'Cambridge-MIT Institute'
GROUP BY
  T1.ORGANIZATION_KEY,
  T1.ORGANIZATION_ID,
  T1.ORGANIZATION_NUMBER,
  T1.ORGANIZATION_LEVEL,
  T1.ORGANIZATION_NAME,
  T1.ASSIGNABLE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2204, 324
TOTAL                  : 239485, 214989, 24496
AVG                    : 2993.56, 2687.36, 306.20
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each building use, list the type, the number of distinct buildings (excluding subdivisions) of this use, the total gross square footage of these buildings, and the number of unique organizations associated with the rooms in these buildings. If the building is used as a residence, display the usage type as "RESIDENTIAL." You should also include a row at the end showing the total number of buildings, the gross square footage, and the number of organizations across all types of building use. All numerical values should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'building use' is related to FCLT_BUILDING.BUILDING_USE
- 'buildings' is related to FCLT_BUILDING.PARENT_BUILDING_NUMBER, FCLT_BUILDING.FCLT_BUILDING_KEY
- 'gross square footage' is related to FCLT_BUILDING.EXT_GROSS_AREA
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY

Join Information: (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCFB80>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCFB50>

***** FINAL SQL QUERY *****
```mysql
SELECT
  COALESCE(CASE WHEN T1.BUILDING_USE = 'RESIDENT' THEN 'RESIDENTIAL' ELSE T1.BUILDING_USE END, 'Total') AS `Building Use`,
  FORMAT(ROUND(COUNT(DISTINCT T1.FCLT_BUILDING_KEY)), 0) AS `Number of Buildings`,
  FORMAT(ROUND(SUM(T1.EXT_GROSS_AREA)), 0) AS `Total Gross Square Footage`,
  FORMAT(ROUND(COUNT(DISTINCT T2.FCLT_ORGANIZATION_KEY)), 0) AS `Number of Organizations`
FROM FCLT_BUILDING AS T1
LEFT JOIN FCLT_ROOMS AS T2
  ON T1.FCLT_BUILDING_KEY = T2.FCLT_BUILDING_KEY
WHERE
  T1.PARENT_BUILDING_NUMBER IS NULL
GROUP BY
  T1.BUILDING_USE WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2765, 219
TOTAL                  : 242469, 217754, 24715
AVG                    : 2993.44, 2688.32, 305.12
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]

### Question ###
For each owned building that is not a subdivision, list the construction start year, the building number, and the year of initial occupancy. Display the construction start year only if it differs from the previous row. If the year of initial occupancy or construction start year is unknown, display 'UNKNOWN'. You should also include a row at the end showing the total number of owned buildings that are not subdivisions, in the format of (null, #building Buildings, null).

(Hints: Schema Mapping Hints:
- 'subdivision' is related to FAC_BUILDING.PARENT_BUILDING_NUMBER
- 'construction start year' is related to FAC_BUILDING.DATE_BUILT
- 'building number' is related to FAC_BUILDING.PARENT_BUILDING_NUMBER
- 'year of initial occupancy' is related to FAC_BUILDING.DATE_OCCUPIED)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCFAC0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCFA90>

***** FINAL SQL QUERY *****
WITH FilteredBuildings AS (
    SELECT
        COALESCE(YEAR(STR_TO_DATE(T1.DATE_BUILT, '%m/%d/%Y')), 'UNKNOWN') AS ConstructedYearStr,
        COALESCE(YEAR(STR_TO_DATE(T1.DATE_OCCUPIED, '%m/%d/%Y')), 'UNKNOWN') AS OccupancyYearStr,
        T1.BUILDING_NUMBER,
        YEAR(STR_TO_DATE(T1.DATE_BUILT, '%m/%d/%Y')) AS SortKey_BuiltYear,
        T1.BUILDING_NUMBER AS SortKey_BuildingNumber
    FROM
        FAC_BUILDING AS T1
    WHERE
        T1.OWNERSHIP_TYPE = 'OWNED'
        AND (T1.PARENT_BUILDING_NUMBER IS NULL OR T1.PARENT_BUILDING_NUMBER = '')
),
LaggedYears AS (
    SELECT
        ConstructedYearStr,
        OccupancyYearStr,
        BUILDING_NUMBER,
        SortKey_BuiltYear,
        SortKey_BuildingNumber,
        LAG(ConstructedYearStr, 1, NULL) OVER (ORDER BY SortKey_BuiltYear, SortKey_BuildingNumber) AS PreviousConstructedYearStr
    FROM
        FilteredBuildings
)
SELECT
    CASE
        WHEN ConstructedYearStr = PreviousConstructedYearStr THEN NULL
        ELSE ConstructedYearStr
    END AS `Construction Start Year`,
    BUILDING_NUMBER AS `Building Number`,
    OccupancyYearStr AS `Year of Initial Occupancy`
FROM
    LaggedYears

UNION ALL

SELECT
    NULL AS `Construction Start Year`,
    CONCAT(COUNT(T1.FAC_BUILDING_KEY), ' Buildings') AS `Building Number`,
    NULL AS `Year of Initial Occupancy`
FROM
    FAC_BUILDING AS T1
WHERE
    T1.OWNERSHIP_TYPE = 'OWNED'
    AND (T1.PARENT_BUILDING_NUMBER IS NULL OR T1.PARENT_BUILDING_NUMBER = '')

ORDER BY
    CASE WHEN `Building Number` LIKE '% Buildings' THEN 1 ELSE 0 END,
    `Construction Start Year`,
    `Building Number`;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1368, 502
TOTAL                  : 244339, 219122, 25217
AVG                    : 2979.74, 2672.22, 307.52
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_FLOOR
[
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(EXT_GROSS_AREA:NUMBER, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:VARCHAR2, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each room, list its associated building name, floor number, room number, ownership type, organization name, number of rooms, area, and percentage of area relative to the building. Include subtotals across floors, subtotals across all floors for each building, and a grand total across all buildings. For the subtotal for each building and the grand total, the percentage of area should be relative to area of all buildings. All numeric values should be rounded to integers and formatted using commas as thousands separators except the relative percentages which should be rounded to two decimal places.

(Hints: Schema Mapping Hints:
- 'room' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'building name' is related to FCLT_BUILDING.BUILDING_NAME_LONG
- 'floor number' is related to FCLT_FLOOR.FLOOR
- 'room number' is related to FCLT_ROOMS.BUILDING_ROOM
- 'ownership type' is related to FCLT_BUILDING.OWNERSHIP_TYPE
- 'organization name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'number of rooms' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_FLOOR.FCLT_FLOOR_KEY = FCLT_ROOMS.FCLT_FLOOR_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_FLOOR.FCLT_BUILDING_KEY), (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FCLT_ROOMS.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCFDC0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCFD90>

***** FINAL SQL QUERY *****
WITH RoomBaseData AS (
    SELECT
        fb.FCLT_BUILDING_KEY,
        fb.BUILDING_NAME_LONG,
        fb.OWNERSHIP_TYPE,
        ff.FLOOR,
        fr.FCLT_ROOM_KEY,
        fr.BUILDING_ROOM,
        fo.ORGANIZATION_NAME,
        fr.AREA
    FROM FCLT_ROOMS AS fr
    JOIN FCLT_BUILDING AS fb
        ON fr.FCLT_BUILDING_KEY = fb.FCLT_BUILDING_KEY
    JOIN FCLT_FLOOR AS ff
        ON fr.FCLT_FLOOR_KEY = ff.FCLT_FLOOR_KEY
    LEFT JOIN FCLT_ORGANIZATION AS fo
        ON fr.FCLT_ORGANIZATION_KEY = fo.FCLT_ORGANIZATION_KEY
),
CalculatedTotals AS (
    SELECT
        rbd.*,
        SUM(rbd.AREA) OVER (PARTITION BY rbd.FCLT_BUILDING_KEY) AS total_area_for_building,
        SUM(rbd.AREA) OVER () AS total_area_all_buildings
    FROM RoomBaseData AS rbd
)
-- Level 1: Room Details
SELECT
    ct.BUILDING_NAME_LONG,
    ct.FLOOR,
    ct.BUILDING_ROOM,
    ct.OWNERSHIP_TYPE,
    ct.ORGANIZATION_NAME,
    FORMAT(1, 0) AS `Number of Rooms`,
    FORMAT(ROUND(ct.AREA), 0) AS Area,
    ROUND((ct.AREA * 100.0 / ct.total_area_for_building), 2) AS `Percentage of Area`,
    1 AS sort_level,
    ct.FCLT_BUILDING_KEY AS building_sort_key,
    ct.FLOOR AS floor_sort_key,
    ct.BUILDING_ROOM AS room_sort_key
FROM CalculatedTotals AS ct

UNION ALL

-- Level 2: Floor Subtotals
SELECT
    ct.BUILDING_NAME_LONG,
    ct.FLOOR,
    'Floor Total' AS BUILDING_ROOM,
    ct.OWNERSHIP_TYPE,
    NULL AS ORGANIZATION_NAME,
    FORMAT(COUNT(ct.FCLT_ROOM_KEY), 0) AS `Number of Rooms`,
    FORMAT(ROUND(SUM(ct.AREA)), 0) AS Area,
    ROUND((SUM(ct.AREA) * 100.0 / MAX(ct.total_area_for_building)), 2) AS `Percentage of Area`,
    2 AS sort_level,
    ct.FCLT_BUILDING_KEY AS building_sort_key,
    ct.FLOOR AS floor_sort_key,
    '~' AS room_sort_key -- Sort after all specific rooms within a floor
FROM CalculatedTotals AS ct
GROUP BY
    ct.FCLT_BUILDING_KEY,
    ct.BUILDING_NAME_LONG,
    ct.OWNERSHIP_TYPE,
    ct.FLOOR

UNION ALL

-- Level 3: Building Subtotals
SELECT
    ct.BUILDING_NAME_LONG,
    'Building Total' AS FLOOR,
    NULL AS BUILDING_ROOM,
    ct.OWNERSHIP_TYPE,
    NULL AS ORGANIZATION_NAME,
    FORMAT(COUNT(ct.FCLT_ROOM_KEY), 0) AS `Number of Rooms`,
    FORMAT(ROUND(SUM(ct.AREA)), 0) AS Area,
    ROUND((SUM(ct.AREA) * 100.0 / MAX(ct.total_area_all_buildings)), 2) AS `Percentage of Area`,
    3 AS sort_level,
    ct.FCLT_BUILDING_KEY AS building_sort_key,
    '~' AS floor_sort_key, -- Sort after all specific floors and floor totals within a building
    '~' AS room_sort_key
FROM CalculatedTotals AS ct
GROUP BY
    ct.FCLT_BUILDING_KEY,
    ct.BUILDING_NAME_LONG,
    ct.OWNERSHIP_TYPE

UNION ALL

-- Level 4: Grand Total
SELECT
    'Grand Total' AS BUILDING_NAME_LONG,
    NULL AS FLOOR,
    NULL AS BUILDING_ROOM,
    NULL AS OWNERSHIP_TYPE,
    NULL AS ORGANIZATION_NAME,
    FORMAT(COUNT(ct.FCLT_ROOM_KEY), 0) AS `Number of Rooms`,
    FORMAT(ROUND(SUM(ct.AREA)), 0) AS Area,
    ROUND(100.00, 2) AS `Percentage of Area`,
    4 AS sort_level,
    'ZZZZZ' AS building_sort_key, -- Sort after all buildings
    'ZZZZZ' AS floor_sort_key,
    'ZZZZZ' AS room_sort_key
FROM CalculatedTotals AS ct

ORDER BY
    building_sort_key,
    sort_level,
    floor_sort_key,
    room_sort_key;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3184, 1175
TOTAL                  : 248698, 222306, 26392
AVG                    : 2996.36, 2678.39, 317.98
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERM_PARAMETER
[
(TERM_PARAMETER:VARCHAR2, Examples: ['SIS_CURRENT_TERM', 'SIS_PREVIOUS_TERM', 'SIS_UPCOMING_TERM']),
(TERM_INDICATOR:VARCHAR2, Examples: ['C', 'P', 'F']),
(TERM_CODE:VARCHAR2, Examples: ['2024SU', '2025FA', '2025JA']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Fall Term 2024-2025', 'Summer Term 2024', 'January Term 2024-2025']),
(TERM_START_DATE:DATE, Examples: ['03-SEP-24', '10-JUN-24', '06-JAN-25']),
(TERM_END_DATE:DATE, Examples: ['20-DEC-24', '20-AUG-24', '31-JAN-25']),
(TERM_LAST_DAY_BEFORE_NEXT_TERM:DATE, Examples: ['05-JAN-25', '02-SEP-24', '31-JAN-25']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['Y', 'N'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the department, school, course number, subject title, total number of enrolled students, term code, and count of distinct catalog ISBNs. Add a summary row at the bottom showing the total number of students and distinct catalog ISBNs for the current term in the format of ('TOTAL:', null, null, null, total number of students, null, number of distinct catalog ISBNs).

(Hints: Schema Mapping Hints:
- 'department' is related to LIBRARY_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'school' is related to LIBRARY_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'course number' is related to LIBRARY_SUBJECT_OFFERED.COURSE_NUMBER
- 'subject title' is related to LIBRARY_SUBJECT_OFFERED.SUBJECT_TITLE
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'term code' is related to LIBRARY_SUBJECT_OFFERED.TERM_CODE
- 'catalog ISBNs' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (ACADEMIC_TERM_PARAMETER.TERM_CODE = LIBRARY_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC880>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC850>

***** FINAL SQL QUERY *****
SELECT
  T1.OFFER_DEPT_NAME,
  T1.OFFER_SCHOOL_NAME,
  T1.COURSE_NUMBER,
  T1.SUBJECT_TITLE,
  T1.NUM_ENROLLED_STUDENTS,
  T1.TERM_CODE,
  COUNT(DISTINCT T3.CATALOG_ISBN) AS distinct_catalog_isbns
FROM LIBRARY_SUBJECT_OFFERED AS T1
JOIN LIBRARY_RESERVE_MATRL_DETAIL AS T2
  ON T1.LIBRARY_SUBJECT_OFFERED_KEY = T2.LIBRARY_SUBJECT_OFFERED_KEY
JOIN LIBRARY_RESERVE_CATALOG AS T3
  ON T2.LIBRARY_RESERVE_CATALOG_KEY = T3.LIBRARY_RESERVE_CATALOG_KEY
JOIN ACADEMIC_TERM_PARAMETER AS T4
  ON T1.TERM_CODE = T4.TERM_CODE
WHERE
  T4.IS_CURRENT_TERM = 'Y'
GROUP BY
  T1.OFFER_DEPT_NAME,
  T1.OFFER_SCHOOL_NAME,
  T1.COURSE_NUMBER,
  T1.SUBJECT_TITLE,
  T1.NUM_ENROLLED_STUDENTS,
  T1.TERM_CODE
UNION ALL
SELECT
  'TOTAL:' AS OFFER_DEPT_NAME,
  NULL AS OFFER_SCHOOL_NAME,
  NULL AS COURSE_NUMBER,
  NULL AS SUBJECT_TITLE,
  (
    SELECT
      SUM(sq.NUM_ENROLLED_STUDENTS)
    FROM (
      SELECT DISTINCT
        LSO.LIBRARY_SUBJECT_OFFERED_KEY,
        LSO.NUM_ENROLLED_STUDENTS
      FROM LIBRARY_SUBJECT_OFFERED AS LSO
      JOIN ACADEMIC_TERM_PARAMETER AS ATP
        ON LSO.TERM_CODE = ATP.TERM_CODE
      WHERE
        ATP.IS_CURRENT_TERM = 'Y'
    ) AS sq
  ) AS total_enrolled_students,
  NULL AS TERM_CODE,
  COUNT(DISTINCT T3_summary.CATALOG_ISBN) AS distinct_catalog_isbns
FROM LIBRARY_RESERVE_MATRL_DETAIL AS T2_summary
JOIN LIBRARY_RESERVE_CATALOG AS T3_summary
  ON T2_summary.LIBRARY_RESERVE_CATALOG_KEY = T3_summary.LIBRARY_RESERVE_CATALOG_KEY
JOIN LIBRARY_SUBJECT_OFFERED AS T1_summary
  ON T2_summary.LIBRARY_SUBJECT_OFFERED_KEY = T1_summary.LIBRARY_SUBJECT_OFFERED_KEY
JOIN ACADEMIC_TERM_PARAMETER AS T4_summary
  ON T1_summary.TERM_CODE = T4_summary.TERM_CODE
WHERE
  T4_summary.IS_CURRENT_TERM = 'Y';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2361, 673
TOTAL                  : 251732, 224667, 27065
AVG                    : 2996.81, 2674.61, 322.20
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_FLOOR
[
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(EXT_GROSS_AREA:NUMBER, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:VARCHAR2, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group buildings by campus sectors. For each group, list the campus sector, name of the building, city and state where the building is located, total number of floors, total assignable area, total number of rooms, total number of organizations, ownership type, and a rank column indicating the order (1-indexed) of this row within each sector based on the descending order of assignable area. Include subtotals for each sector and a grand total across all sectors. The subtotal and grand total only need to computed over the total number of floors and assignable area.

(Hints: Schema Mapping Hints:
- 'campus sector' is related to FCLT_BUILDING.CAMPUS_SECTOR
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME_LONG
- 'city' is related to FCLT_BUILDING_ADDRESS.CITY
- 'state' is related to FCLT_BUILDING_ADDRESS.STATE
- 'floors' is related to FCLT_FLOOR.FLOOR
- 'area' is related to FCLT_BUILDING.ASSIGNABLE_AREA
- 'rooms' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY
- 'ownership type' is related to FCLT_BUILDING.OWNERSHIP_TYPE

Join Information: (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_FLOOR.FCLT_BUILDING_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDCFF40>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCCAC0>

***** FINAL SQL QUERY *****
WITH building_addresses AS (
    SELECT
        FCLT_BUILDING_KEY,
        CITY,
        STATE
    FROM (
        SELECT
            FCLT_BUILDING_KEY,
            CITY,
            STATE,
            ROW_NUMBER() OVER (PARTITION BY FCLT_BUILDING_KEY ORDER BY CASE WHEN ADDRESS_PURPOSE = 'STREET' THEN 1 ELSE 2 END, ADDRESS_PURPOSE) AS rn
        FROM FCLT_BUILDING_ADDRESS
    ) AS sub
    WHERE rn = 1
),
building_metrics AS (
    SELECT
        FB.FCLT_BUILDING_KEY,
        FB.CAMPUS_SECTOR,
        FB.BUILDING_NAME_LONG,
        BA.CITY,
        BA.STATE,
        FB.OWNERSHIP_TYPE,
        FB.ASSIGNABLE_AREA AS building_assignable_area,
        COUNT(DISTINCT FF.FLOOR) AS total_floors,
        COUNT(DISTINCT FR.FCLT_ROOM_KEY) AS total_rooms,
        COUNT(DISTINCT FR.FCLT_ORGANIZATION_KEY) AS total_organizations
    FROM
        FCLT_BUILDING AS FB
    LEFT JOIN
        building_addresses AS BA ON FB.FCLT_BUILDING_KEY = BA.FCLT_BUILDING_KEY
    LEFT JOIN
        FCLT_FLOOR AS FF ON FB.FCLT_BUILDING_KEY = FF.FCLT_BUILDING_KEY
    LEFT JOIN
        FCLT_ROOMS AS FR ON FB.FCLT_BUILDING_KEY = FR.FCLT_BUILDING_KEY
    GROUP BY
        FB.FCLT_BUILDING_KEY,
        FB.CAMPUS_SECTOR,
        FB.BUILDING_NAME_LONG,
        BA.CITY,
        BA.STATE,
        FB.OWNERSHIP_TYPE,
        FB.ASSIGNABLE_AREA
),
ranked_building_metrics AS (
    SELECT
        CAMPUS_SECTOR,
        BUILDING_NAME_LONG,
        CITY,
        STATE,
        total_floors,
        building_assignable_area,
        total_rooms,
        total_organizations,
        OWNERSHIP_TYPE,
        RANK() OVER (PARTITION BY CAMPUS_SECTOR ORDER BY building_assignable_area DESC) AS building_rank
    FROM
        building_metrics
)
SELECT
    rbm.CAMPUS_SECTOR AS `campus sector`,
    rbm.BUILDING_NAME_LONG AS `name of the building`,
    rbm.CITY AS `city`,
    rbm.STATE AS `state`,
    rbm.total_floors AS `total number of floors`,
    rbm.building_assignable_area AS `total assignable area`,
    rbm.total_rooms AS `total number of rooms`,
    rbm.total_organizations AS `total number of organizations`,
    rbm.OWNERSHIP_TYPE AS `ownership type`,
    rbm.building_rank AS `rank`
FROM
    ranked_building_metrics rbm

UNION ALL

SELECT
    bm.CAMPUS_SECTOR AS `campus sector`,
    CONCAT('Subtotal for ', bm.CAMPUS_SECTOR) AS `name of the building`,
    NULL AS `city`,
    NULL AS `state`,
    SUM(bm.total_floors) AS `total number of floors`,
    SUM(bm.building_assignable_area) AS `total assignable area`,
    NULL AS `total number of rooms`,
    NULL AS `total number of organizations`,
    NULL AS `ownership type`,
    NULL AS `rank`
FROM
    building_metrics bm
GROUP BY
    bm.CAMPUS_SECTOR

UNION ALL

SELECT
    'Grand Total' AS `campus sector`,
    'Grand Total' AS `name of the building`,
    NULL AS `city`,
    NULL AS `state`,
    SUM(bm.total_floors) AS `total number of floors`,
    SUM(bm.building_assignable_area) AS `total assignable area`,
    NULL AS `total number of rooms`,
    NULL AS `total number of organizations`,
    NULL AS `ownership type`,
    NULL AS `rank`
FROM
    building_metrics bm

ORDER BY
    `campus sector` ASC,
    CASE
        WHEN `name of the building` LIKE 'Subtotal for %' THEN 1
        WHEN `name of the building` = 'Grand Total' THEN 2
        ELSE 0
    END ASC,
    `total assignable area` DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3663, 1065
TOTAL                  : 256460, 228330, 28130
AVG                    : 3017.18, 2686.24, 330.94
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING_HIST
[
(FCLT_BUILDING_HIST_KEY:VARCHAR2, Examples: ['14S-201505', '46-201505', 'E14-201505']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['201505', '201506', '201507']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['14S', '46', 'E14']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['14', 'W61', 'W70']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY', 'MACGREGOR HOUSE', 'NEW HOUSE']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library', 'Frank S MacGregor House', 'New West Campus Houses']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library (South Wing)', 'Brain & Cognitive Sciences Complex', 'Building E14']),
(EXT_GROSS_AREA:NUMBER, Examples: [48622.2, 418663.0, 173875.0]),
(ASSIGNABLE_AREA:NUMBER, Examples: [34500.5, 218519.0, 73792.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [10286.5, 152699.0, 83752.7]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHWEST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['(NULL)', 'UGBA3', 'UGBI2']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['136.4', '82.8', '88.3']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3623, 42.3605, 42.3615]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0916, -71.0873, -71.0879]),
(EASTING_X_SPCS:NUMBER, Examples: [766530.0, 767698.0, 767547.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2957330.0, 2956650.0, 2957020.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['14S', '46', 'E14']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['SEELY G. MUDD', 'HORACE SAYFORD FORD JR.', 'SEBASTIAN S. KRESGE']),
(BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY (S)', 'BCSC', 'BUILDING E14']),
(DATE_BUILT:VARCHAR2, Examples: ['04/25/2003', '12/31/1932', '12/31/1920']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['05/01/1961', '12/31/1955', '12/31/1939']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['09/01/2005', '03/06/1975', '10/01/1964']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-DEC-14', '01-JAN-15', '01-FEB-15']),
(NUM_OF_ROOMS:NUMBER, Examples: [118, 1403, 341])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group all buildings at MIT into either owned or leased. For each group, state the ownership type, usage type, number of buildings, gross square footage, number of rooms, and the number of associated organizations. Display the ownership type only if it differs from the previous row. Include subtotals for each group and a grand total across all groups. The subtotal and grand total rows should not include ownership type and usage type. Footage should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'buildings at MIT' is related to FCLT_BUILDING_HIST.SITE
- 'ownership type' is related to FCLT_BUILDING_HIST.OWNERSHIP_TYPE
- 'usage type' is related to FCLT_BUILDING_HIST.BUILDING_USE
- 'buildings' is related to FCLT_BUILDING_HIST.PARENT_BUILDING_NUMBER, FCLT_BUILDING_HIST.FCLT_BUILDING_KEY
- 'gross square footage' is related to FCLT_BUILDING_HIST.EXT_GROSS_AREA
- 'rooms' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY

Join Information: (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING_HIST.FCLT_BUILDING_KEY), (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FCLT_ROOMS.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC340>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC310>

***** FINAL SQL QUERY *****
```mysql
WITH RolledUpData AS (
    SELECT
        fbh.OWNERSHIP_TYPE,
        fbh.BUILDING_USE,
        COUNT(DISTINCT fbh.FCLT_BUILDING_KEY) AS NumBuildings,
        SUM(fbh.EXT_GROSS_AREA) AS GrossArea,
        COUNT(DISTINCT fr.FCLT_ROOM_KEY) AS NumRooms,
        COUNT(DISTINCT fo.FCLT_ORGANIZATION_KEY) AS NumOrgs,
        GROUPING(fbh.OWNERSHIP_TYPE) AS grp_ownership,
        GROUPING(fbh.BUILDING_USE) AS grp_building_use
    FROM
        FCLT_BUILDING_HIST AS fbh
    LEFT JOIN
        FCLT_ROOMS AS fr ON fbh.FCLT_BUILDING_KEY = fr.FCLT_BUILDING_KEY
    LEFT JOIN
        FCLT_ORGANIZATION AS fo ON fr.FCLT_ORGANIZATION_KEY = fo.FCLT_ORGANIZATION_KEY
    WHERE
        fbh.SITE = 'MIT'
    GROUP BY
        fbh.OWNERSHIP_TYPE,
        fbh.BUILDING_USE WITH ROLLUP
)
SELECT
    CASE
        -- Grand Total row (where grp_ownership is 1)
        WHEN rd.grp_ownership = 1 THEN NULL
        -- Ownership Subtotal row (where grp_building_use is 1 and grp_ownership is 0)
        -- Per "subtotal and grand total rows should not include ownership type"
        WHEN rd.grp_building_use = 1 THEN NULL
        -- For detail rows, display ownership type only if it differs from the previous row
        WHEN LAG(rd.OWNERSHIP_TYPE, 1, '') OVER (ORDER BY
                                                   CASE WHEN rd.grp_ownership = 1 THEN 2 ELSE 1 END,
                                                   rd.OWNERSHIP_TYPE,
                                                   CASE WHEN rd.grp_building_use = 1 THEN 2 ELSE 1 END,
                                                   rd.BUILDING_USE) = rd.OWNERSHIP_TYPE AND
             -- Ensure the previous row was also a detail row of the same ownership type
             LAG(rd.grp_ownership, 1, 1) OVER (ORDER BY
                                                   CASE WHEN rd.grp_ownership = 1 THEN 2 ELSE 1 END,
                                                   rd.OWNERSHIP_TYPE,
                                                   CASE WHEN rd.grp_building_use = 1 THEN 2 ELSE 1 END,
                                                   rd.BUILDING_USE) = 0 AND
             LAG(rd.grp_building_use, 1, 1) OVER (ORDER BY
                                                   CASE WHEN rd.grp_ownership = 1 THEN 2 ELSE 1 END,
                                                   rd.OWNERSHIP_TYPE,
                                                   CASE WHEN rd.grp_building_use = 1 THEN 2 ELSE 1 END,
                                                   rd.BUILDING_USE) = 0
        THEN NULL
        ELSE rd.OWNERSHIP_TYPE
    END AS `Ownership Type`,
    CASE
        -- Grand Total row
        WHEN rd.grp_ownership = 1 AND rd.grp_building_use = 1 THEN 'Grand Total'
        -- Ownership Subtotal row
        WHEN rd.grp_building_use = 1 THEN CONCAT('Subtotal for ', rd.OWNERSHIP_TYPE)
        -- Detail row
        ELSE rd.BUILDING_USE
    END AS `Usage Type`,
    rd.NumBuildings AS `Number of Buildings`,
    FORMAT(ROUND(rd.GrossArea), 0) AS `Gross Square Footage`,
    rd.NumRooms AS `Number of Rooms`,
    rd.NumOrgs AS `Number of Associated Organizations`
FROM
    RolledUpData AS rd
ORDER BY
    CASE WHEN rd.grp_ownership = 1 THEN 2 ELSE 1 END, -- Grand Total last
    rd.OWNERSHIP_TYPE,
    CASE WHEN rd.grp_building_use = 1 THEN 2 ELSE 1 END, -- Subtotals for ownership type after its detail rows
    rd.BUILDING_USE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2876, 943
TOTAL                  : 260279, 231206, 29073
AVG                    : 3026.50, 2688.44, 338.06
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each mailing list that involves subscribers that work in departments with names starting with 'Computer Science', state the ownership type, the list name, the number of owners, and the number of subscribers. Display the ownership type only if it differs from the previous entry. Include subtotals (the corresponding type field shoud be 'SUBTOTAL') for each ownership type and a grand total (the corresponding type field shoud be 'TOTAL') across all ownership types.

(Hints: Schema Mapping Hints:
- 'departments with names starting with 'Computer Science'' is related to EMPLOYEE_DIRECTORY.DEPARTMENT_NAME
- 'ownership type' is related to MOIRA_LIST_OWNER.OWNER_TYPE
- 'list name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'owners' is related to MOIRA_LIST_OWNER.OWNER
- 'subscribers' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (EMPLOYEE_DIRECTORY.MIT_ID = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC700>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC6D0>

***** FINAL SQL QUERY *****
SELECT
  CASE
    WHEN GROUPING(T3.OWNER_TYPE) = 1 AND GROUPING(T2.MOIRA_LIST_NAME) = 1
    THEN 'TOTAL'
    WHEN GROUPING(T3.OWNER_TYPE) = 1
    THEN 'SUBTOTAL'
    ELSE T3.OWNER_TYPE
  END AS `Ownership Type`,
  CASE
    WHEN GROUPING(T2.MOIRA_LIST_NAME) = 1
    THEN 'SUBTOTAL'
    ELSE T2.MOIRA_LIST_NAME
  END AS `List Name`,
  COUNT(DISTINCT T3.OWNER) AS `Number of Owners`,
  COUNT(DISTINCT T1.MOIRA_LIST_MEMBER_MIT_ID) AS `Number of Subscribers`
FROM MOIRA_LIST_DETAIL AS T1
INNER JOIN MOIRA_LIST AS T2
  ON T1.MOIRA_LIST_KEY = T2.MOIRA_LIST_KEY
INNER JOIN MOIRA_LIST_OWNER AS T3
  ON T1.MOIRA_LIST_OWNER_KEY = T3.MOIRA_LIST_OWNER_KEY
INNER JOIN EMPLOYEE_DIRECTORY AS T4
  ON T1.MOIRA_LIST_MEMBER_MIT_ID = T4.MIT_ID
WHERE
  T4.DEPARTMENT_NAME LIKE 'Computer Science%' AND T2.IS_MOIRA_MAILING_LIST = 'Y'
GROUP BY
  T3.OWNER_TYPE,
  T2.MOIRA_LIST_NAME WITH ROLLUP
ORDER BY
  CASE
    WHEN GROUPING(T3.OWNER_TYPE) = 1
    THEN 2
    ELSE 1
  END,
  T3.OWNER_TYPE,
  CASE
    WHEN GROUPING(T2.MOIRA_LIST_NAME) = 1
    THEN 2
    ELSE 1
  END,
  T2.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1786, 462
TOTAL                  : 262527, 232992, 29535
AVG                    : 3017.55, 2678.07, 339.48
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]

### Question ###
List each floor key and department name within the Stata building, as well as the number of rooms, total area, and average area per department on each floor. Include subtotals for each floor and a grand total across all floors. Sort the results by floor key and department name in ascending order. Exclude departments without any rooms in the building. Only the first row of each floor group should include the floor key, and the subtotal and grand total rows should not include floor key or department name. Number of rooms and area should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'floor key' is related to FAC_FLOOR.FLOOR_KEY
- 'department name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'Stata building' is related to BUILDINGS.BUILDING_NAME
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY
- 'area' is related to FAC_ROOMS.AREA

Join Information: (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FAC_ROOMS.ORGANIZATION_KEY), (BUILDINGS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC4C0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC490>

***** FINAL SQL QUERY *****
SELECT
    CASE WHEN T.rn = 1 THEN T.FLOOR_KEY ELSE NULL END AS `floor key`,
    T.ORGANIZATION_NAME AS `department name`,
    FORMAT(ROUND(T.num_rooms), 0) AS `number of rooms`,
    FORMAT(ROUND(T.total_area), 0) AS `total area`,
    FORMAT(ROUND(T.avg_area), 0) AS `average area`
FROM (
    SELECT
        FR.FLOOR_KEY,
        FO.ORGANIZATION_NAME,
        COUNT(FR.FAC_ROOM_KEY) AS num_rooms,
        SUM(FR.AREA) AS total_area,
        AVG(FR.AREA) AS avg_area,
        ROW_NUMBER() OVER (PARTITION BY FR.FLOOR_KEY ORDER BY FO.ORGANIZATION_NAME ASC) as rn,
        1 as _sort_level,
        FR.FLOOR_KEY as _sort_floor,
        FO.ORGANIZATION_NAME as _sort_dept
    FROM
        BUILDINGS AS B
    INNER JOIN
        FAC_ROOMS AS FR ON B.BUILDING_KEY = FR.BUILDING_KEY
    INNER JOIN
        FCLT_ORGANIZATION AS FO ON FR.ORGANIZATION_KEY = FO.FCLT_ORGANIZATION_KEY
    WHERE
        B.BUILDING_NAME = 'Stata building'
    GROUP BY
        FR.FLOOR_KEY,
        FO.ORGANIZATION_NAME
    HAVING
        COUNT(FR.FAC_ROOM_KEY) > 0
) AS T

UNION ALL

-- Floor Subtotals
SELECT
    NULL AS `floor key`,
    NULL AS `department name`,
    FORMAT(ROUND(COUNT(FR.FAC_ROOM_KEY)), 0) AS `number of rooms`,
    FORMAT(ROUND(SUM(FR.AREA)), 0) AS `total area`,
    FORMAT(ROUND(SUM(FR.AREA) / COUNT(FR.FAC_ROOM_KEY)), 0) AS `average area`,
    2 as _sort_level,
    FR.FLOOR_KEY as _sort_floor,
    NULL as _sort_dept
FROM
    BUILDINGS AS B
INNER JOIN
    FAC_ROOMS AS FR ON B.BUILDING_KEY = FR.BUILDING_KEY
INNER JOIN
    FCLT_ORGANIZATION AS FO ON FR.ORGANIZATION_KEY = FO.FCLT_ORGANIZATION_KEY
WHERE
    B.BUILDING_NAME = 'Stata building'
GROUP BY
    FR.FLOOR_KEY
HAVING
    COUNT(FR.FAC_ROOM_KEY) > 0

UNION ALL

-- Grand Total
SELECT
    NULL AS `floor key`,
    NULL AS `department name`,
    FORMAT(ROUND(COUNT(FR.FAC_ROOM_KEY)), 0) AS `number of rooms`,
    FORMAT(ROUND(SUM(FR.AREA)), 0) AS `total area`,
    FORMAT(ROUND(SUM(FR.AREA) / COUNT(FR.FAC_ROOM_KEY)), 0) AS `average area`,
    3 as _sort_level,
    NULL as _sort_floor,
    NULL as _sort_dept
FROM
    BUILDINGS AS B
INNER JOIN
    FAC_ROOMS AS FR ON B.BUILDING_KEY = FR.BUILDING_KEY
INNER JOIN
    FCLT_ORGANIZATION AS FO ON FR.ORGANIZATION_KEY = FO.FCLT_ORGANIZATION_KEY
WHERE
    B.BUILDING_NAME = 'Stata building'
HAVING
    COUNT(FR.FAC_ROOM_KEY) > 0

ORDER BY
    _sort_floor ASC,
    _sort_level ASC,
    _sort_dept ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2152, 860
TOTAL                  : 265539, 235144, 30395
AVG                    : 3017.49, 2672.09, 345.40
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_MAJOR_USE
[
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE:VARCHAR2, Examples: ['BLDG SRV', 'CIRCULAT', 'CLASSRMS']),
(DESCRIPTION:VARCHAR2, Examples: ['BLDG SERVICE AREA', 'CIRCULATION AREA', 'CLASSROOMS']),
(ASSIGNABLE:VARCHAR2, Examples: ['0', '1']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group all rooms into whether or not they are assignable and the major use descriptions. For each group, state "ASSIGNABLE" if the room is assignable and "NON-ASSIGNABLE" otherwise, the major use description, the total number of rooms, total area, and average area. Include subtotals for each group and a grand total across all groups. The assignable status and major use descriptions should only be displayed when they differ from the previous row. Do not include rooms whose major use or major use description starts with 'ZUSE.' The results should be sorted by assignable status and major use description. The subtotal and grand total rows should not include assignable status or major use description.

(Hints: Schema Mapping Hints:
- 'rooms' is related to FCLT_ROOMS.ROOM
- 'assignable' is related to FCLT_MAJOR_USE.ASSIGNABLE
- 'major use description' is related to FCLT_MAJOR_USE.MAJOR_USE, FCLT_ROOMS.MAJOR_USE_DESC, FCLT_MAJOR_USE.DESCRIPTION
- 'area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_ROOMS.FCLT_MAJOR_USE_KEY = FCLT_MAJOR_USE.FCLT_MAJOR_USE_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC640>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC610>

***** FINAL SQL QUERY *****
WITH RolledUpData AS (
    SELECT
        fm.ASSIGNABLE,
        fm.DESCRIPTION AS MAJOR_USE_DESCRIPTION_RAW,
        COUNT(fr.FCLT_ROOM_KEY) AS total_rooms,
        SUM(fr.AREA) AS total_area,
        AVG(fr.AREA) AS average_area,
        GROUPING(fm.ASSIGNABLE) AS grouping_assignable,
        GROUPING(fm.DESCRIPTION) AS grouping_description
    FROM FCLT_ROOMS AS fr
    JOIN FCLT_MAJOR_USE AS fm
        ON fr.FCLT_MAJOR_USE_KEY = fm.FCLT_MAJOR_USE_KEY
    WHERE
        fm.MAJOR_USE NOT LIKE 'ZUSE%'
        AND fm.DESCRIPTION NOT LIKE 'ZUSE%'
    GROUP BY
        fm.ASSIGNABLE,
        fm.DESCRIPTION WITH ROLLUP
),
PreparedData AS (
    SELECT
        rd.ASSIGNABLE,
        rd.MAJOR_USE_DESCRIPTION_RAW,
        CASE WHEN rd.ASSIGNABLE = '1' THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END AS current_assignable_status_text,
        rd.MAJOR_USE_DESCRIPTION_RAW AS current_major_use_desc_text,
        rd.total_rooms,
        rd.total_area,
        rd.average_area,
        rd.grouping_assignable,
        rd.grouping_description,
        -- Calculate previous assignable status for suppression logic
        LAG(CASE WHEN rd.grouping_assignable = 0 AND rd.grouping_description = 0 THEN (CASE WHEN rd.ASSIGNABLE = '1' THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END) END)
            OVER (ORDER BY rd.ASSIGNABLE IS NULL, rd.ASSIGNABLE ASC, rd.MAJOR_USE_DESCRIPTION_RAW IS NULL, rd.MAJOR_USE_DESCRIPTION_RAW ASC) AS prev_assignable_status_overall,
        -- Calculate previous major use description, partitioned by assignable status for suppression logic within groups
        LAG(CASE WHEN rd.grouping_assignable = 0 AND rd.grouping_description = 0 THEN rd.MAJOR_USE_DESCRIPTION_RAW END)
            OVER (PARTITION BY rd.ASSIGNABLE ORDER BY rd.MAJOR_USE_DESCRIPTION_RAW IS NULL, rd.MAJOR_USE_DESCRIPTION_RAW ASC) AS prev_major_use_desc_partitioned
    FROM RolledUpData AS rd
)
SELECT
    CASE
        -- Suppress assignable status for subtotal and grand total rows
        WHEN pd.grouping_assignable = 1 OR pd.grouping_description = 1 THEN NULL
        -- Display assignable status only if it's the first in its group or different from the previous row
        WHEN pd.current_assignable_status_text <> pd.prev_assignable_status_overall OR pd.prev_assignable_status_overall IS NULL THEN pd.current_assignable_status_text
        ELSE NULL -- Suppress if same as previous detail row
    END AS `Assignable Status`,
    CASE
        -- Suppress major use description for subtotal and grand total rows
        WHEN pd.grouping_description = 1 THEN NULL
        -- Display major use description only if it's the first in its assignable group or different from the previous row within that group
        WHEN pd.current_major_use_desc_text <> pd.prev_major_use_desc_partitioned OR pd.prev_major_use_desc_partitioned IS NULL THEN pd.current_major_use_desc_text
        ELSE NULL -- Suppress if same as previous detail row in the same assignable group
    END AS `Major Use Description`,
    pd.total_rooms AS `Total Rooms`,
    pd.total_area AS `Total Area`,
    pd.average_area AS `Average Area`
FROM PreparedData AS pd
ORDER BY
    pd.ASSIGNABLE IS NULL, pd.ASSIGNABLE ASC,
    pd.MAJOR_USE_DESCRIPTION_RAW IS NULL, pd.MAJOR_USE_DESCRIPTION_RAW ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1157, 931
TOTAL                  : 267627, 236301, 31326
AVG                    : 3007.04, 2655.07, 351.98
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each IAP category, list its name, number of unique sessions, total number of attendees, active period (in the format of 'beginning term code-end term code'), the most common sponsor name, and the most common session start time. Include a grand total row showing the total number of sessions and attendees across all categories in the format of ('TOTAL', number of sessions, number of attendees, null, null, null).

(Hints: Schema Mapping Hints:
- 'name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'attendees' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT
- 'active period' is related to IAP_SUBJECT_DETAIL.TERM_CODE
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'session start time' is related to IAP_SUBJECT_SESSION.SESSION_START_TIME

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY), (IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC280>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC250>

***** FINAL SQL QUERY *****
WITH CategorySponsorCounts AS (
    SELECT
        T1.IAP_SUBJECT_CATEGORY_KEY,
        T4.SPONSOR_NAME,
        COUNT(T4.SPONSOR_NAME) AS sponsor_count,
        ROW_NUMBER() OVER(PARTITION BY T1.IAP_SUBJECT_CATEGORY_KEY ORDER BY COUNT(T4.SPONSOR_NAME) DESC, T4.SPONSOR_NAME) as rn
    FROM
        IAP_SUBJECT_CATEGORY AS T1
    JOIN
        IAP_SUBJECT_DETAIL AS T2 ON T1.IAP_SUBJECT_CATEGORY_KEY = T2.IAP_SUBJECT_CATEGORY_KEY
    JOIN
        IAP_SUBJECT_SPONSOR AS T4 ON T2.IAP_SUBJECT_SPONSOR_KEY = T4.IAP_SUBJECT_SPONSOR_KEY
    GROUP BY
        T1.IAP_SUBJECT_CATEGORY_KEY, T4.SPONSOR_NAME
),
MostCommonSponsor AS (
    SELECT
        IAP_SUBJECT_CATEGORY_KEY,
        SPONSOR_NAME
    FROM
        CategorySponsorCounts
    WHERE
        rn = 1
),
CategorySessionStartCounts AS (
    SELECT
        T1.IAP_SUBJECT_CATEGORY_KEY,
        T3.SESSION_START_TIME,
        COUNT(T3.SESSION_START_TIME) AS start_time_count,
        ROW_NUMBER() OVER(PARTITION BY T1.IAP_SUBJECT_CATEGORY_KEY ORDER BY COUNT(T3.SESSION_START_TIME) DESC, T3.SESSION_START_TIME) as rn
    FROM
        IAP_SUBJECT_CATEGORY AS T1
    JOIN
        IAP_SUBJECT_DETAIL AS T2 ON T1.IAP_SUBJECT_CATEGORY_KEY = T2.IAP_SUBJECT_CATEGORY_KEY
    JOIN
        IAP_SUBJECT_SESSION AS T3 ON T2.IAP_SUBJECT_SESSION_KEY = T3.IAP_SUBJECT_SESSION_KEY
    GROUP BY
        T1.IAP_SUBJECT_CATEGORY_KEY, T3.SESSION_START_TIME
),
MostCommonSessionStart AS (
    SELECT
        IAP_SUBJECT_CATEGORY_KEY,
        SESSION_START_TIME
    FROM
        CategorySessionStartCounts
    WHERE
        rn = 1
)
SELECT
    T1.IAP_CATEGORY_NAME,
    COUNT(DISTINCT T3.IAP_SUBJECT_SESSION_KEY) AS NumberOfUniqueSessions,
    SUM(T2.MAX_ENROLLMENT) AS TotalAttendees,
    CONCAT(MIN(T2.TERM_CODE), '-', MAX(T2.TERM_CODE)) AS ActivePeriod,
    MCS.SPONSOR_NAME AS MostCommonSponsorName,
    MCSS.SESSION_START_TIME AS MostCommonSessionStartTime
FROM
    IAP_SUBJECT_CATEGORY AS T1
LEFT JOIN
    IAP_SUBJECT_DETAIL AS T2 ON T1.IAP_SUBJECT_CATEGORY_KEY = T2.IAP_SUBJECT_CATEGORY_KEY
LEFT JOIN
    IAP_SUBJECT_SESSION AS T3 ON T2.IAP_SUBJECT_SESSION_KEY = T3.IAP_SUBJECT_SESSION_KEY
LEFT JOIN
    IAP_SUBJECT_SPONSOR AS T4 ON T2.IAP_SUBJECT_SPONSOR_KEY = T4.IAP_SUBJECT_SPONSOR_KEY
LEFT JOIN
    MostCommonSponsor AS MCS ON T1.IAP_SUBJECT_CATEGORY_KEY = MCS.IAP_SUBJECT_CATEGORY_KEY
LEFT JOIN
    MostCommonSessionStart AS MCSS ON T1.IAP_SUBJECT_CATEGORY_KEY = MCSS.IAP_SUBJECT_CATEGORY_KEY
GROUP BY
    T1.IAP_SUBJECT_CATEGORY_KEY, T1.IAP_CATEGORY_NAME
UNION ALL
SELECT
    'TOTAL',
    COUNT(DISTINCT T3_total.IAP_SUBJECT_SESSION_KEY),
    SUM(T2_total.MAX_ENROLLMENT),
    NULL,
    NULL,
    NULL
FROM
    IAP_SUBJECT_DETAIL AS T2_total
JOIN
    IAP_SUBJECT_SESSION AS T3_total ON T2_total.IAP_SUBJECT_SESSION_KEY = T3_total.IAP_SUBJECT_SESSION_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2356, 1005
TOTAL                  : 270988, 238657, 32331
AVG                    : 3010.98, 2651.74, 359.23
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_HIST
[
(FCLT_BUILDING_HIST_KEY:VARCHAR2, Examples: ['14S-201505', '46-201505', 'E14-201505']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['201505', '201506', '201507']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['14S', '46', 'E14']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['14', 'W61', 'W70']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY', 'MACGREGOR HOUSE', 'NEW HOUSE']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library', 'Frank S MacGregor House', 'New West Campus Houses']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library (South Wing)', 'Brain & Cognitive Sciences Complex', 'Building E14']),
(EXT_GROSS_AREA:NUMBER, Examples: [48622.2, 418663.0, 173875.0]),
(ASSIGNABLE_AREA:NUMBER, Examples: [34500.5, 218519.0, 73792.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [10286.5, 152699.0, 83752.7]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHWEST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['(NULL)', 'UGBA3', 'UGBI2']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['136.4', '82.8', '88.3']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3623, 42.3605, 42.3615]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0916, -71.0873, -71.0879]),
(EASTING_X_SPCS:NUMBER, Examples: [766530.0, 767698.0, 767547.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2957330.0, 2956650.0, 2957020.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['14S', '46', 'E14']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['SEELY G. MUDD', 'HORACE SAYFORD FORD JR.', 'SEBASTIAN S. KRESGE']),
(BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY (S)', 'BCSC', 'BUILDING E14']),
(DATE_BUILT:VARCHAR2, Examples: ['04/25/2003', '12/31/1932', '12/31/1920']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['05/01/1961', '12/31/1955', '12/31/1939']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['09/01/2005', '03/06/1975', '10/01/1964']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-DEC-14', '01-JAN-15', '01-FEB-15']),
(NUM_OF_ROOMS:NUMBER, Examples: [118, 1403, 341])
]

### Question ###
For each building type, list the name of the building type, the number of buildings that are not subdivisions, number of employees, number of unique building street address, number of unique city, number of unique state, number of unique postal code, and average gross square footage per employee. For building type of 'resident', display it as 'RESIDENTIAL'. Include a grand total across all building types (the corresponding type field is 'TOTAL').

(Hints: Schema Mapping Hints:
- 'name of the building type' is related to FCLT_BUILDING_HIST.BUILDING_TYPE
- 'buildings that are not subdivisions' is related to FCLT_BUILDING_HIST.FCLT_BUILDING_KEY, FCLT_BUILDING_HIST.PARENT_BUILDING_NUMBER
- 'employees' is related to EMPLOYEE_DIRECTORY.MIT_ID
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'postal code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'gross square footage' is related to FCLT_BUILDING_HIST.EXT_GROSS_AREA

Join Information: (FAC_BUILDING_ADDRESS.BUILDING_KEY = FCLT_BUILDING_HIST.FCLT_BUILDING_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (EMPLOYEE_DIRECTORY.OFFICE_LOCATION = FAC_ROOMS.FAC_ROOM_KEY), (FCLT_BUILDING_HIST.FCLT_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_ROOMS.FAC_ROOM_KEY = EMPLOYEE_DIRECTORY.OFFICE_LOCATION))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDECC40>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDECC10>

***** FINAL SQL QUERY *****
SELECT
  CASE
    WHEN GROUPING(T1.BUILDING_TYPE) = 1
    THEN 'TOTAL'
    WHEN T1.BUILDING_TYPE = 'RESIDENT'
    THEN 'RESIDENTIAL'
    ELSE T1.BUILDING_TYPE
  END AS `Building Type Name`,
  COUNT(DISTINCT CASE WHEN T1.PARENT_BUILDING_NUMBER IS NULL THEN T1.FCLT_BUILDING_KEY ELSE NULL END) AS `Number of Buildings That Are Not Subdivisions`,
  COUNT(DISTINCT T5.MIT_ID) AS `Number of Employees`,
  COUNT(DISTINCT T2.BUILDING_STREET_ADDRESS) AS `Number of Unique Building Street Address`,
  COUNT(DISTINCT T3.CITY) AS `Number of Unique City`,
  COUNT(DISTINCT T3.STATE) AS `Number of Unique State`,
  COUNT(DISTINCT T3.POSTAL_CODE) AS `Number of Unique Postal Code`,
  SUM(T1.EXT_GROSS_AREA) / NULLIF(COUNT(DISTINCT T5.MIT_ID), 0) AS `Average Gross Square Footage Per Employee`
FROM FCLT_BUILDING_HIST AS T1
LEFT JOIN BUILDINGS AS T2
  ON T1.FCLT_BUILDING_KEY = T2.BUILDING_KEY
LEFT JOIN FAC_BUILDING_ADDRESS AS T3
  ON T1.FCLT_BUILDING_KEY = T3.BUILDING_KEY
LEFT JOIN FAC_ROOMS AS T4
  ON T2.BUILDING_KEY = T4.BUILDING_KEY
LEFT JOIN EMPLOYEE_DIRECTORY AS T5
  ON T4.FAC_ROOM_KEY = T5.OFFICE_LOCATION
GROUP BY
  T1.BUILDING_TYPE WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3655, 415
TOTAL                  : 275058, 242312, 32746
AVG                    : 3022.62, 2662.77, 359.85
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List each building key and floor key within the department of facilities, the number of rooms, total area, average area per floor, building name, access level, zip code, and city. Include subtotals for each building and a grand total across all buildings. The subtotals and grand total should not include zip code or city. Numbers of rooms and area should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'building key' is related to FAC_ROOMS.BUILDING_KEY
- 'floor key' is related to FAC_ROOMS.FLOOR_KEY
- 'department' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY
- 'area' is related to FAC_ROOMS.AREA
- 'building name' is related to FAC_BUILDING.BUILDING_NAME_LONG
- 'access level' is related to FAC_BUILDING.ACCESS_LEVEL_NAME
- 'zip code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY

Join Information: (FAC_ORGANIZATION.ORGANIZATION_KEY = FAC_ROOMS.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC940>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC910>

***** FINAL SQL QUERY *****
SELECT
  COALESCE(FR.BUILDING_KEY, 'Grand Total') AS `Building Key`,
  CASE
    WHEN GROUPING(FR.FLOOR_KEY) = 1 AND GROUPING(FR.BUILDING_KEY) = 0
    THEN 'Building Subtotal'
    WHEN GROUPING(FR.FLOOR_KEY) = 0
    THEN FR.FLOOR_KEY
    ELSE NULL
  END AS `Floor Key`,
  FORMAT(ROUND(COUNT(FR.FAC_ROOM_KEY)), 0) AS `Number of Rooms`,
  FORMAT(ROUND(SUM(CAST(FR.AREA AS DECIMAL(10, 2)))), 0) AS `Total Area`,
  FORMAT(ROUND(SUM(CAST(FR.AREA AS DECIMAL(10, 2))) / COUNT(DISTINCT FR.FLOOR_KEY)), 0) AS `Average Area Per Floor`,
  CASE
    WHEN GROUPING(FR.BUILDING_KEY) = 1
    THEN NULL
    ELSE FB.BUILDING_NAME_LONG
  END AS `Building Name`,
  CASE
    WHEN GROUPING(FR.BUILDING_KEY) = 1
    THEN NULL
    ELSE FB.ACCESS_LEVEL_NAME
  END AS `Access Level`,
  CASE
    WHEN GROUPING(FR.FLOOR_KEY) = 0
    THEN FBA.POSTAL_CODE
    ELSE NULL
  END AS `Zip Code`,
  CASE
    WHEN GROUPING(FR.FLOOR_KEY) = 0
    THEN FBA.CITY
    ELSE NULL
  END AS `City`
FROM FAC_ROOMS AS FR
JOIN FAC_BUILDING AS FB
  ON FR.BUILDING_KEY = FB.FAC_BUILDING_KEY
JOIN FAC_ORGANIZATION AS FO
  ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY
LEFT JOIN FAC_BUILDING_ADDRESS AS FBA
  ON FB.FAC_BUILDING_KEY = FBA.BUILDING_KEY
WHERE
  FR.ORGANIZATION_NAME = 'DOF'
GROUP BY
  FR.BUILDING_KEY,
  FR.FLOOR_KEY,
  FB.BUILDING_NAME_LONG,
  FB.ACCESS_LEVEL_NAME,
  FBA.POSTAL_CODE,
  FBA.CITY WITH ROLLUP
ORDER BY
  CASE
    WHEN FR.BUILDING_KEY IS NULL
    THEN 1
    ELSE 0
  END,
  FR.BUILDING_KEY,
  CASE
    WHEN FR.FLOOR_KEY IS NULL
    THEN 1
    ELSE 0
  END,
  FR.FLOOR_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3296, 615
TOTAL                  : 278969, 245608, 33361
AVG                    : 3032.27, 2669.65, 362.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, list its name, name of the building of the course location, the start date, the name of the course before it, and the name of the course after it, access level of the building, and the assignable area of the room used for the course, sorted by the ascending order start date and course name.

(Hints: Schema Mapping Hints:
- 'name' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME_LONG
- 'start date' is related to ACADEMIC_TERMS.TERM_START_DATE
- 'name of the course' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'access level' is related to FCLT_BUILDING.ACCESS_LEVEL_NAME
- 'area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDECAC0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDECA90>

***** FINAL SQL QUERY *****
SELECT
  T1.SUBJECT_TITLE,
  T4.BUILDING_NAME_LONG,
  T2.TERM_START_DATE,
  LAG(T1.SUBJECT_TITLE, 1) OVER (
    ORDER BY
      T2.TERM_START_DATE,
      T1.SUBJECT_TITLE
  ) AS PREVIOUS_COURSE_NAME,
  LEAD(T1.SUBJECT_TITLE, 1) OVER (
    ORDER BY
      T2.TERM_START_DATE,
      T1.SUBJECT_TITLE
  ) AS NEXT_COURSE_NAME,
  T4.ACCESS_LEVEL_NAME,
  T3.AREA
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
INNER JOIN ACADEMIC_TERMS AS T2
  ON T1.TERM_CODE = T2.TERM_CODE
INNER JOIN FCLT_ROOMS AS T3
  ON T1.MEET_PLACE = T3.BUILDING_ROOM
INNER JOIN FCLT_BUILDING AS T4
  ON T3.FCLT_BUILDING_KEY = T4.FCLT_BUILDING_KEY
ORDER BY
  T2.TERM_START_DATE,
  T1.SUBJECT_TITLE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5214, 289
TOTAL                  : 284472, 250822, 33650
AVG                    : 3058.84, 2697.01, 361.83
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, list its title, name of the building of the course location, duration (in terms of days), and a running average of the duration (in terms of days) using a window of two preceding and two following courses (partitioned by academic year and sorted by course start date).

(Hints: Schema Mapping Hints:
- 'title' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME
- 'duration' is related to ACADEMIC_TERMS.TERM_END_DATE, ACADEMIC_TERMS.TERM_START_DATE

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.EFFECTIVE_TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDECD00>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDECCD0>

***** FINAL SQL QUERY *****
SELECT
  T1.SUBJECT_TITLE,
  T4.BUILDING_NAME,
  DATEDIFF(T2.TERM_END_DATE, T2.TERM_START_DATE) AS duration_days,
  AVG(DATEDIFF(T2.TERM_END_DATE, T2.TERM_START_DATE)) OVER (
    PARTITION BY
      T2.ACADEMIC_YEAR
    ORDER BY
      T2.TERM_START_DATE ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING
  ) AS running_avg_duration_days
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
INNER JOIN ACADEMIC_TERMS AS T2
  ON T1.EFFECTIVE_TERM_CODE = T2.TERM_CODE
LEFT JOIN FCLT_ROOMS AS T3
  ON T1.MEET_PLACE = T3.BUILDING_ROOM
LEFT JOIN FCLT_BUILDING AS T4
  ON T3.FCLT_BUILDING_KEY = T4.FCLT_BUILDING_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5184, 248
TOTAL                  : 289904, 256006, 33898
AVG                    : 3084.09, 2723.47, 360.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, list its name, name of the building of the course location, and the cumulative number of courses, including the course itself, held in the same year or preceding years (partitioned by academic year and sorted in the ascending order of course start date).

(Hints: Schema Mapping Hints:
- 'name' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'academic year' is related to COURSE_CATALOG_SUBJECT_OFFERED.ACADEMIC_YEAR
- 'course start date' is related to ACADEMIC_TERMS.TERM_START_DATE

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.EFFECTIVE_TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FCLT_ROOMS.FCLT_ROOM_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDECA00>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC9D0>

***** FINAL SQL QUERY *****
```mysql
SELECT
  T1.SUBJECT_TITLE AS course_name,
  T4.BUILDING_NAME AS building_name,
  COUNT(T1.SUBJECT_ID) OVER (PARTITION BY T1.ACADEMIC_YEAR ORDER BY T2.TERM_START_DATE) AS cumulative_courses
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
JOIN ACADEMIC_TERMS AS T2
  ON T1.EFFECTIVE_TERM_CODE = T2.TERM_CODE
JOIN FCLT_ROOMS AS T3
  ON T1.MEET_PLACE = T3.FCLT_ROOM_KEY
JOIN FCLT_BUILDING AS T4
  ON T3.FCLT_BUILDING_KEY = T4.FCLT_BUILDING_KEY
ORDER BY
  T1.ACADEMIC_YEAR,
  T2.TERM_START_DATE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5213, 211
TOTAL                  : 295328, 261219, 34109
AVG                    : 3108.72, 2749.67, 359.04
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each term and department, list the term, department, the number of courses, average number of equivalent subjects, the school name, and department phone number. Include subtotals for each term (the corresponding term field is 'SUBTOTAL') and a grand total across all terms (the corresponding term field is 'TOTAL'). Do not repeat the term if it is the same as the previous row. Sort the table by term and department.

(Hints: Schema Mapping Hints:
- 'term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'department' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'equivalent subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.EQUIVALENT_SUBJECTS
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'department phone number' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER

Join Information: (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDED180>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF6ECB0>

***** FINAL SQL QUERY *****
SELECT
  CASE
    WHEN GROUPING(T1.TERM_CODE) = 1 THEN 'TOTAL'
    ELSE T1.TERM_CODE
  END AS term,
  CASE
    WHEN GROUPING(T1.DEPARTMENT_NAME) = 1 AND GROUPING(T1.TERM_CODE) = 0 THEN 'SUBTOTAL'
    WHEN GROUPING(T1.DEPARTMENT_NAME) = 1 AND GROUPING(T1.TERM_CODE) = 1 THEN 'TOTAL'
    ELSE T1.DEPARTMENT_NAME
  END AS department,
  COUNT(DISTINCT T1.SUBJECT_ID) AS number_of_courses,
  AVG(CASE WHEN T1.EQUIVALENT_SUBJECTS IS NULL OR T1.EQUIVALENT_SUBJECTS = '' THEN 0 ELSE LENGTH(T1.EQUIVALENT_SUBJECTS) - LENGTH(REPLACE(T1.EQUIVALENT_SUBJECTS, ',', '')) + 1 END) AS average_equivalent_subjects,
  CASE
    WHEN GROUPING(T1.DEPARTMENT_NAME) = 1 THEN NULL
    ELSE MAX(T3.SCHOOL_NAME)
  END AS school_name,
  CASE
    WHEN GROUPING(T1.DEPARTMENT_NAME) = 1 THEN NULL
    ELSE MAX(T2.DEPARTMENT_PHONE_NUMBER)
  END AS department_phone_number
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
LEFT JOIN SIS_DEPARTMENT AS T3
  ON T1.DEPARTMENT_CODE = T3.DEPARTMENT_CODE
LEFT JOIN SIS_ADMIN_DEPARTMENT AS T2
  ON T3.DEPARTMENT_CODE = T2.SIS_ADMIN_DEPARTMENT_CODE
GROUP BY
  T1.TERM_CODE,
  T1.DEPARTMENT_NAME WITH ROLLUP
ORDER BY
  CASE WHEN GROUPING(T1.TERM_CODE) = 1 THEN 1 ELSE 0 END,
  T1.TERM_CODE,
  CASE WHEN GROUPING(T1.DEPARTMENT_NAME) = 1 THEN 1 ELSE 0 END,
  T1.DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3292, 477
TOTAL                  : 299097, 264511, 34586
AVG                    : 3115.59, 2755.32, 360.27
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_SUMMARY
[
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese I', 'ESD Graduate Thesis', 'Advanced Organic Chemistry']),
(SUBJECT_OR_CLUSTER:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.004']),
(ULT_MASTER_SUBJECT_ID:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['J', 'S', 'M']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['Joint subject', 'SWE: School-Wide Electives', 'Meeting Together']),
(CLUSTER_LIST:VARCHAR2, Examples: ['3.43, 6.720', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012', '21A.344, STS.062']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['21F', 'ESD', '5']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Global Studies & Languages', 'Engineering Systems Division', 'Chemistry']),
(SCHOOL_CODE:VARCHAR2, Examples: ['H', 'E', 'S']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Hum, Arts & Social Sciences', 'Engineering', 'Science']),
(TOTAL_UNITS:NUMBER, Examples: [12, 1, 15]),
(LECTURE_UNITS:NUMBER, Examples: [4, 0, 3]),
(LAB_UNITS:NUMBER, Examples: [0, 1, 12]),
(PREP_UNITS:NUMBER, Examples: [8, 0, 9]),
(DESIGN_UNITS:NUMBER, Examples: [0, 4, 6]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [45, 203, 26]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [30, 235, 59]),
(SUBJECT_GROUP_ID:VARCHAR2, Examples: ['86CD64962C150327E0440003BACE90BC', 'F9E8CEBB9F5A7CCFE0433D2F091294A0', '86CD6495D8560327E0440003BACE90BC']),
(SUBJECT_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(CLUSTER_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(SUBJECT_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(CLUSTER_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(SUBJECT_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(SUBJECT_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(CLUSTER_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(SUBJECT_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(CLUSTER_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(SUBJECT_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(CLUSTER_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
Group courses in the biology and chemistry department by whether they are current or not and the cluster type. For each group, list the current status ('CURRENT' if yes and 'NON-CURRENT' otherwise), cluster type, the maximum duration of courses (in terms of days), the maximum units, average duration (in terms of days), and average units. Include subtotals for each current status (the corresponding current status field is 'SUBTOTAL') and a grand total across all current status (the corresponding current status field is 'TOTAL'). Do not repeat the current status if it is the same as the previous row. Sort the table by current status and cluster type.

(Hints: Schema Mapping Hints:
- 'biology and chemistry department' is related to SUBJECT_SUMMARY.DEPARTMENT_NAME
- 'current status' is related to ACADEMIC_TERMS_ALL.IS_CURRENT_TERM
- 'cluster type' is related to SUBJECT_SUMMARY.CLUSTER_TYPE
- 'duration' is related to ACADEMIC_TERMS_ALL.TERM_END_DATE, ACADEMIC_TERMS_ALL.TERM_START_DATE
- 'units' is related to SUBJECT_SUMMARY.TOTAL_UNITS

Join Information: (ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_SUMMARY.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDECDC0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDECD90>

***** FINAL SQL QUERY *****
SELECT
    CASE
        WHEN GROUPING(CASE WHEN T.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END) = 1 AND GROUPING(S.CLUSTER_TYPE) = 1 THEN 'TOTAL'
        WHEN GROUPING(S.CLUSTER_TYPE) = 1 THEN 'SUBTOTAL'
        ELSE (CASE WHEN T.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END)
    END AS `Current Status`,
    CASE
        WHEN GROUPING(S.CLUSTER_TYPE) = 1 THEN NULL
        ELSE S.CLUSTER_TYPE
    END AS `Cluster Type`,
    MAX(DATEDIFF(T.TERM_END_DATE, T.TERM_START_DATE)) AS `Maximum Duration (Days)`,
    MAX(S.TOTAL_UNITS) AS `Maximum Units`,
    AVG(DATEDIFF(T.TERM_END_DATE, T.TERM_START_DATE)) AS `Average Duration (Days)`,
    AVG(S.TOTAL_UNITS) AS `Average Units`
FROM
    ACADEMIC_TERMS_ALL AS T
JOIN
    SUBJECT_SUMMARY AS S
ON
    T.TERM_CODE = S.TERM_CODE
WHERE
    S.DEPARTMENT_NAME IN ('Biology', 'Chemistry')
GROUP BY GROUPING SETS (
    (CASE WHEN T.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END, S.CLUSTER_TYPE),
    (CASE WHEN T.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END),
    ()
)
ORDER BY
    CASE
        WHEN GROUPING(CASE WHEN T.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END) = 0 AND GROUPING(S.CLUSTER_TYPE) = 0 THEN 1 -- Detail rows
        WHEN GROUPING(CASE WHEN T.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END) = 0 AND GROUPING(S.CLUSTER_TYPE) = 1 THEN 2 -- Subtotal rows
        WHEN GROUPING(CASE WHEN T.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END) = 1 AND GROUPING(S.CLUSTER_TYPE) = 1 THEN 3 -- Grand total row
    END,
    CASE WHEN T.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END ASC,
    S.CLUSTER_TYPE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2528, 584
TOTAL                  : 302209, 267039, 35170
AVG                    : 3115.56, 2752.98, 362.58
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
Group master courses by department. For each group, state the name of the department, the master course code, the number of subjects, the total new shelf price of associated TIP materials, and the number of unique TIP materials. Display the department and master course only if it differs from the previous entry. Include subtotals for each department and a grand total across all departments. All numerical values should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'name of the department' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'master course code' is related to TIP_SUBJECT_OFFERED.MASTER_COURSE_NUMBER
- 'subjects' is related to TIP_SUBJECT_OFFERED.SUBJECT_ID
- 'new shelf price' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'TIP materials' is related to TIP_MATERIAL.ISBN

Join Information: (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDECB80>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDECB50>

***** FINAL SQL QUERY *****
SELECT
  CASE
    WHEN GROUPING(TSO.OFFER_DEPT_NAME) = 1
    THEN 'Grand Total'
    ELSE TSO.OFFER_DEPT_NAME
  END AS `Department Name`,
  CASE
    WHEN GROUPING(TSO.MASTER_COURSE_NUMBER) = 1 AND GROUPING(TSO.OFFER_DEPT_NAME) = 0
    THEN CONCAT('Subtotal for ', TSO.OFFER_DEPT_NAME)
    WHEN GROUPING(TSO.MASTER_COURSE_NUMBER) = 1 AND GROUPING(TSO.OFFER_DEPT_NAME) = 1
    THEN 'Overall Total'
    ELSE TSO.MASTER_COURSE_NUMBER
  END AS `Master Course Code`,
  FORMAT(COUNT(DISTINCT TSO.SUBJECT_ID), 0) AS `Number of Subjects`,
  FORMAT(ROUND(SUM(TM.NEW_SHELF_PRICE)), 0) AS `Total New Shelf Price`,
  FORMAT(COUNT(DISTINCT TD.TIP_MATERIAL_KEY), 0) AS `Number of Unique TIP Materials`
FROM TIP_SUBJECT_OFFERED AS TSO
JOIN TIP_DETAIL AS TD
  ON TSO.TIP_SUBJECT_OFFERED_KEY = TD.TIP_SUBJECT_OFFERED_KEY
JOIN TIP_MATERIAL AS TM
  ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY
GROUP BY
  TSO.OFFER_DEPT_NAME,
  TSO.MASTER_COURSE_NUMBER WITH ROLLUP
ORDER BY
  GROUPING(TSO.OFFER_DEPT_NAME) ASC,
  TSO.OFFER_DEPT_NAME ASC,
  GROUPING(TSO.MASTER_COURSE_NUMBER) ASC,
  TSO.MASTER_COURSE_NUMBER ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1725, 424
TOTAL                  : 304358, 268764, 35594
AVG                    : 3105.69, 2742.49, 363.20
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_USAGE
[
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(SPACE_USAGE:VARCHAR2, Examples: ['ARC ROOM', 'TST ROOM', 'RSRC RM']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: ZPM_ROOMS_LOAD
[
(BUILDING_ROOM:VARCHAR2, Examples: ['1-073', '1-035', '1-061']),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['0', '1', '2']),
(SPACE_USAGE:VARCHAR2, Examples: ['DSGN STUDIO', 'ARC ROOM', 'DINING RM']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['121000', '150000', '151000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000267', '10000270', '10000272']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['3', '0', '2'])
]

### Question ###
Group spaces in the Stata building by the access level and usage type. For each group, state the access level, usage type, name of the space, the number of spaces, total area across all rooms in the space, and average area across all rooms in the space. Display the access level only if it differs from the previous entry. Include subtotals for each access level, usage type, and space name, subtotals for each access level, and a grand total across all access levels. Exclude usage type that includes "STORAGE". All numerical values should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'Stata building' is related to SPACE_DETAIL.BUILDING_KEY
- 'access level' is related to ZPM_ROOMS_LOAD.ACCESS_LEVEL
- 'usage type' is related to SPACE_USAGE.SPACE_USAGE
- 'name of the space' is related to FCLT_ORGANIZATION.DLC_NAME
- 'spaces' is related to SPACE_UNIT.SPACE_UNIT
- 'area' is related to SPACE_DETAIL.ROOM_SQUARE_FOOTAGE

Join Information: (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = SPACE_UNIT.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC400>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC3D0>

***** FINAL SQL QUERY *****
SELECT
  CASE
    WHEN GROUPING(T4.ACCESS_LEVEL) = 1
    THEN 'Grand Total'
    WHEN GROUPING(T2.SPACE_USAGE) = 1
    THEN CONCAT('Subtotal for Access Level: ', T4.ACCESS_LEVEL)
    WHEN GROUPING(T3.DLC_NAME) = 1
    THEN CONCAT('Subtotal for Usage Type: ', T2.SPACE_USAGE)
    ELSE T4.ACCESS_LEVEL
  END AS `Access Level`,
  CASE
    WHEN GROUPING(T4.ACCESS_LEVEL) = 1
    THEN NULL
    WHEN GROUPING(T2.SPACE_USAGE) = 1
    THEN NULL
    WHEN GROUPING(T3.DLC_NAME) = 1
    THEN T2.SPACE_USAGE
    ELSE T2.SPACE_USAGE
  END AS `Usage Type`,
  CASE
    WHEN GROUPING(T4.ACCESS_LEVEL) = 1
    THEN NULL
    WHEN GROUPING(T2.SPACE_USAGE) = 1
    THEN NULL
    WHEN GROUPING(T3.DLC_NAME) = 1
    THEN NULL
    ELSE T3.DLC_NAME
  END AS `Name of Space`,
  FORMAT(ROUND(COUNT(T1.BUILDING_ROOM)), 0) AS `Number of Spaces`,
  FORMAT(ROUND(SUM(T1.ROOM_SQUARE_FOOTAGE)), 0) AS `Total Area`,
  FORMAT(ROUND(AVG(T1.ROOM_SQUARE_FOOTAGE)), 0) AS `Average Area`
FROM SPACE_DETAIL AS T1
JOIN SPACE_USAGE AS T2
  ON T1.SPACE_USAGE_KEY = T2.SPACE_USAGE_KEY
JOIN SPACE_UNIT AS T5
  ON T1.SPACE_UNIT_KEY = T5.SPACE_UNIT_KEY
JOIN FCLT_ORGANIZATION AS T3
  ON T5.FCLT_ORGANIZATION_KEY = T3.FCLT_ORGANIZATION_KEY
JOIN ZPM_ROOMS_LOAD AS T4
  ON T1.BUILDING_ROOM = T4.BUILDING_ROOM AND T1.BUILDING_COMPONENT = T4.BUILDING_COMPONENT
WHERE
  T1.BUILDING_KEY = '1' AND T2.SPACE_USAGE NOT LIKE '%STORAGE%'
GROUP BY
  T4.ACCESS_LEVEL,
  T2.SPACE_USAGE,
  T3.DLC_NAME WITH ROLLUP
ORDER BY
  T4.ACCESS_LEVEL IS NULL,
  T4.ACCESS_LEVEL,
  T2.SPACE_USAGE IS NULL,
  T2.SPACE_USAGE,
  T3.DLC_NAME IS NULL,
  T3.DLC_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1770, 644
TOTAL                  : 306772, 270534, 36238
AVG                    : 3098.71, 2732.67, 366.04
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: HR_FACULTY_ROSTER
[
(MIT_ID:VARCHAR2, Examples: ['999319439', '927924992', '903738061']),
(LAST_NAME:VARCHAR2, Examples: ['Frederick', 'Hooper', 'Frost']),
(FIRST_NAME:VARCHAR2, Examples: ['Floyd', 'Kade', 'Matthew']),
(MIDDLE_NAME:VARCHAR2, Examples: ['W', 'G', 'Garrison']),
(TERMINAL_DEGREE:VARCHAR2, Examples: ['Doctoral Degree', 'Post-Doctoral Degree', 'Bachelor's Degree']),
(APPOINTMENT_TYPE:VARCHAR2, Examples: ['Primary Appointment', 'Dual Appointment']),
(JOB_TITLE:VARCHAR2, Examples: ['Associate Professor', 'Professor', 'Assistant Professor']),
(HR_ORG_UNIT_TITLE:VARCHAR2, Examples: ['Aeronautics and Astronautics', 'Anthropology Program', 'Architecture']),
(POSITION_TITLE:VARCHAR2),
(ADMIN_ORG_UNIT_TITLE:VARCHAR2),
(ADMIN_POSITION_TITLE:VARCHAR2),
(ADMIN_JOB_TITLE:VARCHAR2),
(DIRECTORY_ORG_UNIT_TITLE:VARCHAR2, Examples: ['Department of Mechanical Engineering', 'Department of Linguistics and Philosophy', 'Division of Comparative Medicine']),
(ENDOWED_CHAIR:VARCHAR2),
(EMERITUS_STATUS:CHAR, Examples: ['Emeritus']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: HR_ORG_UNIT
[
(HR_ORG_UNIT_KEY:VARCHAR2, Examples: ['O10000333', 'O10005059', 'O10004909']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['0', '10000000', '10000001']),
(HR_ORG_UNIT_TITLE:VARCHAR2, Examples: ['[MEDIA82] OXMAN /NERI', 'Abdul Latif Jameel Poverty Action Lab', 'Academic Media Production Services']),
(HR_ORG_UNIT_LEVEL:VARCHAR2, Examples: ['DEPARTMENTS', 'ORGANIZATION LEVEL', 'SUB DEPARTMENT']),
(HR_DEPARTMENT_ID:VARCHAR2, Examples: ['10000333', '10005059', '10004909']),
(HR_DEPARTMENT_CODE:VARCHAR2, Examples: ['HR-068100', 'HR-404511', 'HR-402400']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '121002']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'VPF - Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(HR_DEPARTMENT_NAME_LONG:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'VPF - Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(HR_DEPARTMENT_NAME_ALPHA:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'VPF - Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(ORG_HIER_SCHOOL_AREA_NAME:VARCHAR2, Examples: ['Schwarzman College of Computing Area', 'VP for Finance Area', 'VP Research']),
(ORG_HIER_TOP_LEVEL_NAME:VARCHAR2, Examples: ['Provost Area', 'Executive Vice President Area', 'President & Chair of the Corporation']),
(ORG_HIER_ROOT_NAME:VARCHAR2, Examples: ['MIT-All']),
(HR_ORG_LEVEL1_ID:VARCHAR2, Examples: ['10000000']),
(HR_ORG_LEVEL1_SORT:VARCHAR2, Examples: ['1']),
(HR_ORG_LEVEL1_NAME:VARCHAR2, Examples: ['MIT-All']),
(HR_ORG_LEVEL2_ID:VARCHAR2, Examples: ['10000001', '10000002', '10000003']),
(HR_ORG_LEVEL2_SORT:VARCHAR2, Examples: ['2', '3', '4']),
(HR_ORG_LEVEL2_NAME:VARCHAR2, Examples: ['Provost Area', 'Executive Vice President Area', 'President & Chair of the Corporation']),
(HR_ORG_LEVEL3_ID:VARCHAR2, Examples: ['10005758', '10003333', '10000032']),
(HR_ORG_LEVEL3_SORT:VARCHAR2, Examples: ['513', '326', '18']),
(HR_ORG_LEVEL3_NAME:VARCHAR2, Examples: ['Schwarzman College of Computing Area', 'VP for Finance Area', 'VP Research']),
(HR_ORG_LEVEL4_ID:VARCHAR2, Examples: ['10000333', '10005058', '10004909']),
(HR_ORG_LEVEL4_SORT:VARCHAR2, Examples: ['59', '425', '414']),
(HR_ORG_LEVEL4_NAME:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'Office of the Treasurer Area', 'MIT Environmental Solutions Initiative']),
(HR_ORG_LEVEL5_ID:VARCHAR2, Examples: ['10005059', '10005810', '10005668']),
(HR_ORG_LEVEL5_SORT:VARCHAR2, Examples: ['426', '517', '504']),
(HR_ORG_LEVEL5_NAME:VARCHAR2, Examples: ['VPF - Treasury and Planning', 'Strategic Alliances & Tech Transfer Area', 'Office of the First Year Area']),
(HR_ORG_LEVEL6_ID:VARCHAR2, Examples: ['10000671', '10002483', '10000289']),
(HR_ORG_LEVEL6_SORT:VARCHAR2, Examples: ['168', '272', '42']),
(HR_ORG_LEVEL6_NAME:VARCHAR2, Examples: ['OSATT-Corporate Relations', 'Concourse', 'Terrascope']),
(HR_ORG_LEVEL7_ID:VARCHAR2, Examples: ['10005113', '10005110', '10005109']),
(HR_ORG_LEVEL7_SORT:VARCHAR2, Examples: ['434', '431', '430']),
(HR_ORG_LEVEL7_NAME:VARCHAR2, Examples: ['Open Learning, Corp & Prof, MIT xPRO', 'Open Learning, ODL, K-12', 'Open Learning, Supporting Unit, Bus/Ops']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_NAME:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'Office of Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-DEC-24', '13-DEC-24'])
]
# Table: MASTER_DEPT_HIERARCHY
[
(HIERARCHY_TYPE:VARCHAR2, Examples: ['Standard Hierarchy']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_CODE:VARCHAR2, Examples: ['D_DOF_CORE', 'D_DOF_RESERVE', 'D_DOF_RESIDENCE']),
(DLC_NAME:VARCHAR2, Examples: ['Facilities Building Core (hallways, stairs, etc.)', 'Facilities Provost Reserved', 'Facilities Residences']),
(MASTER_DEPT_HIER_LEVEL_1_CODE:VARCHAR2, Examples: ['D_ALL']),
(MASTER_DEPT_HIER_LEVEL_1_NAME:VARCHAR2, Examples: ['All Departments']),
(MASTER_DEPT_HIER_LEVEL_2_CODE:VARCHAR2, Examples: ['D_EXECVP_AREA', 'D_PROVOST_AREA', 'D_PRES_AREA']),
(MASTER_DEPT_HIER_LEVEL_2_NAME:VARCHAR2, Examples: ['Executive Vice President's Area', 'Provost Area', 'President's area']),
(MASTER_DEPT_HIER_LEVEL_3_CODE:VARCHAR2, Examples: ['D_FINANCE_AREA', 'D_TREAS_AREA', 'D_SC_ENVP']),
(MASTER_DEPT_HIER_LEVEL_3_NAME:VARCHAR2, Examples: ['VP Finance Area', 'Treasurer's Area', 'Senior Council and Environmental Programs']),
(MASTER_DEPT_HIER_LEVEL_4_CODE:VARCHAR2, Examples: ['D_SOURCING_AREA', 'D_OSATT_AREA']),
(MASTER_DEPT_HIER_LEVEL_4_NAME:VARCHAR2, Examples: ['Sourcing Area', 'Office of Strategic Alliances & Tech Transfer Area']),
(MASTER_DEPT_HIER_LEVEL_5_CODE:VARCHAR2),
(MASTER_DEPT_HIER_LEVEL_5_NAME:VARCHAR2)
]

### Question ###
List each organization's break group, ID, name, and formatted name according to its level, along with whether its members are emeritus or non-emeritus. Also, include the organization number, level, employer count, and hierarchy type for each organization. Exclude organizations '139' and '250'. Sort the results by hierarchy type and ensure totals for employer counts are displayed.

(Hints: Schema Mapping Hints:
- 'break group' is related to FCLT_ORGANIZATION.ORGANIZATION_SORT
- 'ID' is related to FCLT_ORGANIZATION.ORGANIZATION_ID
- 'name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'level' is related to FCLT_ORGANIZATION.ORGANIZATION_LEVEL
- 'number' is related to FCLT_ORGANIZATION.ORGANIZATION_NUMBER
- 'employer' is related to HR_FACULTY_ROSTER.MIT_ID
- 'hierarchy type' is related to MASTER_DEPT_HIERARCHY.HIERARCHY_TYPE

Join Information: (FCLT_ORGANIZATION.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY), (FCLT_ORGANIZATION.DLC_KEY = HR_ORG_UNIT.DLC_KEY), (HR_ORG_UNIT.HR_ORG_UNIT_TITLE = HR_FACULTY_ROSTER.HR_ORG_UNIT_TITLE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEC7C0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEC790>

***** FINAL SQL QUERY *****
SELECT
  COALESCE(MDH.HIERARCHY_TYPE, 'Total for All Hierarchy Types') AS `hierarchy type`,
  COALESCE(FO.ORGANIZATION_SORT, 'Total') AS `break group`,
  COALESCE(FO.ORGANIZATION_ID, 'Total') AS ID,
  COALESCE(FO.ORGANIZATION_NAME, 'Total') AS name,
  CASE
    WHEN GROUPING(FO.ORGANIZATION_ID) = 1
    THEN 'Total'
    ELSE CONCAT(REPEAT(' ', (CAST(FO.ORGANIZATION_LEVEL AS UNSIGNED) - 1) * 2), FO.ORGANIZATION_NAME)
  END AS `formatted name`,
  CASE
    WHEN HFR.EMERITUS_STATUS = 'Emeritus'
    THEN 'Emeritus'
    WHEN HFR.EMERITUS_STATUS IS NOT NULL
    THEN 'Non-Emeritus'
    WHEN GROUPING(HFR.EMERITUS_STATUS) = 1
    THEN 'Total'
    ELSE 'No Faculty Info'
  END AS `emeritus status`,
  COALESCE(FO.ORGANIZATION_NUMBER, 'Total') AS `organization number`,
  COALESCE(FO.ORGANIZATION_LEVEL, 'Total') AS level,
  COUNT(DISTINCT HFR.MIT_ID) AS `employer count`
FROM FCLT_ORGANIZATION AS FO
LEFT JOIN HR_ORG_UNIT AS HOU
  ON FO.DLC_KEY = HOU.DLC_KEY
LEFT JOIN HR_FACULTY_ROSTER AS HFR
  ON HOU.HR_ORG_UNIT_TITLE = HFR.HR_ORG_UNIT_TITLE
LEFT JOIN MASTER_DEPT_HIERARCHY AS MDH
  ON FO.DLC_KEY = MDH.DLC_KEY
WHERE
  FO.ORGANIZATION_ID NOT IN ('139', '250')
GROUP BY
  MDH.HIERARCHY_TYPE,
  FO.ORGANIZATION_SORT,
  FO.ORGANIZATION_ID,
  FO.ORGANIZATION_NAME,
  FO.ORGANIZATION_LEVEL,
  HFR.EMERITUS_STATUS,
  FO.ORGANIZATION_NUMBER WITH ROLLUP
ORDER BY
  CASE WHEN GROUPING(MDH.HIERARCHY_TYPE) = 1 THEN 1 ELSE 0 END,
  MDH.HIERARCHY_TYPE ASC,
  CASE WHEN GROUPING(FO.ORGANIZATION_SORT) = 1 THEN 1 ELSE 0 END,
  FO.ORGANIZATION_SORT ASC,
  CASE WHEN GROUPING(FO.ORGANIZATION_ID) = 1 THEN 1 ELSE 0 END,
  FO.ORGANIZATION_ID ASC,
  CASE WHEN GROUPING(FO.ORGANIZATION_NAME) = 1 THEN 1 ELSE 0 END,
  FO.ORGANIZATION_NAME ASC,
  CASE WHEN GROUPING(FO.ORGANIZATION_LEVEL) = 1 THEN 1 ELSE 0 END,
  FO.ORGANIZATION_LEVEL ASC,
  CASE WHEN GROUPING(HFR.EMERITUS_STATUS) = 1 THEN 1 ELSE 0 END,
  HFR.EMERITUS_STATUS ASC,
  CASE WHEN GROUPING(FO.ORGANIZATION_NUMBER) = 1 THEN 1 ELSE 0 END,
  FO.ORGANIZATION_NUMBER ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3186, 776
TOTAL                  : 310734, 273720, 37014
AVG                    : 3107.34, 2737.20, 370.14
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]
# Table: SUBJECT_SUMMARY
[
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese I', 'ESD Graduate Thesis', 'Advanced Organic Chemistry']),
(SUBJECT_OR_CLUSTER:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.004']),
(ULT_MASTER_SUBJECT_ID:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['J', 'S', 'M']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['Joint subject', 'SWE: School-Wide Electives', 'Meeting Together']),
(CLUSTER_LIST:VARCHAR2, Examples: ['3.43, 6.720', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012', '21A.344, STS.062']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['21F', 'ESD', '5']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Global Studies & Languages', 'Engineering Systems Division', 'Chemistry']),
(SCHOOL_CODE:VARCHAR2, Examples: ['H', 'E', 'S']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Hum, Arts & Social Sciences', 'Engineering', 'Science']),
(TOTAL_UNITS:NUMBER, Examples: [12, 1, 15]),
(LECTURE_UNITS:NUMBER, Examples: [4, 0, 3]),
(LAB_UNITS:NUMBER, Examples: [0, 1, 12]),
(PREP_UNITS:NUMBER, Examples: [8, 0, 9]),
(DESIGN_UNITS:NUMBER, Examples: [0, 4, 6]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [45, 203, 26]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [30, 235, 59]),
(SUBJECT_GROUP_ID:VARCHAR2, Examples: ['86CD64962C150327E0440003BACE90BC', 'F9E8CEBB9F5A7CCFE0433D2F091294A0', '86CD6495D8560327E0440003BACE90BC']),
(SUBJECT_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(CLUSTER_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(SUBJECT_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(CLUSTER_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(SUBJECT_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(SUBJECT_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(CLUSTER_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(SUBJECT_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(CLUSTER_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(SUBJECT_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(CLUSTER_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
Group courses in the biology and chemistry department by whether they are current or not and the department name. For each group, list the current status ('CURRENT' if yes and 'NON-CURRENT' otherwise), department name, the maximum duration of courses (in terms of days), the maximum units, average duration (in terms of days), and average units. Include subtotals for each current status (the corresponding current status field is 'SUBTOTAL') and a grand total across all current status (the corresponding current status field is 'TOTAL'). Do not repeat the current status if it is the same as the previous row. Sort the table by current status and department.

(Hints: Schema Mapping Hints:
- 'biology and chemistry department' is related to SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'current status' is related to ACADEMIC_TERMS_ALL.IS_CURRENT_TERM
- 'duration' is related to ACADEMIC_TERMS_ALL.TERM_END_DATE, ACADEMIC_TERMS_ALL.TERM_START_DATE
- 'units' is related to SUBJECT_SUMMARY.TOTAL_UNITS

Join Information: (ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_SUMMARY.TERM_CODE), (SUBJECT_SUMMARY.SUBJECT_ID = SUBJECT_OFFERED.SUBJECT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDECE80>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCCBE0>

***** FINAL SQL QUERY *****
SELECT
    CASE
        WHEN GROUPING(ATA.IS_CURRENT_TERM) = 1 AND GROUPING(SO.OFFER_DEPT_NAME) = 1 THEN 'TOTAL'
        WHEN GROUPING(SO.OFFER_DEPT_NAME) = 1 THEN 'SUBTOTAL'
        WHEN ATA.IS_CURRENT_TERM = 'Y' THEN 'CURRENT'
        ELSE 'NON-CURRENT'
    END AS `current status`,
    CASE
        WHEN GROUPING(SO.OFFER_DEPT_NAME) = 1 THEN NULL
        ELSE SO.OFFER_DEPT_NAME
    END AS `department name`,
    MAX(DATEDIFF(ATA.TERM_END_DATE, ATA.TERM_START_DATE)) AS max_duration_days,
    MAX(SS.TOTAL_UNITS) AS max_units,
    AVG(DATEDIFF(ATA.TERM_END_DATE, ATA.TERM_START_DATE)) AS avg_duration_days,
    AVG(SS.TOTAL_UNITS) AS avg_units
FROM
    ACADEMIC_TERMS_ALL AS ATA
JOIN
    SUBJECT_SUMMARY AS SS
    ON ATA.TERM_CODE = SS.TERM_CODE
JOIN
    SUBJECT_OFFERED AS SO
    ON SS.SUBJECT_ID = SO.SUBJECT_ID
WHERE
    SO.OFFER_DEPT_NAME LIKE '%Biology%' OR SO.OFFER_DEPT_NAME LIKE '%Chemistry%'
GROUP BY
    ATA.IS_CURRENT_TERM,
    SO.OFFER_DEPT_NAME WITH ROLLUP
ORDER BY
    CASE
        WHEN GROUPING(ATA.IS_CURRENT_TERM) = 1 AND GROUPING(SO.OFFER_DEPT_NAME) = 1 THEN 3
        WHEN GROUPING(SO.OFFER_DEPT_NAME) = 1 THEN 2
        ELSE 1
    END,
    CASE ATA.IS_CURRENT_TERM WHEN 'Y' THEN 1 ELSE 2 END,
    `department name`;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4321, 464
TOTAL                  : 315519, 278041, 37478
AVG                    : 3123.95, 2752.88, 371.07
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_MAJOR_USE
[
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE:VARCHAR2, Examples: ['BLDG SRV', 'CIRCULAT', 'CLASSRMS']),
(DESCRIPTION:VARCHAR2, Examples: ['BLDG SERVICE AREA', 'CIRCULATION AREA', 'CLASSROOMS']),
(ASSIGNABLE:VARCHAR2, Examples: ['0', '1']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List all rooms in building 45, including their full name, area, major use, the organization that occupies them, the count of rooms per major use, and the total area occupied by rooms for each organization.

(Hints: Schema Mapping Hints:
- 'building 45' is related to FAC_ROOMS.BUILDING_KEY
- 'full name' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'area' is related to FAC_ROOMS.AREA
- 'major use' is related to FAC_MAJOR_USE.MAJOR_USE
- 'organization' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY

Join Information: (FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDED000>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDECFD0>

***** FINAL SQL QUERY *****
SELECT
  T1.ROOM_FULL_NAME,
  T1.AREA,
  T2.MAJOR_USE,
  T3.ORGANIZATION_NAME,
  COUNT(T1.FAC_ROOM_KEY) OVER (PARTITION BY T2.MAJOR_USE) AS rooms_per_major_use,
  SUM(T1.AREA) OVER (PARTITION BY T3.ORGANIZATION_NAME) AS total_area_per_organization
FROM FAC_ROOMS AS T1
JOIN FAC_MAJOR_USE AS T2
  ON T1.MAJOR_USE_KEY = T2.MAJOR_USE_KEY
JOIN FAC_ORGANIZATION AS T3
  ON T1.ORGANIZATION_KEY = T3.ORGANIZATION_KEY
WHERE
  T1.BUILDING_KEY = '45';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1545, 189
TOTAL                  : 317253, 279586, 37667
AVG                    : 3110.32, 2741.04, 369.28
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Calculate the total assignable and non-assignable area for each building by summing up the respective areas of all its floors. For each building, list the building name, building number, total assignable area, total non-assignable area, and total room count, sorted in descending order of the total assignable area.

(Hints: Schema Mapping Hints:
- 'building name' is related to FAC_BUILDING.BUILDING_NAME
- 'building number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'assignable area' is related to FAC_FLOOR.ASSIGNABLE_AREA
- 'non-assignable area' is related to FAC_FLOOR.NON_ASSIGNABLE_AREA
- 'room' is related to FAC_ROOMS.FAC_ROOM_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_FLOOR.BUILDING_KEY), (FAC_FLOOR.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_FLOOR.FLOOR = FAC_ROOMS.FLOOR))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDECF40>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDECF10>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NAME,
  T1.BUILDING_NUMBER,
  COALESCE(SUM(T2.ASSIGNABLE_AREA), 0) AS Total_Assignable_Area,
  COALESCE(SUM(T2.NON_ASSIGNABLE_AREA), 0) AS Total_Non_Assignable_Area,
  COALESCE(COUNT(T3.FAC_ROOM_KEY), 0) AS Total_Room_Count
FROM FAC_BUILDING AS T1
LEFT JOIN FAC_FLOOR AS T2
  ON T1.FAC_BUILDING_KEY = T2.BUILDING_KEY
LEFT JOIN FAC_ROOMS AS T3
  ON T1.FAC_BUILDING_KEY = T3.BUILDING_KEY
GROUP BY
  T1.FAC_BUILDING_KEY,
  T1.BUILDING_NAME,
  T1.BUILDING_NUMBER
ORDER BY
  Total_Assignable_Area DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2348, 223
TOTAL                  : 319824, 281934, 37890
AVG                    : 3105.09, 2737.22, 367.86
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group sessions by their current term status. For each group, state the status ('CURRENT' if is current term and 'NOT CURRENT' otherwise), name of the session, number of IAP sessions, total IAP session time in days, and average IAP session time in days. Show a subtotal for each current status and a grand total row across all status. Order the results by current status and cluster type. Display the the current status only if it differs from the previous entry.

(Hints: Schema Mapping Hints:
- 'current term status' is related to ACADEMIC_TERMS.IS_CURRENT_TERM
- 'name of the session' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'IAP sessions' is related to IAP_SUBJECT_SESSION.SESSION_DATE
- 'session time' is related to IAP_SUBJECT_SESSION.SESSION_START_TIME, IAP_SUBJECT_SESSION.SESSION_END_TIME

Join Information: (IAP_SUBJECT_DETAIL.TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDED0C0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCD480>

***** FINAL SQL QUERY *****
SELECT
  CASE
    WHEN GROUPING(CASE WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NOT CURRENT' END) = 1 AND GROUPING(ISC.IAP_CATEGORY_NAME) = 1
    THEN 'Grand Total'
    WHEN GROUPING(ISC.IAP_CATEGORY_NAME) = 1
    THEN CONCAT('Subtotal for ', (CASE WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NOT CURRENT' END))
    ELSE (CASE WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NOT CURRENT' END)
  END AS current_status,
  CASE
    WHEN GROUPING(ISC.IAP_CATEGORY_NAME) = 1
    THEN NULL
    ELSE ISC.IAP_CATEGORY_NAME
  END AS session_name,
  COUNT(ISS.IAP_SUBJECT_SESSION_KEY) AS num_iap_sessions,
  SUM(TIMESTAMPDIFF(SECOND, STR_TO_DATE(CONCAT(ISS.SESSION_DATE, ' ', ISS.SESSION_START_TIME), '%d-%M-%y %h%i%p'), STR_TO_DATE(CONCAT(ISS.SESSION_DATE, ' ', ISS.SESSION_END_TIME), '%d-%M-%y %h%i%p')) / 86400.0) AS total_iap_session_time_days,
  AVG(TIMESTAMPDIFF(SECOND, STR_TO_DATE(CONCAT(ISS.SESSION_DATE, ' ', ISS.SESSION_START_TIME), '%d-%M-%y %h%i%p'), STR_TO_DATE(CONCAT(ISS.SESSION_DATE, ' ', ISS.SESSION_END_TIME), '%d-%M-%y %h%i%p')) / 86400.0) AS average_iap_session_time_days
FROM IAP_SUBJECT_DETAIL AS ISD
JOIN ACADEMIC_TERMS AS AT
  ON ISD.TERM_CODE = AT.TERM_CODE
JOIN IAP_SUBJECT_CATEGORY AS ISC
  ON ISD.IAP_SUBJECT_CATEGORY_KEY = ISC.IAP_SUBJECT_CATEGORY_KEY
JOIN IAP_SUBJECT_SESSION AS ISS
  ON ISD.IAP_SUBJECT_SESSION_KEY = ISS.IAP_SUBJECT_SESSION_KEY
GROUP BY ROLLUP(
  (CASE WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NOT CURRENT' END),
  ISC.IAP_CATEGORY_NAME
)
ORDER BY
  GROUPING(CASE WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NOT CURRENT' END) DESC,
  (CASE WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NOT CURRENT' END) ASC,
  GROUPING(ISC.IAP_CATEGORY_NAME) ASC,
  ISC.IAP_CATEGORY_NAME ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2976, 670
TOTAL                  : 323470, 284910, 38560
AVG                    : 3110.29, 2739.52, 370.77
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each department, list its name, number of unique courses offered, the number of unique reserved materials, and the number of unique instructors associated with those courses, sorted by the number of unique courses offered in descending order.

(Hints: Schema Mapping Hints:
- 'name' is related to LIBRARY_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'course' is related to LIBRARY_SUBJECT_OFFERED.MASTER_COURSE_NUMBER
- 'reserved materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_TITLE
- 'instructors' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME

Join Information: (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEDA80>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEDA50>

***** FINAL SQL QUERY *****
SELECT
  T1.OFFER_DEPT_NAME,
  COUNT(DISTINCT T1.MASTER_COURSE_NUMBER) AS num_unique_courses,
  COUNT(DISTINCT T3.CATALOG_TITLE) AS num_unique_reserved_materials,
  COUNT(DISTINCT T4.INSTRUCTOR_NAME) AS num_unique_instructors
FROM LIBRARY_SUBJECT_OFFERED AS T1
LEFT JOIN LIBRARY_RESERVE_MATRL_DETAIL AS T2
  ON T1.LIBRARY_SUBJECT_OFFERED_KEY = T2.LIBRARY_SUBJECT_OFFERED_KEY
LEFT JOIN LIBRARY_RESERVE_CATALOG AS T3
  ON T2.LIBRARY_RESERVE_CATALOG_KEY = T3.LIBRARY_RESERVE_CATALOG_KEY
LEFT JOIN LIBRARY_COURSE_INSTRUCTOR AS T4
  ON T2.LIBRARY_COURSE_INSTRUCTOR_KEY = T4.LIBRARY_COURSE_INSTRUCTOR_KEY
GROUP BY
  T1.OFFER_DEPT_NAME
ORDER BY
  num_unique_courses DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2238, 250
TOTAL                  : 325958, 287148, 38810
AVG                    : 3104.36, 2734.74, 369.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course title, list the title, the total number of reserved materials, and the count of distinct material status associated with those materials, sorted by the total number of reserved materials in descending order.

(Hints: Schema Mapping Hints:
- 'title' is related to LIBRARY_SUBJECT_OFFERED.SUBJECT_TITLE
- 'reserved materials' is related to LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY
- 'material status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDED9C0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDED990>

***** FINAL SQL QUERY *****
SELECT
  T1.SUBJECT_TITLE,
  COUNT(T2.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials,
  COUNT(DISTINCT T3.LIBRARY_MATERIAL_STATUS) AS distinct_material_status_count
FROM LIBRARY_SUBJECT_OFFERED AS T1
JOIN LIBRARY_RESERVE_MATRL_DETAIL AS T2
  ON T1.LIBRARY_SUBJECT_OFFERED_KEY = T2.LIBRARY_SUBJECT_OFFERED_KEY
JOIN LIBRARY_MATERIAL_STATUS AS T3
  ON T2.LIBRARY_MATERIAL_STATUS_KEY = T3.LIBRARY_MATERIAL_STATUS_KEY
GROUP BY
  T1.SUBJECT_TITLE
ORDER BY
  total_reserved_materials DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1387, 175
TOTAL                  : 327520, 288535, 38985
AVG                    : 3089.81, 2722.03, 367.78
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For students with last names starting with K, list their names, the phone numbers of departments they belong to, total number of mailing lists each student is in, and the average size of the mailing lists each student is in.

(Hints: Schema Mapping Hints:
- 'last names' is related to MIT_STUDENT_DIRECTORY.LAST_NAME
- 'names' is related to MIT_STUDENT_DIRECTORY.FULL_NAME
- 'phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'mailing lists' is related to MOIRA_LIST.MOIRA_LIST_KEY

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE), (MIT_STUDENT_DIRECTORY.FULL_NAME = SE_PERSON.FULL_NAME), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDED300>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCF280>

***** FINAL SQL QUERY *****
```mysql
SELECT
  T1.FULL_NAME,
  T4.DEPARTMENT_PHONE_NUMBER,
  COUNT(DISTINCT T3.MOIRA_LIST_KEY),
  AVG(LS.list_size)
FROM MIT_STUDENT_DIRECTORY AS T1
JOIN SIS_DEPARTMENT AS T2
  ON T1.DEPARTMENT = T2.DEPARTMENT_CODE
JOIN SIS_ADMIN_DEPARTMENT AS T4
  ON T2.DEPARTMENT_CODE = T4.SIS_ADMIN_DEPARTMENT_CODE
LEFT JOIN MOIRA_LIST_DETAIL AS T3
  ON T1.FULL_NAME = T3.MOIRA_LIST_MEMBER_FULL_NAME
LEFT JOIN (
  SELECT
    MOIRA_LIST_KEY,
    COUNT(MOIRA_LIST_MEMBER) AS list_size
  FROM MOIRA_LIST_DETAIL
  GROUP BY
    MOIRA_LIST_KEY
) AS LS
  ON T3.MOIRA_LIST_KEY = LS.MOIRA_LIST_KEY
WHERE
  T1.LAST_NAME LIKE 'K%'
GROUP BY
  T1.FULL_NAME,
  T4.DEPARTMENT_PHONE_NUMBER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2192, 266
TOTAL                  : 329978, 290727, 39251
AVG                    : 3083.91, 2717.07, 366.83
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each IAP category, list the category name, the sponsor name, the number of activities offered, and the average fee per activity, sorted by the number of activities in descending order.

(Hints: Schema Mapping Hints:
- 'category name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'activities' is related to IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEDCC0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCC490>

***** FINAL SQL QUERY *****
SELECT
  T1.IAP_CATEGORY_NAME,
  T3.SPONSOR_NAME,
  COUNT(T2.ACTIVITY_TITLE),
  AVG(T2.FEE)
FROM IAP_SUBJECT_CATEGORY AS T1
INNER JOIN IAP_SUBJECT_DETAIL AS T2
  ON T1.IAP_SUBJECT_CATEGORY_KEY = T2.IAP_SUBJECT_CATEGORY_KEY
INNER JOIN IAP_SUBJECT_SPONSOR AS T3
  ON T2.IAP_SUBJECT_SPONSOR_KEY = T3.IAP_SUBJECT_SPONSOR_KEY
GROUP BY
  T1.IAP_CATEGORY_NAME,
  T3.SPONSOR_NAME
ORDER BY
  COUNT(T2.ACTIVITY_TITLE) DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1777, 184
TOTAL                  : 331939, 292504, 39435
AVG                    : 3073.51, 2708.37, 365.14
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]

### Question ###
For each instructor, list their name, the number of unique courses they teach, the total number of material assignments, average publication year, and number of distinct status, sorted by the number of unique courses in descending order.

(Hints: Schema Mapping Hints:
- 'name' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'course' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME
- 'material assignments' is related to LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY
- 'publication year' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS

Join Information: (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDED600>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDED5D0>

***** FINAL SQL QUERY *****
SELECT
  T1.INSTRUCTOR_NAME,
  COUNT(DISTINCT T1.COURSE_NAME),
  COUNT(T2.LIBRARY_RESERVE_CATALOG_KEY),
  AVG(CAST(T3.CATALOG_YEAR AS SIGNED)),
  COUNT(DISTINCT T4.LIBRARY_MATERIAL_STATUS)
FROM LIBRARY_COURSE_INSTRUCTOR AS T1
INNER JOIN LIBRARY_RESERVE_MATRL_DETAIL AS T2
  ON T1.LIBRARY_COURSE_INSTRUCTOR_KEY = T2.LIBRARY_COURSE_INSTRUCTOR_KEY
INNER JOIN LIBRARY_RESERVE_CATALOG AS T3
  ON T2.LIBRARY_RESERVE_CATALOG_KEY = T3.LIBRARY_RESERVE_CATALOG_KEY
INNER JOIN LIBRARY_MATERIAL_STATUS AS T4
  ON T2.LIBRARY_MATERIAL_STATUS_KEY = T4.LIBRARY_MATERIAL_STATUS_KEY
GROUP BY
  T1.INSTRUCTOR_NAME
ORDER BY
  COUNT(DISTINCT T1.COURSE_NAME) DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1706, 241
TOTAL                  : 333886, 294210, 39676
AVG                    : 3063.17, 2699.17, 364.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]

### Question ###
For each publication year, list the year, the total number of reserved materials, the average length of their titles, distinct number of status, and number of courses, sorted by publication year in descending order.

(Hints: Schema Mapping Hints:
- 'publication year' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'reserved materials' is related to LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY
- 'title' is related to LIBRARY_RESERVE_CATALOG.CATALOG_TITLE
- 'status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'courses' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME

Join Information: (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF8CAC0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEDBD0>

***** FINAL SQL QUERY *****
SELECT
  T1.CATALOG_YEAR,
  COUNT(DISTINCT T1.LIBRARY_RESERVE_CATALOG_KEY),
  AVG(LENGTH(T1.CATALOG_TITLE)),
  COUNT(DISTINCT T3.LIBRARY_MATERIAL_STATUS),
  COUNT(DISTINCT T4.COURSE_NAME)
FROM LIBRARY_RESERVE_CATALOG AS T1
INNER JOIN LIBRARY_RESERVE_MATRL_DETAIL AS T2
  ON T1.LIBRARY_RESERVE_CATALOG_KEY = T2.LIBRARY_RESERVE_CATALOG_KEY
INNER JOIN LIBRARY_MATERIAL_STATUS AS T3
  ON T2.LIBRARY_MATERIAL_STATUS_KEY = T3.LIBRARY_MATERIAL_STATUS_KEY
INNER JOIN LIBRARY_COURSE_INSTRUCTOR AS T4
  ON T2.LIBRARY_COURSE_INSTRUCTOR_KEY = T4.LIBRARY_COURSE_INSTRUCTOR_KEY
GROUP BY
  T1.CATALOG_YEAR
ORDER BY
  T1.CATALOG_YEAR DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1709, 236
TOTAL                  : 335831, 295919, 39912
AVG                    : 3053.01, 2690.17, 362.84
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
From the 100 email lists with the most number of subscribers, list their names, their total number of subscribers, their public status, the name of the department with the most presence in the list, and the number of students from this department in the list.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subscribers' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'public status' is related to MOIRA_LIST.IS_PUBLIC
- 'department' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'students' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (SIS_DEPARTMENT.DEPARTMENT_CODE = MIT_STUDENT_DIRECTORY.DEPARTMENT))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDED480>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDCD840>

***** FINAL SQL QUERY *****
WITH ListSubscribers AS (
  SELECT
    T1.MOIRA_LIST_KEY,
    T1.MOIRA_LIST_NAME,
    T1.IS_PUBLIC,
    COUNT(DISTINCT T2.MOIRA_LIST_MEMBER) AS total_subscribers
  FROM MOIRA_LIST AS T1
  JOIN MOIRA_LIST_DETAIL AS T2
    ON T1.MOIRA_LIST_KEY = T2.MOIRA_LIST_KEY
  GROUP BY
    T1.MOIRA_LIST_KEY,
    T1.MOIRA_LIST_NAME,
    T1.IS_PUBLIC
  ORDER BY
    total_subscribers DESC
  LIMIT 100
), StudentDepartmentCounts AS (
  SELECT
    LS.MOIRA_LIST_KEY,
    T3.DEPARTMENT,
    COUNT(DISTINCT T2.MOIRA_LIST_MEMBER_FULL_NAME) AS student_count,
    ROW_NUMBER() OVER (PARTITION BY LS.MOIRA_LIST_KEY ORDER BY COUNT(DISTINCT T2.MOIRA_LIST_MEMBER_FULL_NAME) DESC, T3.DEPARTMENT) AS rn
  FROM ListSubscribers AS LS
  JOIN MOIRA_LIST_DETAIL AS T2
    ON LS.MOIRA_LIST_KEY = T2.MOIRA_LIST_KEY
  JOIN MIT_STUDENT_DIRECTORY AS T3
    ON T2.MOIRA_LIST_MEMBER_FULL_NAME = T3.FULL_NAME
  GROUP BY
    LS.MOIRA_LIST_KEY,
    T3.DEPARTMENT
)
SELECT
  LS.MOIRA_LIST_NAME,
  LS.total_subscribers,
  LS.IS_PUBLIC,
  T4.DEPARTMENT_NAME,
  SDC.student_count
FROM ListSubscribers AS LS
LEFT JOIN StudentDepartmentCounts AS SDC
  ON LS.MOIRA_LIST_KEY = SDC.MOIRA_LIST_KEY
  AND SDC.rn = 1
LEFT JOIN SIS_DEPARTMENT AS T4
  ON SDC.DEPARTMENT = T4.DEPARTMENT_CODE
ORDER BY
  LS.total_subscribers DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1948, 500
TOTAL                  : 338279, 297867, 40412
AVG                    : 3047.56, 2683.49, 364.07
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_PERSON
[
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(PERSON_ROLE:VARCHAR2, Examples: ['Activity leader', 'Session leader', 'Contact person']),
(PERSON_MIT_AFFILIATION:VARCHAR2, Examples: ['Staff', 'Senior Lecturer', 'Other MIT']),
(PERSON_NAME:VARCHAR2, Examples: ['Willie Hewitt', 'Junaid Ochoa', 'Rufus Armstrong']),
(PERSON_LOCATION:VARCHAR2, Examples: ['Register for Zoom ID', 'NE48', 'E15-413']),
(PERSON_EMAIL:VARCHAR2, Examples: ['anac@worker.com', 'ec@worker.com', 'pv@worker.com']),
(PERSON_ORGANIZATION:VARCHAR2),
(PERSON_TITLE:VARCHAR2),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each person role and IAP category, list the role, the category name, the number of people in this role, and the average fee, sorted by the role count in descending order.

(Hints: Schema Mapping Hints:
- 'role' is related to IAP_SUBJECT_PERSON.PERSON_ROLE
- 'category name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'people' is related to IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE

Join Information: (IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_PERSON_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEDF00>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF8E4A0>

***** FINAL SQL QUERY *****
SELECT
  T1.PERSON_ROLE,
  T3.IAP_CATEGORY_NAME,
  COUNT(DISTINCT T1.IAP_SUBJECT_PERSON_KEY) AS Number_of_People,
  AVG(T2.FEE) AS Average_Fee
FROM IAP_SUBJECT_PERSON AS T1
JOIN IAP_SUBJECT_DETAIL AS T2
  ON T1.IAP_SUBJECT_PERSON_KEY = T2.IAP_SUBJECT_PERSON_KEY
JOIN IAP_SUBJECT_CATEGORY AS T3
  ON T2.IAP_SUBJECT_CATEGORY_KEY = T3.IAP_SUBJECT_CATEGORY_KEY
GROUP BY
  T1.PERSON_ROLE,
  T3.IAP_CATEGORY_NAME
ORDER BY
  Number_of_People DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1859, 186
TOTAL                  : 340324, 299726, 40598
AVG                    : 3038.61, 2676.12, 362.48
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List the name, number, construction date, and type of all buildings, along with the count of addresses associated with each building, the average gross area of the buildings, and the total number of rooms in each building. Sort the results by building name.

(Hints: Schema Mapping Hints:
- 'name' is related to FAC_BUILDING.BUILDING_NAME
- 'number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'construction date' is related to FAC_BUILDING.DATE_BUILT
- 'type' is related to FAC_BUILDING.BUILDING_TYPE
- 'addresses' is related to FAC_BUILDING_ADDRESS.BUILDING_ADDRESS_KEY
- 'gross area' is related to FAC_BUILDING.EXT_GROSS_AREA
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDED3C0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDED390>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NAME AS name,
  T1.BUILDING_NUMBER AS number,
  T1.DATE_BUILT AS `construction date`,
  T1.BUILDING_TYPE AS type,
  COUNT(DISTINCT T2.BUILDING_ADDRESS_KEY) AS `count of addresses`,
  AVG(CAST(T1.EXT_GROSS_AREA AS DECIMAL(10, 2))) AS `average gross area`,
  COUNT(DISTINCT T3.FAC_ROOM_KEY) AS `total number of rooms`
FROM FAC_BUILDING AS T1
LEFT JOIN FAC_BUILDING_ADDRESS AS T2
  ON T1.FAC_BUILDING_KEY = T2.BUILDING_KEY
LEFT JOIN FAC_ROOMS AS T3
  ON T1.FAC_BUILDING_KEY = T3.BUILDING_KEY
GROUP BY
  T1.FAC_BUILDING_KEY,
  T1.BUILDING_NAME,
  T1.BUILDING_NUMBER,
  T1.DATE_BUILT,
  T1.BUILDING_TYPE
ORDER BY
  T1.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2328, 268
TOTAL                  : 342920, 302054, 40866
AVG                    : 3034.69, 2673.04, 361.65
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each department, list the department name, department phone number, number of students, and the length of the longest student full name in that department.

(Hints: Schema Mapping Hints:
- 'department name' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'department phone number' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'students' is related to MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS
- 'student full name' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEDB40>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEDB10>

***** FINAL SQL QUERY *****
SELECT
  T1.DEPARTMENT_NAME,
  T2.DEPARTMENT_PHONE_NUMBER,
  COUNT(T3.EMAIL_ADDRESS),
  MAX(LENGTH(T3.FULL_NAME))
FROM SIS_DEPARTMENT AS T1
INNER JOIN SIS_ADMIN_DEPARTMENT AS T2
  ON T1.DEPARTMENT_CODE = T2.SIS_ADMIN_DEPARTMENT_CODE
LEFT JOIN MIT_STUDENT_DIRECTORY AS T3
  ON T1.DEPARTMENT_CODE = T3.DEPARTMENT
GROUP BY
  T1.DEPARTMENT_NAME,
  T2.DEPARTMENT_PHONE_NUMBER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1305, 138
TOTAL                  : 344363, 303359, 41004
AVG                    : 3020.73, 2661.04, 359.68
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each school, list the school name, total number of courses that appear in SIS subject code catalog, and the total number of degree-granting courses that appear in SIS subject code catalog.

(Hints: Schema Mapping Hints:
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'courses' is related to SIS_COURSE_DESCRIPTION.COURSE
- 'degree-granting courses' is related to SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING

Join Information: (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_COURSE_DESCRIPTION.COURSE = SIS_SUBJECT_CODE.COURSE_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEE080>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF8E230>

***** FINAL SQL QUERY *****
SELECT
  T1.SCHOOL_NAME,
  COUNT(DISTINCT T2.COURSE) AS total_courses,
  COUNT(DISTINCT CASE WHEN T2.IS_DEGREE_GRANTING = 'Y' THEN T2.COURSE ELSE NULL END) AS total_degree_granting_courses
FROM SIS_DEPARTMENT AS T1
INNER JOIN SIS_COURSE_DESCRIPTION AS T2
  ON T1.DEPARTMENT_CODE = T2.DEPARTMENT
INNER JOIN SIS_SUBJECT_CODE AS T3
  ON T2.COURSE = T3.COURSE_NUMBER
GROUP BY
  T1.SCHOOL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1572, 141
TOTAL                  : 346076, 304931, 41145
AVG                    : 3009.36, 2651.57, 357.78
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List the names of the buildings with the most floors. If there are ties, list each one separately.

(Hints: Schema Mapping Hints:
- 'name of the buildings' is related to FAC_BUILDING.BUILDING_NAME
- 'floors' is related to FAC_FLOOR.LEVEL_ID

Join Information: (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEDEDD80>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEDEE410>

***** FINAL SQL QUERY *****
SELECT
  T1.BUILDING_NAME
FROM FAC_BUILDING AS T1
INNER JOIN FAC_FLOOR AS T2
  ON T1.FAC_BUILDING_KEY = T2.BUILDING_KEY
GROUP BY
  T1.FAC_BUILDING_KEY,
  T1.BUILDING_NAME
HAVING
  COUNT(DISTINCT T2.LEVEL_ID) = (
    SELECT
      MAX(floor_count)
    FROM (
      SELECT
        COUNT(DISTINCT T3.LEVEL_ID) AS floor_count
      FROM FAC_BUILDING AS T4
      INNER JOIN FAC_FLOOR AS T3
        ON T4.FAC_BUILDING_KEY = T3.BUILDING_KEY
      GROUP BY
        T4.FAC_BUILDING_KEY
    ) AS subquery
  );

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2228, 196
TOTAL                  : 348500, 307159, 41341
AVG                    : 3004.31, 2647.92, 356.39
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For email lists with names starting with e (case insensitive), containing 10 to 20 members inclusive, and where over 75% are computer science students, provide the list name, owner, and member count.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'computer science' is related to MIT_STUDENT_DIRECTORY.DEPARTMENT
- 'owner' is related to MOIRA_LIST_OWNER.OWNER

Join Information: (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = SE_PERSON.KRB_NAME), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAE8388B0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAE83A230>

***** FINAL SQL QUERY *****
SELECT
  ML.MOIRA_LIST_NAME,
  MIN(MLO.OWNER) AS owner,
  COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER) AS member_count
FROM MOIRA_LIST AS ML
JOIN MOIRA_LIST_DETAIL AS MLD
  ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
LEFT JOIN MOIRA_LIST_OWNER AS MLO
  ON MLD.MOIRA_LIST_OWNER_KEY = MLO.MOIRA_LIST_OWNER_KEY
LEFT JOIN SE_PERSON AS SP
  ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME
LEFT JOIN MIT_STUDENT_DIRECTORY AS MSD
  ON SP.FULL_NAME = MSD.FULL_NAME
WHERE
  LOWER(ML.MOIRA_LIST_NAME) LIKE 'e%' AND ML.IS_MOIRA_MAILING_LIST = 'Y'
GROUP BY
  ML.MOIRA_LIST_KEY,
  ML.MOIRA_LIST_NAME
HAVING
  COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER) BETWEEN 10 AND 20 AND
  SUM(CASE WHEN MSD.STUDENT_YEAR IS NOT NULL AND MSD.DEPARTMENT_NAME LIKE '%Computer Sci%' THEN 1 ELSE 0 END) * 1.0 / COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER) > 0.75;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1685, 336
TOTAL                  : 350521, 308844, 41677
AVG                    : 2995.91, 2639.69, 356.21
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the mailing list with owner key LIST69.377-keeper-xenon, list the owner, total number of mailing lists, and total number of members across all these mailing lists.

(Hints: Schema Mapping Hints:
- 'owner key' is related to MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'mailing lists' is related to MOIRA_LIST.MOIRA_LIST_KEY
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAE83A5C0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAE83B880>

***** FINAL SQL QUERY *****
SELECT
  T1.OWNER,
  COUNT(DISTINCT T2.MOIRA_LIST_KEY) AS total_number_of_mailing_lists,
  COUNT(DISTINCT T2.MOIRA_LIST_MEMBER) AS total_number_of_members
FROM MOIRA_LIST_OWNER AS T1
JOIN MOIRA_LIST_DETAIL AS T2
  ON T1.MOIRA_LIST_OWNER_KEY = T2.MOIRA_LIST_OWNER_KEY
WHERE
  T1.MOIRA_LIST_OWNER_KEY = 'LIST69.377-keeper-xenon'
GROUP BY
  T1.OWNER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 971, 159
TOTAL                  : 351651, 309815, 41836
AVG                    : 2980.09, 2625.55, 354.54
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]

### Question ###
List each academic year, the term code, and the number of newly introduced subjects in this term. Display the academic year only if it differs from the previous entry. Include a grand total (the corresponding year field should be 'TOTAL') stating the total number of subjects across all academic years.

(Hints: Schema Mapping Hints:
- 'academic year' is related to ACADEMIC_TERMS_ALL.ACADEMIC_YEAR
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAEF8CD60>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAEF8F9D0>

***** FINAL SQL QUERY *****
```mysql
WITH NewSubjectsPerTerm AS (
    SELECT
        ACADEMIC_YEAR,
        TERM_CODE,
        COUNT(DISTINCT SUBJECT_ID) AS new_subjects_count
    FROM
        COURSE_CATALOG_SUBJECT_OFFERED
    WHERE
        STATUS_CHANGE LIKE '%New subject%'
    GROUP BY
        ACADEMIC_YEAR,
        TERM_CODE
),
CombinedData AS (
    SELECT
        ACADEMIC_YEAR,
        TERM_CODE,
        new_subjects_count
    FROM
        NewSubjectsPerTerm
    UNION ALL
    SELECT
        NULL AS ACADEMIC_YEAR,
        NULL AS TERM_CODE,
        SUM(new_subjects_count) AS new_subjects_count
    FROM
        NewSubjectsPerTerm
)
SELECT
    CASE
        WHEN ACADEMIC_YEAR IS NULL THEN 'TOTAL'
        WHEN ACADEMIC_YEAR = LAG(ACADEMIC_YEAR, 1, '') OVER (ORDER BY ACADEMIC_YEAR, TERM_CODE)
            THEN ''
        ELSE ACADEMIC_YEAR
    END AS `Academic Year`,
    TERM_CODE AS `Term Code`,
    new_subjects_count AS `Number of newly introduced subjects`
FROM
    CombinedData
ORDER BY
    ACADEMIC_YEAR IS NULL DESC,
    ACADEMIC_YEAR ASC,
    TERM_CODE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3301, 318
TOTAL                  : 355270, 313116, 42154
AVG                    : 2985.46, 2631.23, 354.24
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]

### Question ###
For subjects offered in the summer term, list the subject titles, number of instructors, and the length of the longest instructor name.

(Hints: Schema Mapping Hints:
- 'summer term' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'subject titles' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'instructors' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'instructor name' is related to EMPLOYEE_DIRECTORY.FULL_NAME

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAE83B3D0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAE8399F0>

***** FINAL SQL QUERY *****
SELECT
  T1.SUBJECT_TITLE,
  COUNT(DISTINCT T2.FULL_NAME),
  MAX(LENGTH(T2.FULL_NAME))
FROM COURSE_CATALOG_SUBJECT_OFFERED AS T1
JOIN EMPLOYEE_DIRECTORY AS T2
  ON T1.RESPONSIBLE_FACULTY_MIT_ID = T2.MIT_ID
WHERE
  T1.IS_OFFERED_SUMMER_TERM = 'Y'
GROUP BY
  T1.SUBJECT_TITLE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4057, 121
TOTAL                  : 359448, 317173, 42275
AVG                    : 2995.40, 2643.11, 352.29
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each sponsor, list the sponsor name, the number of IAP sessions hosted, and the number of unique subjects organized.

(Hints: Schema Mapping Hints:
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'IAP sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'subjects' is related to IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
<src.model.gemini_model.MockResponse object at 0x000001FAAE83A7A0>

***** TOKEN INFO *****
<src.model.gemini_model.MockUsage object at 0x000001FAAE83AE00>

***** FINAL SQL QUERY *****
SELECT
  T1.SPONSOR_NAME,
  COUNT(T3.IAP_SUBJECT_SESSION_KEY) AS num_iap_sessions_hosted,
  COUNT(DISTINCT T2.IAP_SUBJECT_SESSION_KEY) AS num_unique_subjects_organized
FROM IAP_SUBJECT_SPONSOR AS T1
LEFT JOIN IAP_SUBJECT_DETAIL AS T2
  ON T1.IAP_SUBJECT_SPONSOR_KEY = T2.IAP_SUBJECT_SPONSOR_KEY
LEFT JOIN IAP_SUBJECT_SESSION AS T3
  ON T2.IAP_SUBJECT_SESSION_KEY = T3.IAP_SUBJECT_SESSION_KEY
GROUP BY
  T1.SPONSOR_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1925, 175
TOTAL                  : 361548, 319098, 42450
AVG                    : 2988.00, 2637.17, 350.83
******************************************************************************************************************************************************
******************************************************************************************************************************************************

