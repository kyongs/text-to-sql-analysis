--- Log Session Started at 2025-12-31 20:14:28 ---

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORG_DLC_KEY
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MASTER_DEPT_HIERARCHY
[
(HIERARCHY_TYPE:VARCHAR2, Examples: ['Standard Hierarchy']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_CODE:VARCHAR2, Examples: ['D_DOF_CORE', 'D_DOF_RESERVE', 'D_DOF_RESIDENCE']),
(DLC_NAME:VARCHAR2, Examples: ['Facilities Building Core (hallways, stairs, etc.)', 'Facilities Provost Reserved', 'Facilities Residences']),
(MASTER_DEPT_HIER_LEVEL_1_CODE:VARCHAR2, Examples: ['D_ALL']),
(MASTER_DEPT_HIER_LEVEL_1_NAME:VARCHAR2, Examples: ['All Departments']),
(MASTER_DEPT_HIER_LEVEL_2_CODE:VARCHAR2, Examples: ['D_EXECVP_AREA', 'D_PROVOST_AREA', 'D_PRES_AREA']),
(MASTER_DEPT_HIER_LEVEL_2_NAME:VARCHAR2, Examples: ['Executive Vice President's Area', 'Provost Area', 'President's area']),
(MASTER_DEPT_HIER_LEVEL_3_CODE:VARCHAR2, Examples: ['D_FINANCE_AREA', 'D_TREAS_AREA', 'D_SC_ENVP']),
(MASTER_DEPT_HIER_LEVEL_3_NAME:VARCHAR2, Examples: ['VP Finance Area', 'Treasurer's Area', 'Senior Council and Environmental Programs']),
(MASTER_DEPT_HIER_LEVEL_4_CODE:VARCHAR2, Examples: ['D_SOURCING_AREA', 'D_OSATT_AREA']),
(MASTER_DEPT_HIER_LEVEL_4_NAME:VARCHAR2, Examples: ['Sourcing Area', 'Office of Strategic Alliances & Tech Transfer Area']),
(MASTER_DEPT_HIER_LEVEL_5_CODE:VARCHAR2),
(MASTER_DEPT_HIER_LEVEL_5_NAME:VARCHAR2)
]

### Question ###
What is the current building key, building street address, city, state, and postal code of the history department?

(Hints: Schema Mapping Hints:
- 'building key' is related to FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FCLT_BUILDING_ADDRESS.CITY
- 'state' is related to FCLT_BUILDING_ADDRESS.STATE
- 'postal code' is related to FCLT_BUILDING_ADDRESS.POSTAL_CODE
- 'history department' is related to MASTER_DEPT_HIERARCHY.DLC_NAME

Join Information: (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORG_DLC_KEY.FCLT_ORGANIZATION_KEY), (FCLT_ORG_DLC_KEY.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY), (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoRqalHV1P6klGLfaqpmYirHyyFj', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    BUILDINGS.BUILDING_KEY, \n    BUILDINGS.BUILDING_STREET_ADDRESS, \n    FCLT_BUILDING_ADDRESS.CITY, \n    FCLT_BUILDING_ADDRESS.STATE, \n    FCLT_BUILDING_ADDRESS.POSTAL_CODE \nFROM \n    BUILDINGS \nJOIN \n    FCLT_BUILDING_ADDRESS ON BUILDINGS.BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY \nJOIN \n    FCLT_ROOMS ON FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY \nJOIN \n    FCLT_ORG_DLC_KEY ON FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORG_DLC_KEY.FCLT_ORGANIZATION_KEY \nJOIN \n    MASTER_DEPT_HIERARCHY ON FCLT_ORG_DLC_KEY.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY \nWHERE \n    MASTER_DEPT_HIERARCHY.DLC_NAME = 'history department';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179670, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=221, prompt_tokens=1827, total_tokens=2048, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=221, prompt_tokens=1827, total_tokens=2048, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    BUILDINGS.BUILDING_KEY, 
    BUILDINGS.BUILDING_STREET_ADDRESS, 
    FCLT_BUILDING_ADDRESS.CITY, 
    FCLT_BUILDING_ADDRESS.STATE, 
    FCLT_BUILDING_ADDRESS.POSTAL_CODE 
FROM 
    BUILDINGS 
JOIN 
    FCLT_BUILDING_ADDRESS ON BUILDINGS.BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY 
JOIN 
    FCLT_ROOMS ON FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY 
JOIN 
    FCLT_ORG_DLC_KEY ON FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORG_DLC_KEY.FCLT_ORGANIZATION_KEY 
JOIN 
    MASTER_DEPT_HIERARCHY ON FCLT_ORG_DLC_KEY.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY 
WHERE 
    MASTER_DEPT_HIERARCHY.DLC_NAME = 'history department';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1827, 221
TOTAL                  : 2048, 1827, 221
AVG                    : 2048.00, 1827.00, 221.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_PERSON
[
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(PERSON_ROLE:VARCHAR2, Examples: ['Activity leader', 'Session leader', 'Contact person']),
(PERSON_MIT_AFFILIATION:VARCHAR2, Examples: ['Staff', 'Senior Lecturer', 'Other MIT']),
(PERSON_NAME:VARCHAR2, Examples: ['Willie Hewitt', 'Junaid Ochoa', 'Rufus Armstrong']),
(PERSON_LOCATION:VARCHAR2, Examples: ['Register for Zoom ID', 'NE48', 'E15-413']),
(PERSON_EMAIL:VARCHAR2, Examples: ['anac@worker.com', 'ec@worker.com', 'pv@worker.com']),
(PERSON_ORGANIZATION:VARCHAR2),
(PERSON_TITLE:VARCHAR2),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Show the unique activity titles, locations, term start date, and supervisor name for all independent activities, sorted by the ascending order of start date.

(Hints: Schema Mapping Hints:
- 'activity titles' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'locations' is related to IAP_SUBJECT_SESSION.SESSION_LOCATION
- 'term start date' is related to ACADEMIC_TERMS_ALL.TERM_START_DATE
- 'supervisor name' is related to IAP_SUBJECT_PERSON.PERSON_NAME, IAP_SUBJECT_PERSON.PERSON_ROLE

Join Information: (IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_PERSON_KEY), (ACADEMIC_TERMS_ALL.TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoRu29hzGyM6YqPhfyjabhCJrjKM', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT DISTINCT sd.ACTIVITY_TITLE, s.SESSION_LOCATION, at.TERM_START_DATE, sp.PERSON_NAME\nFROM IAP_SUBJECT_DETAIL sd\nJOIN IAP_SUBJECT_SESSION s ON sd.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY\nJOIN ACADEMIC_TERMS_ALL at ON sd.TERM_CODE = at.TERM_CODE\nJOIN IAP_SUBJECT_PERSON sp ON sd.IAP_SUBJECT_PERSON_KEY = sp.IAP_SUBJECT_PERSON_KEY\nWHERE sp.PERSON_ROLE = 'Activity leader'\nORDER BY at.TERM_START_DATE ASC;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179674, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=123, prompt_tokens=2262, total_tokens=2385, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=123, prompt_tokens=2262, total_tokens=2385, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT DISTINCT sd.ACTIVITY_TITLE, s.SESSION_LOCATION, at.TERM_START_DATE, sp.PERSON_NAME
FROM IAP_SUBJECT_DETAIL sd
JOIN IAP_SUBJECT_SESSION s ON sd.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY
JOIN ACADEMIC_TERMS_ALL at ON sd.TERM_CODE = at.TERM_CODE
JOIN IAP_SUBJECT_PERSON sp ON sd.IAP_SUBJECT_PERSON_KEY = sp.IAP_SUBJECT_PERSON_KEY
WHERE sp.PERSON_ROLE = 'Activity leader'
ORDER BY at.TERM_START_DATE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2262, 123
TOTAL                  : 4433, 4089, 344
AVG                    : 2216.50, 2044.50, 172.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the unique course instructor names, course titles, and the amount of material for each course instructor key and the key of subject offered.

(Hints: Schema Mapping Hints:
- 'course instructor names' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'course titles' is related to LIBRARY_SUBJECT_OFFERED.SUBJECT_TITLE
- 'amount of material' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN
- 'course instructor key' is related to LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY
- 'key of subject offered' is related to LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY

Join Information: (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoRxKEtQdsSXkyJr1Ibupc6bNKdu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    DISTINCT LCI.INSTRUCTOR_NAME, \n    LSO.SUBJECT_TITLE, \n    COUNT(LRCD.LIBRARY_RESERVE_CATALOG_KEY) AS AMOUNT_OF_MATERIAL\nFROM \n    LIBRARY_COURSE_INSTRUCTOR LCI\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    LIBRARY_SUBJECT_OFFERED LSO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG LRCD ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRCD.LIBRARY_RESERVE_CATALOG_KEY\nGROUP BY \n    LCI.INSTRUCTOR_NAME, \n    LSO.SUBJECT_TITLE;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179677, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=184, prompt_tokens=1889, total_tokens=2073, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=184, prompt_tokens=1889, total_tokens=2073, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    DISTINCT LCI.INSTRUCTOR_NAME, 
    LSO.SUBJECT_TITLE, 
    COUNT(LRCD.LIBRARY_RESERVE_CATALOG_KEY) AS AMOUNT_OF_MATERIAL
FROM 
    LIBRARY_COURSE_INSTRUCTOR LCI
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    LIBRARY_SUBJECT_OFFERED LSO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG LRCD ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRCD.LIBRARY_RESERVE_CATALOG_KEY
GROUP BY 
    LCI.INSTRUCTOR_NAME, 
    LSO.SUBJECT_TITLE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1889, 184
TOTAL                  : 6506, 5978, 528
AVG                    : 2168.67, 1992.67, 176.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
What is the room, floor, building key, building street address, city, state, and postal code of Professor Summer Haynes's office?

(Hints: Schema Mapping Hints:
- 'room' is related to FAC_ROOMS.ROOM
- 'floor' is related to FAC_ROOMS.FLOOR
- 'building key' is related to FAC_BUILDING_ADDRESS.BUILDING_KEY
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'postal code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'Professor Summer Haynes' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'office' is related to EMPLOYEE_DIRECTORY.OFFICE_LOCATION

Join Information: (EMPLOYEE_DIRECTORY.OFFICE_LOCATION = FAC_ROOMS.FAC_ROOM_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoS1DRBjIiBkkq8iv7rK8MWupagD', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    fr.ROOM, \n    fr.FLOOR, \n    fb.BUILDING_KEY, \n    b.BUILDING_STREET_ADDRESS, \n    fb.CITY, \n    fb.STATE, \n    fb.POSTAL_CODE\nFROM \n    EMPLOYEE_DIRECTORY ed\nJOIN \n    FAC_ROOMS fr ON ed.OFFICE_LOCATION = fr.FAC_ROOM_KEY\nJOIN \n    FAC_BUILDING_ADDRESS fb ON fr.BUILDING_KEY = fb.BUILDING_KEY\nJOIN \n    BUILDINGS b ON fb.BUILDING_KEY = b.BUILDING_KEY\nWHERE \n    ed.FULL_NAME = 'Haynes, Summer';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179681, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=136, prompt_tokens=1903, total_tokens=2039, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=136, prompt_tokens=1903, total_tokens=2039, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    fr.ROOM, 
    fr.FLOOR, 
    fb.BUILDING_KEY, 
    b.BUILDING_STREET_ADDRESS, 
    fb.CITY, 
    fb.STATE, 
    fb.POSTAL_CODE
FROM 
    EMPLOYEE_DIRECTORY ed
JOIN 
    FAC_ROOMS fr ON ed.OFFICE_LOCATION = fr.FAC_ROOM_KEY
JOIN 
    FAC_BUILDING_ADDRESS fb ON fr.BUILDING_KEY = fb.BUILDING_KEY
JOIN 
    BUILDINGS b ON fb.BUILDING_KEY = b.BUILDING_KEY
WHERE 
    ed.FULL_NAME = 'Haynes, Summer';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1903, 136
TOTAL                  : 8545, 7881, 664
AVG                    : 2136.25, 1970.25, 166.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the unique full room names, their corresponding building names, street addresses, cities, states, postal codes, and building heights for rooms associated with subjects that Computer Science students can enroll in.

(Hints: Schema Mapping Hints:
- 'full room names' is related to FCLT_ROOMS.ROOM_FULL_NAME
- 'building names' is related to BUILDINGS.BUILDING_NAME
- 'street addresses' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'cities' is related to FCLT_BUILDING_ADDRESS.CITY
- 'states' is related to FCLT_BUILDING_ADDRESS.STATE
- 'postal codes' is related to FCLT_BUILDING_ADDRESS.POSTAL_CODE
- 'building heights' is related to FCLT_BUILDING.BUILDING_HEIGHT
- 'Computer Science' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FCLT_ROOMS.FCLT_ROOM_KEY), (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoS3iCNMBT2kmVTp471XdT86qTQg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT DISTINCT \n    FR.ROOM_FULL_NAME, \n    B.BUILDING_NAME, \n    BA.STREET_NAME || ' ' || BA.STREET_SUFFIX || ' ' || BA.POST_DIRECTIONAL || ' ' || BA.STREET_NUMBER AS STREET_ADDRESS,\n    BA.CITY, \n    BA.STATE, \n    BA.POSTAL_CODE, \n    FB.BUILDING_HEIGHT\nFROM \n    FCLT_ROOMS FR\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED CS ON FR.FCLT_ROOM_KEY = CS.MEET_PLACE\nJOIN \n    FCLT_BUILDING FB ON FR.FCLT_BUILDING_KEY = FB.FCLT_BUILDING_KEY\nJOIN \n    FCLT_BUILDING_ADDRESS BA ON FB.FCLT_BUILDING_KEY = BA.FCLT_BUILDING_KEY\nJOIN \n    BUILDINGS B ON FB.FCLT_BUILDING_KEY = B.BUILDING_KEY\nWHERE \n    CS.DEPARTMENT_NAME = 'Electrical Eng & Computer Sci';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179683, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=208, prompt_tokens=4205, total_tokens=4413, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=208, prompt_tokens=4205, total_tokens=4413, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT DISTINCT 
    FR.ROOM_FULL_NAME, 
    B.BUILDING_NAME, 
    BA.STREET_NAME || ' ' || BA.STREET_SUFFIX || ' ' || BA.POST_DIRECTIONAL || ' ' || BA.STREET_NUMBER AS STREET_ADDRESS,
    BA.CITY, 
    BA.STATE, 
    BA.POSTAL_CODE, 
    FB.BUILDING_HEIGHT
FROM 
    FCLT_ROOMS FR
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED CS ON FR.FCLT_ROOM_KEY = CS.MEET_PLACE
JOIN 
    FCLT_BUILDING FB ON FR.FCLT_BUILDING_KEY = FB.FCLT_BUILDING_KEY
JOIN 
    FCLT_BUILDING_ADDRESS BA ON FB.FCLT_BUILDING_KEY = BA.FCLT_BUILDING_KEY
JOIN 
    BUILDINGS B ON FB.FCLT_BUILDING_KEY = B.BUILDING_KEY
WHERE 
    CS.DEPARTMENT_NAME = 'Electrical Eng & Computer Sci';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4205, 208
TOTAL                  : 12958, 12086, 872
AVG                    : 2591.60, 2417.20, 174.40
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
List the unique term code, subject title, room, floor, building key, building street address, city, state, and postal code, formats, and number of enrolled students for all courses with more than 300 attendees.

(Hints: Schema Mapping Hints:
- 'term code' is related to SUBJECT_OFFERED.TERM_CODE
- 'subject title' is related to SUBJECT_OFFERED.SUBJECT_TITLE
- 'room' is related to FCLT_ROOMS.ROOM
- 'floor' is related to FCLT_ROOMS.FLOOR
- 'building key' is related to BUILDINGS.BUILDING_KEY
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FCLT_BUILDING_ADDRESS.CITY
- 'state' is related to FCLT_BUILDING_ADDRESS.STATE
- 'postal code' is related to FCLT_BUILDING_ADDRESS.POSTAL_CODE
- 'formats' is related to SUBJECT_OFFERED.FORM_TYPE
- 'number of enrolled students' is related to SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'attendees' is related to SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (FCLT_ROOMS.FCLT_ROOM_KEY = SUBJECT_OFFERED.MEET_PLACE), (FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoS8vEtoSVrQNGeqO3CPyfnpyPbl', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT DISTINCT SUBJECT_OFFERED.TERM_CODE, SUBJECT_OFFERED.SUBJECT_TITLE, FCLT_ROOMS.ROOM, FCLT_ROOMS.FLOOR, FCLT_ROOMS.FCLT_BUILDING_KEY, BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.CITY, FCLT_BUILDING_ADDRESS.STATE, FCLT_BUILDING_ADDRESS.POSTAL_CODE, SUBJECT_OFFERED.FORM_TYPE, SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS \nFROM SUBJECT_OFFERED \nJOIN FCLT_ROOMS ON FCLT_ROOMS.MEET_PLACE = SUBJECT_OFFERED.MEET_PLACE \nJOIN FCLT_BUILDING_ADDRESS ON FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY \nJOIN BUILDINGS ON FCLT_ROOMS.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY \nWHERE SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS > 300;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179688, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=211, prompt_tokens=2891, total_tokens=3102, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=211, prompt_tokens=2891, total_tokens=3102, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT DISTINCT SUBJECT_OFFERED.TERM_CODE, SUBJECT_OFFERED.SUBJECT_TITLE, FCLT_ROOMS.ROOM, FCLT_ROOMS.FLOOR, FCLT_ROOMS.FCLT_BUILDING_KEY, BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.CITY, FCLT_BUILDING_ADDRESS.STATE, FCLT_BUILDING_ADDRESS.POSTAL_CODE, SUBJECT_OFFERED.FORM_TYPE, SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS 
FROM SUBJECT_OFFERED 
JOIN FCLT_ROOMS ON FCLT_ROOMS.MEET_PLACE = SUBJECT_OFFERED.MEET_PLACE 
JOIN FCLT_BUILDING_ADDRESS ON FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY 
JOIN BUILDINGS ON FCLT_ROOMS.FCLT_BUILDING_KEY = BUILDINGS.BUILDING_KEY 
WHERE SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS > 300;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2891, 211
TOTAL                  : 16060, 14977, 1083
AVG                    : 2676.67, 2496.17, 180.50
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What are the subject titles, their material titles, ISBN numbers, new shelf prices, and total costs of new materials for each subject title, sorted by individual item prices in ascending order?

(Hints: Schema Mapping Hints:
- 'subject titles' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE
- 'material titles' is related to TIP_MATERIAL.TITLE
- 'ISBN numbers' is related to TIP_MATERIAL.ISBN
- 'new shelf prices' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'cost of new materials' is related to TIP_MATERIAL.NEW_SHELF_PRICE

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_SUBJECT_OFFERED.SUBJECT_ID = TIP_DETAIL.SUBJECT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSDTKhFfYyfjoGtbuSKbBng4r3I', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    TSO.SUBJECT_TITLE, \n    TM.TITLE AS MATERIAL_TITLE, \n    TM.ISBN, \n    TM.NEW_SHELF_PRICE, \n    TM.NEW_SHELF_PRICE AS TOTAL_COST\nFROM \n    TIP_SUBJECT_OFFERED TSO\nJOIN \n    TIP_DETAIL TD ON TSO.SUBJECT_ID = TD.SUBJECT_ID\nJOIN \n    TIP_MATERIAL TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY\nORDER BY \n    TM.NEW_SHELF_PRICE ASC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179693, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=113, prompt_tokens=1423, total_tokens=1536, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=113, prompt_tokens=1423, total_tokens=1536, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    TSO.SUBJECT_TITLE, 
    TM.TITLE AS MATERIAL_TITLE, 
    TM.ISBN, 
    TM.NEW_SHELF_PRICE, 
    TM.NEW_SHELF_PRICE AS TOTAL_COST
FROM 
    TIP_SUBJECT_OFFERED TSO
JOIN 
    TIP_DETAIL TD ON TSO.SUBJECT_ID = TD.SUBJECT_ID
JOIN 
    TIP_MATERIAL TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY
ORDER BY 
    TM.NEW_SHELF_PRICE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1423, 113
TOTAL                  : 17596, 16400, 1196
AVG                    : 2513.71, 2342.86, 170.86
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FCLT_BUILDING_HIST
[
(FCLT_BUILDING_HIST_KEY:VARCHAR2, Examples: ['14S-201505', '46-201505', 'E14-201505']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['201505', '201506', '201507']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['14S', '46', 'E14']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['14', 'W61', 'W70']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY', 'MACGREGOR HOUSE', 'NEW HOUSE']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library', 'Frank S MacGregor House', 'New West Campus Houses']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library (South Wing)', 'Brain & Cognitive Sciences Complex', 'Building E14']),
(EXT_GROSS_AREA:NUMBER, Examples: [48622.2, 418663.0, 173875.0]),
(ASSIGNABLE_AREA:NUMBER, Examples: [34500.5, 218519.0, 73792.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [10286.5, 152699.0, 83752.7]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHWEST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['(NULL)', 'UGBA3', 'UGBI2']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['136.4', '82.8', '88.3']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3623, 42.3605, 42.3615]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0916, -71.0873, -71.0879]),
(EASTING_X_SPCS:NUMBER, Examples: [766530.0, 767698.0, 767547.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2957330.0, 2956650.0, 2957020.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['14S', '46', 'E14']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['SEELY G. MUDD', 'HORACE SAYFORD FORD JR.', 'SEBASTIAN S. KRESGE']),
(BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY (S)', 'BCSC', 'BUILDING E14']),
(DATE_BUILT:VARCHAR2, Examples: ['04/25/2003', '12/31/1932', '12/31/1920']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['05/01/1961', '12/31/1955', '12/31/1939']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['09/01/2005', '03/06/1975', '10/01/1964']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-DEC-14', '01-JAN-15', '01-FEB-15']),
(NUM_OF_ROOMS:NUMBER, Examples: [118, 1403, 341])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the long names of buildings constructed before 1950 that have more than 100 employees, the built year of the building, and number of employees.

(Hints: Schema Mapping Hints:
- 'long names of buildings' is related to FCLT_BUILDING_HIST.BUILDING_NAME_LONG
- 'built year' is related to FCLT_BUILDING_HIST.DATE_BUILT
- 'employees' is related to EMPLOYEE_DIRECTORY.MIT_ID

Join Information: (EMPLOYEE_DIRECTORY.OFFICE_LOCATION = FCLT_ROOMS.BUILDING_ROOM))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSHjmmugYRK7tObVt9JVuJ0FwlN', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    F.BUILDING_NAME_LONG, \n    F.DATE_BUILT, \n    COUNT(E.MIT_ID) AS num_of_employees\nFROM \n    FCLT_BUILDING_HIST F\nJOIN \n    FCLT_ROOMS R ON F.FCLT_BUILDING_KEY = R.FCLT_BUILDING_KEY\nJOIN \n    EMPLOYEE_DIRECTORY E ON R.BUILDING_ROOM = E.OFFICE_LOCATION\nWHERE \n    F.DATE_BUILT < '1950-01-01'\nGROUP BY \n    F.BUILDING_NAME_LONG, F.DATE_BUILT\nHAVING \n    COUNT(E.MIT_ID) > 100;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179697, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=139, prompt_tokens=2265, total_tokens=2404, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=139, prompt_tokens=2265, total_tokens=2404, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    F.BUILDING_NAME_LONG, 
    F.DATE_BUILT, 
    COUNT(E.MIT_ID) AS num_of_employees
FROM 
    FCLT_BUILDING_HIST F
JOIN 
    FCLT_ROOMS R ON F.FCLT_BUILDING_KEY = R.FCLT_BUILDING_KEY
JOIN 
    EMPLOYEE_DIRECTORY E ON R.BUILDING_ROOM = E.OFFICE_LOCATION
WHERE 
    F.DATE_BUILT < '1950-01-01'
GROUP BY 
    F.BUILDING_NAME_LONG, F.DATE_BUILT
HAVING 
    COUNT(E.MIT_ID) > 100;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2265, 139
TOTAL                  : 20000, 18665, 1335
AVG                    : 2500.00, 2333.12, 166.88
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: CIS_COURSE_CATALOG
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2003', '2002', '2007']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['097', '098', '090']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['N', 'Y', 'S']),
(DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:DATE, Examples: ['Electrical Eng & Computer Sci', 'Architecture', 'Chemistry']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1991FA', '1995FA', '1989FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['Y', 'N']),
(LECTURE_UNITS:VARCHAR2, Examples: [0, 3, 1]),
(LAB_UNITS:VARCHAR2, Examples: [0, 12, 4]),
(PREPARATION_UNITS:VARCHAR2, Examples: [0, 9, 5]),
(TOTAL_UNITS:VARCHAR2, Examples: [0, 12, 6]),
(DESIGN_UNITS:VARCHAR2, Examples: [0, 6, 8]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['R', 'J', 'N']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Can be repeated for credit', 'Continuing and Repeatable', 'Not repeatable for credit']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', 'H-LEVEL Grad Credit (except for Course 18 students)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['HD1', 'HE', 'HD5']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS-D, Category 1', 'HASS Elective', 'HASS-D, Category 5']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:NUMBER, Examples: ['RESH', 'NTRN', 'COOP']),
(TUITION_ATTRIBUTE_DESC:NUMBER, Examples: ['Pre-thesis Research Subject', 'Internship', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:NUMBER, Examples: ['WRT2', 'WRT1']),
(WRITE_REQ_ATTRIBUTE_DESC:NUMBER, Examples: ['Writing Requirement, Phase II', 'Writing Requirement, Phase I']),
(SUPERVISOR_ATTRIBUTE:NUMBER, Examples: ['UROP', 'THG', 'THU']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['UROP subject', 'Grad Thesis', 'Undergrad Thesis']),
(PREREQUISITES:VARCHAR2, Examples: ['Permission of instructor', '10.213', '12.120 and 12.103, or permission of instructor']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Crystal structures of mantle and core minerals, elastic and thermodynamic properties of materials at high pressure-temperature,', 'Investigates social conflict and distributional disputes in the public sector. While theoretical aspects of conflict are consid', 'Presents a framework for current landscape ecological theory, structured to encourage application in physical planning of lands']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.285J, 11.482J', '3.57J', '1.232J, 15.054J, 16.71J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE', '1.EPW, 3.EPW, 6.EPW, 10.EPW, 16.EPW, 20.EPW, 22.EPW', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['2.729J, EC.729J', 'EC.718J, WGS.277J', '21A.136J, 21G.026J']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['15.511, 15.515', '15.024', '15.414']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(STATUS_CHANGE:VARCHAR2, Examples: ['(2016: New number: 21G.110)', '(2016: New number: 21G.113)', '(2016: New number: 21G.142)']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['02-SEP-01', '12-JAN-06', '16-MAY-05']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.005']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HS', 'HA', 'HH']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Social Sciences', 'HASS Arts', 'HASS Humanities']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'Second Half Term Subject', 'First Half Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Asia', 'United States of America']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['China', 'Brazil|Uruguay|Vietnam|Russia|Australia', 'United States of America']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m2c.html', 'http://student.mit.edu/catalog/m3b.html'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each building key, what is the building name and the number of courses offered by the Center for International Studies?

(Hints: Schema Mapping Hints:
- 'building key' is related to FCLT_BUILDING.FCLT_BUILDING_KEY
- 'building name' is related to FCLT_BUILDING.BUILDING_NAME
- 'courses offered by the Center for International Studies' is related to CIS_COURSE_CATALOG.SUBJECT_ID

Join Information: (CIS_COURSE_CATALOG.SUBJECT_ID = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FCLT_ROOMS.FCLT_ROOM_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSKOeAEhMBtzqxrzYzDG3zSE8V6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    FCLT_BUILDING.FCLT_BUILDING_KEY, \n    FCLT_BUILDING.BUILDING_NAME, \n    COUNT(COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS number_of_courses\nFROM \n    FCLT_BUILDING\nJOIN \n    FCLT_ROOMS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED ON FCLT_ROOMS.BUILDING_ROOM = COURSE_CATALOG_SUBJECT_OFFERED.PRINT_SUBJECT_ID\nJOIN \n    CIS_COURSE_CATALOG ON COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID = CIS_COURSE_CATALOG.SUBJECT_ID\nWHERE \n    CIS_COURSE_CATALOG.DEPARTMENT_NAME = 'Center for International Studies'\nGROUP BY \n    FCLT_BUILDING.FCLT_BUILDING_KEY, \n    FCLT_BUILDING.BUILDING_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179700, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=212, prompt_tokens=5193, total_tokens=5405, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=212, prompt_tokens=5193, total_tokens=5405, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    FCLT_BUILDING.FCLT_BUILDING_KEY, 
    FCLT_BUILDING.BUILDING_NAME, 
    COUNT(COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS number_of_courses
FROM 
    FCLT_BUILDING
JOIN 
    FCLT_ROOMS ON FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED ON FCLT_ROOMS.BUILDING_ROOM = COURSE_CATALOG_SUBJECT_OFFERED.PRINT_SUBJECT_ID
JOIN 
    CIS_COURSE_CATALOG ON COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID = CIS_COURSE_CATALOG.SUBJECT_ID
WHERE 
    CIS_COURSE_CATALOG.DEPARTMENT_NAME = 'Center for International Studies'
GROUP BY 
    FCLT_BUILDING.FCLT_BUILDING_KEY, 
    FCLT_BUILDING.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5193, 212
TOTAL                  : 25405, 23858, 1547
AVG                    : 2822.78, 2650.89, 171.89
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the name of the building that accomodates the most students, and how many students does it accomodate?

(Hints: Schema Mapping Hints:
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME
- 'students' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (FCLT_ROOMS.BUILDING_ROOM = MIT_STUDENT_DIRECTORY.OFFICE_LOCATION), (FCLT_ROOMS.BUILDING_ROOM = MIT_STUDENT_DIRECTORY.OFFICE_LOCATION))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSPL7ilsKRwS3Ar9fqvpaqyssYr', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT FB.BUILDING_NAME, COUNT(MS.FULL_NAME) AS student_count\nFROM FCLT_BUILDING FB\nJOIN FCLT_ROOMS FR ON FB.FCLT_BUILDING_KEY = FR.FCLT_BUILDING_KEY\nJOIN MIT_STUDENT_DIRECTORY MS ON FR.BUILDING_ROOM = MS.OFFICE_LOCATION\nGROUP BY FB.BUILDING_NAME\nORDER BY student_count DESC\nLIMIT 1;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179705, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=91, prompt_tokens=1901, total_tokens=1992, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=91, prompt_tokens=1901, total_tokens=1992, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT FB.BUILDING_NAME, COUNT(MS.FULL_NAME) AS student_count
FROM FCLT_BUILDING FB
JOIN FCLT_ROOMS FR ON FB.FCLT_BUILDING_KEY = FR.FCLT_BUILDING_KEY
JOIN MIT_STUDENT_DIRECTORY MS ON FR.BUILDING_ROOM = MS.OFFICE_LOCATION
GROUP BY FB.BUILDING_NAME
ORDER BY student_count DESC
LIMIT 1;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1901, 91
TOTAL                  : 27397, 25759, 1638
AVG                    : 2739.70, 2575.90, 163.80
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]

### Question ###
List the name and floor of the building with the largest floor number.

(Hints: Schema Mapping Hints:
- 'name' is related to FAC_BUILDING.BUILDING_NAME
- 'floor' is related to FAC_FLOOR.FLOOR

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_FLOOR.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSSwXms2LMSQxvD1oXPGYT3vLvP', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT b.BUILDING_NAME, f.FLOOR\nFROM FAC_BUILDING b\nJOIN FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY\nWHERE f.FLOOR = (SELECT MAX(FLOOR) FROM FAC_FLOOR)\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179708, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=61, prompt_tokens=1372, total_tokens=1433, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=61, prompt_tokens=1372, total_tokens=1433, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT b.BUILDING_NAME, f.FLOOR
FROM FAC_BUILDING b
JOIN FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY
WHERE f.FLOOR = (SELECT MAX(FLOOR) FROM FAC_FLOOR)

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1372, 61
TOTAL                  : 28830, 27131, 1699
AVG                    : 2620.91, 2466.45, 154.45
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIME_DAY
[
(FISCAL_PERIOD:VARCHAR2, Examples: ['195007', '195008', '195009']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1975 Period 6', 'FY 1987 Period 11', 'FY 1983 Period 12']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['197412', '198705', '198306']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['December 1974', 'May 1987', 'June 1983']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1974', '1987', '1983']),
(START_DATE:DATE, Examples: ['01-DEC-74', '01-MAY-87', '01-JUN-83']),
(END_DATE:DATE, Examples: ['31-DEC-74', '31-MAY-87', '30-JUN-83']),
(CALENDAR_DATE:DATE, Examples: ['01-APR-00', '01-APR-01', '01-APR-02']),
(DAY_OF_WEEK:VARCHAR2, Examples: ['Friday   ', 'Wednesday', 'Sunday   ']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['2021', '2002', '1994']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 2020-2021', 'Aid Year 2001-2002', 'Aid year 1993-94']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(ACADEMIC_TERM_CODE:VARCHAR2, Examples: ['1951SP', '1951SU', '1952SP']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1986-1987', 'Summer Term 1983', 'Summer Term 2020'])
]

### Question ###
For each IAP category and academic year, list the category name, academic year, total fee collected, total number of IAP subjects, and the minimum and maximum enrollment.

(Hints: Schema Mapping Hints:
- 'category name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'academic year' is related to TIME_DAY.ACADEMIC_YEAR
- 'fee collected' is related to IAP_SUBJECT_DETAIL.FEE
- 'IAP subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY), (TIME_DAY.ACADEMIC_TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSTXVJelCH8CRuTqsRNA0zTflgb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    isc.IAP_CATEGORY_NAME,\n    td.ACADEMIC_YEAR,\n    SUM(isd.FEE) AS total_fee_collected,\n    COUNT(isd.ACTIVITY_TITLE) AS total_IAP_subjects,\n    MIN(isd.MAX_ENROLLMENT) AS min_enrollment,\n    MAX(isd.MAX_ENROLLMENT) AS max_enrollment\nFROM \n    IAP_SUBJECT_DETAIL isd\nJOIN \n    IAP_SUBJECT_CATEGORY isc ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY\nJOIN \n    TIME_DAY td ON isd.TERM_CODE = td.ACADEMIC_TERM_CODE\nGROUP BY \n    isc.IAP_CATEGORY_NAME, td.ACADEMIC_YEAR;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179709, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=150, prompt_tokens=1683, total_tokens=1833, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=150, prompt_tokens=1683, total_tokens=1833, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    isc.IAP_CATEGORY_NAME,
    td.ACADEMIC_YEAR,
    SUM(isd.FEE) AS total_fee_collected,
    COUNT(isd.ACTIVITY_TITLE) AS total_IAP_subjects,
    MIN(isd.MAX_ENROLLMENT) AS min_enrollment,
    MAX(isd.MAX_ENROLLMENT) AS max_enrollment
FROM 
    IAP_SUBJECT_DETAIL isd
JOIN 
    IAP_SUBJECT_CATEGORY isc ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY
JOIN 
    TIME_DAY td ON isd.TERM_CODE = td.ACADEMIC_TERM_CODE
GROUP BY 
    isc.IAP_CATEGORY_NAME, td.ACADEMIC_YEAR;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1683, 150
TOTAL                  : 30663, 28814, 1849
AVG                    : 2555.25, 2401.17, 154.08
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each sponsor of the independent activity periods, list the sponsor name, number of sessions held, the total number of enrollment, the minimum and maximum fee, the number of sessions with info, and the number of sessions without info.

(Hints: Schema Mapping Hints:
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'info' is related to IAP_SUBJECT_SESSION.HAS_SESSION_INFO

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSWUpFHnZAzkeJxYz3lWlLWyAav', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    sp.SPONSOR_NAME,\n    COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS number_of_sessions,\n    SUM(d.MAX_ENROLLMENT) AS total_enrollment,\n    MIN(d.FEE) AS minimum_fee,\n    MAX(d.FEE) AS maximum_fee,\n    SUM(CASE WHEN s.HAS_SESSION_INFO = 'Y' THEN 1 ELSE 0 END) AS sessions_with_info,\n    SUM(CASE WHEN s.HAS_SESSION_INFO = 'N' THEN 1 ELSE 0 END) AS sessions_without_info\nFROM \n    IAP_SUBJECT_SPONSOR sp\nJOIN \n    IAP_SUBJECT_DETAIL d ON sp.IAP_SUBJECT_SPONSOR_KEY = d.IAP_SUBJECT_SPONSOR_KEY\nJOIN \n    IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY\nGROUP BY \n    sp.SPONSOR_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179712, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=196, prompt_tokens=1585, total_tokens=1781, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=196, prompt_tokens=1585, total_tokens=1781, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sp.SPONSOR_NAME,
    COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS number_of_sessions,
    SUM(d.MAX_ENROLLMENT) AS total_enrollment,
    MIN(d.FEE) AS minimum_fee,
    MAX(d.FEE) AS maximum_fee,
    SUM(CASE WHEN s.HAS_SESSION_INFO = 'Y' THEN 1 ELSE 0 END) AS sessions_with_info,
    SUM(CASE WHEN s.HAS_SESSION_INFO = 'N' THEN 1 ELSE 0 END) AS sessions_without_info
FROM 
    IAP_SUBJECT_SPONSOR sp
JOIN 
    IAP_SUBJECT_DETAIL d ON sp.IAP_SUBJECT_SPONSOR_KEY = d.IAP_SUBJECT_SPONSOR_KEY
JOIN 
    IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY
GROUP BY 
    sp.SPONSOR_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1585, 196
TOTAL                  : 32444, 30399, 2045
AVG                    : 2495.69, 2338.38, 157.31
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_PERSON
[
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(PERSON_ROLE:VARCHAR2, Examples: ['Activity leader', 'Session leader', 'Contact person']),
(PERSON_MIT_AFFILIATION:VARCHAR2, Examples: ['Staff', 'Senior Lecturer', 'Other MIT']),
(PERSON_NAME:VARCHAR2, Examples: ['Willie Hewitt', 'Junaid Ochoa', 'Rufus Armstrong']),
(PERSON_LOCATION:VARCHAR2, Examples: ['Register for Zoom ID', 'NE48', 'E15-413']),
(PERSON_EMAIL:VARCHAR2, Examples: ['anac@worker.com', 'ec@worker.com', 'pv@worker.com']),
(PERSON_ORGANIZATION:VARCHAR2),
(PERSON_TITLE:VARCHAR2),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIME_DAY
[
(FISCAL_PERIOD:VARCHAR2, Examples: ['195007', '195008', '195009']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1975 Period 6', 'FY 1987 Period 11', 'FY 1983 Period 12']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['197412', '198705', '198306']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['December 1974', 'May 1987', 'June 1983']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1974', '1987', '1983']),
(START_DATE:DATE, Examples: ['01-DEC-74', '01-MAY-87', '01-JUN-83']),
(END_DATE:DATE, Examples: ['31-DEC-74', '31-MAY-87', '30-JUN-83']),
(CALENDAR_DATE:DATE, Examples: ['01-APR-00', '01-APR-01', '01-APR-02']),
(DAY_OF_WEEK:VARCHAR2, Examples: ['Friday   ', 'Wednesday', 'Sunday   ']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['2021', '2002', '1994']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 2020-2021', 'Aid Year 2001-2002', 'Aid year 1993-94']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(ACADEMIC_TERM_CODE:VARCHAR2, Examples: ['1951SP', '1951SU', '1952SP']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1986-1987', 'Summer Term 1983', 'Summer Term 2020'])
]

### Question ###
What are the individual's email and name, academic year, total number of IAP subjects, the minimum and maximum fees, and the total course enrollment for each individual and academic year?

(Hints: Schema Mapping Hints:
- 'email' is related to IAP_SUBJECT_PERSON.PERSON_EMAIL
- 'name' is related to IAP_SUBJECT_PERSON.PERSON_NAME
- 'academic year' is related to TIME_DAY.ACADEMIC_YEAR
- 'IAP subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'fees' is related to IAP_SUBJECT_DETAIL.FEE
- 'course enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_PERSON_KEY = IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY), (TIME_DAY.ACADEMIC_TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSaLPfQdkrwoaLktbok3dWtKN5E', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    sp.PERSON_EMAIL,\n    sp.PERSON_NAME,\n    td.ACADEMIC_YEAR,\n    COUNT(sd.ACTIVITY_TITLE) AS total_subjects,\n    MIN(sd.FEE) AS min_fee,\n    MAX(sd.FEE) AS max_fee,\n    SUM(sd.MAX_ENROLLMENT) AS total_enrollment\nFROM \n    IAP_SUBJECT_PERSON sp\nJOIN \n    IAP_SUBJECT_DETAIL sd ON sp.IAP_SUBJECT_PERSON_KEY = sd.IAP_SUBJECT_PERSON_KEY\nJOIN \n    TIME_DAY td ON sd.TERM_CODE = td.ACADEMIC_TERM_CODE\nGROUP BY \n    sp.PERSON_EMAIL, sp.PERSON_NAME, td.ACADEMIC_YEAR;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179716, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=149, prompt_tokens=1750, total_tokens=1899, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=149, prompt_tokens=1750, total_tokens=1899, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sp.PERSON_EMAIL,
    sp.PERSON_NAME,
    td.ACADEMIC_YEAR,
    COUNT(sd.ACTIVITY_TITLE) AS total_subjects,
    MIN(sd.FEE) AS min_fee,
    MAX(sd.FEE) AS max_fee,
    SUM(sd.MAX_ENROLLMENT) AS total_enrollment
FROM 
    IAP_SUBJECT_PERSON sp
JOIN 
    IAP_SUBJECT_DETAIL sd ON sp.IAP_SUBJECT_PERSON_KEY = sd.IAP_SUBJECT_PERSON_KEY
JOIN 
    TIME_DAY td ON sd.TERM_CODE = td.ACADEMIC_TERM_CODE
GROUP BY 
    sp.PERSON_EMAIL, sp.PERSON_NAME, td.ACADEMIC_YEAR;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1750, 149
TOTAL                  : 34343, 32149, 2194
AVG                    : 2453.07, 2296.36, 156.71
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the term code, term description, total number of IAP sessions, total fee collected, and minimum and maximum enrollment for each term code?

(Hints: Schema Mapping Hints:
- 'term code' is related to IAP_SUBJECT_DETAIL.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'IAP sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'enrollment' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (ACADEMIC_TERMS_ALL.TERM_CODE = IAP_SUBJECT_DETAIL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSe2bB44u2iubGPmMdyLSeRtvKg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    at.TERM_CODE,\n    at.TERM_DESCRIPTION,\n    COUNT(iss.IAP_SUBJECT_SESSION_KEY) AS total_sessions,\n    SUM(isd.FEE) AS total_fee_collected,\n    MIN(isd.MAX_ENROLLMENT) AS min_enrollment,\n    MAX(isd.MAX_ENROLLMENT) AS max_enrollment\nFROM \n    ACADEMIC_TERMS_ALL at\nLEFT JOIN \n    IAP_SUBJECT_DETAIL isd ON at.TERM_CODE = isd.TERM_CODE\nLEFT JOIN \n    IAP_SUBJECT_SESSION iss ON isd.IAP_SUBJECT_SESSION_KEY = iss.IAP_SUBJECT_SESSION_KEY\nGROUP BY \n    at.TERM_CODE, \n    at.TERM_DESCRIPTION\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179720, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=152, prompt_tokens=2000, total_tokens=2152, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=152, prompt_tokens=2000, total_tokens=2152, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    at.TERM_CODE,
    at.TERM_DESCRIPTION,
    COUNT(iss.IAP_SUBJECT_SESSION_KEY) AS total_sessions,
    SUM(isd.FEE) AS total_fee_collected,
    MIN(isd.MAX_ENROLLMENT) AS min_enrollment,
    MAX(isd.MAX_ENROLLMENT) AS max_enrollment
FROM 
    ACADEMIC_TERMS_ALL at
LEFT JOIN 
    IAP_SUBJECT_DETAIL isd ON at.TERM_CODE = isd.TERM_CODE
LEFT JOIN 
    IAP_SUBJECT_SESSION iss ON isd.IAP_SUBJECT_SESSION_KEY = iss.IAP_SUBJECT_SESSION_KEY
GROUP BY 
    at.TERM_CODE, 
    at.TERM_DESCRIPTION

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2000, 152
TOTAL                  : 36495, 34149, 2346
AVG                    : 2433.00, 2276.60, 156.40
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the name of the building, total number of subjects, total fee, and shortest and longest sessions for each physical IAP session location?

(Hints: Schema Mapping Hints:
- 'name of the building' is related to BUILDINGS.BUILDING_NAME
- 'subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'sessions' is related to IAP_SUBJECT_SESSION.SESSION_END_TIME, IAP_SUBJECT_SESSION.SESSION_START_TIME

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_SESSION.SESSION_LOCATION = BUILDINGS.BUILDING_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoShZ4UW1u8oojPYZbO8YGMwDEZ9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    B.BUILDING_NAME,\n    COUNT(DISTINCT ISD.ACTIVITY_TITLE) AS total_subjects,\n    SUM(ISD.FEE) AS total_fee,\n    MIN(STRFTIME('%H:%M', ISS.SESSION_END_TIME) - STRFTIME('%H:%M', ISS.SESSION_START_TIME)) AS shortest_session,\n    MAX(STRFTIME('%H:%M', ISS.SESSION_END_TIME) - STRFTIME('%H:%M', ISS.SESSION_START_TIME)) AS longest_session\nFROM \n    BUILDINGS B\nJOIN \n    IAP_SUBJECT_SESSION ISS ON B.BUILDING_NUMBER = ISS.SESSION_LOCATION\nJOIN \n    IAP_SUBJECT_DETAIL ISD ON ISS.IAP_SUBJECT_SESSION_KEY = ISD.IAP_SUBJECT_SESSION_KEY\nGROUP BY \n    B.BUILDING_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179723, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=178, prompt_tokens=1579, total_tokens=1757, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=178, prompt_tokens=1579, total_tokens=1757, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    B.BUILDING_NAME,
    COUNT(DISTINCT ISD.ACTIVITY_TITLE) AS total_subjects,
    SUM(ISD.FEE) AS total_fee,
    MIN(STRFTIME('%H:%M', ISS.SESSION_END_TIME) - STRFTIME('%H:%M', ISS.SESSION_START_TIME)) AS shortest_session,
    MAX(STRFTIME('%H:%M', ISS.SESSION_END_TIME) - STRFTIME('%H:%M', ISS.SESSION_START_TIME)) AS longest_session
FROM 
    BUILDINGS B
JOIN 
    IAP_SUBJECT_SESSION ISS ON B.BUILDING_NUMBER = ISS.SESSION_LOCATION
JOIN 
    IAP_SUBJECT_DETAIL ISD ON ISS.IAP_SUBJECT_SESSION_KEY = ISD.IAP_SUBJECT_SESSION_KEY
GROUP BY 
    B.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1579, 178
TOTAL                  : 38252, 35728, 2524
AVG                    : 2390.75, 2233.00, 157.75
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is total number of subjects, the total fee, and the shortest and longest sessions, for all virtual IAP sessions?

(Hints: Schema Mapping Hints:
- 'subjects' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE
- 'sessions' is related to IAP_SUBJECT_SESSION.SESSION_END_TIME, IAP_SUBJECT_SESSION.SESSION_START_TIME

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_SESSION.SESSION_LOCATION = BUILDINGS.BUILDING_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSlJcF43HUwg6pvZn0K2prxe6u6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    COUNT(DISTINCT IAP_SUBJECT_DETAIL.ACTIVITY_TITLE) AS total_subjects,\n    SUM(IAP_SUBJECT_DETAIL.FEE) AS total_fee,\n    MIN(strftime('%H:%M', IAP_SUBJECT_SESSION.SESSION_END_TIME) - strftime('%H:%M', IAP_SUBJECT_SESSION.SESSION_START_TIME)) AS shortest_session,\n    MAX(strftime('%H:%M', IAP_SUBJECT_SESSION.SESSION_END_TIME) - strftime('%H:%M', IAP_SUBJECT_SESSION.SESSION_START_TIME)) AS longest_session\nFROM \n    IAP_SUBJECT_DETAIL\nJOIN \n    IAP_SUBJECT_SESSION ON IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY\nWHERE \n    IAP_SUBJECT_SESSION.SESSION_LOCATION = 'On line'\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179727, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=179, prompt_tokens=1558, total_tokens=1737, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=179, prompt_tokens=1558, total_tokens=1737, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    COUNT(DISTINCT IAP_SUBJECT_DETAIL.ACTIVITY_TITLE) AS total_subjects,
    SUM(IAP_SUBJECT_DETAIL.FEE) AS total_fee,
    MIN(strftime('%H:%M', IAP_SUBJECT_SESSION.SESSION_END_TIME) - strftime('%H:%M', IAP_SUBJECT_SESSION.SESSION_START_TIME)) AS shortest_session,
    MAX(strftime('%H:%M', IAP_SUBJECT_SESSION.SESSION_END_TIME) - strftime('%H:%M', IAP_SUBJECT_SESSION.SESSION_START_TIME)) AS longest_session
FROM 
    IAP_SUBJECT_DETAIL
JOIN 
    IAP_SUBJECT_SESSION ON IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY
WHERE 
    IAP_SUBJECT_SESSION.SESSION_LOCATION = 'On line'

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1558, 179
TOTAL                  : 39989, 37286, 2703
AVG                    : 2352.29, 2193.29, 159.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the school code, school name, full name of the department, course level, total number of courses, and total number of degree-granting courses for each school code, department, and course level?

(Hints: Schema Mapping Hints:
- 'school code' is related to SIS_SUBJECT_CODE.SCHOOL_CODE
- 'school name' is related to SIS_SUBJECT_CODE.SCHOOL_NAME
- 'full name of the department' is related to SIS_DEPARTMENT.DEPARTMENT_FULL_NAME
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'courses' is related to SIS_COURSE_DESCRIPTION.COURSE
- 'degree-granting courses' is related to SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING

Join Information: (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_COURSE_DESCRIPTION.DEPARTMENT), (SIS_COURSE_DESCRIPTION.COURSE = SIS_SUBJECT_CODE.SUBJECT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSofykellCHh2psSrAn9YZU07b9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    sc.SCHOOL_CODE, \n    sc.SCHOOL_NAME, \n    d.DEPARTMENT_FULL_NAME, \n    cd.COURSE_LEVEL, \n    COUNT(cd.COURSE) AS total_courses, \n    SUM(CASE WHEN cd.IS_DEGREE_GRANTING = 'Y' THEN 1 ELSE 0 END) AS total_degree_granting_courses\nFROM \n    SIS_COURSE_DESCRIPTION cd\nJOIN \n    SIS_DEPARTMENT d ON cd.DEPARTMENT = d.DEPARTMENT_CODE\nJOIN \n    SIS_SUBJECT_CODE sc ON cd.COURSE = sc.SUBJECT_CODE\nGROUP BY \n    sc.SCHOOL_CODE, \n    sc.SCHOOL_NAME, \n    d.DEPARTMENT_FULL_NAME, \n    cd.COURSE_LEVEL;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179730, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=167, prompt_tokens=1459, total_tokens=1626, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=167, prompt_tokens=1459, total_tokens=1626, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sc.SCHOOL_CODE, 
    sc.SCHOOL_NAME, 
    d.DEPARTMENT_FULL_NAME, 
    cd.COURSE_LEVEL, 
    COUNT(cd.COURSE) AS total_courses, 
    SUM(CASE WHEN cd.IS_DEGREE_GRANTING = 'Y' THEN 1 ELSE 0 END) AS total_degree_granting_courses
FROM 
    SIS_COURSE_DESCRIPTION cd
JOIN 
    SIS_DEPARTMENT d ON cd.DEPARTMENT = d.DEPARTMENT_CODE
JOIN 
    SIS_SUBJECT_CODE sc ON cd.COURSE = sc.SUBJECT_CODE
GROUP BY 
    sc.SCHOOL_CODE, 
    sc.SCHOOL_NAME, 
    d.DEPARTMENT_FULL_NAME, 
    cd.COURSE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1459, 167
TOTAL                  : 41615, 38745, 2870
AVG                    : 2311.94, 2152.50, 159.44
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What are the different schools and departments that offer SIS courses? List their school code, school name, department code, department name, the total number of phone numbers, and the most common course level.

(Hints: Schema Mapping Hints:
- 'school code' is related to SIS_SUBJECT_CODE.SCHOOL_CODE
- 'school name' is related to SIS_SUBJECT_CODE.SCHOOL_NAME
- 'department code' is related to SIS_DEPARTMENT.DEPARTMENT_CODE
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL

Join Information: (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_COURSE_DESCRIPTION.DEPARTMENT), (SIS_SUBJECT_CODE.SUBJECT_CODE = SIS_COURSE_DESCRIPTION.COURSE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSrIWEs2PHrY1KaWlvxRWBNnMyr', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    SSD.SCHOOL_CODE, \n    SSD.SCHOOL_NAME, \n    SAD.SIS_ADMIN_DEPARTMENT_CODE AS DEPARTMENT_CODE, \n    SAD.SIS_ADMIN_DEPARTMENT_NAME AS DEPARTMENT_NAME, \n    COUNT(SAD.DEPARTMENT_PHONE_NUMBER) AS TOTAL_PHONE_NUMBERS, \n    (SELECT COURSE_LEVEL \n     FROM SIS_COURSE_DESCRIPTION \n     WHERE DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE \n     GROUP BY COURSE_LEVEL \n     ORDER BY COUNT(*) DESC \n     LIMIT 1) AS MOST_COMMON_COURSE_LEVEL\nFROM \n    SIS_ADMIN_DEPARTMENT SAD\nJOIN \n    SIS_DEPARTMENT SD ON SAD.SIS_ADMIN_DEPARTMENT_CODE = SD.DEPARTMENT_CODE\nJOIN \n    SIS_COURSE_DESCRIPTION SCD ON SD.DEPARTMENT_CODE = SCD.DEPARTMENT\nJOIN \n    SIS_SUBJECT_CODE SSD ON SCD.COURSE = SSD.SUBJECT_CODE\nGROUP BY \n    SSD.SCHOOL_CODE, SSD.SCHOOL_NAME, SAD.SIS_ADMIN_DEPARTMENT_CODE, SAD.SIS_ADMIN_DEPARTMENT_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179733, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=226, prompt_tokens=1637, total_tokens=1863, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=226, prompt_tokens=1637, total_tokens=1863, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    SSD.SCHOOL_CODE, 
    SSD.SCHOOL_NAME, 
    SAD.SIS_ADMIN_DEPARTMENT_CODE AS DEPARTMENT_CODE, 
    SAD.SIS_ADMIN_DEPARTMENT_NAME AS DEPARTMENT_NAME, 
    COUNT(SAD.DEPARTMENT_PHONE_NUMBER) AS TOTAL_PHONE_NUMBERS, 
    (SELECT COURSE_LEVEL 
     FROM SIS_COURSE_DESCRIPTION 
     WHERE DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE 
     GROUP BY COURSE_LEVEL 
     ORDER BY COUNT(*) DESC 
     LIMIT 1) AS MOST_COMMON_COURSE_LEVEL
FROM 
    SIS_ADMIN_DEPARTMENT SAD
JOIN 
    SIS_DEPARTMENT SD ON SAD.SIS_ADMIN_DEPARTMENT_CODE = SD.DEPARTMENT_CODE
JOIN 
    SIS_COURSE_DESCRIPTION SCD ON SD.DEPARTMENT_CODE = SCD.DEPARTMENT
JOIN 
    SIS_SUBJECT_CODE SSD ON SCD.COURSE = SSD.SUBJECT_CODE
GROUP BY 
    SSD.SCHOOL_CODE, SSD.SCHOOL_NAME, SAD.SIS_ADMIN_DEPARTMENT_CODE, SAD.SIS_ADMIN_DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1637, 226
TOTAL                  : 43478, 40382, 3096
AVG                    : 2288.32, 2125.37, 162.95
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the school code, school name, DLC key, the graduate level, total number of SIS subjects, the minimum and maximum course numbers, and the total number of departments offering subjects for each school?

(Hints: Schema Mapping Hints:
- 'school code' is related to SIS_SUBJECT_CODE.SCHOOL_CODE
- 'school name' is related to SIS_SUBJECT_CODE.SCHOOL_NAME
- 'DLC key' is related to SIS_DEPARTMENT.DLC_KEY
- 'graduate level' is related to SIS_COURSE_DESCRIPTION.GRADUATE_LEVEL
- 'SIS subjects' is related to SIS_SUBJECT_CODE.SUBJECT_CODE
- 'course numbers' is related to SIS_SUBJECT_CODE.COURSE_NUMBER
- 'departments' is related to SIS_DEPARTMENT.DEPARTMENT_CODE

Join Information: (SIS_SUBJECT_CODE.SUBJECT_CODE = SIS_COURSE_DESCRIPTION.COURSE), (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoSxWAF0HLiIpqzRn2WtyKwqjLgD', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    S.SCHOOL_CODE, \n    S.SCHOOL_NAME, \n    D.DLC_KEY, \n    C.GRADUATE_LEVEL, \n    COUNT(DISTINCT S.SUBJECT_CODE) AS total_sis_subjects, \n    MIN(S.COURSE_NUMBER) AS min_course_number, \n    MAX(S.COURSE_NUMBER) AS max_course_number, \n    COUNT(DISTINCT D.DEPARTMENT_CODE) AS total_departments\nFROM \n    SIS_SUBJECT_CODE S\nJOIN \n    SIS_COURSE_DESCRIPTION C ON S.SUBJECT_CODE = C.COURSE\nJOIN \n    SIS_DEPARTMENT D ON C.DEPARTMENT = D.DEPARTMENT_CODE\nGROUP BY \n    S.SCHOOL_CODE, \n    S.SCHOOL_NAME, \n    D.DLC_KEY, \n    C.GRADUATE_LEVEL;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179739, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=181, prompt_tokens=1464, total_tokens=1645, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=181, prompt_tokens=1464, total_tokens=1645, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    S.SCHOOL_CODE, 
    S.SCHOOL_NAME, 
    D.DLC_KEY, 
    C.GRADUATE_LEVEL, 
    COUNT(DISTINCT S.SUBJECT_CODE) AS total_sis_subjects, 
    MIN(S.COURSE_NUMBER) AS min_course_number, 
    MAX(S.COURSE_NUMBER) AS max_course_number, 
    COUNT(DISTINCT D.DEPARTMENT_CODE) AS total_departments
FROM 
    SIS_SUBJECT_CODE S
JOIN 
    SIS_COURSE_DESCRIPTION C ON S.SUBJECT_CODE = C.COURSE
JOIN 
    SIS_DEPARTMENT D ON C.DEPARTMENT = D.DEPARTMENT_CODE
GROUP BY 
    S.SCHOOL_CODE, 
    S.SCHOOL_NAME, 
    D.DLC_KEY, 
    C.GRADUATE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1464, 181
TOTAL                  : 45123, 41846, 3277
AVG                    : 2256.15, 2092.30, 163.85
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_FLOOR
[
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR_NAME:VARCHAR2, Examples: ['0 Floor', '00 Floor', '000 Floor']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_SUPERVISOR_USAGE
[
(MIT_ID:VARCHAR2, Examples: ['932464132', '989998641', '904031741']),
(DEPT_COUNT:NUMBER, Examples: [1, 2, 4]),
(DEPT_NAMES:VARCHAR2, Examples: ['D_ACT', 'D_ACT,D_RESDEV', 'D_ADM']),
(NUM_OF_SUPERVISEES:NUMBER, Examples: [1, 4, 2]),
(SQFT:NUMBER, Examples: [0.0, 103.0, 162.0]),
(RESEARCH_VOLUME:NUMBER, Examples: [0.0, 1350070.0, 56280.0]),
(SQFT_PER_SUPERVISEE:NUMBER, Examples: [0.0, 103.0, 162.0]),
(SQFT_PER_RES_VOL:NUMBER, Examples: [0.0, -18.0, 5.0]),
(RES_VOL_PER_SQFT:NUMBER, Examples: [0.0, 522.0, 253.0])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the building component, name of the building, square footage for all rooms, total number of floors, total number of rooms, total number of facility organizations, total number of supervisors, and total number of supervisees for each building component?

(Hints: Schema Mapping Hints:
- 'building component' is related to SPACE_DETAIL.BUILDING_COMPONENT
- 'name of the building' is related to BUILDINGS.BUILDING_NAME
- 'square footage' is related to SPACE_DETAIL.ROOM_SQUARE_FOOTAGE
- 'rooms' is related to SPACE_DETAIL.BUILDING_ROOM
- 'floors' is related to SPACE_FLOOR.FLOOR
- 'facility organizations' is related to SPACE_UNIT.FCLT_ORGANIZATION_KEY
- 'supervisors' is related to SPACE_SUPERVISOR_USAGE.MIT_ID
- 'supervisees' is related to SPACE_SUPERVISOR_USAGE.NUM_OF_SUPERVISEES

Join Information: (SPACE_SUPERVISOR_USAGE.DEPT_NAMES = SPACE_UNIT.DLC_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoT17MjgDUNZByudVX2Vyy4T6FAN', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    sd.BUILDING_COMPONENT,\n    b.BUILDING_NAME,\n    SUM(sd.ROOM_SQUARE_FOOTAGE) AS total_square_footage,\n    COUNT(DISTINCT sf.FLOOR) AS total_floors,\n    COUNT(DISTINCT sd.BUILDING_ROOM) AS total_rooms,\n    COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) AS total_facility_organizations,\n    COUNT(DISTINCT su.MIT_ID) AS total_supervisors,\n    SUM(su.NUM_OF_SUPERVISEES) AS total_supervisees\nFROM \n    SPACE_DETAIL sd\nJOIN \n    BUILDINGS b ON sd.BUILDING_KEY = b.BUILDING_KEY\nJOIN \n    SPACE_FLOOR sf ON sf.FLOOR_KEY = sd.FLOOR_KEY\nLEFT JOIN \n    SPACE_UNIT su ON su.SPACE_UNIT_KEY = sd.SPACE_UNIT_KEY\nLEFT JOIN \n    SPACE_SUPERVISOR_USAGE ssu ON ssu.DEPT_NAMES = su.DLC_KEY\nGROUP BY \n    sd.BUILDING_COMPONENT, b.BUILDING_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179743, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=230, prompt_tokens=1231, total_tokens=1461, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=230, prompt_tokens=1231, total_tokens=1461, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sd.BUILDING_COMPONENT,
    b.BUILDING_NAME,
    SUM(sd.ROOM_SQUARE_FOOTAGE) AS total_square_footage,
    COUNT(DISTINCT sf.FLOOR) AS total_floors,
    COUNT(DISTINCT sd.BUILDING_ROOM) AS total_rooms,
    COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) AS total_facility_organizations,
    COUNT(DISTINCT su.MIT_ID) AS total_supervisors,
    SUM(su.NUM_OF_SUPERVISEES) AS total_supervisees
FROM 
    SPACE_DETAIL sd
JOIN 
    BUILDINGS b ON sd.BUILDING_KEY = b.BUILDING_KEY
JOIN 
    SPACE_FLOOR sf ON sf.FLOOR_KEY = sd.FLOOR_KEY
LEFT JOIN 
    SPACE_UNIT su ON su.SPACE_UNIT_KEY = sd.SPACE_UNIT_KEY
LEFT JOIN 
    SPACE_SUPERVISOR_USAGE ssu ON ssu.DEPT_NAMES = su.DLC_KEY
GROUP BY 
    sd.BUILDING_COMPONENT, b.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1231, 230
TOTAL                  : 46584, 43077, 3507
AVG                    : 2218.29, 2051.29, 167.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_FLOOR
[
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR_NAME:VARCHAR2, Examples: ['0 Floor', '00 Floor', '000 Floor']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_SUPERVISOR_USAGE
[
(MIT_ID:VARCHAR2, Examples: ['932464132', '989998641', '904031741']),
(DEPT_COUNT:NUMBER, Examples: [1, 2, 4]),
(DEPT_NAMES:VARCHAR2, Examples: ['D_ACT', 'D_ACT,D_RESDEV', 'D_ADM']),
(NUM_OF_SUPERVISEES:NUMBER, Examples: [1, 4, 2]),
(SQFT:NUMBER, Examples: [0.0, 103.0, 162.0]),
(RESEARCH_VOLUME:NUMBER, Examples: [0.0, 1350070.0, 56280.0]),
(SQFT_PER_SUPERVISEE:NUMBER, Examples: [0.0, 103.0, 162.0]),
(SQFT_PER_RES_VOL:NUMBER, Examples: [0.0, -18.0, 5.0]),
(RES_VOL_PER_SQFT:NUMBER, Examples: [0.0, 522.0, 253.0])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the DLC key, name of the DLC, total number of floors, total square footage, total number of facility organizations, total number of supervisors, total number of supervisees, and total building heights for each DLC?

(Hints: Schema Mapping Hints:
- 'DLC key' is related to SPACE_UNIT.DLC_KEY
- 'name of the DLC' is related to FCLT_ORGANIZATION.DLC_NAME
- 'floors' is related to SPACE_FLOOR.FLOOR
- 'square footage' is related to SPACE_DETAIL.ROOM_SQUARE_FOOTAGE
- 'facility organizations' is related to SPACE_UNIT.FCLT_ORGANIZATION_KEY
- 'supervisors' is related to SPACE_SUPERVISOR_USAGE.MIT_ID
- 'supervisees' is related to SPACE_SUPERVISOR_USAGE.NUM_OF_SUPERVISEES
- 'building heights' is related to FCLT_BUILDING.BUILDING_HEIGHT

Join Information: (SPACE_UNIT.DLC_KEY = SPACE_SUPERVISOR_USAGE.DEPT_NAMES))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoT6MTyMeHX4plIsdrK2Gntpr6wb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    su.DLC_KEY AS "DLC key",\n    fo.DLC_NAME AS "name of the DLC",\n    COUNT(DISTINCT sf.FLOOR_KEY) AS "total number of floors",\n    SUM(sd.ROOM_SQUARE_FOOTAGE) AS "total square footage",\n    COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) AS "total number of facility organizations",\n    COUNT(DISTINCT su.MIT_ID) AS "total number of supervisors",\n    SUM(su.NUM_OF_SUPERVISEES) AS "total number of supervisees",\n    SUM(fb.BUILDING_HEIGHT) AS "total building heights"\nFROM \n    SPACE_UNIT su\nJOIN \n    SPACE_SUPERVISOR_USAGE su ON su.DLC_KEY = su.DEPT_NAMES\nJOIN \n    SPACE_DETAIL sd ON sd.BUILDING_KEY = su.SPACE_UNIT_KEY\nJOIN \n    SPACE_FLOOR sf ON sf.FLOOR_KEY = sd.FLOOR_KEY\nJOIN \n    FCLT_ORGANIZATION fo ON fo.DLC_KEY = su.DLC_KEY\nJOIN \n    FCLT_BUILDING fb ON fb.FCLT_BUILDING_KEY = sd.BUILDING_KEY\nGROUP BY \n    su.DLC_KEY, fo.DLC_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179748, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=264, prompt_tokens=2373, total_tokens=2637, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=264, prompt_tokens=2373, total_tokens=2637, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    su.DLC_KEY AS "DLC key",
    fo.DLC_NAME AS "name of the DLC",
    COUNT(DISTINCT sf.FLOOR_KEY) AS "total number of floors",
    SUM(sd.ROOM_SQUARE_FOOTAGE) AS "total square footage",
    COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) AS "total number of facility organizations",
    COUNT(DISTINCT su.MIT_ID) AS "total number of supervisors",
    SUM(su.NUM_OF_SUPERVISEES) AS "total number of supervisees",
    SUM(fb.BUILDING_HEIGHT) AS "total building heights"
FROM 
    SPACE_UNIT su
JOIN 
    SPACE_SUPERVISOR_USAGE su ON su.DLC_KEY = su.DEPT_NAMES
JOIN 
    SPACE_DETAIL sd ON sd.BUILDING_KEY = su.SPACE_UNIT_KEY
JOIN 
    SPACE_FLOOR sf ON sf.FLOOR_KEY = sd.FLOOR_KEY
JOIN 
    FCLT_ORGANIZATION fo ON fo.DLC_KEY = su.DLC_KEY
JOIN 
    FCLT_BUILDING fb ON fb.FCLT_BUILDING_KEY = sd.BUILDING_KEY
GROUP BY 
    su.DLC_KEY, fo.DLC_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2373, 264
TOTAL                  : 49221, 45450, 3771
AVG                    : 2237.32, 2065.91, 171.41
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the department name, total number of types of TIP subjects, total number of enrolled students, the minimum and maximum rental new price for each department?

(Hints: Schema Mapping Hints:
- 'department name' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'TIP subjects' is related to TIP_SUBJECT_OFFERED.SUBJECT_ID
- 'enrolled students' is related to TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'rental new price' is related to TIP_MATERIAL.RENTAL_NEW_PRICE

Join Information: (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTAH3m0TF05ft3zVWZL9uZV7fnw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    s.OFFER_DEPT_NAME,\n    COUNT(DISTINCT s.SUBJECT_ID) AS total_tip_subjects,\n    SUM(s.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,\n    MIN(m.RENTAL_NEW_PRICE) AS min_rental_new_price,\n    MAX(m.RENTAL_NEW_PRICE) AS max_rental_new_price\nFROM \n    TIP_SUBJECT_OFFERED s\nJOIN \n    TIP_DETAIL d ON s.TIP_SUBJECT_OFFERED_KEY = d.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    TIP_MATERIAL m ON d.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY\nGROUP BY \n    s.OFFER_DEPT_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179752, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=150, prompt_tokens=1424, total_tokens=1574, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=150, prompt_tokens=1424, total_tokens=1574, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    s.OFFER_DEPT_NAME,
    COUNT(DISTINCT s.SUBJECT_ID) AS total_tip_subjects,
    SUM(s.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,
    MIN(m.RENTAL_NEW_PRICE) AS min_rental_new_price,
    MAX(m.RENTAL_NEW_PRICE) AS max_rental_new_price
FROM 
    TIP_SUBJECT_OFFERED s
JOIN 
    TIP_DETAIL d ON s.TIP_SUBJECT_OFFERED_KEY = d.TIP_SUBJECT_OFFERED_KEY
JOIN 
    TIP_MATERIAL m ON d.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY
GROUP BY 
    s.OFFER_DEPT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1424, 150
TOTAL                  : 50795, 46874, 3921
AVG                    : 2208.48, 2038.00, 170.48
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
What are the details of courses offered in the current academic term, including the academic year, term code, hgn code, the total number of types of courses, the average number of units, the department name, the name and email address of the person in charge?

(Hints: Schema Mapping Hints:
- 'current academic term' is related to ACADEMIC_TERMS.IS_CURRENT_TERM
- 'academic year' is related to COURSE_CATALOG_SUBJECT_OFFERED.ACADEMIC_YEAR
- 'term code' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'hgn code' is related to SUBJECT_OFFERED.HGN_CODE
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'number of units' is related to COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS
- 'department name' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME
- 'name' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'email address' is related to EMPLOYEE_DIRECTORY.EMAIL_ADDRESS

Join Information: (SUBJECT_OFFERED.SUBJECT_ID = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (EMPLOYEE_DIRECTORY.MIT_ID = SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTDldZ4pHvjqmVcmwmucnOfxnHv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ACADEMIC_TERMS.ACADEMIC_YEAR, \n    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE, \n    SUBJECT_OFFERED.HGN_CODE, \n    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS total_number_of_courses, \n    AVG(COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS) AS average_units, \n    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME, \n    EMPLOYEE_DIRECTORY.FULL_NAME, \n    EMPLOYEE_DIRECTORY.EMAIL_ADDRESS\nFROM \n    ACADEMIC_TERMS\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED ON ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE\nJOIN \n    SUBJECT_OFFERED ON COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID = SUBJECT_OFFERED.SUBJECT_ID\nJOIN \n    EMPLOYEE_DIRECTORY ON SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID\nWHERE \n    ACADEMIC_TERMS.IS_CURRENT_TERM = 'Y'\nGROUP BY \n    ACADEMIC_TERMS.ACADEMIC_YEAR, \n    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE, \n    SUBJECT_OFFERED.HGN_CODE, \n    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME, \n    EMPLOYEE_DIRECTORY.FULL_NAME, \n    EMPLOYEE_DIRECTORY.EMAIL_ADDRESS;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179755, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=306, prompt_tokens=5064, total_tokens=5370, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=306, prompt_tokens=5064, total_tokens=5370, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ACADEMIC_TERMS.ACADEMIC_YEAR, 
    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE, 
    SUBJECT_OFFERED.HGN_CODE, 
    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS total_number_of_courses, 
    AVG(COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS) AS average_units, 
    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME, 
    EMPLOYEE_DIRECTORY.FULL_NAME, 
    EMPLOYEE_DIRECTORY.EMAIL_ADDRESS
FROM 
    ACADEMIC_TERMS
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED ON ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
JOIN 
    SUBJECT_OFFERED ON COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID = SUBJECT_OFFERED.SUBJECT_ID
JOIN 
    EMPLOYEE_DIRECTORY ON SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID
WHERE 
    ACADEMIC_TERMS.IS_CURRENT_TERM = 'Y'
GROUP BY 
    ACADEMIC_TERMS.ACADEMIC_YEAR, 
    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE, 
    SUBJECT_OFFERED.HGN_CODE, 
    COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME, 
    EMPLOYEE_DIRECTORY.FULL_NAME, 
    EMPLOYEE_DIRECTORY.EMAIL_ADDRESS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 5064, 306
TOTAL                  : 56165, 51938, 4227
AVG                    : 2340.21, 2164.08, 176.12
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Retrieve information about the IAP subjects, including their titles, categories, session titles, session start time, session end time, sponsor names, and total number of sessions.

(Hints: Schema Mapping Hints:
- 'titles' is related to IAP_SUBJECT_DETAIL.ACTIVITY_TITLE
- 'categories' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'session titles' is related to IAP_SUBJECT_SESSION.SESSION_TITLE
- 'session start time' is related to IAP_SUBJECT_SESSION.SESSION_START_TIME
- 'session end time' is related to IAP_SUBJECT_SESSION.SESSION_END_TIME
- 'sponsor names' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY

Join Information: (IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTKX2T57RPxgmTLh8kNLzdKcgxj', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    IAP_SUBJECT_DETAIL.ACTIVITY_TITLE AS title,\n    IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME AS category,\n    IAP_SUBJECT_SESSION.SESSION_TITLE AS session_title,\n    IAP_SUBJECT_SESSION.SESSION_START_TIME AS session_start_time,\n    IAP_SUBJECT_SESSION.SESSION_END_TIME AS session_end_time,\n    IAP_SUBJECT_SPONSOR.SPONSOR_NAME AS sponsor_name,\n    COUNT(IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY) OVER (PARTITION BY IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY) AS total_sessions\nFROM \n    IAP_SUBJECT_DETAIL\nJOIN \n    IAP_SUBJECT_CATEGORY ON IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY\nJOIN \n    IAP_SUBJECT_SESSION ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY\nJOIN \n    IAP_SUBJECT_SPONSOR ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179762, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=241, prompt_tokens=1830, total_tokens=2071, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=241, prompt_tokens=1830, total_tokens=2071, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    IAP_SUBJECT_DETAIL.ACTIVITY_TITLE AS title,
    IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME AS category,
    IAP_SUBJECT_SESSION.SESSION_TITLE AS session_title,
    IAP_SUBJECT_SESSION.SESSION_START_TIME AS session_start_time,
    IAP_SUBJECT_SESSION.SESSION_END_TIME AS session_end_time,
    IAP_SUBJECT_SPONSOR.SPONSOR_NAME AS sponsor_name,
    COUNT(IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY) OVER (PARTITION BY IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY) AS total_sessions
FROM 
    IAP_SUBJECT_DETAIL
JOIN 
    IAP_SUBJECT_CATEGORY ON IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY
JOIN 
    IAP_SUBJECT_SESSION ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
JOIN 
    IAP_SUBJECT_SPONSOR ON IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1830, 241
TOTAL                  : 58236, 53768, 4468
AVG                    : 2329.44, 2150.72, 178.72
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Show the department names, the corresponding SIS subject code, subject code descriptions, graduate level, and the total number of courses per department.

(Hints: Schema Mapping Hints:
- 'department names' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'SIS subject code' is related to SIS_SUBJECT_CODE.SUBJECT_CODE
- 'subject code descriptions' is related to SIS_SUBJECT_CODE.SUBJECT_CODE_DESC
- 'graduate level' is related to SIS_COURSE_DESCRIPTION.GRADUATE_LEVEL
- 'courses' is related to SIS_SUBJECT_CODE.COURSE_NUMBER

Join Information: (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_SUBJECT_CODE.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTP3FRetJIw6dJ2LYMKOeqQMfKR', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    d.DEPARTMENT_NAME, \n    s.SUBJECT_CODE, \n    s.SUBJECT_CODE_DESC, \n    c.GRADUATE_LEVEL, \n    COUNT(s.COURSE_NUMBER) AS total_courses\nFROM \n    SIS_DEPARTMENT d\nJOIN \n    SIS_COURSE_DESCRIPTION c ON c.DEPARTMENT = d.DEPARTMENT_CODE\nJOIN \n    SIS_SUBJECT_CODE s ON s.COURSE_NUMBER = c.COURSE\nGROUP BY \n    d.DEPARTMENT_NAME, s.SUBJECT_CODE, s.SUBJECT_CODE_DESC, c.GRADUATE_LEVEL;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179767, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=131, prompt_tokens=1421, total_tokens=1552, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=131, prompt_tokens=1421, total_tokens=1552, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    d.DEPARTMENT_NAME, 
    s.SUBJECT_CODE, 
    s.SUBJECT_CODE_DESC, 
    c.GRADUATE_LEVEL, 
    COUNT(s.COURSE_NUMBER) AS total_courses
FROM 
    SIS_DEPARTMENT d
JOIN 
    SIS_COURSE_DESCRIPTION c ON c.DEPARTMENT = d.DEPARTMENT_CODE
JOIN 
    SIS_SUBJECT_CODE s ON s.COURSE_NUMBER = c.COURSE
GROUP BY 
    d.DEPARTMENT_NAME, s.SUBJECT_CODE, s.SUBJECT_CODE_DESC, c.GRADUATE_LEVEL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1421, 131
TOTAL                  : 59788, 55189, 4599
AVG                    : 2299.54, 2122.65, 176.88
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: ACADEMIC_TERM_PARAMETER
[
(TERM_PARAMETER:VARCHAR2, Examples: ['SIS_CURRENT_TERM', 'SIS_PREVIOUS_TERM', 'SIS_UPCOMING_TERM']),
(TERM_INDICATOR:VARCHAR2, Examples: ['C', 'P', 'F']),
(TERM_CODE:VARCHAR2, Examples: ['2024SU', '2025FA', '2025JA']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Fall Term 2024-2025', 'Summer Term 2024', 'January Term 2024-2025']),
(TERM_START_DATE:DATE, Examples: ['03-SEP-24', '10-JUN-24', '06-JAN-25']),
(TERM_END_DATE:DATE, Examples: ['20-DEC-24', '20-AUG-24', '31-JAN-25']),
(TERM_LAST_DAY_BEFORE_NEXT_TERM:DATE, Examples: ['05-JAN-25', '02-SEP-24', '31-JAN-25']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['Y', 'N'])
]
# Table: CIS_COURSE_CATALOG
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2003', '2002', '2007']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['097', '098', '090']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['N', 'Y', 'S']),
(DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:DATE, Examples: ['Electrical Eng & Computer Sci', 'Architecture', 'Chemistry']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1991FA', '1995FA', '1989FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['Y', 'N']),
(LECTURE_UNITS:VARCHAR2, Examples: [0, 3, 1]),
(LAB_UNITS:VARCHAR2, Examples: [0, 12, 4]),
(PREPARATION_UNITS:VARCHAR2, Examples: [0, 9, 5]),
(TOTAL_UNITS:VARCHAR2, Examples: [0, 12, 6]),
(DESIGN_UNITS:VARCHAR2, Examples: [0, 6, 8]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['R', 'J', 'N']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Can be repeated for credit', 'Continuing and Repeatable', 'Not repeatable for credit']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', 'H-LEVEL Grad Credit (except for Course 18 students)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['HD1', 'HE', 'HD5']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS-D, Category 1', 'HASS Elective', 'HASS-D, Category 5']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:NUMBER, Examples: ['RESH', 'NTRN', 'COOP']),
(TUITION_ATTRIBUTE_DESC:NUMBER, Examples: ['Pre-thesis Research Subject', 'Internship', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:NUMBER, Examples: ['WRT2', 'WRT1']),
(WRITE_REQ_ATTRIBUTE_DESC:NUMBER, Examples: ['Writing Requirement, Phase II', 'Writing Requirement, Phase I']),
(SUPERVISOR_ATTRIBUTE:NUMBER, Examples: ['UROP', 'THG', 'THU']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['UROP subject', 'Grad Thesis', 'Undergrad Thesis']),
(PREREQUISITES:VARCHAR2, Examples: ['Permission of instructor', '10.213', '12.120 and 12.103, or permission of instructor']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Crystal structures of mantle and core minerals, elastic and thermodynamic properties of materials at high pressure-temperature,', 'Investigates social conflict and distributional disputes in the public sector. While theoretical aspects of conflict are consid', 'Presents a framework for current landscape ecological theory, structured to encourage application in physical planning of lands']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.285J, 11.482J', '3.57J', '1.232J, 15.054J, 16.71J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE', '1.EPW, 3.EPW, 6.EPW, 10.EPW, 16.EPW, 20.EPW, 22.EPW', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['2.729J, EC.729J', 'EC.718J, WGS.277J', '21A.136J, 21G.026J']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['15.511, 15.515', '15.024', '15.414']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(STATUS_CHANGE:VARCHAR2, Examples: ['(2016: New number: 21G.110)', '(2016: New number: 21G.113)', '(2016: New number: 21G.142)']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['02-SEP-01', '12-JAN-06', '16-MAY-05']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.005']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HS', 'HA', 'HH']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Social Sciences', 'HASS Arts', 'HASS Humanities']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'Second Half Term Subject', 'First Half Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Asia', 'United States of America']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['China', 'Brazil|Uruguay|Vietnam|Russia|Australia', 'United States of America']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m2c.html', 'http://student.mit.edu/catalog/m3b.html'])
]

### Question ###
For each term, list the term code, the term description, whether the term is current or not, and the total number of types of CIS courses.

(Hints: Schema Mapping Hints:
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'term is current or not' is related to ACADEMIC_TERM_PARAMETER.IS_CURRENT_TERM
- 'CIS courses' is related to CIS_COURSE_CATALOG.SUBJECT_ID)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTT9tEYWqgj9ODndEMnZlyQcUTB', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    ata.TERM_CODE, \n    ata.TERM_DESCRIPTION, \n    atp.IS_CURRENT_TERM, \n    COUNT(DISTINCT ccc.SUBJECT_ID) AS total_types_of_cis_courses\nFROM \n    ACADEMIC_TERMS_ALL ata\nLEFT JOIN \n    ACADEMIC_TERM_PARAMETER atp ON ata.TERM_CODE = atp.TERM_CODE\nLEFT JOIN \n    CIS_COURSE_CATALOG ccc ON ccc.ACADEMIC_YEAR = ata.ACADEMIC_YEAR\nGROUP BY \n    ata.TERM_CODE, \n    ata.TERM_DESCRIPTION, \n    atp.IS_CURRENT_TERM;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179771, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=131, prompt_tokens=2700, total_tokens=2831, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=131, prompt_tokens=2700, total_tokens=2831, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ata.TERM_CODE, 
    ata.TERM_DESCRIPTION, 
    atp.IS_CURRENT_TERM, 
    COUNT(DISTINCT ccc.SUBJECT_ID) AS total_types_of_cis_courses
FROM 
    ACADEMIC_TERMS_ALL ata
LEFT JOIN 
    ACADEMIC_TERM_PARAMETER atp ON ata.TERM_CODE = atp.TERM_CODE
LEFT JOIN 
    CIS_COURSE_CATALOG ccc ON ccc.ACADEMIC_YEAR = ata.ACADEMIC_YEAR
GROUP BY 
    ata.TERM_CODE, 
    ata.TERM_DESCRIPTION, 
    atp.IS_CURRENT_TERM;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2700, 131
TOTAL                  : 62619, 57889, 4730
AVG                    : 2319.22, 2144.04, 175.19
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: STUDENT_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Ctr for Transportation Studies', 'Foreign Study Program', 'Center for Adv Eng Studies']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['CTS-Ctr for Transportation Studies', 'FOR-Foreign Study Program', 'EN-Center for Adv Eng Studies']),
(SCHOOL_CODE:VARCHAR2, Examples: ['E', 'Y', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'MIT, academic', 'Hum, Arts & Social Sciences'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the author, school name, material status, total record counts, and total number of types of courses for each author and school?

(Hints: Schema Mapping Hints:
- 'author' is related to TIP_MATERIAL.AUTHOR
- 'school name' is related to STUDENT_DEPARTMENT.SCHOOL_NAME
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'record counts' is related to TIP_DETAIL.RECORD_COUNT
- 'courses' is related to TIP_DETAIL.SUBJECT_ID

Join Information: (TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY = TIP_DETAIL.TIP_MATERIAL_STATUS_KEY), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (STUDENT_DEPARTMENT.DEPARTMENT_CODE = TIP_SUBJECT_OFFERED.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTXMlOHOJLJv7O4eqBNtKWRuIYQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    m.AUTHOR,\n    d.SCHOOL_NAME,\n    s.TIP_MATERIAL_STATUS,\n    SUM(td.RECORD_COUNT) AS total_record_counts,\n    COUNT(DISTINCT td.SUBJECT_ID) AS total_number_of_types_of_courses\nFROM \n    TIP_MATERIAL m\nJOIN \n    TIP_DETAIL td ON m.TIP_MATERIAL_KEY = td.TIP_MATERIAL_KEY\nJOIN \n    TIP_MATERIAL_STATUS s ON s.TIP_MATERIAL_STATUS_KEY = td.TIP_MATERIAL_STATUS_KEY\nJOIN \n    TIP_SUBJECT_OFFERED o ON o.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    STUDENT_DEPARTMENT d ON d.DEPARTMENT_CODE = o.OFFER_DEPT_CODE\nGROUP BY \n    m.AUTHOR, d.SCHOOL_NAME, s.TIP_MATERIAL_STATUS\n```\n', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179775, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=184, prompt_tokens=1670, total_tokens=1854, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=184, prompt_tokens=1670, total_tokens=1854, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    m.AUTHOR,
    d.SCHOOL_NAME,
    s.TIP_MATERIAL_STATUS,
    SUM(td.RECORD_COUNT) AS total_record_counts,
    COUNT(DISTINCT td.SUBJECT_ID) AS total_number_of_types_of_courses
FROM 
    TIP_MATERIAL m
JOIN 
    TIP_DETAIL td ON m.TIP_MATERIAL_KEY = td.TIP_MATERIAL_KEY
JOIN 
    TIP_MATERIAL_STATUS s ON s.TIP_MATERIAL_STATUS_KEY = td.TIP_MATERIAL_STATUS_KEY
JOIN 
    TIP_SUBJECT_OFFERED o ON o.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY
JOIN 
    STUDENT_DEPARTMENT d ON d.DEPARTMENT_CODE = o.OFFER_DEPT_CODE
GROUP BY 
    m.AUTHOR, d.SCHOOL_NAME, s.TIP_MATERIAL_STATUS

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1670, 184
TOTAL                  : 64473, 59559, 4914
AVG                    : 2302.61, 2127.11, 175.50
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the course number, subject title, material status, the total, min, and max new shelf price, the total, min, and max used shelf price, total number of schools and the total number of materials for each TIP subject and material status?

(Hints: Schema Mapping Hints:
- 'course number' is related to TIP_SUBJECT_OFFERED.COURSE_NUMBER
- 'subject title' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'new shelf price' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'used shelf price' is related to TIP_MATERIAL.USED_SHELF_PRICE
- 'schools' is related to TIP_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'materials' is related to TIP_DETAIL.TIP_MATERIAL_KEY
- 'TIP subject' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE

Join Information: (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY), (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY), (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTbOISCqczqsSIUVgpmvu9pAFeb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    tso.COURSE_NUMBER,\n    tso.SUBJECT_TITLE,\n    tms.TIP_MATERIAL_STATUS,\n    COUNT(DISTINCT tso.OFFER_SCHOOL_NAME) AS total_schools,\n    COUNT(td.TIP_MATERIAL_KEY) AS total_materials,\n    SUM(tm.NEW_SHELF_PRICE) AS total_new_price,\n    MIN(tm.NEW_SHELF_PRICE) AS min_new_price,\n    MAX(tm.NEW_SHELF_PRICE) AS max_new_price,\n    SUM(tm.USED_SHELF_PRICE) AS total_used_price,\n    MIN(tm.USED_SHELF_PRICE) AS min_used_price,\n    MAX(tm.USED_SHELF_PRICE) AS max_used_price\nFROM \n    TIP_SUBJECT_OFFERED tso\nJOIN \n    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY\nJOIN \n    TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY\nGROUP BY \n    tso.COURSE_NUMBER, \n    tso.SUBJECT_TITLE, \n    tms.TIP_MATERIAL_STATUS\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179779, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=261, prompt_tokens=1626, total_tokens=1887, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=261, prompt_tokens=1626, total_tokens=1887, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    tso.COURSE_NUMBER,
    tso.SUBJECT_TITLE,
    tms.TIP_MATERIAL_STATUS,
    COUNT(DISTINCT tso.OFFER_SCHOOL_NAME) AS total_schools,
    COUNT(td.TIP_MATERIAL_KEY) AS total_materials,
    SUM(tm.NEW_SHELF_PRICE) AS total_new_price,
    MIN(tm.NEW_SHELF_PRICE) AS min_new_price,
    MAX(tm.NEW_SHELF_PRICE) AS max_new_price,
    SUM(tm.USED_SHELF_PRICE) AS total_used_price,
    MIN(tm.USED_SHELF_PRICE) AS min_used_price,
    MAX(tm.USED_SHELF_PRICE) AS max_used_price
FROM 
    TIP_SUBJECT_OFFERED tso
JOIN 
    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY
JOIN 
    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY
JOIN 
    TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY
GROUP BY 
    tso.COURSE_NUMBER, 
    tso.SUBJECT_TITLE, 
    tms.TIP_MATERIAL_STATUS

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1626, 261
TOTAL                  : 66360, 61185, 5175
AVG                    : 2288.28, 2109.83, 178.45
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: STUDENT_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Ctr for Transportation Studies', 'Foreign Study Program', 'Center for Adv Eng Studies']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['CTS-Ctr for Transportation Studies', 'FOR-Foreign Study Program', 'EN-Center for Adv Eng Studies']),
(SCHOOL_CODE:VARCHAR2, Examples: ['E', 'Y', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'MIT, academic', 'Hum, Arts & Social Sciences'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is material status, the total number of materials, the total number of subjects, the total number of schools, and the most recent publication year for each material status?

(Hints: Schema Mapping Hints:
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'materials' is related to TIP_DETAIL.TIP_MATERIAL_KEY
- 'subjects' is related to TIP_DETAIL.SUBJECT_ID
- 'schools' is related to STUDENT_DEPARTMENT.SCHOOL_NAME
- 'publication year' is related to TIP_MATERIAL.YEAR

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY = TIP_DETAIL.TIP_MATERIAL_STATUS_KEY), (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY), (STUDENT_DEPARTMENT.DEPARTMENT_CODE = TIP_SUBJECT_OFFERED.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTgx5JzQv8XHOiKeHFMEf5wnFcz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    TMS.TIP_MATERIAL_STATUS AS material_status,\n    COUNT(DISTINCT TD.TIP_MATERIAL_KEY) AS total_materials,\n    COUNT(DISTINCT TD.SUBJECT_ID) AS total_subjects,\n    COUNT(DISTINCT SD.SCHOOL_NAME) AS total_schools,\n    MAX(TM.YEAR) AS most_recent_publication_year\nFROM \n    TIP_DETAIL TD\nJOIN \n    TIP_MATERIAL TM ON TM.TIP_MATERIAL_KEY = TD.TIP_MATERIAL_KEY\nJOIN \n    TIP_MATERIAL_STATUS TMS ON TMS.TIP_MATERIAL_STATUS_KEY = TD.TIP_MATERIAL_STATUS_KEY\nJOIN \n    TIP_SUBJECT_OFFERED TSO ON TSO.TIP_SUBJECT_OFFERED_KEY = TD.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    STUDENT_DEPARTMENT SD ON SD.DEPARTMENT_CODE = TSO.OFFER_DEPT_CODE\nGROUP BY \n    TMS.TIP_MATERIAL_STATUS\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179784, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=203, prompt_tokens=1694, total_tokens=1897, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=203, prompt_tokens=1694, total_tokens=1897, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    TMS.TIP_MATERIAL_STATUS AS material_status,
    COUNT(DISTINCT TD.TIP_MATERIAL_KEY) AS total_materials,
    COUNT(DISTINCT TD.SUBJECT_ID) AS total_subjects,
    COUNT(DISTINCT SD.SCHOOL_NAME) AS total_schools,
    MAX(TM.YEAR) AS most_recent_publication_year
FROM 
    TIP_DETAIL TD
JOIN 
    TIP_MATERIAL TM ON TM.TIP_MATERIAL_KEY = TD.TIP_MATERIAL_KEY
JOIN 
    TIP_MATERIAL_STATUS TMS ON TMS.TIP_MATERIAL_STATUS_KEY = TD.TIP_MATERIAL_STATUS_KEY
JOIN 
    TIP_SUBJECT_OFFERED TSO ON TSO.TIP_SUBJECT_OFFERED_KEY = TD.TIP_SUBJECT_OFFERED_KEY
JOIN 
    STUDENT_DEPARTMENT SD ON SD.DEPARTMENT_CODE = TSO.OFFER_DEPT_CODE
GROUP BY 
    TMS.TIP_MATERIAL_STATUS

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1694, 203
TOTAL                  : 68257, 62879, 5378
AVG                    : 2275.23, 2095.97, 179.27
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
What is the term description, whether the term is current or not, total number of types of TIP subjects offered and materials needed, the minimum and maximum number of enrolled students, the total number of schools offering subjects, and the total number of records for each term code?

(Hints: Schema Mapping Hints:
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'term is current or not' is related to ACADEMIC_TERMS_ALL.IS_CURRENT_TERM
- 'TIP subjects' is related to TIP_SUBJECT_OFFERED.COURSE_NUMBER
- 'materials' is related to TIP_MATERIAL.ISBN
- 'enrolled students' is related to TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'schools' is related to TIP_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'number of records' is related to TIP_DETAIL.RECORD_COUNT
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE

Join Information: (ACADEMIC_TERMS_ALL.TERM_CODE = TIP_SUBJECT_OFFERED.TERM_CODE), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY), (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTkFzdv0bwWLgMN8oxnVWhLVueX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    at.TERM_DESCRIPTION,\n    at.IS_CURRENT_TERM,\n    COUNT(DISTINCT tso.COURSE_NUMBER) AS total_tip_subjects_offered,\n    COUNT(DISTINCT tm.ISBN) AS total_materials_needed,\n    MIN(tso.NUM_ENROLLED_STUDENTS) AS min_enrolled_students,\n    MAX(tso.NUM_ENROLLED_STUDENTS) AS max_enrolled_students,\n    COUNT(DISTINCT tso.OFFER_SCHOOL_NAME) AS total_schools_offering_subjects,\n    COUNT(td.RECORD_COUNT) AS total_records\nFROM \n    ACADEMIC_TERMS_ALL at\nLEFT JOIN \n    TIP_SUBJECT_OFFERED tso ON at.TERM_CODE = tso.TERM_CODE\nLEFT JOIN \n    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY\nLEFT JOIN \n    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY\nGROUP BY \n    at.TERM_DESCRIPTION, at.IS_CURRENT_TERM;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179788, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=219, prompt_tokens=2254, total_tokens=2473, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=219, prompt_tokens=2254, total_tokens=2473, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    at.TERM_DESCRIPTION,
    at.IS_CURRENT_TERM,
    COUNT(DISTINCT tso.COURSE_NUMBER) AS total_tip_subjects_offered,
    COUNT(DISTINCT tm.ISBN) AS total_materials_needed,
    MIN(tso.NUM_ENROLLED_STUDENTS) AS min_enrolled_students,
    MAX(tso.NUM_ENROLLED_STUDENTS) AS max_enrolled_students,
    COUNT(DISTINCT tso.OFFER_SCHOOL_NAME) AS total_schools_offering_subjects,
    COUNT(td.RECORD_COUNT) AS total_records
FROM 
    ACADEMIC_TERMS_ALL at
LEFT JOIN 
    TIP_SUBJECT_OFFERED tso ON at.TERM_CODE = tso.TERM_CODE
LEFT JOIN 
    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY
LEFT JOIN 
    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY
GROUP BY 
    at.TERM_DESCRIPTION, at.IS_CURRENT_TERM;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2254, 219
TOTAL                  : 70730, 65133, 5597
AVG                    : 2281.61, 2101.06, 180.55
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List all buildings with their names, building numbers, building height, street address, city, state, HR department name, assignable square footage, total and average square footage, ordered in descending order of assignable, total, and average square footage.

(Hints: Schema Mapping Hints:
- 'names' is related to BUILDINGS.BUILDING_NAME
- 'building numbers' is related to BUILDINGS.BUILDING_NUMBER
- 'building height' is related to FAC_BUILDING.BUILDING_HEIGHT
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'HR department name' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'assignable square footage' is related to BUILDINGS.BLDG_ASSIGNABLE_SQUARE_FOOTAGE
- 'square footage' is related to FAC_ROOMS.AREA

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = BUILDINGS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTocmjrD3hCOePGJYEOsIgfNj0J', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    b.BUILDING_NAME,\n    b.BUILDING_NUMBER,\n    fb.BUILDING_HEIGHT,\n    b.BUILDING_STREET_ADDRESS,\n    fa.CITY,\n    fa.STATE,\n    fo.HR_DEPARTMENT_NAME,\n    b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE,\n    SUM(fr.AREA) AS total_square_footage,\n    AVG(fr.AREA) AS average_square_footage\nFROM \n    BUILDINGS b\nJOIN \n    FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY\nJOIN \n    FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY\nJOIN \n    FAC_BUILDING_ADDRESS fa ON b.BUILDING_KEY = fa.BUILDING_KEY\nJOIN \n    FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY\nGROUP BY \n    b.BUILDING_NAME,\n    b.BUILDING_NUMBER,\n    fb.BUILDING_HEIGHT,\n    b.BUILDING_STREET_ADDRESS,\n    fa.CITY,\n    fa.STATE,\n    fo.HR_DEPARTMENT_NAME,\n    b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE\nORDER BY \n    b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE DESC,\n    total_square_footage DESC,\n    average_square_footage DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179792, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=279, prompt_tokens=2617, total_tokens=2896, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=279, prompt_tokens=2617, total_tokens=2896, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    b.BUILDING_NAME,
    b.BUILDING_NUMBER,
    fb.BUILDING_HEIGHT,
    b.BUILDING_STREET_ADDRESS,
    fa.CITY,
    fa.STATE,
    fo.HR_DEPARTMENT_NAME,
    b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE,
    SUM(fr.AREA) AS total_square_footage,
    AVG(fr.AREA) AS average_square_footage
FROM 
    BUILDINGS b
JOIN 
    FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY
JOIN 
    FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY
JOIN 
    FAC_BUILDING_ADDRESS fa ON b.BUILDING_KEY = fa.BUILDING_KEY
JOIN 
    FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY
GROUP BY 
    b.BUILDING_NAME,
    b.BUILDING_NUMBER,
    fb.BUILDING_HEIGHT,
    b.BUILDING_STREET_ADDRESS,
    fa.CITY,
    fa.STATE,
    fo.HR_DEPARTMENT_NAME,
    b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE
ORDER BY 
    b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE DESC,
    total_square_footage DESC,
    average_square_footage DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2617, 279
TOTAL                  : 73626, 67750, 5876
AVG                    : 2300.81, 2117.19, 183.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]

### Question ###
For the 2023 Fall term, what are the unique term descriptions, subject titles along with their prerequisites, total number of types of subjects per term code, instructor of this course, and the number of types of courses ever taught by the instructor?

(Hints: Schema Mapping Hints:
- '2023 Fall term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'term descriptions' is related to ACADEMIC_TERMS.TERM_DESCRIPTION
- 'subject titles' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'prerequisites' is related to COURSE_CATALOG_SUBJECT_OFFERED.PREREQUISITES
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'term code' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'instructor' is related to COURSE_CATALOG_SUBJECT_OFFERED.FALL_INSTRUCTORS
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTuu0a08FRCRCm1QgiqKdeQ9Ane', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    DISTINCT a.TERM_DESCRIPTION, \n    c.SUBJECT_TITLE, \n    c.PREREQUISITES, \n    COUNT(DISTINCT c.SUBJECT_ID) OVER (PARTITION BY c.TERM_CODE) AS TYPE_COUNT,\n    c.FALL_INSTRUCTORS,\n    COUNT(DISTINCT c.SUBJECT_ID) OVER (PARTITION BY c.FALL_INSTRUCTORS) AS INSTRUCTOR_COURSE_COUNT\nFROM \n    ACADEMIC_TERMS a\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED c ON a.TERM_CODE = c.TERM_CODE\nWHERE \n    a.TERM_CODE = '2023FA';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179798, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=138, prompt_tokens=2982, total_tokens=3120, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=138, prompt_tokens=2982, total_tokens=3120, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    DISTINCT a.TERM_DESCRIPTION, 
    c.SUBJECT_TITLE, 
    c.PREREQUISITES, 
    COUNT(DISTINCT c.SUBJECT_ID) OVER (PARTITION BY c.TERM_CODE) AS TYPE_COUNT,
    c.FALL_INSTRUCTORS,
    COUNT(DISTINCT c.SUBJECT_ID) OVER (PARTITION BY c.FALL_INSTRUCTORS) AS INSTRUCTOR_COURSE_COUNT
FROM 
    ACADEMIC_TERMS a
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED c ON a.TERM_CODE = c.TERM_CODE
WHERE 
    a.TERM_CODE = '2023FA';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2982, 138
TOTAL                  : 76746, 70732, 6014
AVG                    : 2325.64, 2143.39, 182.24
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Show the details of rooms including the full name of the rooms, the building names, floor numbers, the organizations occupying them, name of the departments occupying them, and the percentage of the room area over the assignable floor area and building.

(Hints: Schema Mapping Hints:
- 'full name of the rooms' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'floor numbers' is related to FAC_FLOOR.FLOOR
- 'organizations' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'name of the departments' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'room area' is related to FAC_ROOMS.AREA
- 'assignable floor area' is related to FAC_FLOOR.ASSIGNABLE_AREA

Join Information: (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_ROOMS.FLOOR_KEY = FAC_FLOOR.FLOOR_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoTyar5mU2INJbznFqArYLMcJf6i', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    FR.ROOM_FULL_NAME,\n    FB.BUILDING_NAME,\n    FF.FLOOR,\n    FO.ORGANIZATION_NAME,\n    FO.HR_DEPARTMENT_NAME,\n    (FR.AREA / FF.ASSIGNABLE_AREA * 100) AS ROOM_AREA_PERCENTAGE,\n    (FR.AREA / (SELECT SUM(FS.ASSIGNABLE_AREA) FROM FAC_FLOOR AS FS WHERE FS.BUILDING_KEY = FR.BUILDING_KEY) * 100) AS ROOM_AREA_PERCENTAGE_BUILDING\nFROM \n    FAC_ROOMS FR\nJOIN \n    FAC_FLOOR FF ON FR.FLOOR_KEY = FF.FLOOR_KEY\nJOIN \n    FAC_BUILDING FB ON FR.BUILDING_KEY = FB.FAC_BUILDING_KEY\nJOIN \n    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179802, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=183, prompt_tokens=2417, total_tokens=2600, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=183, prompt_tokens=2417, total_tokens=2600, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    FR.ROOM_FULL_NAME,
    FB.BUILDING_NAME,
    FF.FLOOR,
    FO.ORGANIZATION_NAME,
    FO.HR_DEPARTMENT_NAME,
    (FR.AREA / FF.ASSIGNABLE_AREA * 100) AS ROOM_AREA_PERCENTAGE,
    (FR.AREA / (SELECT SUM(FS.ASSIGNABLE_AREA) FROM FAC_FLOOR AS FS WHERE FS.BUILDING_KEY = FR.BUILDING_KEY) * 100) AS ROOM_AREA_PERCENTAGE_BUILDING
FROM 
    FAC_ROOMS FR
JOIN 
    FAC_FLOOR FF ON FR.FLOOR_KEY = FF.FLOOR_KEY
JOIN 
    FAC_BUILDING FB ON FR.BUILDING_KEY = FB.FAC_BUILDING_KEY
JOIN 
    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2417, 183
TOTAL                  : 79346, 73149, 6197
AVG                    : 2333.71, 2151.44, 182.26
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Show the details of rooms including the full name of the rooms, the building names, floor numbers, the organizations occupying them, name of the departments occupying them, and the percentage of the room area over the floor area and building.

(Hints: Schema Mapping Hints:
- 'full name' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'floor numbers' is related to FAC_FLOOR.FLOOR
- 'organizations' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'departments' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'room area' is related to FAC_ROOMS.AREA
- 'floor area' is related to FAC_ROOMS.AREA, FAC_ROOMS.FLOOR_KEY)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoU2b3XmlewlpMSK5MZFl0HytDIv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    FR.ROOM_FULL_NAME,\n    FB.BUILDING_NAME,\n    FF.FLOOR,\n    FO.ORGANIZATION_NAME,\n    FO.HR_DEPARTMENT_NAME,\n    (FR.AREA / FF.ASSIGNABLE_AREA * 100) AS ROOM_AREA_PERCENTAGE,\n    (FR.AREA / FF.EXT_GROSS_AREA * 100) AS ROOM_AREA_PERCENTAGE_BUILDING\nFROM \n    FAC_ROOMS FR\nJOIN \n    FAC_BUILDING FB ON FR.BUILDING_KEY = FB.FAC_BUILDING_KEY\nJOIN \n    FAC_FLOOR FF ON FR.BUILDING_KEY = FF.BUILDING_KEY AND FR.FLOOR = FF.FLOOR\nJOIN \n    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179806, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=168, prompt_tokens=2355, total_tokens=2523, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=168, prompt_tokens=2355, total_tokens=2523, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    FR.ROOM_FULL_NAME,
    FB.BUILDING_NAME,
    FF.FLOOR,
    FO.ORGANIZATION_NAME,
    FO.HR_DEPARTMENT_NAME,
    (FR.AREA / FF.ASSIGNABLE_AREA * 100) AS ROOM_AREA_PERCENTAGE,
    (FR.AREA / FF.EXT_GROSS_AREA * 100) AS ROOM_AREA_PERCENTAGE_BUILDING
FROM 
    FAC_ROOMS FR
JOIN 
    FAC_BUILDING FB ON FR.BUILDING_KEY = FB.FAC_BUILDING_KEY
JOIN 
    FAC_FLOOR FF ON FR.BUILDING_KEY = FF.BUILDING_KEY AND FR.FLOOR = FF.FLOOR
JOIN 
    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2355, 168
TOTAL                  : 81869, 75504, 6365
AVG                    : 2339.11, 2157.26, 181.86
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
What are the academic year, and instructors names for courses offered in the academic year 2022, along with the total number of types of courses per instructor?

(Hints: Schema Mapping Hints:
- 'academic year' is related to ACADEMIC_TERMS_ALL.ACADEMIC_YEAR
- 'instructors names' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'courses' is related to SUBJECT_OFFERED.COURSE_NUMBER

Join Information: (SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE), (SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoU73xrgtgB0PQUlwqj0M3O1BLo9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR, \n    EMPLOYEE_DIRECTORY.FULL_NAME, \n    COUNT(DISTINCT SUBJECT_OFFERED.COURSE_NUMBER) AS total_course_types\nFROM \n    ACADEMIC_TERMS_ALL\nJOIN \n    SUBJECT_OFFERED ON ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_OFFERED.TERM_CODE\nJOIN \n    EMPLOYEE_DIRECTORY ON SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID\nWHERE \n    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR = '2022'\nGROUP BY \n    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR, \n    EMPLOYEE_DIRECTORY.FULL_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179811, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=155, prompt_tokens=2900, total_tokens=3055, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=155, prompt_tokens=2900, total_tokens=3055, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR, 
    EMPLOYEE_DIRECTORY.FULL_NAME, 
    COUNT(DISTINCT SUBJECT_OFFERED.COURSE_NUMBER) AS total_course_types
FROM 
    ACADEMIC_TERMS_ALL
JOIN 
    SUBJECT_OFFERED ON ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_OFFERED.TERM_CODE
JOIN 
    EMPLOYEE_DIRECTORY ON SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID
WHERE 
    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR = '2022'
GROUP BY 
    ACADEMIC_TERMS_ALL.ACADEMIC_YEAR, 
    EMPLOYEE_DIRECTORY.FULL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2900, 155
TOTAL                  : 84924, 78404, 6520
AVG                    : 2359.00, 2177.89, 181.11
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
What are the building names, department names, organizations, their highest and lowest floor number, along with the total number of rooms per each building key?

(Hints: Schema Mapping Hints:
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'department names' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'organizations' is related to FAC_ORGANIZATION.ORGANIZATION
- 'floor number' is related to FAC_FLOOR.LEVEL_ID
- 'room' is related to FAC_ROOMS.FAC_ROOM_KEY
- 'building key' is related to FAC_BUILDING.FAC_BUILDING_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY), (FAC_ORGANIZATION.ORGANIZATION_KEY = FAC_ROOMS.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUBpiGq52NWqqkfSIyMt5hzLlRi', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    b.BUILDING_NAME, \n    o.HR_DEPARTMENT_NAME, \n    o.ORGANIZATION, \n    MIN(f.FLOOR) AS lowest_floor, \n    MAX(f.FLOOR) AS highest_floor, \n    COUNT(r.FAC_ROOM_KEY) AS total_rooms\nFROM \n    FAC_BUILDING b\nJOIN \n    FAC_ROOMS r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY\nJOIN \n    FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY\nJOIN \n    FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY\nGROUP BY \n    b.BUILDING_NAME, \n    o.HR_DEPARTMENT_NAME, \n    o.ORGANIZATION;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179815, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=163, prompt_tokens=2375, total_tokens=2538, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2048)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=163, prompt_tokens=2375, total_tokens=2538, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2048))

***** FINAL SQL QUERY *****
SELECT 
    b.BUILDING_NAME, 
    o.HR_DEPARTMENT_NAME, 
    o.ORGANIZATION, 
    MIN(f.FLOOR) AS lowest_floor, 
    MAX(f.FLOOR) AS highest_floor, 
    COUNT(r.FAC_ROOM_KEY) AS total_rooms
FROM 
    FAC_BUILDING b
JOIN 
    FAC_ROOMS r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY
JOIN 
    FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY
JOIN 
    FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY
GROUP BY 
    b.BUILDING_NAME, 
    o.HR_DEPARTMENT_NAME, 
    o.ORGANIZATION;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2375, 163
TOTAL                  : 87462, 80779, 6683
AVG                    : 2363.84, 2183.22, 180.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Provide the complete information for students with the first name Kevin, including their full names, email addresses, department names, department phone numbers, school names, and the total student count per department and school. If a student is associated with more than one department, list a separate row for each department.

(Hints: Schema Mapping Hints:
- 'first name' is related to MIT_STUDENT_DIRECTORY.FIRST_NAME
- 'full names' is related to MIT_STUDENT_DIRECTORY.FULL_NAME
- 'email addresses' is related to MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS
- 'department names' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'department phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'school names' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'student' is related to MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS
- 'department' is related to SIS_DEPARTMENT.DEPARTMENT_CODE
- 'school' is related to SIS_DEPARTMENT.SCHOOL_CODE

Join Information: (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUFipwqCsQ6Ophq3snwA4i81zvY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    MSD.FULL_NAME, \n    MSD.EMAIL_ADDRESS, \n    SD.DEPARTMENT_NAME, \n    SAD.DEPARTMENT_PHONE_NUMBER, \n    SD.SCHOOL_NAME, \n    COUNT(*) OVER (PARTITION BY SD.DEPARTMENT_NAME, SD.SCHOOL_NAME) AS TOTAL_STUDENT_COUNT\nFROM \n    MIT_STUDENT_DIRECTORY MSD\nJOIN \n    SIS_DEPARTMENT SD ON MSD.DEPARTMENT = SD.DEPARTMENT_CODE\nJOIN \n    SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE\nWHERE \n    MSD.FIRST_NAME = 'Kevin';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179819, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_29330a9688', usage=CompletionUsage(completion_tokens=136, prompt_tokens=1240, total_tokens=1376, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=136, prompt_tokens=1240, total_tokens=1376, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    MSD.FULL_NAME, 
    MSD.EMAIL_ADDRESS, 
    SD.DEPARTMENT_NAME, 
    SAD.DEPARTMENT_PHONE_NUMBER, 
    SD.SCHOOL_NAME, 
    COUNT(*) OVER (PARTITION BY SD.DEPARTMENT_NAME, SD.SCHOOL_NAME) AS TOTAL_STUDENT_COUNT
FROM 
    MIT_STUDENT_DIRECTORY MSD
JOIN 
    SIS_DEPARTMENT SD ON MSD.DEPARTMENT = SD.DEPARTMENT_CODE
JOIN 
    SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE
WHERE 
    MSD.FIRST_NAME = 'Kevin';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1240, 136
TOTAL                  : 88838, 82019, 6819
AVG                    : 2337.84, 2158.39, 179.45
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]

### Question ###
What are the unique titles of subjects offered in the fall term along with their instructor names, instructor emails, and the total number of types of subjects per instructor?

(Hints: Schema Mapping Hints:
- 'titles' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'fall term' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'instructor names' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'instructor emails' is related to EMPLOYEE_DIRECTORY.EMAIL_ADDRESS

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUHzZRaOUS4LIXB3S55Pk7XeJEB', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT DISTINCT c.SUBJECT_TITLE, e.FULL_NAME AS INSTRUCTOR_NAME, e.EMAIL_ADDRESS AS INSTRUCTOR_EMAIL, COUNT(DISTINCT c.SUBJECT_ID) AS SUBJECT_COUNT\nFROM COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID\nJOIN ACADEMIC_TERMS_ALL t ON c.TERM_CODE = t.TERM_CODE\nWHERE t.TERM_CODE LIKE '%FA%'\nGROUP BY c.SUBJECT_TITLE, e.FULL_NAME, e.EMAIL_ADDRESS;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179821, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=120, prompt_tokens=3436, total_tokens=3556, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=120, prompt_tokens=3436, total_tokens=3556, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT DISTINCT c.SUBJECT_TITLE, e.FULL_NAME AS INSTRUCTOR_NAME, e.EMAIL_ADDRESS AS INSTRUCTOR_EMAIL, COUNT(DISTINCT c.SUBJECT_ID) AS SUBJECT_COUNT
FROM COURSE_CATALOG_SUBJECT_OFFERED c
JOIN EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID
JOIN ACADEMIC_TERMS_ALL t ON c.TERM_CODE = t.TERM_CODE
WHERE t.TERM_CODE LIKE '%FA%'
GROUP BY c.SUBJECT_TITLE, e.FULL_NAME, e.EMAIL_ADDRESS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3436, 120
TOTAL                  : 92394, 85455, 6939
AVG                    : 2369.08, 2191.15, 177.92
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List the building names, names of HR departments occupying them, the total gross square footage, the total and average assignable square footage, and the built year per building key.

(Hints: Schema Mapping Hints:
- 'building names' is related to BUILDINGS.BUILDING_NAME
- 'names of HR departments' is related to FAC_ORGANIZATION.HR_DEPARTMENT_NAME
- 'gross square footage' is related to BUILDINGS.BLDG_GROSS_SQUARE_FOOTAGE
- 'assignable square footage' is related to BUILDINGS.BLDG_ASSIGNABLE_SQUARE_FOOTAGE
- 'built year' is related to FAC_BUILDING.DATE_BUILT
- 'building key' is related to BUILDINGS.BUILDING_KEY

Join Information: (BUILDINGS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUKQaYu5tEhZbbuvPbFqD5okgS8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    b.BUILDING_NAME, \n    fo.HR_DEPARTMENT_NAME, \n    b.BLDG_GROSS_SQUARE_FOOTAGE, \n    SUM(b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS total_assignable_square_footage, \n    AVG(b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS average_assignable_square_footage, \n    fb.DATE_BUILT \nFROM \n    BUILDINGS b \nJOIN \n    FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY \nJOIN \n    FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY \nJOIN \n    FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY \nGROUP BY \n    b.BUILDING_NAME, fo.HR_DEPARTMENT_NAME, b.BLDG_GROSS_SQUARE_FOOTAGE, fb.DATE_BUILT;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179824, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=195, prompt_tokens=2283, total_tokens=2478, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=195, prompt_tokens=2283, total_tokens=2478, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    b.BUILDING_NAME, 
    fo.HR_DEPARTMENT_NAME, 
    b.BLDG_GROSS_SQUARE_FOOTAGE, 
    SUM(b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS total_assignable_square_footage, 
    AVG(b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS average_assignable_square_footage, 
    fb.DATE_BUILT 
FROM 
    BUILDINGS b 
JOIN 
    FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY 
JOIN 
    FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY 
JOIN 
    FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY 
GROUP BY 
    b.BUILDING_NAME, fo.HR_DEPARTMENT_NAME, b.BLDG_GROSS_SQUARE_FOOTAGE, fb.DATE_BUILT;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2283, 195
TOTAL                  : 94872, 87738, 7134
AVG                    : 2371.80, 2193.45, 178.35
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Retrieve the titles of subjects offered in the summer term along with their descriptions, responsible faculty names, email address, building name, room name, floor level, building street address, and the total number of types of courses per departmnet.

(Hints: Schema Mapping Hints:
- 'titles of subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'summer term' is related to ACADEMIC_TERMS.TERM_CODE
- 'descriptions' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_DESCRIPTION
- 'responsible faculty names' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_NAME
- 'email address' is related to EMPLOYEE_DIRECTORY.EMAIL_ADDRESS
- 'building name' is related to BUILDINGS.BUILDING_NAME
- 'room name' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'floor level' is related to FAC_FLOOR.LEVEL_ID
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'department' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID), (ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE), (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FAC_ROOMS.FAC_ROOM_KEY), (FAC_ROOMS.FLOOR_KEY = FAC_FLOOR.FLOOR_KEY), (FAC_ROOMS.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUPqZ9fOzU6oeBUw5yLcZyOuhHd', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    C.SUBJECT_TITLE,\n    C.SUBJECT_DESCRIPTION,\n    C.RESPONSIBLE_FACULTY_NAME,\n    E.EMAIL_ADDRESS,\n    B.BUILDING_NAME,\n    R.ROOM_FULL_NAME,\n    F.LEVEL_ID,\n    B.BUILDING_STREET_ADDRESS,\n    COUNT(DISTINCT C.SUBJECT_ID) AS TOTAL_COURSE_TYPES\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED C\nJOIN \n    ACADEMIC_TERMS T ON C.TERM_CODE = T.TERM_CODE\nJOIN \n    EMPLOYEE_DIRECTORY E ON C.RESPONSIBLE_FACULTY_MIT_ID = E.MIT_ID\nJOIN \n    FAC_ROOMS R ON C.MEET_PLACE = R.FAC_ROOM_KEY\nJOIN \n    FAC_FLOOR F ON R.FLOOR_KEY = F.FLOOR_KEY\nJOIN \n    BUILDINGS B ON R.BUILDING_KEY = B.BUILDING_KEY\nJOIN \n    FAC_BUILDING_ADDRESS A ON B.BUILDING_KEY = A.BUILDING_KEY\nWHERE \n    T.TERM_CODE LIKE '%SUMMER%' \nGROUP BY \n    C.SUBJECT_TITLE, C.SUBJECT_DESCRIPTION, C.RESPONSIBLE_FACULTY_NAME, E.EMAIL_ADDRESS, B.BUILDING_NAME, R.ROOM_FULL_NAME, F.LEVEL_ID, B.BUILDING_STREET_ADDRESS\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179829, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=288, prompt_tokens=4978, total_tokens=5266, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=288, prompt_tokens=4978, total_tokens=5266, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    C.SUBJECT_TITLE,
    C.SUBJECT_DESCRIPTION,
    C.RESPONSIBLE_FACULTY_NAME,
    E.EMAIL_ADDRESS,
    B.BUILDING_NAME,
    R.ROOM_FULL_NAME,
    F.LEVEL_ID,
    B.BUILDING_STREET_ADDRESS,
    COUNT(DISTINCT C.SUBJECT_ID) AS TOTAL_COURSE_TYPES
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED C
JOIN 
    ACADEMIC_TERMS T ON C.TERM_CODE = T.TERM_CODE
JOIN 
    EMPLOYEE_DIRECTORY E ON C.RESPONSIBLE_FACULTY_MIT_ID = E.MIT_ID
JOIN 
    FAC_ROOMS R ON C.MEET_PLACE = R.FAC_ROOM_KEY
JOIN 
    FAC_FLOOR F ON R.FLOOR_KEY = F.FLOOR_KEY
JOIN 
    BUILDINGS B ON R.BUILDING_KEY = B.BUILDING_KEY
JOIN 
    FAC_BUILDING_ADDRESS A ON B.BUILDING_KEY = A.BUILDING_KEY
WHERE 
    T.TERM_CODE LIKE '%SUMMER%' 
GROUP BY 
    C.SUBJECT_TITLE, C.SUBJECT_DESCRIPTION, C.RESPONSIBLE_FACULTY_NAME, E.EMAIL_ADDRESS, B.BUILDING_NAME, R.ROOM_FULL_NAME, F.LEVEL_ID, B.BUILDING_STREET_ADDRESS

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4978, 288
TOTAL                  : 100138, 92716, 7422
AVG                    : 2442.39, 2261.37, 181.02
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: CIS_HASS_ATTRIBUTE
[
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HA,HS']),
(DESCRIPTION_ON_FORM:VARCHAR2, Examples: ['HASS Elective', '1/2 HASS Social Sciences', 'HASS-D, Category 1']),
(DESCRIPTION_IN_BULLETIN:VARCHAR2, Examples: ['HASS-E', 'HASS-S/2', 'HASS-D 1']),
(CIS_ATTRIBUTE_GROUP:VARCHAR2, Examples: ['H', 'G']),
(CIS_ATTRIBUTE_GROUP_NOTE:VARCHAR2, Examples: ['HASS_ATTRIBUTE, for students entering in Fall 2010 or later', 'GIR_ATTRIBUTE, for students entering prior to Fall 2010']),
(ICON_GIF_NAME:VARCHAR2, Examples: ['hassT.gif', 'hass1.gif', 'hass2.gif']),
(ICON_HEIGHT:VARCHAR2, Examples: ['16']),
(ICON_WIDTH:VARCHAR2, Examples: ['16', '35']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['05-MAR-10', '22-FEB-12', '26-APR-10']),
(LAST_UPDATE_USER:VARCHAR2, Examples: ['PETECHOI']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each term code, list the term description, attribute desciption, department name, school name, and the number of subjects in the area of humanities, arts and social sciences.

(Hints: Schema Mapping Hints:
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'attribute desciption' is related to COURSE_CATALOG_SUBJECT_OFFERED.HASS_ATTRIBUTE_DESC
- 'department name' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'area of humanities, arts and social studies' is related to CIS_HASS_ATTRIBUTE.CIS_ATTRIBUTE_GROUP

Join Information: (CIS_HASS_ATTRIBUTE.HASS_ATTRIBUTE = COURSE_CATALOG_SUBJECT_OFFERED.HASS_ATTRIBUTE), (COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE), (ACADEMIC_TERMS_ALL.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUVfWNG2jcmQDHnkxTTP45ylmJH', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    at.TERM_CODE, \n    at.TERM_DESCRIPTION, \n    ca.HASS_ATTRIBUTE_DESC, \n    d.DEPARTMENT_NAME, \n    d.SCHOOL_NAME, \n    COUNT(ca.SUBJECT_ID) AS NUMBER_OF_SUBJECTS\nFROM \n    ACADEMIC_TERMS_ALL at\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED ca ON at.TERM_CODE = ca.TERM_CODE\nJOIN \n    CIS_HASS_ATTRIBUTE cha ON ca.HASS_ATTRIBUTE = cha.HASS_ATTRIBUTE\nJOIN \n    SIS_DEPARTMENT d ON ca.DEPARTMENT_CODE = d.DEPARTMENT_CODE\nWHERE \n    cha.CIS_ATTRIBUTE_GROUP = 'H'\nGROUP BY \n    at.TERM_CODE, \n    at.TERM_DESCRIPTION, \n    ca.HASS_ATTRIBUTE_DESC, \n    d.DEPARTMENT_NAME, \n    d.SCHOOL_NAME\nORDER BY \n    at.TERM_CODE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179835, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=195, prompt_tokens=3559, total_tokens=3754, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=195, prompt_tokens=3559, total_tokens=3754, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    at.TERM_CODE, 
    at.TERM_DESCRIPTION, 
    ca.HASS_ATTRIBUTE_DESC, 
    d.DEPARTMENT_NAME, 
    d.SCHOOL_NAME, 
    COUNT(ca.SUBJECT_ID) AS NUMBER_OF_SUBJECTS
FROM 
    ACADEMIC_TERMS_ALL at
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED ca ON at.TERM_CODE = ca.TERM_CODE
JOIN 
    CIS_HASS_ATTRIBUTE cha ON ca.HASS_ATTRIBUTE = cha.HASS_ATTRIBUTE
JOIN 
    SIS_DEPARTMENT d ON ca.DEPARTMENT_CODE = d.DEPARTMENT_CODE
WHERE 
    cha.CIS_ATTRIBUTE_GROUP = 'H'
GROUP BY 
    at.TERM_CODE, 
    at.TERM_DESCRIPTION, 
    ca.HASS_ATTRIBUTE_DESC, 
    d.DEPARTMENT_NAME, 
    d.SCHOOL_NAME
ORDER BY 
    at.TERM_CODE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3559, 195
TOTAL                  : 103892, 96275, 7617
AVG                    : 2473.62, 2292.26, 181.36
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List building names, their height, street address, city, state, postal code, their gross and assignable square footage, the smallest and largest floor level and the total area of all rooms for each building key.

(Hints: Schema Mapping Hints:
- 'building names' is related to FAC_BUILDING.BUILDING_NAME
- 'height' is related to FAC_BUILDING.BUILDING_HEIGHT
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'postal code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'gross square footage' is related to FAC_BUILDING.EXT_GROSS_AREA
- 'assignable square footage' is related to FAC_BUILDING.ASSIGNABLE_AREA
- 'floor level' is related to FAC_FLOOR.LEVEL_ID
- 'area' is related to FAC_ROOMS.AREA
- 'building key' is related to FAC_BUILDING.FAC_BUILDING_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_FLOOR.BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = BUILDINGS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUaTNkpZP5Sjg5WHdQtRKizNZf3', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    b.BUILDING_NAME,\n    fb.BUILDING_HEIGHT,\n    b.BUILDING_STREET_ADDRESS,\n    fba.CITY,\n    fba.STATE,\n    fba.POSTAL_CODE,\n    fb.EXT_GROSS_AREA,\n    fb.ASSIGNABLE_AREA,\n    MIN(ff.LEVEL_ID) AS smallest_floor_level,\n    MAX(ff.LEVEL_ID) AS largest_floor_level,\n    SUM(fr.AREA) AS total_room_area\nFROM \n    BUILDINGS b\nJOIN \n    FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY\nJOIN \n    FAC_BUILDING_ADDRESS fba ON fb.FAC_BUILDING_KEY = fba.BUILDING_KEY\nJOIN \n    FAC_FLOOR ff ON fb.FAC_BUILDING_KEY = ff.BUILDING_KEY\nJOIN \n    FAC_ROOMS fr ON ff.FLOOR_KEY = fr.FLOOR_KEY\nGROUP BY \n    b.BUILDING_NAME, fb.BUILDING_HEIGHT, b.BUILDING_STREET_ADDRESS, fba.CITY, fba.STATE, fba.POSTAL_CODE, fb.EXT_GROSS_AREA, fb.ASSIGNABLE_AREA;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179840, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=245, prompt_tokens=2539, total_tokens=2784, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=245, prompt_tokens=2539, total_tokens=2784, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    b.BUILDING_NAME,
    fb.BUILDING_HEIGHT,
    b.BUILDING_STREET_ADDRESS,
    fba.CITY,
    fba.STATE,
    fba.POSTAL_CODE,
    fb.EXT_GROSS_AREA,
    fb.ASSIGNABLE_AREA,
    MIN(ff.LEVEL_ID) AS smallest_floor_level,
    MAX(ff.LEVEL_ID) AS largest_floor_level,
    SUM(fr.AREA) AS total_room_area
FROM 
    BUILDINGS b
JOIN 
    FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY
JOIN 
    FAC_BUILDING_ADDRESS fba ON fb.FAC_BUILDING_KEY = fba.BUILDING_KEY
JOIN 
    FAC_FLOOR ff ON fb.FAC_BUILDING_KEY = ff.BUILDING_KEY
JOIN 
    FAC_ROOMS fr ON ff.FLOOR_KEY = fr.FLOOR_KEY
GROUP BY 
    b.BUILDING_NAME, fb.BUILDING_HEIGHT, b.BUILDING_STREET_ADDRESS, fba.CITY, fba.STATE, fba.POSTAL_CODE, fb.EXT_GROSS_AREA, fb.ASSIGNABLE_AREA;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2539, 245
TOTAL                  : 106676, 98814, 7862
AVG                    : 2480.84, 2298.00, 182.84
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: CIP
[
(PROGRAM_CODE:VARCHAR2, Examples: ['010000', '010100', '010101']),
(PROGRAM_TITLE:VARCHAR2, Examples: ['Agriculture, General', 'Agricultural Business and Management', 'Agricultural Business and Management, General']),
(CATEGORY_CODE:VARCHAR2, Examples: ['1', '2', '3']),
(CATEGORY_TITLE:VARCHAR2, Examples: ['AGRICULTURAL/ANIMAL/PLANT/VETERINARY SCIENCE AND RELATED FIELDS', 'AGRICULTURAL BUSINESS AND PRODUCTION', 'AGRICULTURE, AGRICULTURE OPERATIONS, AND RELATED SCIENCES']),
(FOUR_DIGIT_CODE:VARCHAR2, Examples: ['0100', '0101', '0102']),
(FOUR_DIGIT_TITLE:VARCHAR2, Examples: ['Agriculture, General', 'Agricultural Business and Management', 'Agricultural Mechanization']),
(NOTE:VARCHAR2, Examples: ['(2020) No substantive changes ', '(2020) No substantive changes- CIP text change ', 'New in 2020']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['17-MAY-23', '11-JUN-14']),
(VERSION:VARCHAR2, Examples: ['2020', '1990', '2010'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the category title, version, department name, school name, total number of courses for each course level, and the total number of degree-granting courses for each CIP category code?

(Hints: Schema Mapping Hints:
- 'category title' is related to CIP.CATEGORY_TITLE
- 'version' is related to CIP.VERSION
- 'department name' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'degree-granting courses' is related to SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING
- 'CIP category code' is related to CIP.CATEGORY_CODE

Join Information: (SIS_COURSE_DESCRIPTION.CIP_PROGRAM_CODE = CIP.PROGRAM_CODE), (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUfktiQekuFmyk2QceAtgBIEfmC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    CIP.CATEGORY_TITLE, \n    CIP.VERSION, \n    SIS_DEPARTMENT.DEPARTMENT_NAME, \n    SIS_DEPARTMENT.SCHOOL_NAME, \n    SIS_COURSE_DESCRIPTION.COURSE_LEVEL, \n    COUNT(SIS_COURSE_DESCRIPTION.COURSE) AS total_courses, \n    SUM(CASE WHEN SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING = 'Y' THEN 1 ELSE 0 END) AS total_degree_granting_courses\nFROM \n    CIP \nJOIN \n    SIS_COURSE_DESCRIPTION ON CIP.PROGRAM_CODE = SIS_COURSE_DESCRIPTION.CIP_PROGRAM_CODE \nJOIN \n    SIS_DEPARTMENT ON SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE\nGROUP BY \n    CIP.CATEGORY_TITLE, \n    CIP.VERSION, \n    SIS_DEPARTMENT.DEPARTMENT_NAME, \n    SIS_DEPARTMENT.SCHOOL_NAME, \n    SIS_COURSE_DESCRIPTION.COURSE_LEVEL\nORDER BY \n    CIP.CATEGORY_TITLE, \n    SIS_DEPARTMENT.DEPARTMENT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179845, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=225, prompt_tokens=1538, total_tokens=1763, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=225, prompt_tokens=1538, total_tokens=1763, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    CIP.CATEGORY_TITLE, 
    CIP.VERSION, 
    SIS_DEPARTMENT.DEPARTMENT_NAME, 
    SIS_DEPARTMENT.SCHOOL_NAME, 
    SIS_COURSE_DESCRIPTION.COURSE_LEVEL, 
    COUNT(SIS_COURSE_DESCRIPTION.COURSE) AS total_courses, 
    SUM(CASE WHEN SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING = 'Y' THEN 1 ELSE 0 END) AS total_degree_granting_courses
FROM 
    CIP 
JOIN 
    SIS_COURSE_DESCRIPTION ON CIP.PROGRAM_CODE = SIS_COURSE_DESCRIPTION.CIP_PROGRAM_CODE 
JOIN 
    SIS_DEPARTMENT ON SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE
GROUP BY 
    CIP.CATEGORY_TITLE, 
    CIP.VERSION, 
    SIS_DEPARTMENT.DEPARTMENT_NAME, 
    SIS_DEPARTMENT.SCHOOL_NAME, 
    SIS_COURSE_DESCRIPTION.COURSE_LEVEL
ORDER BY 
    CIP.CATEGORY_TITLE, 
    SIS_DEPARTMENT.DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1538, 225
TOTAL                  : 108439, 100352, 8087
AVG                    : 2464.52, 2280.73, 183.80
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]

### Question ###
What is the total number of library materials, the minimum and maximum publication years, and the total number of materials status for each course name?

(Hints: Schema Mapping Hints:
- 'library materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_SYSTEM_NUMBER
- 'publication years' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'materials status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'course name' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUjyAkZifnXyUAkQc72V74EU5VE', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    LCI.COURSE_NAME,\n    COUNT(LRCD.CATALOG_SYSTEM_NUMBER) AS total_materials,\n    MIN(LRCD.CATALOG_YEAR) AS min_publication_year,\n    MAX(LRCD.CATALOG_YEAR) AS max_publication_year,\n    COUNT(DISTINCT LMS.LIBRARY_MATERIAL_STATUS) AS total_material_status\nFROM \n    LIBRARY_COURSE_INSTRUCTOR LCI\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG LRCD ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRCD.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_MATERIAL_STATUS LMS ON LRMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY\nGROUP BY \n    LCI.COURSE_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179849, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=202, prompt_tokens=1397, total_tokens=1599, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=202, prompt_tokens=1397, total_tokens=1599, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    LCI.COURSE_NAME,
    COUNT(LRCD.CATALOG_SYSTEM_NUMBER) AS total_materials,
    MIN(LRCD.CATALOG_YEAR) AS min_publication_year,
    MAX(LRCD.CATALOG_YEAR) AS max_publication_year,
    COUNT(DISTINCT LMS.LIBRARY_MATERIAL_STATUS) AS total_material_status
FROM 
    LIBRARY_COURSE_INSTRUCTOR LCI
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG LRCD ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRCD.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_MATERIAL_STATUS LMS ON LRMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY
GROUP BY 
    LCI.COURSE_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1397, 202
TOTAL                  : 110038, 101749, 8289
AVG                    : 2445.29, 2261.09, 184.20
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the total number of library reserve materials, the minimum and maximum publication years, and the total number of enrolled students for each course instructor?

(Hints: Schema Mapping Hints:
- 'library reserve materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_SYSTEM_NUMBER
- 'publication years' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'course instructor' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUoMfRnoEAdGoGl3WHTeGYPgFaN', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    LCI.INSTRUCTOR_NAME,\n    COUNT(DISTINCT LRC.CATALOG_SYSTEM_NUMBER) AS TOTAL_LIBRARY_RESERVE_MATERIALS,\n    MIN(LRC.CATALOG_YEAR) AS MIN_PUBLICATION_YEAR,\n    MAX(LRC.CATALOG_YEAR) AS MAX_PUBLICATION_YEAR,\n    SUM(LSO.NUM_ENROLLED_STUDENTS) AS TOTAL_ENROLLED_STUDENTS\nFROM \n    LIBRARY_COURSE_INSTRUCTOR LCI\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_SUBJECT_OFFERED LSO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY\nGROUP BY \n    LCI.INSTRUCTOR_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179854, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=216, prompt_tokens=1860, total_tokens=2076, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=216, prompt_tokens=1860, total_tokens=2076, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    LCI.INSTRUCTOR_NAME,
    COUNT(DISTINCT LRC.CATALOG_SYSTEM_NUMBER) AS TOTAL_LIBRARY_RESERVE_MATERIALS,
    MIN(LRC.CATALOG_YEAR) AS MIN_PUBLICATION_YEAR,
    MAX(LRC.CATALOG_YEAR) AS MAX_PUBLICATION_YEAR,
    SUM(LSO.NUM_ENROLLED_STUDENTS) AS TOTAL_ENROLLED_STUDENTS
FROM 
    LIBRARY_COURSE_INSTRUCTOR LCI
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_SUBJECT_OFFERED LSO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY
GROUP BY 
    LCI.INSTRUCTOR_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1860, 216
TOTAL                  : 112114, 103609, 8505
AVG                    : 2437.26, 2252.37, 184.89
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
What is the material status, term description, total number of courses and materials, occurences in departments and school, and the total number of instructors for each library material status code and term code?

(Hints: Schema Mapping Hints:
- 'material status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'term description' is related to ACADEMIC_TERMS_ALL.TERM_DESCRIPTION
- 'courses' is related to LIBRARY_SUBJECT_OFFERED.COURSE_NUMBER
- 'materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_SYSTEM_NUMBER
- 'departments' is related to LIBRARY_SUBJECT_OFFERED.OFFER_DEPT_CODE
- 'school' is related to LIBRARY_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'instructors' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'library material status code' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_CODE
- 'term code' is related to LIBRARY_SUBJECT_OFFERED.TERM_CODE

Join Information: (LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (ACADEMIC_TERMS_ALL.TERM_CODE = LIBRARY_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUtDAEpUQqCu0K1EFJZOFjGTfZY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    LMS.LIBRARY_MATERIAL_STATUS,\n    ATA.TERM_DESCRIPTION,\n    COUNT(DISTINCT LSO.COURSE_NUMBER) AS total_courses,\n    COUNT(DISTINCT LRC.CATALOG_SYSTEM_NUMBER) AS total_materials,\n    COUNT(DISTINCT LSO.OFFER_DEPT_CODE) AS occurrences_in_departments,\n    COUNT(DISTINCT LSO.OFFER_SCHOOL_NAME) AS occurrences_in_schools,\n    COUNT(DISTINCT LCI.INSTRUCTOR_NAME) AS total_instructors\nFROM \n    LIBRARY_MATERIAL_STATUS LMS\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LMS.LIBRARY_MATERIAL_STATUS_KEY = LRMD.LIBRARY_MATERIAL_STATUS_KEY\nJOIN \n    LIBRARY_SUBJECT_OFFERED LSO ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRMD.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG LRC ON LRC.LIBRARY_RESERVE_CATALOG_KEY = LRMD.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    ACADEMIC_TERMS_ALL ATA ON ATA.TERM_CODE = LSO.TERM_CODE\nJOIN \n    LIBRARY_COURSE_INSTRUCTOR LCI ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY\nGROUP BY \n    LMS.LIBRARY_MATERIAL_STATUS,\n    ATA.TERM_DESCRIPTION;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179859, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=300, prompt_tokens=2719, total_tokens=3019, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=300, prompt_tokens=2719, total_tokens=3019, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    LMS.LIBRARY_MATERIAL_STATUS,
    ATA.TERM_DESCRIPTION,
    COUNT(DISTINCT LSO.COURSE_NUMBER) AS total_courses,
    COUNT(DISTINCT LRC.CATALOG_SYSTEM_NUMBER) AS total_materials,
    COUNT(DISTINCT LSO.OFFER_DEPT_CODE) AS occurrences_in_departments,
    COUNT(DISTINCT LSO.OFFER_SCHOOL_NAME) AS occurrences_in_schools,
    COUNT(DISTINCT LCI.INSTRUCTOR_NAME) AS total_instructors
FROM 
    LIBRARY_MATERIAL_STATUS LMS
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LMS.LIBRARY_MATERIAL_STATUS_KEY = LRMD.LIBRARY_MATERIAL_STATUS_KEY
JOIN 
    LIBRARY_SUBJECT_OFFERED LSO ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRMD.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG LRC ON LRC.LIBRARY_RESERVE_CATALOG_KEY = LRMD.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    ACADEMIC_TERMS_ALL ATA ON ATA.TERM_CODE = LSO.TERM_CODE
JOIN 
    LIBRARY_COURSE_INSTRUCTOR LCI ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
GROUP BY 
    LMS.LIBRARY_MATERIAL_STATUS,
    ATA.TERM_DESCRIPTION;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2719, 300
TOTAL                  : 115133, 106328, 8805
AVG                    : 2449.64, 2262.30, 187.34
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_FLOOR
[
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR:VARCHAR2, Examples: ['0', '00', '000']),
(FLOOR_NAME:VARCHAR2, Examples: ['0 Floor', '00 Floor', '000 Floor']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_USAGE
[
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(SPACE_USAGE:VARCHAR2, Examples: ['ARC ROOM', 'TST ROOM', 'RSRC RM']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For building 36, list all space units, their floor and building name, building street address, their space usage, and the number of organizations and space units on the same building and floor.

(Hints: Schema Mapping Hints:
- 'building 36' is related to BUILDINGS.BUILDING_NUMBER
- 'space units' is related to SPACE_UNIT.SPACE_UNIT
- 'floor' is related to SPACE_FLOOR.FLOOR
- 'building name' is related to BUILDINGS.BUILDING_NAME
- 'building street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FCLT_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'space usage' is related to SPACE_USAGE.SPACE_USAGE
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY

Join Information: (SPACE_DETAIL.SPACE_UNIT_KEY = SPACE_UNIT.SPACE_UNIT_KEY), (SPACE_USAGE.SPACE_USAGE_KEY = SPACE_DETAIL.SPACE_USAGE_KEY), (SPACE_DETAIL.FLOOR_KEY = SPACE_FLOOR.FLOOR_KEY), (SPACE_DETAIL.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = SPACE_UNIT.FCLT_ORGANIZATION_KEY), (BUILDINGS.BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoUzDAlGRGmeHqcHnhsw6csEaJsH', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    SU.SPACE_UNIT,\n    SF.FLOOR,\n    B.BUILDING_NAME,\n    B.BUILDING_STREET_ADDRESS,\n    U.SPACE_USAGE,\n    COUNT(DISTINCT O.FCLT_ORGANIZATION_KEY) AS organization_count,\n    COUNT(DISTINCT SU.SPACE_UNIT_KEY) AS space_unit_count\nFROM \n    BUILDINGS B\nJOIN \n    SPACE_DETAIL SD ON B.BUILDING_KEY = SD.BUILDING_KEY\nJOIN \n    SPACE_UNIT SU ON SD.SPACE_UNIT_KEY = SU.SPACE_UNIT_KEY\nJOIN \n    SPACE_FLOOR SF ON SD.FLOOR_KEY = SF.FLOOR_KEY\nJOIN \n    SPACE_USAGE U ON SD.SPACE_USAGE_KEY = U.SPACE_USAGE_KEY\nJOIN \n    FCLT_ORGANIZATION O ON SU.FCLT_ORGANIZATION_KEY = O.FCLT_ORGANIZATION_KEY\nWHERE \n    B.BUILDING_NUMBER = '36'\nGROUP BY \n    SU.SPACE_UNIT, SF.FLOOR, B.BUILDING_NAME, B.BUILDING_STREET_ADDRESS, U.SPACE_USAGE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179865, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=233, prompt_tokens=1922, total_tokens=2155, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=233, prompt_tokens=1922, total_tokens=2155, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    SU.SPACE_UNIT,
    SF.FLOOR,
    B.BUILDING_NAME,
    B.BUILDING_STREET_ADDRESS,
    U.SPACE_USAGE,
    COUNT(DISTINCT O.FCLT_ORGANIZATION_KEY) AS organization_count,
    COUNT(DISTINCT SU.SPACE_UNIT_KEY) AS space_unit_count
FROM 
    BUILDINGS B
JOIN 
    SPACE_DETAIL SD ON B.BUILDING_KEY = SD.BUILDING_KEY
JOIN 
    SPACE_UNIT SU ON SD.SPACE_UNIT_KEY = SU.SPACE_UNIT_KEY
JOIN 
    SPACE_FLOOR SF ON SD.FLOOR_KEY = SF.FLOOR_KEY
JOIN 
    SPACE_USAGE U ON SD.SPACE_USAGE_KEY = U.SPACE_USAGE_KEY
JOIN 
    FCLT_ORGANIZATION O ON SU.FCLT_ORGANIZATION_KEY = O.FCLT_ORGANIZATION_KEY
WHERE 
    B.BUILDING_NUMBER = '36'
GROUP BY 
    SU.SPACE_UNIT, SF.FLOOR, B.BUILDING_NAME, B.BUILDING_STREET_ADDRESS, U.SPACE_USAGE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1922, 233
TOTAL                  : 117288, 108250, 9038
AVG                    : 2443.50, 2255.21, 188.29
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each distinct mailing list containing more than 1000 people and with a name starting with A (case insensitive), provide its name, whether it is a mailing list, whether it is a moira group, whether it is a NFS group, the owner of the mailing list, and the number of people in the list.

(Hints: Schema Mapping Hints:
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'mailing list' is related to MOIRA_LIST.IS_MOIRA_MAILING_LIST
- 'moira group' is related to MOIRA_LIST.IS_MOIRA_GROUP
- 'NFS group' is related to MOIRA_LIST.IS_NFS_GROUP
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'people' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoV3TU8wDZWerLtz2IAHIGLgYpDb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    ml.IS_MOIRA_MAILING_LIST, \n    ml.IS_MOIRA_GROUP, \n    ml.IS_NFS_GROUP, \n    mo.OWNER, \n    COUNT(dl.MOIRA_LIST_MEMBER) AS member_count\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL dl ON ml.MOIRA_LIST_KEY = dl.MOIRA_LIST_KEY\nJOIN \n    MOIRA_LIST_OWNER mo ON dl.MOIRA_LIST_OWNER_KEY = mo.MOIRA_LIST_OWNER_KEY\nWHERE \n    LOWER(ml.MOIRA_LIST_NAME) LIKE 'a%' \nGROUP BY \n    ml.MOIRA_LIST_NAME, ml.IS_MOIRA_MAILING_LIST, ml.IS_MOIRA_GROUP, ml.IS_NFS_GROUP, mo.OWNER\nHAVING \n    COUNT(dl.MOIRA_LIST_MEMBER) > 1000;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179869, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=189, prompt_tokens=889, total_tokens=1078, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=189, prompt_tokens=889, total_tokens=1078, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    ml.IS_MOIRA_MAILING_LIST, 
    ml.IS_MOIRA_GROUP, 
    ml.IS_NFS_GROUP, 
    mo.OWNER, 
    COUNT(dl.MOIRA_LIST_MEMBER) AS member_count
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL dl ON ml.MOIRA_LIST_KEY = dl.MOIRA_LIST_KEY
JOIN 
    MOIRA_LIST_OWNER mo ON dl.MOIRA_LIST_OWNER_KEY = mo.MOIRA_LIST_OWNER_KEY
WHERE 
    LOWER(ml.MOIRA_LIST_NAME) LIKE 'a%' 
GROUP BY 
    ml.MOIRA_LIST_NAME, ml.IS_MOIRA_MAILING_LIST, ml.IS_MOIRA_GROUP, ml.IS_NFS_GROUP, mo.OWNER
HAVING 
    COUNT(dl.MOIRA_LIST_MEMBER) > 1000;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 889, 189
TOTAL                  : 118366, 109139, 9227
AVG                    : 2415.63, 2227.33, 188.31
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the mailing lists with the largest number of members and the least number of members, including their names, owners, public status, hidden status, and number of members in the list. If a mailing list has multiple owners, create a separate entry for each owner. Similarly, if multiple lists share the minimum or maximum member count, include all those lists.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'owners' is related to MOIRA_LIST_OWNER.OWNER
- 'public status' is related to MOIRA_LIST.IS_PUBLIC
- 'hidden status' is related to MOIRA_LIST.IS_HIDDEN
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoV7tqSIjKorGV1QOBblvAUkfqOY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH MemberCounts AS (\n    SELECT\n        ml.MOIRA_LIST_NAME,\n        mld.MOIRA_LIST_MEMBER,\n        mol.OWNER,\n        ml.IS_PUBLIC,\n        ml.IS_HIDDEN,\n        COUNT(mld.MOIRA_LIST_MEMBER) OVER (PARTITION BY ml.MOIRA_LIST_KEY) AS member_count\n    FROM\n        MOIRA_LIST ml\n    JOIN\n        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\n    JOIN\n        MOIRA_LIST_OWNER mol ON mld.MOIRA_LIST_OWNER_KEY = mol.MOIRA_LIST_OWNER_KEY\n    WHERE\n        ml.IS_MOIRA_MAILING_LIST = 'Y'\n)\nSELECT\n    MOIRA_LIST_NAME,\n    OWNER,\n    IS_PUBLIC,\n    IS_HIDDEN,\n    member_count\nFROM\n    MemberCounts\nWHERE\n    member_count = (SELECT MAX(member_count) FROM MemberCounts)\n    OR member_count = (SELECT MIN(member_count) FROM MemberCounts);\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179873, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=211, prompt_tokens=868, total_tokens=1079, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=211, prompt_tokens=868, total_tokens=1079, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH MemberCounts AS (
    SELECT
        ml.MOIRA_LIST_NAME,
        mld.MOIRA_LIST_MEMBER,
        mol.OWNER,
        ml.IS_PUBLIC,
        ml.IS_HIDDEN,
        COUNT(mld.MOIRA_LIST_MEMBER) OVER (PARTITION BY ml.MOIRA_LIST_KEY) AS member_count
    FROM
        MOIRA_LIST ml
    JOIN
        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
    JOIN
        MOIRA_LIST_OWNER mol ON mld.MOIRA_LIST_OWNER_KEY = mol.MOIRA_LIST_OWNER_KEY
    WHERE
        ml.IS_MOIRA_MAILING_LIST = 'Y'
)
SELECT
    MOIRA_LIST_NAME,
    OWNER,
    IS_PUBLIC,
    IS_HIDDEN,
    member_count
FROM
    MemberCounts
WHERE
    member_count = (SELECT MAX(member_count) FROM MemberCounts)
    OR member_count = (SELECT MIN(member_count) FROM MemberCounts);

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 868, 211
TOTAL                  : 119445, 110007, 9438
AVG                    : 2388.90, 2200.14, 188.76
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For email lists with names starting with C (case insensitive) and containing faculty who teach courses in the summer in financial aid years after 2001, provide the name of the list, the number of people in the list, and the number of faculty in the list.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'faculty' is related to EMPLOYEE_DIRECTORY.MIT_ID
- 'courses in the summer' is related to ACADEMIC_TERMS.TERM_CODE
- 'financial aid years' is related to ACADEMIC_TERMS.FINANCIAL_AID_YEAR
- 'people' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (EMPLOYEE_DIRECTORY.MIT_ID = COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID), (ACADEMIC_TERMS.TERM_CODE = COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVCCEzhP853TTzGYWSmMQc3qjic', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS total_people, \n    COUNT(DISTINCT ed.MIT_ID) AS total_faculty\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    EMPLOYEE_DIRECTORY ed ON mld.MOIRA_LIST_MEMBER_MIT_ID = ed.MIT_ID\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED cc ON ed.MIT_ID = cc.RESPONSIBLE_FACULTY_MIT_ID\nJOIN \n    ACADEMIC_TERMS at ON cc.TERM_CODE = at.TERM_CODE\nWHERE \n    ml.MOIRA_LIST_NAME ILIKE 'C%' \n    AND at.FINANCIAL_AID_YEAR > '2001' \n    AND at.IS_OFFERED_SUMMER_TERM = 'Y'\nGROUP BY \n    ml.MOIRA_LIST_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179878, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=212, prompt_tokens=3943, total_tokens=4155, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3072)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=212, prompt_tokens=3943, total_tokens=4155, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3072))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS total_people, 
    COUNT(DISTINCT ed.MIT_ID) AS total_faculty
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    EMPLOYEE_DIRECTORY ed ON mld.MOIRA_LIST_MEMBER_MIT_ID = ed.MIT_ID
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED cc ON ed.MIT_ID = cc.RESPONSIBLE_FACULTY_MIT_ID
JOIN 
    ACADEMIC_TERMS at ON cc.TERM_CODE = at.TERM_CODE
WHERE 
    ml.MOIRA_LIST_NAME ILIKE 'C%' 
    AND at.FINANCIAL_AID_YEAR > '2001' 
    AND at.IS_OFFERED_SUMMER_TERM = 'Y'
GROUP BY 
    ml.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3943, 212
TOTAL                  : 123600, 113950, 9650
AVG                    : 2423.53, 2234.31, 189.22
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Regarding the mailing list about duo users, provide the number of students in this list, and the number of departments and schools associated with these students.

(Hints: Schema Mapping Hints:
- 'duo users' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'students' is related to SE_PERSON.MIT_ID
- 'departments' is related to SIS_DEPARTMENT.DEPARTMENT_CODE
- 'schools' is related to SIS_DEPARTMENT.SCHOOL_CODE

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVHpwrufLxipa9UBg3xYqBNaMM9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    COUNT(DISTINCT md.MOIRA_LIST_MEMBER_MIT_ID) AS student_count,\n    COUNT(DISTINCT sd.DEPARTMENT_CODE) AS department_count,\n    COUNT(DISTINCT sd.SCHOOL_CODE) AS school_count\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL md ON ml.MOIRA_LIST_KEY = md.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON sp ON md.MOIRA_LIST_MEMBER_MIT_ID = sp.MIT_ID\nJOIN \n    MIT_STUDENT_DIRECTORY msd ON sp.MIT_ID = msd.EMAIL_ADDRESS\nJOIN \n    SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE\nWHERE \n    ml.MOIRA_LIST_NAME = 'cat-duo-users'\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179883, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=166, prompt_tokens=1623, total_tokens=1789, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=166, prompt_tokens=1623, total_tokens=1789, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    COUNT(DISTINCT md.MOIRA_LIST_MEMBER_MIT_ID) AS student_count,
    COUNT(DISTINCT sd.DEPARTMENT_CODE) AS department_count,
    COUNT(DISTINCT sd.SCHOOL_CODE) AS school_count
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL md ON ml.MOIRA_LIST_KEY = md.MOIRA_LIST_KEY
JOIN 
    SE_PERSON sp ON md.MOIRA_LIST_MEMBER_MIT_ID = sp.MIT_ID
JOIN 
    MIT_STUDENT_DIRECTORY msd ON sp.MIT_ID = msd.EMAIL_ADDRESS
JOIN 
    SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE
WHERE 
    ml.MOIRA_LIST_NAME = 'cat-duo-users'

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1623, 166
TOTAL                  : 125389, 115573, 9816
AVG                    : 2411.33, 2222.56, 188.77
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For faculty who are responsible for courses in 2023 fall term, list the name of mailing lists with ten members that they subscribe to, the number of faculty in these lists, and the number of courses associated with those faculty.

(Hints: Schema Mapping Hints:
- 'faculty' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID
- '2023 fall term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'name of mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE

Join Information: (employee_directory.MIT_ID = COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID), (employee_directory.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVKAri1vkzyyNYdSRjQGg7btzJ7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME,\n    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER_MIT_ID) AS number_of_faculty,\n    COUNT(DISTINCT c.SUBJECT_TITLE) AS number_of_courses\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN \n    EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID\nJOIN \n    MOIRA_LIST_DETAIL mld ON e.KRB_NAME = mld.MOIRA_LIST_MEMBER\nJOIN \n    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY\nWHERE \n    c.TERM_CODE = '2023FA' \nGROUP BY \n    ml.MOIRA_LIST_NAME\nHAVING \n    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) = 10;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179886, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=181, prompt_tokens=3276, total_tokens=3457, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=181, prompt_tokens=3276, total_tokens=3457, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME,
    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER_MIT_ID) AS number_of_faculty,
    COUNT(DISTINCT c.SUBJECT_TITLE) AS number_of_courses
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED c
JOIN 
    EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID
JOIN 
    MOIRA_LIST_DETAIL mld ON e.KRB_NAME = mld.MOIRA_LIST_MEMBER
JOIN 
    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY
WHERE 
    c.TERM_CODE = '2023FA' 
GROUP BY 
    ml.MOIRA_LIST_NAME
HAVING 
    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) = 10;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3276, 181
TOTAL                  : 128846, 118849, 9997
AVG                    : 2431.06, 2242.43, 188.62
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For each course instructor in the 'keeper-zephyr' mailing list, provide the name of mailing lists they subscribe to, instructor name, earliest and latest publication years, and total number of enrolled students.

(Hints: Schema Mapping Hints:
- ''keeper-zephyr' mailing list' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'name of mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'instructor name' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'publication years' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME = SE_PERSON.FULL_NAME))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVOnws5rVRZzpdEbx5vAO8BD28y', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    lci.INSTRUCTOR_NAME, \n    MIN(lrc.CATALOG_YEAR) AS Earliest_Publication_Year, \n    MAX(lrc.CATALOG_YEAR) AS Latest_Publication_Year, \n    lso.NUM_ENROLLED_STUDENTS\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME\nJOIN \n    LIBRARY_COURSE_INSTRUCTOR lci ON sp.FULL_NAME = lci.INSTRUCTOR_NAME\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL lrcd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrcd.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG lrc ON lrcd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_SUBJECT_OFFERED lso ON lrcd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY\nWHERE \n    ml.MOIRA_LIST_NAME = 'keeper-zephyr'\nGROUP BY \n    ml.MOIRA_LIST_NAME, lci.INSTRUCTOR_NAME, lso.NUM_ENROLLED_STUDENTS;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179890, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=299, prompt_tokens=2571, total_tokens=2870, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=299, prompt_tokens=2571, total_tokens=2870, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    lci.INSTRUCTOR_NAME, 
    MIN(lrc.CATALOG_YEAR) AS Earliest_Publication_Year, 
    MAX(lrc.CATALOG_YEAR) AS Latest_Publication_Year, 
    lso.NUM_ENROLLED_STUDENTS
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME
JOIN 
    LIBRARY_COURSE_INSTRUCTOR lci ON sp.FULL_NAME = lci.INSTRUCTOR_NAME
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL lrcd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrcd.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG lrc ON lrcd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_SUBJECT_OFFERED lso ON lrcd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY
WHERE 
    ml.MOIRA_LIST_NAME = 'keeper-zephyr'
GROUP BY 
    ml.MOIRA_LIST_NAME, lci.INSTRUCTOR_NAME, lso.NUM_ENROLLED_STUDENTS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2571, 299
TOTAL                  : 131716, 121420, 10296
AVG                    : 2439.19, 2248.52, 190.67
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For each mailing list with a name beginning with R (case insensitive), and that Professor Ayden Hopkins is subscribed to, list its name, description, owner, number of people in the list, and number of tenured faculty in the list.

(Hints: Schema Mapping Hints:
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'Professor Ayden Hopkins' is related to SE_PERSON.FULL_NAME
- 'description' is related to MOIRA_LIST.MOIRA_LIST_DESCRIPTION
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'people' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'tenured faculty' is related to SE_PERSON.PAYROLL_RANK, MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVV9oVmgArRui4P7xFwyoajOj14', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    ml.MOIRA_LIST_DESCRIPTION, \n    mo.OWNER,\n    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS number_of_people,\n    COUNT(CASE WHEN sp.PAYROLL_RANK LIKE '%tenured%' THEN 1 END) AS number_of_tenured_faculty\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    MOIRA_LIST_OWNER mo ON mo.MOIRA_LIST_OWNER_KEY = mld.MOIRA_LIST_OWNER_KEY\nJOIN \n    SE_PERSON sp ON sp.MIT_ID = mld.MOIRA_LIST_MEMBER_MIT_ID\nWHERE \n    ml.IS_MOIRA_MAILING_LIST = 'Y' \n    AND LOWER(ml.MOIRA_LIST_NAME) LIKE 'r%' \n    AND mld.MOIRA_LIST_MEMBER_FULL_NAME = 'Hopkins, Ayden' \nGROUP BY \n    ml.MOIRA_LIST_NAME, ml.MOIRA_LIST_DESCRIPTION, mo.OWNER;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179897, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=233, prompt_tokens=1136, total_tokens=1369, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=233, prompt_tokens=1136, total_tokens=1369, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    ml.MOIRA_LIST_DESCRIPTION, 
    mo.OWNER,
    COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS number_of_people,
    COUNT(CASE WHEN sp.PAYROLL_RANK LIKE '%tenured%' THEN 1 END) AS number_of_tenured_faculty
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    MOIRA_LIST_OWNER mo ON mo.MOIRA_LIST_OWNER_KEY = mld.MOIRA_LIST_OWNER_KEY
JOIN 
    SE_PERSON sp ON sp.MIT_ID = mld.MOIRA_LIST_MEMBER_MIT_ID
WHERE 
    ml.IS_MOIRA_MAILING_LIST = 'Y' 
    AND LOWER(ml.MOIRA_LIST_NAME) LIKE 'r%' 
    AND mld.MOIRA_LIST_MEMBER_FULL_NAME = 'Hopkins, Ayden' 
GROUP BY 
    ml.MOIRA_LIST_NAME, ml.MOIRA_LIST_DESCRIPTION, mo.OWNER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1136, 233
TOTAL                  : 133085, 122556, 10529
AVG                    : 2419.73, 2228.29, 191.44
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the email list with name 'date-destiny', list the name of the list, department name, the number of students from the Management department, and the percentage of students who are from the Management department, rounded to two decimal places.

(Hints: Schema Mapping Hints:
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'students' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'Management department' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME

Join Information: (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (SE_PERSON.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVcAdxHUQNzbhhPuUCColESeosn', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    sad.SIS_ADMIN_DEPARTMENT_NAME, \n    COUNT(CASE WHEN sd.DEPARTMENT_NAME = 'Management' THEN 1 END) AS num_management_students,\n    ROUND(COUNT(CASE WHEN sd.DEPARTMENT_NAME = 'Management' THEN 1 END) * 100.0 / COUNT(*), 2) AS percentage_management_students\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME\nJOIN \n    MIT_STUDENT_DIRECTORY sd ON sp.FULL_NAME = sd.FULL_NAME\nJOIN \n    SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT = sad.SIS_ADMIN_DEPARTMENT_CODE\nWHERE \n    ml.MOIRA_LIST_NAME = 'date-destiny'\nGROUP BY \n    ml.MOIRA_LIST_NAME, sad.SIS_ADMIN_DEPARTMENT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179904, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=219, prompt_tokens=1470, total_tokens=1689, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=219, prompt_tokens=1470, total_tokens=1689, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    sad.SIS_ADMIN_DEPARTMENT_NAME, 
    COUNT(CASE WHEN sd.DEPARTMENT_NAME = 'Management' THEN 1 END) AS num_management_students,
    ROUND(COUNT(CASE WHEN sd.DEPARTMENT_NAME = 'Management' THEN 1 END) * 100.0 / COUNT(*), 2) AS percentage_management_students
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME
JOIN 
    MIT_STUDENT_DIRECTORY sd ON sp.FULL_NAME = sd.FULL_NAME
JOIN 
    SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT = sad.SIS_ADMIN_DEPARTMENT_CODE
WHERE 
    ml.MOIRA_LIST_NAME = 'date-destiny'
GROUP BY 
    ml.MOIRA_LIST_NAME, sad.SIS_ADMIN_DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1470, 219
TOTAL                  : 134774, 124026, 10748
AVG                    : 2406.68, 2214.75, 191.93
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the building with the most floors, list the building name and the names of the mailing lists staring with a (case insensitive) that the building employees with kerberos starting with c (case insensitive) subscribe to.

(Hints: Schema Mapping Hints:
- 'floors' is related to FAC_FLOOR.LEVEL_ID
- 'building name' is related to FAC_BUILDING.BUILDING_NAME
- 'names of the mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'kerberos' is related to EMPLOYEE_DIRECTORY.KRB_NAME

Join Information: (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY), (FAC_ROOMS.FAC_ROOM_KEY = EMPLOYEE_DIRECTORY.OFFICE_LOCATION), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = EMPLOYEE_DIRECTORY.KRB_NAME), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVhljWbETkCyNolqyHMEnynYhWf', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    fb.BUILDING_NAME, \n    ml.MOIRA_LIST_NAME\nFROM \n    FAC_BUILDING fb\nJOIN \n    FAC_FLOOR ff ON fb.FAC_BUILDING_KEY = ff.BUILDING_KEY\nJOIN \n    FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY\nJOIN \n    EMPLOYEE_DIRECTORY ed ON fr.FAC_ROOM_KEY = ed.OFFICE_LOCATION\nJOIN \n    MOIRA_LIST_DETAIL mld ON ed.KRB_NAME = mld.MOIRA_LIST_MEMBER\nJOIN \n    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY\nWHERE \n    fb.FAC_BUILDING_KEY = (SELECT \n                               fb_inner.FAC_BUILDING_KEY\n                           FROM \n                               FAC_BUILDING fb_inner\n                           JOIN \n                               FAC_FLOOR ff_inner ON fb_inner.FAC_BUILDING_KEY = ff_inner.BUILDING_KEY\n                           GROUP BY \n                               fb_inner.FAC_BUILDING_KEY\n                           ORDER BY \n                               COUNT(ff_inner.FLOOR) DESC\n                           LIMIT 1)\n    AND ed.KRB_NAME LIKE 'c%'\nORDER BY \n    fb.BUILDING_NAME, ml.MOIRA_LIST_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179909, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=256, prompt_tokens=2960, total_tokens=3216, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=256, prompt_tokens=2960, total_tokens=3216, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    fb.BUILDING_NAME, 
    ml.MOIRA_LIST_NAME
FROM 
    FAC_BUILDING fb
JOIN 
    FAC_FLOOR ff ON fb.FAC_BUILDING_KEY = ff.BUILDING_KEY
JOIN 
    FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY
JOIN 
    EMPLOYEE_DIRECTORY ed ON fr.FAC_ROOM_KEY = ed.OFFICE_LOCATION
JOIN 
    MOIRA_LIST_DETAIL mld ON ed.KRB_NAME = mld.MOIRA_LIST_MEMBER
JOIN 
    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY
WHERE 
    fb.FAC_BUILDING_KEY = (SELECT 
                               fb_inner.FAC_BUILDING_KEY
                           FROM 
                               FAC_BUILDING fb_inner
                           JOIN 
                               FAC_FLOOR ff_inner ON fb_inner.FAC_BUILDING_KEY = ff_inner.BUILDING_KEY
                           GROUP BY 
                               fb_inner.FAC_BUILDING_KEY
                           ORDER BY 
                               COUNT(ff_inner.FLOOR) DESC
                           LIMIT 1)
    AND ed.KRB_NAME LIKE 'c%'
ORDER BY 
    fb.BUILDING_NAME, ml.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2960, 256
TOTAL                  : 137990, 126986, 11004
AVG                    : 2420.88, 2227.82, 193.05
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the email lists subscribed by faculty members with last names begin with Y, list the names of the lists, the total number of subjects managed by faculty in those mailing lists, and the number of such faculty in the lists.

(Hints: Schema Mapping Hints:
- 'last names' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_NAME
- 'names of the lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'faculty' is related to COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_NAME

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVmn8FGs1B8mEIL5MN8LmeS8C6v', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME,\n    COUNT(DISTINCT c.SUBJECT_ID) AS total_subjects_managed,\n    COUNT(DISTINCT e.MIT_ID) AS total_faculty\nFROM \n    MOIRA_LIST AS ml\nJOIN \n    MOIRA_LIST_DETAIL AS mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    EMPLOYEE_DIRECTORY AS e ON mld.MOIRA_LIST_MEMBER_MIT_ID = e.MIT_ID\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED AS c ON e.FULL_NAME LIKE '%' || substr(c.RESPONSIBLE_FACULTY_NAME, instr(c.RESPONSIBLE_FACULTY_NAME, ',') + 1) || '%'\nWHERE \n    e.LAST_NAME LIKE 'Y%'\nGROUP BY \n    ml.MOIRA_LIST_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179914, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=182, prompt_tokens=3225, total_tokens=3407, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=182, prompt_tokens=3225, total_tokens=3407, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME,
    COUNT(DISTINCT c.SUBJECT_ID) AS total_subjects_managed,
    COUNT(DISTINCT e.MIT_ID) AS total_faculty
FROM 
    MOIRA_LIST AS ml
JOIN 
    MOIRA_LIST_DETAIL AS mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    EMPLOYEE_DIRECTORY AS e ON mld.MOIRA_LIST_MEMBER_MIT_ID = e.MIT_ID
JOIN 
    COURSE_CATALOG_SUBJECT_OFFERED AS c ON e.FULL_NAME LIKE '%' || substr(c.RESPONSIBLE_FACULTY_NAME, instr(c.RESPONSIBLE_FACULTY_NAME, ',') + 1) || '%'
WHERE 
    e.LAST_NAME LIKE 'Y%'
GROUP BY 
    ml.MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3225, 182
TOTAL                  : 141397, 130211, 11186
AVG                    : 2437.88, 2245.02, 192.86
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For students with last names starting with H who are subscribed to mailing list 'beacon-date-date', list the names of the students, the phone numbers of departments they belong to, and the size of the mailing list 'beacon-date-date' that they are subscribed to.

(Hints: Schema Mapping Hints:
- 'last names' is related to MIT_STUDENT_DIRECTORY.LAST_NAME
- 'mailing list 'beacon-date-date'' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'names' is related to MIT_STUDENT_DIRECTORY.FULL_NAME
- 'phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'size of the mailing list' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE), (MIT_STUDENT_DIRECTORY.FULL_NAME = SE_PERSON.FULL_NAME), (SE_PERSON.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVqo2TdK9bPt2buGJUNn7eIBXB6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    msd.FULL_NAME, \n    sad.DEPARTMENT_PHONE_NUMBER, \n    (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL mld WHERE mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY) AS LIST_SIZE\nFROM \n    MIT_STUDENT_DIRECTORY msd\nJOIN \n    MOIRA_LIST_DETAIL mld ON msd.FULL_NAME = mld.MOIRA_LIST_MEMBER_FULL_NAME\nJOIN \n    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY\nJOIN \n    SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE\nJOIN \n    SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE\nWHERE \n    msd.LAST_NAME LIKE 'H%' AND \n    ml.MOIRA_LIST_NAME = 'beacon-date-date';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179918, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=189, prompt_tokens=1920, total_tokens=2109, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=189, prompt_tokens=1920, total_tokens=2109, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    msd.FULL_NAME, 
    sad.DEPARTMENT_PHONE_NUMBER, 
    (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL mld WHERE mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY) AS LIST_SIZE
FROM 
    MIT_STUDENT_DIRECTORY msd
JOIN 
    MOIRA_LIST_DETAIL mld ON msd.FULL_NAME = mld.MOIRA_LIST_MEMBER_FULL_NAME
JOIN 
    MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY
JOIN 
    SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE
JOIN 
    SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE
WHERE 
    msd.LAST_NAME LIKE 'H%' AND 
    ml.MOIRA_LIST_NAME = 'beacon-date-date';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1920, 189
TOTAL                  : 143506, 132131, 11375
AVG                    : 2432.31, 2239.51, 192.80
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
Give the count of mailing lists with names starting with B that include members from the Electrical Engineering and Computer Science department, along with the name of the list starting with B that have the highest number of members from that department and the corresponding member count.

(Hints: Schema Mapping Hints:
- 'mailing lists' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'members' is related to SE_PERSON.MIT_ID
- 'Electrical Engineering and Computer Science department' is related to SE_PERSON.ORGANIZATION

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = SE_PERSON.KRB_NAME))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVuliQfl8ReWpbqjNm8W73NK9UV', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH MailingListCounts AS (\n    SELECT \n        ml.MOIRA_LIST_NAME,\n        COUNT(*) AS MemberCount\n    FROM \n        MOIRA_LIST ml\n    JOIN \n        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\n    JOIN \n        SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME\n    WHERE \n        ml.MOIRA_LIST_NAME LIKE 'B%' \n        AND sp.ORGANIZATION = 'Electrical Engineering and Computer Science'\n    GROUP BY \n        ml.MOIRA_LIST_NAME\n),\nMailingListSummary AS (\n    SELECT \n        COUNT(*) AS TotalMailingLists,\n        MAX(MemberCount) AS MaxMemberCount\n    FROM \n        MailingListCounts\n)\nSELECT \n    mlc.TotalMailingLists,\n    mlc.MOIRA_LIST_NAME,\n    mlc.MemberCount\nFROM \n    MailingListCounts mlc\nJOIN \n    MailingListSummary mls ON mlc.MemberCount = mls.MaxMemberCount\nLIMIT 1;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179922, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=221, prompt_tokens=954, total_tokens=1175, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=221, prompt_tokens=954, total_tokens=1175, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH MailingListCounts AS (
    SELECT 
        ml.MOIRA_LIST_NAME,
        COUNT(*) AS MemberCount
    FROM 
        MOIRA_LIST ml
    JOIN 
        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
    JOIN 
        SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME
    WHERE 
        ml.MOIRA_LIST_NAME LIKE 'B%' 
        AND sp.ORGANIZATION = 'Electrical Engineering and Computer Science'
    GROUP BY 
        ml.MOIRA_LIST_NAME
),
MailingListSummary AS (
    SELECT 
        COUNT(*) AS TotalMailingLists,
        MAX(MemberCount) AS MaxMemberCount
    FROM 
        MailingListCounts
)
SELECT 
    mlc.TotalMailingLists,
    mlc.MOIRA_LIST_NAME,
    mlc.MemberCount
FROM 
    MailingListCounts mlc
JOIN 
    MailingListSummary mls ON mlc.MemberCount = mls.MaxMemberCount
LIMIT 1;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 954, 221
TOTAL                  : 144681, 133085, 11596
AVG                    : 2411.35, 2218.08, 193.27
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the 'kangaroo-inspire-yearn' email list, for each department present in the list, list the department name, the number of students in that department, and its percentage relative to the students in the mailing list.

(Hints: Schema Mapping Hints:
- ''kangaroo-inspire-yearn' email list' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'students' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (SE_PERSON.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoVyUDSTyoBIKFJxMCpey6WHLGaF', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    SAD.SIS_ADMIN_DEPARTMENT_NAME, \n    COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER_MIT_ID) AS student_count, \n    ROUND((COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER_MIT_ID) * 100.0 / (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL MLD2 WHERE MLD2.MOIRA_LIST_KEY = 'kangaroo-inspire-yearn')), 2) AS percentage\nFROM \n    MOIRA_LIST ML\nJOIN \n    MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME\nJOIN \n    MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME\nJOIN \n    SIS_ADMIN_DEPARTMENT SAD ON MSD.DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE\nWHERE \n    ML.MOIRA_LIST_NAME = 'kangaroo-inspire-yearn'\nGROUP BY \n    SAD.SIS_ADMIN_DEPARTMENT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179926, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=222, prompt_tokens=1456, total_tokens=1678, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=222, prompt_tokens=1456, total_tokens=1678, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    SAD.SIS_ADMIN_DEPARTMENT_NAME, 
    COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER_MIT_ID) AS student_count, 
    ROUND((COUNT(DISTINCT MLD.MOIRA_LIST_MEMBER_MIT_ID) * 100.0 / (SELECT COUNT(*) FROM MOIRA_LIST_DETAIL MLD2 WHERE MLD2.MOIRA_LIST_KEY = 'kangaroo-inspire-yearn')), 2) AS percentage
FROM 
    MOIRA_LIST ML
JOIN 
    MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
JOIN 
    SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME
JOIN 
    MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME
JOIN 
    SIS_ADMIN_DEPARTMENT SAD ON MSD.DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE
WHERE 
    ML.MOIRA_LIST_NAME = 'kangaroo-inspire-yearn'
GROUP BY 
    SAD.SIS_ADMIN_DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1456, 222
TOTAL                  : 146359, 134541, 11818
AVG                    : 2399.33, 2205.59, 193.74
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Among the mailing lists subscribed by people with physical offices in building 24, provide the name of the most subscribed mailing list and the total number of subscribers.

(Hints: Schema Mapping Hints:
- 'physical offices in building 24' is related to EMPLOYEE_DIRECTORY.OFFICE_LOCATION
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subscribers' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (EMPLOYEE_DIRECTORY.KRB_NAME = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoW4nvAXU14ID4VuIsL8sNejhCmi', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT ml.MOIRA_LIST_NAME, COUNT(md.MOIRA_LIST_MEMBER) AS total_subscribers\nFROM MOIRA_LIST ml\nJOIN MOIRA_LIST_DETAIL md ON ml.MOIRA_LIST_KEY = md.MOIRA_LIST_KEY\nJOIN EMPLOYEE_DIRECTORY ed ON ed.KRB_NAME = md.MOIRA_LIST_MEMBER\nWHERE ed.OFFICE_LOCATION LIKE '24%'\nGROUP BY ml.MOIRA_LIST_NAME\nORDER BY total_subscribers DESC\nLIMIT 1;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179932, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=100, prompt_tokens=1269, total_tokens=1369, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=100, prompt_tokens=1269, total_tokens=1369, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT ml.MOIRA_LIST_NAME, COUNT(md.MOIRA_LIST_MEMBER) AS total_subscribers
FROM MOIRA_LIST ml
JOIN MOIRA_LIST_DETAIL md ON ml.MOIRA_LIST_KEY = md.MOIRA_LIST_KEY
JOIN EMPLOYEE_DIRECTORY ed ON ed.KRB_NAME = md.MOIRA_LIST_MEMBER
WHERE ed.OFFICE_LOCATION LIKE '24%'
GROUP BY ml.MOIRA_LIST_NAME
ORDER BY total_subscribers DESC
LIMIT 1;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1269, 100
TOTAL                  : 147728, 135810, 11918
AVG                    : 2382.71, 2190.48, 192.23
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For email lists subscribed by either support staff or faculty, list its name, the number of subscribers that are support staff, the number of subscribers that are faculty, as well as its active status.

(Hints: Schema Mapping Hints:
- 'support staff or faculty' is related to SE_PERSON.EMPLOYEE_TYPE
- 'name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subscribers' is related to SE_PERSON.EMPLOYEE_TYPE
- 'active status' is related to MOIRA_LIST.IS_ACTIVE

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoW6BGCoYzIresX8J9pqyPGwbXws', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    ml.MOIRA_LIST_NAME, \n    SUM(CASE WHEN sp.EMPLOYEE_TYPE = 'Support Staff' THEN 1 ELSE 0 END) AS support_staff_count,\n    SUM(CASE WHEN sp.EMPLOYEE_TYPE = 'Faculty' THEN 1 ELSE 0 END) AS faculty_count,\n    ml.IS_ACTIVE\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER_MIT_ID = sp.MIT_ID\nWHERE \n    sp.EMPLOYEE_TYPE IN ('Support Staff', 'Faculty')\nGROUP BY \n    ml.MOIRA_LIST_NAME, ml.IS_ACTIVE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179934, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=161, prompt_tokens=924, total_tokens=1085, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=161, prompt_tokens=924, total_tokens=1085, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    ml.MOIRA_LIST_NAME, 
    SUM(CASE WHEN sp.EMPLOYEE_TYPE = 'Support Staff' THEN 1 ELSE 0 END) AS support_staff_count,
    SUM(CASE WHEN sp.EMPLOYEE_TYPE = 'Faculty' THEN 1 ELSE 0 END) AS faculty_count,
    ml.IS_ACTIVE
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN 
    SE_PERSON sp ON mld.MOIRA_LIST_MEMBER_MIT_ID = sp.MIT_ID
WHERE 
    sp.EMPLOYEE_TYPE IN ('Support Staff', 'Faculty')
GROUP BY 
    ml.MOIRA_LIST_NAME, ml.IS_ACTIVE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 924, 161
TOTAL                  : 148813, 136734, 12079
AVG                    : 2362.11, 2170.38, 191.73
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the 'ocean-apple' mailing list, identify the department with the highest student count. Provide the department name, phone number, and the total number of students subscribed to the mailing list from that department. If multiple departments have the same highest count, list each one separately.

(Hints: Schema Mapping Hints:
- ''ocean-apple' mailing list' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'department name' is related to SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_NAME
- 'phone number' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'students' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = SE_PERSON.KRB_NAME), (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoWAHjUDIU1ZsUSnhy3er0UUCYuA', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    SAD.SIS_ADMIN_DEPARTMENT_NAME, \n    SAD.DEPARTMENT_PHONE_NUMBER, \n    COUNT(*) AS student_count\nFROM \n    MOIRA_LIST ML\nJOIN \n    MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY\nJOIN \n    SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME\nJOIN \n    MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME\nJOIN \n    SIS_ADMIN_DEPARTMENT SAD ON MSD.DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE\nWHERE \n    ML.MOIRA_LIST_NAME = 'ocean-apple'\nGROUP BY \n    SAD.SIS_ADMIN_DEPARTMENT_NAME, SAD.DEPARTMENT_PHONE_NUMBER\nHAVING \n    COUNT(*) = (SELECT MAX(student_count)\n                 FROM (SELECT COUNT(*) AS student_count\n                       FROM MOIRA_LIST ML\n                       JOIN MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY\n                       JOIN SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME\n                       JOIN MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME\n                       JOIN SIS_ADMIN_DEPARTMENT SAD ON MSD.DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE\n                       WHERE ML.MOIRA_LIST_NAME = 'ocean-apple'\n                       GROUP BY SAD.SIS_ADMIN_DEPARTMENT_NAME) AS dept_counts);\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179938, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=307, prompt_tokens=1482, total_tokens=1789, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=307, prompt_tokens=1482, total_tokens=1789, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    SAD.SIS_ADMIN_DEPARTMENT_NAME, 
    SAD.DEPARTMENT_PHONE_NUMBER, 
    COUNT(*) AS student_count
FROM 
    MOIRA_LIST ML
JOIN 
    MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
JOIN 
    SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME
JOIN 
    MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME
JOIN 
    SIS_ADMIN_DEPARTMENT SAD ON MSD.DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE
WHERE 
    ML.MOIRA_LIST_NAME = 'ocean-apple'
GROUP BY 
    SAD.SIS_ADMIN_DEPARTMENT_NAME, SAD.DEPARTMENT_PHONE_NUMBER
HAVING 
    COUNT(*) = (SELECT MAX(student_count)
                 FROM (SELECT COUNT(*) AS student_count
                       FROM MOIRA_LIST ML
                       JOIN MOIRA_LIST_DETAIL MLD ON ML.MOIRA_LIST_KEY = MLD.MOIRA_LIST_KEY
                       JOIN SE_PERSON SP ON MLD.MOIRA_LIST_MEMBER = SP.KRB_NAME
                       JOIN MIT_STUDENT_DIRECTORY MSD ON SP.FULL_NAME = MSD.FULL_NAME
                       JOIN SIS_ADMIN_DEPARTMENT SAD ON MSD.DEPARTMENT = SAD.SIS_ADMIN_DEPARTMENT_CODE
                       WHERE ML.MOIRA_LIST_NAME = 'ocean-apple'
                       GROUP BY SAD.SIS_ADMIN_DEPARTMENT_NAME) AS dept_counts);

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1482, 307
TOTAL                  : 150602, 138216, 12386
AVG                    : 2353.16, 2159.62, 193.53
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each mailing list, list its owner, owner type, the member visibility ('Public Members' if public, and 'Hidden Members' otherwise), and the number of members of this type of visibility. For each owner and owner type, include a grand total for all members in the format of (owner, owner type, null, total members).

(Hints: Schema Mapping Hints:
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'owner type' is related to MOIRA_LIST_OWNER.OWNER_TYPE
- 'member visibility' is related to MOIRA_LIST.IS_PUBLIC
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoWGvR5dqJ0JHMzFgvxtrti5ltNd', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    o.OWNER, \n    o.OWNER_TYPE, \n    CASE \n        WHEN ml.IS_PUBLIC = 'Y' THEN 'Public Members' \n        ELSE 'Hidden Members' \n    END AS member_visibility, \n    COUNT(DISTINCT d.MOIRA_LIST_MEMBER) AS total_members\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL d ON ml.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY\nJOIN \n    MOIRA_LIST_OWNER o ON d.MOIRA_LIST_OWNER_KEY = o.MOIRA_LIST_OWNER_KEY\nGROUP BY \n    o.OWNER, \n    o.OWNER_TYPE, \n    ml.IS_PUBLIC\n\nUNION ALL\n\nSELECT \n    o.OWNER, \n    o.OWNER_TYPE, \n    NULL AS member_visibility, \n    COUNT(DISTINCT d.MOIRA_LIST_MEMBER) AS total_members\nFROM \n    MOIRA_LIST ml\nJOIN \n    MOIRA_LIST_DETAIL d ON ml.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY\nJOIN \n    MOIRA_LIST_OWNER o ON d.MOIRA_LIST_OWNER_KEY = o.MOIRA_LIST_OWNER_KEY\nGROUP BY \n    o.OWNER, \n    o.OWNER_TYPE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179944, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=257, prompt_tokens=851, total_tokens=1108, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=257, prompt_tokens=851, total_tokens=1108, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    o.OWNER, 
    o.OWNER_TYPE, 
    CASE 
        WHEN ml.IS_PUBLIC = 'Y' THEN 'Public Members' 
        ELSE 'Hidden Members' 
    END AS member_visibility, 
    COUNT(DISTINCT d.MOIRA_LIST_MEMBER) AS total_members
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL d ON ml.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY
JOIN 
    MOIRA_LIST_OWNER o ON d.MOIRA_LIST_OWNER_KEY = o.MOIRA_LIST_OWNER_KEY
GROUP BY 
    o.OWNER, 
    o.OWNER_TYPE, 
    ml.IS_PUBLIC

UNION ALL

SELECT 
    o.OWNER, 
    o.OWNER_TYPE, 
    NULL AS member_visibility, 
    COUNT(DISTINCT d.MOIRA_LIST_MEMBER) AS total_members
FROM 
    MOIRA_LIST ml
JOIN 
    MOIRA_LIST_DETAIL d ON ml.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY
JOIN 
    MOIRA_LIST_OWNER o ON d.MOIRA_LIST_OWNER_KEY = o.MOIRA_LIST_OWNER_KEY
GROUP BY 
    o.OWNER, 
    o.OWNER_TYPE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 851, 257
TOTAL                  : 151710, 139067, 12643
AVG                    : 2334.00, 2139.49, 194.51
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED_SUMMARY
[
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese II', 'Eng 10A: British Writers', 'Biology of Cancer Cell']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0035, HAA.0036, HAA.0042, HAA.006', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0001, HAA.0002, HAA.0003, HAA.0004, HAA.0005, HAA.0006, HAA.0007, HAA.0008, HAA.0009, HAA.0010, HAA.0011, HAA.001']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Graduate program', 'Higher level graduate program']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'Architecture and Planning']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(TOTAL_UNITS:NUMBER, Examples: [15, 1, 24]),
(LECTURE_UNITS:NUMBER, Examples: [0, 6, 12]),
(LAB_UNITS:NUMBER, Examples: [15, 1, 24]),
(PREPARATION_UNITS:NUMBER, Examples: [0, 9, 8]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [195, 159, 170]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]

### Question ###
Group biology courses by cluster type and course level. For each group, list the name of the department, the course title, cluster type, total enrollments, average enrollment within its cluster, course level, number of unique course materials, average new and used prices for TIP materials, total material record count for TIP materials, number of unique library titles, and number of unique library ISBNs.

(Hints: Schema Mapping Hints:
- 'biology courses' is related to SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_NAME
- 'cluster type' is related to SUBJECT_OFFERED_SUMMARY.CLUSTER_TYPE
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'name of the department' is related to SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_NAME
- 'course title' is related to SUBJECT_OFFERED_SUMMARY.SUBJECT_TITLE
- 'enrollment' is related to SUBJECT_OFFERED_SUMMARY.NUM_ENROLLED_STUDENTS
- 'course materials' is related to TIP_MATERIAL.TITLE
- 'new price' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'use price' is related to TIP_MATERIAL.USED_SHELF_PRICE
- 'record count for TIP materials' is related to TIP_DETAIL.RECORD_COUNT
- 'library titles' is related to LIBRARY_RESERVE_CATALOG.CATALOG_TITLE
- 'library ISBNs' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN

Join Information: (SUBJECT_OFFERED_SUMMARY.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE), (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoWLQXIG8uJnbUlYB4V2CM1bEJm3', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    sos.OFFER_DEPT_NAME AS department_name,\n    sos.SUBJECT_TITLE AS course_title,\n    sos.CLUSTER_TYPE,\n    SUM(sos.NUM_ENROLLED_STUDENTS) AS total_enrollments,\n    AVG(sos.NUM_ENROLLED_STUDENTS) OVER (PARTITION BY sos.CLUSTER_TYPE) AS avg_enrollment_within_cluster,\n    scd.COURSE_LEVEL,\n    COUNT(DISTINCT tm.TITLE) AS unique_course_materials,\n    AVG(tm.NEW_SHELF_PRICE) AS avg_new_price,\n    AVG(tm.USED_SHELF_PRICE) AS avg_used_price,\n    SUM(td.RECORD_COUNT) AS total_material_record_count,\n    COUNT(DISTINCT lrc.CATALOG_TITLE) AS unique_library_titles,\n    COUNT(DISTINCT lrc.CATALOG_ISBN) AS unique_library_isbns\nFROM \n    SUBJECT_OFFERED_SUMMARY sos\nJOIN \n    SIS_COURSE_DESCRIPTION scd ON sos.COURSE_NUMBER = scd.COURSE\nLEFT JOIN \n    TIP_DETAIL td ON sos.SUBJECT_ID = td.SUBJECT_ID\nLEFT JOIN \n    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY\nLEFT JOIN \n    LIBRARY_RESERVE_CATALOG lrc ON tm.ISBN = lrc.CATALOG_ISBN\nWHERE \n    sos.SUBJECT_TITLE LIKE '%Biology%'\nGROUP BY \n    sos.OFFER_DEPT_NAME, sos.SUBJECT_TITLE, sos.CLUSTER_TYPE, scd.COURSE_LEVEL\nORDER BY \n    sos.OFFER_DEPT_NAME, sos.SUBJECT_TITLE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179949, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=335, prompt_tokens=3051, total_tokens=3386, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=335, prompt_tokens=3051, total_tokens=3386, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sos.OFFER_DEPT_NAME AS department_name,
    sos.SUBJECT_TITLE AS course_title,
    sos.CLUSTER_TYPE,
    SUM(sos.NUM_ENROLLED_STUDENTS) AS total_enrollments,
    AVG(sos.NUM_ENROLLED_STUDENTS) OVER (PARTITION BY sos.CLUSTER_TYPE) AS avg_enrollment_within_cluster,
    scd.COURSE_LEVEL,
    COUNT(DISTINCT tm.TITLE) AS unique_course_materials,
    AVG(tm.NEW_SHELF_PRICE) AS avg_new_price,
    AVG(tm.USED_SHELF_PRICE) AS avg_used_price,
    SUM(td.RECORD_COUNT) AS total_material_record_count,
    COUNT(DISTINCT lrc.CATALOG_TITLE) AS unique_library_titles,
    COUNT(DISTINCT lrc.CATALOG_ISBN) AS unique_library_isbns
FROM 
    SUBJECT_OFFERED_SUMMARY sos
JOIN 
    SIS_COURSE_DESCRIPTION scd ON sos.COURSE_NUMBER = scd.COURSE
LEFT JOIN 
    TIP_DETAIL td ON sos.SUBJECT_ID = td.SUBJECT_ID
LEFT JOIN 
    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY
LEFT JOIN 
    LIBRARY_RESERVE_CATALOG lrc ON tm.ISBN = lrc.CATALOG_ISBN
WHERE 
    sos.SUBJECT_TITLE LIKE '%Biology%'
GROUP BY 
    sos.OFFER_DEPT_NAME, sos.SUBJECT_TITLE, sos.CLUSTER_TYPE, scd.COURSE_LEVEL
ORDER BY 
    sos.OFFER_DEPT_NAME, sos.SUBJECT_TITLE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3051, 335
TOTAL                  : 155096, 142118, 12978
AVG                    : 2349.94, 2153.30, 196.64
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For subjects offered this year in either the Fall or Spring term, list its department name, school name, subject ID, subject title, course level, total units, the term it is offered ('Spring' for Spring term and 'Fall' for Fall term), term description, the number of distinct instructors teaching in the Fall, and the number of distinct instructors teaching in the Spring.

(Hints: Schema Mapping Hints:
- 'subjects offered this year' is related to COURSE_CATALOG_SUBJECT_OFFERED.IS_OFFERED_THIS_YEAR
- 'department name' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'subject ID' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'subject title' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'total units' is related to COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS
- 'term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'term description' is related to ACADEMIC_TERMS.TERM_DESCRIPTION
- 'instructors' is related to COURSE_CATALOG_SUBJECT_OFFERED.FALL_INSTRUCTORS, COURSE_CATALOG_SUBJECT_OFFERED.SPRING_INSTRUCTORS

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoWSO9xBOECynVcptfZM8eKU2DET', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    cs.DEPARTMENT_NAME, \n    d.SCHOOL_NAME, \n    cs.SUBJECT_ID, \n    cs.SUBJECT_TITLE, \n    cd.COURSE_LEVEL, \n    cs.TOTAL_UNITS, \n    CASE \n        WHEN cs.TERM_CODE LIKE '%FA%' THEN 'Fall' \n        WHEN cs.TERM_CODE LIKE '%SP%' THEN 'Spring' \n    END AS TERM, \n    at.TERM_DESCRIPTION, \n    (SELECT COUNT(DISTINCT FALL_INSTRUCTORS) FROM COURSE_CATALOG_SUBJECT_OFFERED cs1 WHERE cs1.TERM_CODE LIKE '%FA%' AND cs1.IS_OFFERED_THIS_YEAR = 'Y' AND cs1.SUBJECT_CODE = cs.SUBJECT_CODE) AS FALL_INSTRUCTORS_COUNT, \n    (SELECT COUNT(DISTINCT SPRING_INSTRUCTORS) FROM COURSE_CATALOG_SUBJECT_OFFERED cs2 WHERE cs2.TERM_CODE LIKE '%SP%' AND cs2.IS_OFFERED_THIS_YEAR = 'Y' AND cs2.SUBJECT_CODE = cs.SUBJECT_CODE) AS SPRING_INSTRUCTORS_COUNT\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED cs\nJOIN \n    SIS_DEPARTMENT d ON cs.DEPARTMENT_CODE = d.DEPARTMENT_CODE\nJOIN \n    SIS_COURSE_DESCRIPTION cd ON cs.SUBJECT_CODE = cd.COURSE\nJOIN \n    ACADEMIC_TERMS at ON cs.TERM_CODE = at.TERM_CODE\nWHERE \n    cs.IS_OFFERED_THIS_YEAR = 'Y' \n    AND cs.TERM_CODE LIKE '%FA%'\n    OR cs.TERM_CODE LIKE '%SP%';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179956, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=342, prompt_tokens=4045, total_tokens=4387, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=342, prompt_tokens=4045, total_tokens=4387, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    cs.DEPARTMENT_NAME, 
    d.SCHOOL_NAME, 
    cs.SUBJECT_ID, 
    cs.SUBJECT_TITLE, 
    cd.COURSE_LEVEL, 
    cs.TOTAL_UNITS, 
    CASE 
        WHEN cs.TERM_CODE LIKE '%FA%' THEN 'Fall' 
        WHEN cs.TERM_CODE LIKE '%SP%' THEN 'Spring' 
    END AS TERM, 
    at.TERM_DESCRIPTION, 
    (SELECT COUNT(DISTINCT FALL_INSTRUCTORS) FROM COURSE_CATALOG_SUBJECT_OFFERED cs1 WHERE cs1.TERM_CODE LIKE '%FA%' AND cs1.IS_OFFERED_THIS_YEAR = 'Y' AND cs1.SUBJECT_CODE = cs.SUBJECT_CODE) AS FALL_INSTRUCTORS_COUNT, 
    (SELECT COUNT(DISTINCT SPRING_INSTRUCTORS) FROM COURSE_CATALOG_SUBJECT_OFFERED cs2 WHERE cs2.TERM_CODE LIKE '%SP%' AND cs2.IS_OFFERED_THIS_YEAR = 'Y' AND cs2.SUBJECT_CODE = cs.SUBJECT_CODE) AS SPRING_INSTRUCTORS_COUNT
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED cs
JOIN 
    SIS_DEPARTMENT d ON cs.DEPARTMENT_CODE = d.DEPARTMENT_CODE
JOIN 
    SIS_COURSE_DESCRIPTION cd ON cs.SUBJECT_CODE = cd.COURSE
JOIN 
    ACADEMIC_TERMS at ON cs.TERM_CODE = at.TERM_CODE
WHERE 
    cs.IS_OFFERED_THIS_YEAR = 'Y' 
    AND cs.TERM_CODE LIKE '%FA%'
    OR cs.TERM_CODE LIKE '%SP%';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4045, 342
TOTAL                  : 159483, 146163, 13320
AVG                    : 2380.34, 2181.54, 198.81
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: CIS_COURSE_CATALOG
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2003', '2002', '2007']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['097', '098', '090']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.097', '6.098', '6.090']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['N', 'Y', 'S']),
(DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:DATE, Examples: ['Electrical Eng & Computer Sci', 'Architecture', 'Chemistry']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1991FA', '1995FA', '1989FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Spec Subj: EE & CS', 'Spec Prob in Arch Design', 'Special Topics I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['Y', 'N']),
(LECTURE_UNITS:VARCHAR2, Examples: [0, 3, 1]),
(LAB_UNITS:VARCHAR2, Examples: [0, 12, 4]),
(PREPARATION_UNITS:VARCHAR2, Examples: [0, 9, 5]),
(TOTAL_UNITS:VARCHAR2, Examples: [0, 12, 6]),
(DESIGN_UNITS:VARCHAR2, Examples: [0, 6, 8]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['R', 'J', 'N']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Can be repeated for credit', 'Continuing and Repeatable', 'Not repeatable for credit']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', 'H-LEVEL Grad Credit (except for Course 18 students)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['HD1', 'HE', 'HD5']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS-D, Category 1', 'HASS Elective', 'HASS-D, Category 5']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:NUMBER, Examples: ['RESH', 'NTRN', 'COOP']),
(TUITION_ATTRIBUTE_DESC:NUMBER, Examples: ['Pre-thesis Research Subject', 'Internship', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:NUMBER, Examples: ['WRT2', 'WRT1']),
(WRITE_REQ_ATTRIBUTE_DESC:NUMBER, Examples: ['Writing Requirement, Phase II', 'Writing Requirement, Phase I']),
(SUPERVISOR_ATTRIBUTE:NUMBER, Examples: ['UROP', 'THG', 'THU']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['UROP subject', 'Grad Thesis', 'Undergrad Thesis']),
(PREREQUISITES:VARCHAR2, Examples: ['Permission of instructor', '10.213', '12.120 and 12.103, or permission of instructor']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Crystal structures of mantle and core minerals, elastic and thermodynamic properties of materials at high pressure-temperature,', 'Investigates social conflict and distributional disputes in the public sector. While theoretical aspects of conflict are consid', 'Presents a framework for current landscape ecological theory, structured to encourage application in physical planning of lands']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.285J, 11.482J', '3.57J', '1.232J, 15.054J, 16.71J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE', '1.EPW, 3.EPW, 6.EPW, 10.EPW, 16.EPW, 20.EPW, 22.EPW', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 16.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['2.729J, EC.729J', 'EC.718J, WGS.277J', '21A.136J, 21G.026J']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['15.511, 15.515', '15.024', '15.414']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['Staff', 'Z. O. Summers', 'L. W. Shaw']),
(STATUS_CHANGE:VARCHAR2, Examples: ['(2016: New number: 21G.110)', '(2016: New number: 21G.113)', '(2016: New number: 21G.142)']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['02-SEP-01', '12-JAN-06', '16-MAY-05']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.005']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HS', 'HA', 'HH']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Social Sciences', 'HASS Arts', 'HASS Humanities']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'Second Half Term Subject', 'First Half Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Asia', 'United States of America']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['China', 'Brazil|Uruguay|Vietnam|Russia|Australia', 'United States of America']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m2c.html', 'http://student.mit.edu/catalog/m3b.html'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED_SUMMARY
[
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese II', 'Eng 10A: British Writers', 'Biology of Cancer Cell']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0035, HAA.0036, HAA.0042, HAA.006', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0001, HAA.0002, HAA.0003, HAA.0004, HAA.0005, HAA.0006, HAA.0007, HAA.0008, HAA.0009, HAA.0010, HAA.0011, HAA.001']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Graduate program', 'Higher level graduate program']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'Architecture and Planning']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(TOTAL_UNITS:NUMBER, Examples: [15, 1, 24]),
(LECTURE_UNITS:NUMBER, Examples: [0, 6, 12]),
(LAB_UNITS:NUMBER, Examples: [15, 1, 24]),
(PREPARATION_UNITS:NUMBER, Examples: [0, 9, 8]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [195, 159, 170]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA'])
]

### Question ###
For Political Science courses with HASS attributes, for each attribute, list the name and description of the attribute, the number of unique subjects, average units, the total enrollment, the number of departments that grant degrees, and the subject code description.

(Hints: Schema Mapping Hints:
- 'Political Science' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'name' is related to CIS_COURSE_CATALOG.HASS_ATTRIBUTE
- 'description' is related to CIS_COURSE_CATALOG.HASS_ATTRIBUTE_DESC
- 'subjects' is related to CIS_COURSE_CATALOG.SUBJECT_ID
- 'units' is related to CIS_COURSE_CATALOG.TOTAL_UNITS
- 'enrollment' is related to SUBJECT_OFFERED_SUMMARY.NUM_ENROLLED_STUDENTS
- 'departments that grant degrees' is related to SIS_DEPARTMENT.IS_DEGREE_GRANTING
- 'subject code description' is related to SIS_SUBJECT_CODE.SUBJECT_CODE_DESC

Join Information: (CIS_COURSE_CATALOG.SUBJECT_CODE = SIS_SUBJECT_CODE.SUBJECT_CODE), (SUBJECT_OFFERED_SUMMARY.SUBJECT_ID = CIS_COURSE_CATALOG.SUBJECT_ID), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_SUBJECT_CODE.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoWaKQTBBE76LUQZKvZww9jevmIS', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    C.HASS_ATTRIBUTE AS name,\n    C.HASS_ATTRIBUTE_DESC AS description,\n    COUNT(DISTINCT C.SUBJECT_ID) AS unique_subjects,\n    AVG(C.TOTAL_UNITS) AS average_units,\n    SUM(S.NUM_ENROLLED_STUDENTS) AS total_enrollment,\n    COUNT(DISTINCT D.DEPARTMENT_CODE) AS departments_granting_degrees,\n    SC.SUBJECT_CODE_DESC\nFROM \n    CIS_COURSE_CATALOG C\nJOIN \n    SUBJECT_OFFERED_SUMMARY S ON C.SUBJECT_ID = S.SUBJECT_ID\nJOIN \n    SIS_SUBJECT_CODE SC ON C.SUBJECT_CODE = SC.SUBJECT_CODE\nJOIN \n    SIS_DEPARTMENT D ON SC.DEPARTMENT_CODE = D.DEPARTMENT_CODE\nWHERE \n    D.DEPARTMENT_NAME LIKE '%Political Science%' \n    AND C.HASS_ATTRIBUTE IS NOT NULL\nGROUP BY \n    C.HASS_ATTRIBUTE, C.HASS_ATTRIBUTE_DESC, SC.SUBJECT_CODE_DESC;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179964, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=212, prompt_tokens=3609, total_tokens=3821, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=212, prompt_tokens=3609, total_tokens=3821, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    C.HASS_ATTRIBUTE AS name,
    C.HASS_ATTRIBUTE_DESC AS description,
    COUNT(DISTINCT C.SUBJECT_ID) AS unique_subjects,
    AVG(C.TOTAL_UNITS) AS average_units,
    SUM(S.NUM_ENROLLED_STUDENTS) AS total_enrollment,
    COUNT(DISTINCT D.DEPARTMENT_CODE) AS departments_granting_degrees,
    SC.SUBJECT_CODE_DESC
FROM 
    CIS_COURSE_CATALOG C
JOIN 
    SUBJECT_OFFERED_SUMMARY S ON C.SUBJECT_ID = S.SUBJECT_ID
JOIN 
    SIS_SUBJECT_CODE SC ON C.SUBJECT_CODE = SC.SUBJECT_CODE
JOIN 
    SIS_DEPARTMENT D ON SC.DEPARTMENT_CODE = D.DEPARTMENT_CODE
WHERE 
    D.DEPARTMENT_NAME LIKE '%Political Science%' 
    AND C.HASS_ATTRIBUTE IS NOT NULL
GROUP BY 
    C.HASS_ATTRIBUTE, C.HASS_ATTRIBUTE_DESC, SC.SUBJECT_CODE_DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3609, 212
TOTAL                  : 163304, 149772, 13532
AVG                    : 2401.53, 2202.53, 199.00
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED_SUMMARY
[
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese II', 'Eng 10A: British Writers', 'Biology of Cancer Cell']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0035, HAA.0036, HAA.0042, HAA.006', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0001, HAA.0002, HAA.0003, HAA.0004, HAA.0005, HAA.0006, HAA.0007, HAA.0008, HAA.0009, HAA.0010, HAA.0011, HAA.001']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Graduate program', 'Higher level graduate program']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'Architecture and Planning']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(TOTAL_UNITS:NUMBER, Examples: [15, 1, 24]),
(LECTURE_UNITS:NUMBER, Examples: [0, 6, 12]),
(LAB_UNITS:NUMBER, Examples: [15, 1, 24]),
(PREPARATION_UNITS:NUMBER, Examples: [0, 9, 8]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [195, 159, 170]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA'])
]

### Question ###
Group subjects by cluster type, department offering the subject, and the school name. For each group, list the cluster type, name of the department, school name, whether the department grants degrees, total number of subjects, total enrollment, and average enrollment. Exclude clusters or schools with no student data.

(Hints: Schema Mapping Hints:
- 'cluster type' is related to SUBJECT_OFFERED_SUMMARY.CLUSTER_TYPE
- 'name of the department' is related to SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'whether the department grants degrees' is related to SIS_DEPARTMENT.IS_DEGREE_GRANTING
- 'subjects' is related to SUBJECT_OFFERED_SUMMARY.SUBJECT_ID
- 'enrollment' is related to SUBJECT_OFFERED_SUMMARY.NUM_ENROLLED_STUDENTS

Join Information: (SUBJECT_OFFERED_SUMMARY.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SUBJECT_OFFERED_SUMMARY.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoWfmSieJ0pYzn6jaU7xgMneP6aD', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    sos.CLUSTER_TYPE,\n    sos.OFFER_DEPT_NAME,\n    sd.SCHOOL_NAME,\n    sd.IS_DEGREE_GRANTING,\n    COUNT(sos.SUBJECT_ID) AS total_subjects,\n    SUM(sos.NUM_ENROLLED_STUDENTS) AS total_enrollment,\n    AVG(sos.NUM_ENROLLED_STUDENTS) AS avg_enrollment\nFROM \n    SUBJECT_OFFERED_SUMMARY sos\nJOIN \n    SIS_DEPARTMENT sd ON sos.OFFER_DEPT_CODE = sd.DEPARTMENT_CODE\nGROUP BY \n    sos.CLUSTER_TYPE, \n    sos.OFFER_DEPT_NAME, \n    sd.SCHOOL_NAME, \n    sd.IS_DEGREE_GRANTING\nHAVING \n    total_enrollment > 0;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179969, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=163, prompt_tokens=2317, total_tokens=2480, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=163, prompt_tokens=2317, total_tokens=2480, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    sos.CLUSTER_TYPE,
    sos.OFFER_DEPT_NAME,
    sd.SCHOOL_NAME,
    sd.IS_DEGREE_GRANTING,
    COUNT(sos.SUBJECT_ID) AS total_subjects,
    SUM(sos.NUM_ENROLLED_STUDENTS) AS total_enrollment,
    AVG(sos.NUM_ENROLLED_STUDENTS) AS avg_enrollment
FROM 
    SUBJECT_OFFERED_SUMMARY sos
JOIN 
    SIS_DEPARTMENT sd ON sos.OFFER_DEPT_CODE = sd.DEPARTMENT_CODE
GROUP BY 
    sos.CLUSTER_TYPE, 
    sos.OFFER_DEPT_NAME, 
    sd.SCHOOL_NAME, 
    sd.IS_DEGREE_GRANTING
HAVING 
    total_enrollment > 0;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2317, 163
TOTAL                  : 165784, 152089, 13695
AVG                    : 2402.67, 2204.19, 198.48
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]

### Question ###
Group classes that take place in buildings at MIT by the building name and course level. For each group, provide the name of the building, the course level ('Graduate' or 'Undergraduate'), the total number of unique courses of such level, and total instructors for these courses. Include subtotals for each building and course level and a grand total across all buildings and course levels.

(Hints: Schema Mapping Hints:
- 'buildings at MIT' is related to FAC_BUILDING.SITE
- 'name of the building' is related to FAC_BUILDING.BUILDING_NAME
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'courses' is related to SUBJECT_OFFERED_SUMMARY.SUBJECT_ID
- 'instructors' is related to SUBJECT_OFFERED_SUMMARY.RESPONSIBLE_FACULTY_NAME

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = SUBJECT_OFFERED.MEET_PLACE), (SUBJECT_OFFERED.COURSE_NUMBER = SIS_COURSE_DESCRIPTION.COURSE), (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoWiMq1XFiw0fg6AoCdfZsGl0q30', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CourseDetails AS (\n    SELECT \n        fb.BUILDING_NAME AS building_name,\n        CASE \n            WHEN sc.COURSE_LEVEL = 'G' THEN 'Graduate'\n            WHEN sc.COURSE_LEVEL = 'U' THEN 'Undergraduate'\n            ELSE 'Other'\n        END AS course_level,\n        so.SUBJECT_ID AS course_id,\n        so.RESPONSIBLE_FACULTY_NAME AS instructor\n    FROM \n        FAC_BUILDING fb\n    JOIN \n        SUBJECT_OFFERED so ON fb.FAC_BUILDING_KEY = so.MEET_PLACE\n    JOIN \n        SIS_COURSE_DESCRIPTION sc ON so.COURSE_NUMBER = sc.COURSE\n    WHERE \n        fb.SITE = 'MIT'\n)\n\nSELECT \n    building_name,\n    course_level,\n    COUNT(DISTINCT course_id) AS total_courses,\n    COUNT(DISTINCT instructor) AS total_instructors\nFROM \n    CourseDetails\nWHERE \n    course_level IN ('Graduate', 'Undergraduate')\nGROUP BY \n    building_name, course_level\n\nWITH ROLLUP;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179972, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=224, prompt_tokens=3492, total_tokens=3716, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=224, prompt_tokens=3492, total_tokens=3716, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH CourseDetails AS (
    SELECT 
        fb.BUILDING_NAME AS building_name,
        CASE 
            WHEN sc.COURSE_LEVEL = 'G' THEN 'Graduate'
            WHEN sc.COURSE_LEVEL = 'U' THEN 'Undergraduate'
            ELSE 'Other'
        END AS course_level,
        so.SUBJECT_ID AS course_id,
        so.RESPONSIBLE_FACULTY_NAME AS instructor
    FROM 
        FAC_BUILDING fb
    JOIN 
        SUBJECT_OFFERED so ON fb.FAC_BUILDING_KEY = so.MEET_PLACE
    JOIN 
        SIS_COURSE_DESCRIPTION sc ON so.COURSE_NUMBER = sc.COURSE
    WHERE 
        fb.SITE = 'MIT'
)

SELECT 
    building_name,
    course_level,
    COUNT(DISTINCT course_id) AS total_courses,
    COUNT(DISTINCT instructor) AS total_instructors
FROM 
    CourseDetails
WHERE 
    course_level IN ('Graduate', 'Undergraduate')
GROUP BY 
    building_name, course_level

WITH ROLLUP;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3492, 224
TOTAL                  : 169500, 155581, 13919
AVG                    : 2421.43, 2222.59, 198.84
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_MAJOR_USE
[
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE:VARCHAR2, Examples: ['BLDG SRV', 'CIRCULAT', 'CLASSRMS']),
(DESCRIPTION:VARCHAR2, Examples: ['BLDG SERVICE AREA', 'CIRCULATION AREA', 'CLASSROOMS']),
(ASSIGNABLE:VARCHAR2, Examples: ['0', '1']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, provide the room number of course location, building name, building number, building city, building state, area, organization name, room usage, term code, course level, the total number of subjects, unique meeting times, and total units. Do not include meet place or meet times with NULL values.

(Hints: Schema Mapping Hints:
- 'room number' is related to COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE
- 'building name' is related to FAC_BUILDING.BUILDING_NAME
- 'building number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'building city' is related to FAC_BUILDING_ADDRESS.CITY
- 'building state' is related to FAC_BUILDING_ADDRESS.STATE
- 'area' is related to FAC_ROOMS.AREA
- 'organization name' is related to FAC_ROOMS.ORGANIZATION_NAME
- 'room usage' is related to FAC_MAJOR_USE.MAJOR_USE
- 'term code' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'course level' is related to SIS_COURSE_DESCRIPTION.COURSE_LEVEL
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'meeting times' is related to COURSE_CATALOG_SUBJECT_OFFERED.MEET_TIME
- 'units' is related to COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS

Join Information: (FAC_ROOMS.FAC_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE), (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoWm5C5fn5ZiyArHgB4I1X4wcgcC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    FAC_ROOMS.ROOM AS 'room_number',\n    FAC_BUILDING.BUILDING_NAME_LONG AS 'building_name',\n    FAC_BUILDING.BUILDING_NUMBER AS 'building_number',\n    FAC_BUILDING_ADDRESS.CITY AS 'building_city',\n    FAC_BUILDING_ADDRESS.STATE AS 'building_state',\n    FAC_ROOMS.AREA AS 'area',\n    FAC_ROOMS.ORGANIZATION_NAME AS 'organization_name',\n    FAC_MAJOR_USE.MAJOR_USE AS 'room_usage',\n    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE AS 'term_code',\n    SIS_COURSE_DESCRIPTION.COURSE_LEVEL AS 'course_level',\n    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS 'total_subjects',\n    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.MEET_TIME) AS 'unique_meeting_times',\n    SUM(COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS) AS 'total_units'\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED\nJOIN \n    FAC_ROOMS ON FAC_ROOMS.FAC_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE\nJOIN \n    FAC_BUILDING ON FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY\nJOIN \n    FAC_BUILDING_ADDRESS ON FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY\nJOIN \n    FAC_MAJOR_USE ON FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY\nJOIN \n    SIS_COURSE_DESCRIPTION ON SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID\nWHERE \n    COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE IS NOT NULL\n    AND COURSE_CATALOG_SUBJECT_OFFERED.MEET_TIME IS NOT NULL\nGROUP BY \n    FAC_ROOMS.ROOM,\n    FAC_BUILDING.BUILDING_NAME_LONG,\n    FAC_BUILDING.BUILDING_NUMBER,\n    FAC_BUILDING_ADDRESS.CITY,\n    FAC_BUILDING_ADDRESS.STATE,\n    FAC_ROOMS.AREA,\n    FAC_ROOMS.ORGANIZATION_NAME,\n    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE,\n    SIS_COURSE_DESCRIPTION.COURSE_LEVEL\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179976, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=468, prompt_tokens=4703, total_tokens=5171, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1920)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=468, prompt_tokens=4703, total_tokens=5171, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1920))

***** FINAL SQL QUERY *****
SELECT 
    FAC_ROOMS.ROOM AS 'room_number',
    FAC_BUILDING.BUILDING_NAME_LONG AS 'building_name',
    FAC_BUILDING.BUILDING_NUMBER AS 'building_number',
    FAC_BUILDING_ADDRESS.CITY AS 'building_city',
    FAC_BUILDING_ADDRESS.STATE AS 'building_state',
    FAC_ROOMS.AREA AS 'area',
    FAC_ROOMS.ORGANIZATION_NAME AS 'organization_name',
    FAC_MAJOR_USE.MAJOR_USE AS 'room_usage',
    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE AS 'term_code',
    SIS_COURSE_DESCRIPTION.COURSE_LEVEL AS 'course_level',
    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID) AS 'total_subjects',
    COUNT(DISTINCT COURSE_CATALOG_SUBJECT_OFFERED.MEET_TIME) AS 'unique_meeting_times',
    SUM(COURSE_CATALOG_SUBJECT_OFFERED.TOTAL_UNITS) AS 'total_units'
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED
JOIN 
    FAC_ROOMS ON FAC_ROOMS.FAC_ROOM_KEY = COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE
JOIN 
    FAC_BUILDING ON FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY
JOIN 
    FAC_BUILDING_ADDRESS ON FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY
JOIN 
    FAC_MAJOR_USE ON FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY
JOIN 
    SIS_COURSE_DESCRIPTION ON SIS_COURSE_DESCRIPTION.COURSE = COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
WHERE 
    COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE IS NOT NULL
    AND COURSE_CATALOG_SUBJECT_OFFERED.MEET_TIME IS NOT NULL
GROUP BY 
    FAC_ROOMS.ROOM,
    FAC_BUILDING.BUILDING_NAME_LONG,
    FAC_BUILDING.BUILDING_NUMBER,
    FAC_BUILDING_ADDRESS.CITY,
    FAC_BUILDING_ADDRESS.STATE,
    FAC_ROOMS.AREA,
    FAC_ROOMS.ORGANIZATION_NAME,
    COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE,
    SIS_COURSE_DESCRIPTION.COURSE_LEVEL

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4703, 468
TOTAL                  : 174671, 160284, 14387
AVG                    : 2460.15, 2257.52, 202.63
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Consider only books cataloged on or after 2000. For each library material status and department, list the material status, department name, number of associated catalog items, and the total number of enrolled students in courses using those materials. Include subtotals for each material status and a grand total across all status (the corresponding status field is 'Grand Total').

(Hints: Schema Mapping Hints:
- 'cataloged on or after 2000' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'material status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'department name' is related to SIS_SUBJECT_CODE.DEPARTMENT_NAME
- 'catalog items' is related to LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_SUBJECT_OFFERED.COURSE_NUMBER = SIS_SUBJECT_CODE.COURSE_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoWu6ZJunO2SUN5Qgu1bn5whlUJy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH MaterialStats AS (\n    SELECT \n        LMS.LIBRARY_MATERIAL_STATUS AS material_status,\n        SSC.DEPARTMENT_NAME AS department_name,\n        COUNT(DISTINCT RLC.LIBRARY_RESERVE_CATALOG_KEY) AS catalog_item_count,\n        SUM(SSO.NUM_ENROLLED_STUDENTS) AS total_enrolled_students\n    FROM \n        LIBRARY_RESERVE_CATALOG RLC\n    JOIN \n        LIBRARY_RESERVE_MATRL_DETAIL RMD ON RLC.LIBRARY_RESERVE_CATALOG_KEY = RMD.LIBRARY_RESERVE_CATALOG_KEY\n    JOIN \n        LIBRARY_MATERIAL_STATUS LMS ON RMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY\n    JOIN \n        LIBRARY_SUBJECT_OFFERED SSO ON RMD.LIBRARY_SUBJECT_OFFERED_KEY = SSO.LIBRARY_SUBJECT_OFFERED_KEY\n    JOIN \n        SIS_SUBJECT_CODE SSC ON SSO.COURSE_NUMBER = SSC.COURSE_NUMBER\n    WHERE \n        RLC.CATALOG_YEAR >= '2000'\n    GROUP BY \n        LMS.LIBRARY_MATERIAL_STATUS, SSC.DEPARTMENT_NAME\n),\nSubtotals AS (\n    SELECT \n        material_status,\n        department_name,\n        catalog_item_count,\n        total_enrolled_students\n    FROM \n        MaterialStats\n\n    UNION ALL\n\n    SELECT \n        material_status,\n        'Subtotal' AS department_name,\n        SUM(catalog_item_count) AS catalog_item_count,\n        SUM(total_enrolled_students) AS total_enrolled_students\n    FROM \n        MaterialStats\n    GROUP BY \n        material_status\n    \n    UNION ALL\n    \n    SELECT \n        'Grand Total' AS material_status,\n        'Grand Total' AS department_name,\n        SUM(catalog_item_count) AS catalog_item_count,\n        SUM(total_enrolled_students) AS total_enrolled_students\n    FROM \n        MaterialStats\n)\n\nSELECT \n    material_status,\n    department_name,\n    catalog_item_count,\n    total_enrolled_students\nFROM \n    Subtotals\nORDER BY \n    material_status, department_name;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179984, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=440, prompt_tokens=1943, total_tokens=2383, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=440, prompt_tokens=1943, total_tokens=2383, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH MaterialStats AS (
    SELECT 
        LMS.LIBRARY_MATERIAL_STATUS AS material_status,
        SSC.DEPARTMENT_NAME AS department_name,
        COUNT(DISTINCT RLC.LIBRARY_RESERVE_CATALOG_KEY) AS catalog_item_count,
        SUM(SSO.NUM_ENROLLED_STUDENTS) AS total_enrolled_students
    FROM 
        LIBRARY_RESERVE_CATALOG RLC
    JOIN 
        LIBRARY_RESERVE_MATRL_DETAIL RMD ON RLC.LIBRARY_RESERVE_CATALOG_KEY = RMD.LIBRARY_RESERVE_CATALOG_KEY
    JOIN 
        LIBRARY_MATERIAL_STATUS LMS ON RMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY
    JOIN 
        LIBRARY_SUBJECT_OFFERED SSO ON RMD.LIBRARY_SUBJECT_OFFERED_KEY = SSO.LIBRARY_SUBJECT_OFFERED_KEY
    JOIN 
        SIS_SUBJECT_CODE SSC ON SSO.COURSE_NUMBER = SSC.COURSE_NUMBER
    WHERE 
        RLC.CATALOG_YEAR >= '2000'
    GROUP BY 
        LMS.LIBRARY_MATERIAL_STATUS, SSC.DEPARTMENT_NAME
),
Subtotals AS (
    SELECT 
        material_status,
        department_name,
        catalog_item_count,
        total_enrolled_students
    FROM 
        MaterialStats

    UNION ALL

    SELECT 
        material_status,
        'Subtotal' AS department_name,
        SUM(catalog_item_count) AS catalog_item_count,
        SUM(total_enrolled_students) AS total_enrolled_students
    FROM 
        MaterialStats
    GROUP BY 
        material_status
    
    UNION ALL
    
    SELECT 
        'Grand Total' AS material_status,
        'Grand Total' AS department_name,
        SUM(catalog_item_count) AS catalog_item_count,
        SUM(total_enrolled_students) AS total_enrolled_students
    FROM 
        MaterialStats
)

SELECT 
    material_status,
    department_name,
    catalog_item_count,
    total_enrolled_students
FROM 
    Subtotals
ORDER BY 
    material_status, department_name;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1943, 440
TOTAL                  : 177054, 162227, 14827
AVG                    : 2459.08, 2253.15, 205.93
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each department in the library system, list the name of the department, total number of courses using library materials, the number of catalog items associated with those courses, and the average enrollment per course. Include a grand total across all departments (the corresponding department field should be 'Grand Total').

(Hints: Schema Mapping Hints:
- 'name of the department' is related to LIBRARY_COURSE_INSTRUCTOR.DEPARTMENT
- 'courses' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME
- 'catalog items' is related to LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY
- 'enrollment' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoX5hYSbaYfDCi7ar0Dd4z6Td74Y', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CourseStats AS (\n    SELECT \n        LCI.DEPARTMENT,\n        COUNT(DISTINCT LCI.COURSE_NAME) AS total_courses,\n        COUNT(DISTINCT LRC.LIBRARY_RESERVE_CATALOG_KEY) AS total_catalog_items,\n        AVG(LSO.NUM_ENROLLED_STUDENTS) AS avg_enrollment\n    FROM \n        LIBRARY_COURSE_INSTRUCTOR LCI\n    JOIN \n        LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY\n    JOIN \n        LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY\n    JOIN \n        LIBRARY_SUBJECT_OFFERED LSO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY\n    GROUP BY \n        LCI.DEPARTMENT\n)\n\nSELECT \n    DEPARTMENT,\n    total_courses,\n    total_catalog_items,\n    avg_enrollment\nFROM \n    CourseStats\n\nUNION ALL\n\nSELECT \n    'Grand Total' AS DEPARTMENT,\n    SUM(total_courses) AS total_courses,\n    SUM(total_catalog_items) AS total_catalog_items,\n    AVG(avg_enrollment) AS avg_enrollment\nFROM \n    CourseStats;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767179995, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=292, prompt_tokens=1896, total_tokens=2188, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=292, prompt_tokens=1896, total_tokens=2188, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH CourseStats AS (
    SELECT 
        LCI.DEPARTMENT,
        COUNT(DISTINCT LCI.COURSE_NAME) AS total_courses,
        COUNT(DISTINCT LRC.LIBRARY_RESERVE_CATALOG_KEY) AS total_catalog_items,
        AVG(LSO.NUM_ENROLLED_STUDENTS) AS avg_enrollment
    FROM 
        LIBRARY_COURSE_INSTRUCTOR LCI
    JOIN 
        LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LCI.LIBRARY_COURSE_INSTRUCTOR_KEY = LRMD.LIBRARY_COURSE_INSTRUCTOR_KEY
    JOIN 
        LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY
    JOIN 
        LIBRARY_SUBJECT_OFFERED LSO ON LRMD.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY
    GROUP BY 
        LCI.DEPARTMENT
)

SELECT 
    DEPARTMENT,
    total_courses,
    total_catalog_items,
    avg_enrollment
FROM 
    CourseStats

UNION ALL

SELECT 
    'Grand Total' AS DEPARTMENT,
    SUM(total_courses) AS total_courses,
    SUM(total_catalog_items) AS total_catalog_items,
    AVG(avg_enrollment) AS avg_enrollment
FROM 
    CourseStats;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1896, 292
TOTAL                  : 179242, 164123, 15119
AVG                    : 2455.37, 2248.26, 207.11
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each department and school offering courses with materials, list the department name, school name, number of unique course materials, number of courses, average new and used shelf prices of materials, total material records, and number of distinct material statuses. Include a grand total across all schools and departments (the corresponding school and department fields should be null).

(Hints: Schema Mapping Hints:
- 'courses with materials' is related to TIP_SUBJECT_OFFERED.IS_NO_COURSE_MATERIAL
- 'department name' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'course materials' is related to TIP_MATERIAL.TITLE
- 'courses' is related to TIP_SUBJECT_OFFERED.SUBJECT_TITLE
- 'new' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'used' is related to TIP_MATERIAL.USED_SHELF_PRICE
- 'material records' is related to TIP_DETAIL.RECORD_COUNT
- 'material statuses' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY), (SIS_DEPARTMENT.DEPARTMENT_CODE = TIP_SUBJECT_OFFERED.OFFER_DEPT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoXBMVm0yDboABuAcyEidWgvGD3h', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    d.DEPARTMENT_NAME,\n    d.SCHOOL_NAME,\n    COUNT(DISTINCT m.TITLE) AS num_unique_course_materials,\n    COUNT(DISTINCT so.SUBJECT_TITLE) AS num_courses,\n    AVG(m.NEW_SHELF_PRICE) AS average_new_price,\n    AVG(m.USED_SHELF_PRICE) AS average_used_price,\n    SUM(dt.RECORD_COUNT) AS total_material_records,\n    COUNT(DISTINCT ms.TIP_MATERIAL_STATUS) AS num_distinct_material_statuses\nFROM SIS_DEPARTMENT d\nJOIN TIP_SUBJECT_OFFERED so ON d.DEPARTMENT_CODE = so.OFFER_DEPT_CODE\nJOIN TIP_DETAIL dt ON so.TIP_SUBJECT_OFFERED_KEY = dt.TIP_SUBJECT_OFFERED_KEY\nJOIN TIP_MATERIAL m ON dt.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY\nJOIN TIP_MATERIAL_STATUS ms ON dt.TIP_MATERIAL_STATUS_KEY = ms.TIP_MATERIAL_STATUS_KEY\nWHERE so.IS_NO_COURSE_MATERIAL = 'N'\nGROUP BY d.DEPARTMENT_NAME, d.SCHOOL_NAME\nWITH ROLLUP\nHAVING (GROUPING(d.DEPARTMENT_NAME) = 0 OR GROUPING(d.SCHOOL_NAME) = 0);\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180001, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=267, prompt_tokens=2056, total_tokens=2323, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=267, prompt_tokens=2056, total_tokens=2323, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    d.DEPARTMENT_NAME,
    d.SCHOOL_NAME,
    COUNT(DISTINCT m.TITLE) AS num_unique_course_materials,
    COUNT(DISTINCT so.SUBJECT_TITLE) AS num_courses,
    AVG(m.NEW_SHELF_PRICE) AS average_new_price,
    AVG(m.USED_SHELF_PRICE) AS average_used_price,
    SUM(dt.RECORD_COUNT) AS total_material_records,
    COUNT(DISTINCT ms.TIP_MATERIAL_STATUS) AS num_distinct_material_statuses
FROM SIS_DEPARTMENT d
JOIN TIP_SUBJECT_OFFERED so ON d.DEPARTMENT_CODE = so.OFFER_DEPT_CODE
JOIN TIP_DETAIL dt ON so.TIP_SUBJECT_OFFERED_KEY = dt.TIP_SUBJECT_OFFERED_KEY
JOIN TIP_MATERIAL m ON dt.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY
JOIN TIP_MATERIAL_STATUS ms ON dt.TIP_MATERIAL_STATUS_KEY = ms.TIP_MATERIAL_STATUS_KEY
WHERE so.IS_NO_COURSE_MATERIAL = 'N'
GROUP BY d.DEPARTMENT_NAME, d.SCHOOL_NAME
WITH ROLLUP
HAVING (GROUPING(d.DEPARTMENT_NAME) = 0 OR GROUPING(d.SCHOOL_NAME) = 0);

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2056, 267
TOTAL                  : 181565, 166179, 15386
AVG                    : 2453.58, 2245.66, 207.92
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each TIP material status, list the total number of unique materials associated with the status, the total number of records associated with the status, and the total student enrollment associated with the status. Any material status with null values should be displayed as 'No material status'. Additionally, include a grand total across all material status (the material status for this row should be displayed as 'Grand Total').

(Hints: Schema Mapping Hints:
- 'TIP material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'materials' is related to TIP_MATERIAL.TITLE
- 'records' is related to TIP_DETAIL.RECORD_COUNT
- 'student enrollment' is related to TIP_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS

Join Information: (TIP_DETAIL.TIP_MATERIAL_STATUS_KEY = TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY), (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY), (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoXHzm4fSq6hDPk7WuK1HHo6KViV', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    COALESCE(TMS.TIP_MATERIAL_STATUS, 'No material status') AS Material_Status,\n    COUNT(DISTINCT TM.ISBN) AS Unique_Materials,\n    SUM(TD.RECORD_COUNT) AS Total_Records,\n    SUM(TSO.NUM_ENROLLED_STUDENTS) AS Total_Enrollment\nFROM \n    TIP_DETAIL TD\nLEFT JOIN \n    TIP_MATERIAL_STATUS TMS ON TD.TIP_MATERIAL_STATUS_KEY = TMS.TIP_MATERIAL_STATUS_KEY\nLEFT JOIN \n    TIP_MATERIAL TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY\nLEFT JOIN \n    TIP_SUBJECT_OFFERED TSO ON TD.TIP_SUBJECT_OFFERED_KEY = TSO.TIP_SUBJECT_OFFERED_KEY\nGROUP BY \n    TMS.TIP_MATERIAL_STATUS\n\nUNION ALL\n\nSELECT \n    'Grand Total' AS Material_Status,\n    COUNT(DISTINCT TM.ISBN) AS Unique_Materials,\n    SUM(TD.RECORD_COUNT) AS Total_Records,\n    SUM(TSO.NUM_ENROLLED_STUDENTS) AS Total_Enrollment\nFROM \n    TIP_DETAIL TD\nLEFT JOIN \n    TIP_MATERIAL_STATUS TMS ON TD.TIP_MATERIAL_STATUS_KEY = TMS.TIP_MATERIAL_STATUS_KEY\nLEFT JOIN \n    TIP_MATERIAL TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY\nLEFT JOIN \n    TIP_SUBJECT_OFFERED TSO ON TD.TIP_SUBJECT_OFFERED_KEY = TSO.TIP_SUBJECT_OFFERED_KEY;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180007, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=326, prompt_tokens=1576, total_tokens=1902, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=326, prompt_tokens=1576, total_tokens=1902, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    COALESCE(TMS.TIP_MATERIAL_STATUS, 'No material status') AS Material_Status,
    COUNT(DISTINCT TM.ISBN) AS Unique_Materials,
    SUM(TD.RECORD_COUNT) AS Total_Records,
    SUM(TSO.NUM_ENROLLED_STUDENTS) AS Total_Enrollment
FROM 
    TIP_DETAIL TD
LEFT JOIN 
    TIP_MATERIAL_STATUS TMS ON TD.TIP_MATERIAL_STATUS_KEY = TMS.TIP_MATERIAL_STATUS_KEY
LEFT JOIN 
    TIP_MATERIAL TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY
LEFT JOIN 
    TIP_SUBJECT_OFFERED TSO ON TD.TIP_SUBJECT_OFFERED_KEY = TSO.TIP_SUBJECT_OFFERED_KEY
GROUP BY 
    TMS.TIP_MATERIAL_STATUS

UNION ALL

SELECT 
    'Grand Total' AS Material_Status,
    COUNT(DISTINCT TM.ISBN) AS Unique_Materials,
    SUM(TD.RECORD_COUNT) AS Total_Records,
    SUM(TSO.NUM_ENROLLED_STUDENTS) AS Total_Enrollment
FROM 
    TIP_DETAIL TD
LEFT JOIN 
    TIP_MATERIAL_STATUS TMS ON TD.TIP_MATERIAL_STATUS_KEY = TMS.TIP_MATERIAL_STATUS_KEY
LEFT JOIN 
    TIP_MATERIAL TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY
LEFT JOIN 
    TIP_SUBJECT_OFFERED TSO ON TD.TIP_SUBJECT_OFFERED_KEY = TSO.TIP_SUBJECT_OFFERED_KEY;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1576, 326
TOTAL                  : 183467, 167755, 15712
AVG                    : 2446.23, 2236.73, 209.49
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_FLOOR
[
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(EXT_GROSS_AREA:NUMBER, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:VARCHAR2, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each room, list its associated building name, floor number, room number, ownership type, organization name, number of rooms, area, and percentage of area relative to the building. Include subtotals across floors, subtotals across all floors for each building, and a grand total across all buildings. For the subtotal for each building and the grand total, the percentage of area should be relative to area of all buildings. All numeric values should be rounded to integers and formatted using commas as thousands separators except the relative percentages which should be rounded to two decimal places.

(Hints: Schema Mapping Hints:
- 'room' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'building name' is related to FCLT_BUILDING.BUILDING_NAME_LONG
- 'floor number' is related to FCLT_FLOOR.FLOOR
- 'room number' is related to FCLT_ROOMS.BUILDING_ROOM
- 'ownership type' is related to FCLT_BUILDING.OWNERSHIP_TYPE
- 'organization name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'number of rooms' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_FLOOR.FCLT_FLOOR_KEY = FCLT_ROOMS.FCLT_FLOOR_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_FLOOR.FCLT_BUILDING_KEY), (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FCLT_ROOMS.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoXNqSpuhr2O78uVptsIpxFU5hO1', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH RoomData AS (\n    SELECT \n        B.BUILDING_NAME_LONG,\n        F.FLOOR,\n        R.BUILDING_ROOM,\n        B.OWNERSHIP_TYPE,\n        O.ORGANIZATION_NAME,\n        COUNT(R.FCLT_ROOM_KEY) AS NUM_OF_ROOMS,\n        ROUND(SUM(R.AREA)) AS AREA\n    FROM \n        FCLT_ROOMS R\n    JOIN \n        FCLT_FLOOR F ON R.FCLT_FLOOR_KEY = F.FCLT_FLOOR_KEY\n    JOIN \n        FCLT_BUILDING B ON F.FCLT_BUILDING_KEY = B.FCLT_BUILDING_KEY\n    JOIN \n        FCLT_ORGANIZATION O ON R.FCLT_ORGANIZATION_KEY = O.FCLT_ORGANIZATION_KEY\n    GROUP BY \n        B.BUILDING_NAME_LONG, F.FLOOR, R.BUILDING_ROOM, B.OWNERSHIP_TYPE, O.ORGANIZATION_NAME\n), TotalData AS (\n    SELECT \n        SUM(AREA) AS TOTAL_AREA\n    FROM \n        RoomData\n), FloorSubtotals AS (\n    SELECT \n        BUILDING_NAME_LONG,\n        FLOOR,\n        SUM(AREA) AS FLOOR_TOTAL_AREA,\n        ROUND(100.0 * SUM(AREA) / (SELECT SUM(AREA) FROM RoomData), 2) AS FLOOR_PERCENTAGE\n    FROM \n        RoomData\n    GROUP BY \n        BUILDING_NAME_LONG, FLOOR\n), BuildingSubtotals AS (\n    SELECT \n        BUILDING_NAME_LONG,\n        SUM(AREA) AS BUILDING_TOTAL_AREA,\n        ROUND(100.0 * SUM(AREA) / (SELECT SUM(AREA) FROM RoomData), 2) AS BUILDING_PERCENTAGE\n    FROM \n        RoomData\n    GROUP BY \n        BUILDING_NAME_LONG\n)\nSELECT \n    R.BUILDING_NAME_LONG,\n    R.FLOOR,\n    R.BUILDING_ROOM,\n    R.OWNERSHIP_TYPE,\n    R.ORGANIZATION_NAME,\n    R.NUM_OF_ROOMS,\n    R.AREA,\n    ROUND(100.0 * R.AREA / (SELECT SUM(AREA) FROM RoomData), 2) AS AREA_PERCENTAGE\nFROM \n    RoomData R\nUNION ALL\nSELECT \n    FLOOR_SUB.BUILDING_NAME_LONG,\n    FLOOR_SUB.FLOOR,\n    'Subtotal' AS BUILDING_ROOM,\n    NULL AS OWNERSHIP_TYPE,\n    NULL AS ORGANIZATION_NAME,\n    NULL AS NUM_OF_ROOMS,\n    FLOOR_SUB.FLOOR_TOTAL_AREA,\n    FLOOR_SUB.FLOOR_PERCENTAGE\nFROM \n    FloorSubtotals FLOOR_SUB\nUNION ALL\nSELECT \n    BUILDING_SUB.BUILDING_NAME_LONG,\n    'Total' AS FLOOR,\n    NULL AS BUILDING_ROOM,\n    NULL AS OWNERSHIP_TYPE,\n    NULL AS ORGANIZATION_NAME,\n    NULL AS NUM_OF_ROOMS,\n    BUILDING_SUB.BUILDING_TOTAL_AREA,\n    BUILDING_SUB.BUILDING_PERCENTAGE\nFROM \n    BuildingSubtotals BUILDING_SUB\nUNION ALL\nSELECT \n    'Grand Total' AS BUILDING_NAME_LONG,\n    NULL AS FLOOR,\n    NULL AS BUILDING_ROOM,\n    NULL AS OWNERSHIP_TYPE,\n    NULL AS ORGANIZATION_NAME,\n    NULL AS NUM_OF_ROOMS,\n    (SELECT SUM(AREA) FROM RoomData) AS GRAND_TOTAL_AREA,\n    100 AS GRAND_TOTAL_PERCENTAGE\nORDER BY \n    1, 2, 3;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180013, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=728, prompt_tokens=2630, total_tokens=3358, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=728, prompt_tokens=2630, total_tokens=3358, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH RoomData AS (
    SELECT 
        B.BUILDING_NAME_LONG,
        F.FLOOR,
        R.BUILDING_ROOM,
        B.OWNERSHIP_TYPE,
        O.ORGANIZATION_NAME,
        COUNT(R.FCLT_ROOM_KEY) AS NUM_OF_ROOMS,
        ROUND(SUM(R.AREA)) AS AREA
    FROM 
        FCLT_ROOMS R
    JOIN 
        FCLT_FLOOR F ON R.FCLT_FLOOR_KEY = F.FCLT_FLOOR_KEY
    JOIN 
        FCLT_BUILDING B ON F.FCLT_BUILDING_KEY = B.FCLT_BUILDING_KEY
    JOIN 
        FCLT_ORGANIZATION O ON R.FCLT_ORGANIZATION_KEY = O.FCLT_ORGANIZATION_KEY
    GROUP BY 
        B.BUILDING_NAME_LONG, F.FLOOR, R.BUILDING_ROOM, B.OWNERSHIP_TYPE, O.ORGANIZATION_NAME
), TotalData AS (
    SELECT 
        SUM(AREA) AS TOTAL_AREA
    FROM 
        RoomData
), FloorSubtotals AS (
    SELECT 
        BUILDING_NAME_LONG,
        FLOOR,
        SUM(AREA) AS FLOOR_TOTAL_AREA,
        ROUND(100.0 * SUM(AREA) / (SELECT SUM(AREA) FROM RoomData), 2) AS FLOOR_PERCENTAGE
    FROM 
        RoomData
    GROUP BY 
        BUILDING_NAME_LONG, FLOOR
), BuildingSubtotals AS (
    SELECT 
        BUILDING_NAME_LONG,
        SUM(AREA) AS BUILDING_TOTAL_AREA,
        ROUND(100.0 * SUM(AREA) / (SELECT SUM(AREA) FROM RoomData), 2) AS BUILDING_PERCENTAGE
    FROM 
        RoomData
    GROUP BY 
        BUILDING_NAME_LONG
)
SELECT 
    R.BUILDING_NAME_LONG,
    R.FLOOR,
    R.BUILDING_ROOM,
    R.OWNERSHIP_TYPE,
    R.ORGANIZATION_NAME,
    R.NUM_OF_ROOMS,
    R.AREA,
    ROUND(100.0 * R.AREA / (SELECT SUM(AREA) FROM RoomData), 2) AS AREA_PERCENTAGE
FROM 
    RoomData R
UNION ALL
SELECT 
    FLOOR_SUB.BUILDING_NAME_LONG,
    FLOOR_SUB.FLOOR,
    'Subtotal' AS BUILDING_ROOM,
    NULL AS OWNERSHIP_TYPE,
    NULL AS ORGANIZATION_NAME,
    NULL AS NUM_OF_ROOMS,
    FLOOR_SUB.FLOOR_TOTAL_AREA,
    FLOOR_SUB.FLOOR_PERCENTAGE
FROM 
    FloorSubtotals FLOOR_SUB
UNION ALL
SELECT 
    BUILDING_SUB.BUILDING_NAME_LONG,
    'Total' AS FLOOR,
    NULL AS BUILDING_ROOM,
    NULL AS OWNERSHIP_TYPE,
    NULL AS ORGANIZATION_NAME,
    NULL AS NUM_OF_ROOMS,
    BUILDING_SUB.BUILDING_TOTAL_AREA,
    BUILDING_SUB.BUILDING_PERCENTAGE
FROM 
    BuildingSubtotals BUILDING_SUB
UNION ALL
SELECT 
    'Grand Total' AS BUILDING_NAME_LONG,
    NULL AS FLOOR,
    NULL AS BUILDING_ROOM,
    NULL AS OWNERSHIP_TYPE,
    NULL AS ORGANIZATION_NAME,
    NULL AS NUM_OF_ROOMS,
    (SELECT SUM(AREA) FROM RoomData) AS GRAND_TOTAL_AREA,
    100 AS GRAND_TOTAL_PERCENTAGE
ORDER BY 
    1, 2, 3;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2630, 728
TOTAL                  : 186825, 170385, 16440
AVG                    : 2458.22, 2241.91, 216.32
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: ACADEMIC_TERM_PARAMETER
[
(TERM_PARAMETER:VARCHAR2, Examples: ['SIS_CURRENT_TERM', 'SIS_PREVIOUS_TERM', 'SIS_UPCOMING_TERM']),
(TERM_INDICATOR:VARCHAR2, Examples: ['C', 'P', 'F']),
(TERM_CODE:VARCHAR2, Examples: ['2024SU', '2025FA', '2025JA']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Fall Term 2024-2025', 'Summer Term 2024', 'January Term 2024-2025']),
(TERM_START_DATE:DATE, Examples: ['03-SEP-24', '10-JUN-24', '06-JAN-25']),
(TERM_END_DATE:DATE, Examples: ['20-DEC-24', '20-AUG-24', '31-JAN-25']),
(TERM_LAST_DAY_BEFORE_NEXT_TERM:DATE, Examples: ['05-JAN-25', '02-SEP-24', '31-JAN-25']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['Y', 'N'])
]
# Table: TIME_DAY
[
(FISCAL_PERIOD:VARCHAR2, Examples: ['195007', '195008', '195009']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1975 Period 6', 'FY 1987 Period 11', 'FY 1983 Period 12']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['197412', '198705', '198306']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['December 1974', 'May 1987', 'June 1983']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1974', '1987', '1983']),
(START_DATE:DATE, Examples: ['01-DEC-74', '01-MAY-87', '01-JUN-83']),
(END_DATE:DATE, Examples: ['31-DEC-74', '31-MAY-87', '30-JUN-83']),
(CALENDAR_DATE:DATE, Examples: ['01-APR-00', '01-APR-01', '01-APR-02']),
(DAY_OF_WEEK:VARCHAR2, Examples: ['Friday   ', 'Wednesday', 'Sunday   ']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['2021', '2002', '1994']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 2020-2021', 'Aid Year 2001-2002', 'Aid year 1993-94']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1975', '1987', '1983']),
(ACADEMIC_TERM_CODE:VARCHAR2, Examples: ['1951SP', '1951SU', '1952SP']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1986-1987', 'Summer Term 1983', 'Summer Term 2020'])
]
# Table: TIME_MONTH
[
(TIME_MONTH_KEY:VARCHAR2, Examples: ['199602', '199601', '199607']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['199601', '199602', '199603']),
(FISCAL_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['FY 1996 Period 2', 'FY 1996 Period 1', 'FY 1996 Period 7']),
(FISCAL_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(FISCAL_YEAR_QUARTER:VARCHAR2, Examples: ['FY 1996 Quarter 1', 'FY 1996 Quarter 3', 'FY 1997 Quarter 1']),
(FY_QUARTER_CODE:VARCHAR2, Examples: ['FY1996Q1', 'FY1996Q2', 'FY1996Q3']),
(CALENDAR_PERIOD:VARCHAR2, Examples: ['199508', '199507', '199601']),
(CALENDAR_PERIOD_DESCRIPTION:VARCHAR2, Examples: ['August 1995', 'July 1995', 'January 1996']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(START_DATE:VARCHAR2, Examples: ['01-AUG-95', '01-JUL-95', '01-JAN-96']),
(END_DATE:VARCHAR2, Examples: ['31-AUG-95', '31-JUL-95', '31-JAN-96']),
(CALENDAR_MONTH:VARCHAR2, Examples: ['8', '7', '1']),
(CALENDAR_MONTH_NAME:DATE, Examples: ['August', 'July', 'January']),
(IS_CURRENT_FISCAL_PERIOD:DATE, Examples: ['N', 'Y']),
(IS_PREVIOUS_FISCAL_PERIOD:VARCHAR2, Examples: ['N', 'Y']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_TERM:VARCHAR2, Examples: ['1995SU', '1996JA', '1996SU']),
(ACADEMIC_TERM_DESCRIPTION:VARCHAR2, Examples: ['Summer Term 1995', 'January Term 1995-1996', 'Summer Term 1996']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(FINANCIAL_AID_YEAR_DESC:VARCHAR2, Examples: ['Aid Year 1995-96', 'Aid Year 1996-97', 'Aid Year 1997-98']),
(IS_CLOSING_PERIOD:VARCHAR2, Examples: ['N', 'Y']),
(FISCAL_PERIOD_SELECTOR:VARCHAR2, Examples: ['199602 -- August 1995', '199601 -- July 1995', '199607 -- January 1996']),
(IS_CURRENT_FISCAL_YEAR:VARCHAR2, Examples: ['N', 'Y'])
]
# Table: TIME_QUARTER
[
(FISCAL_YEAR:VARCHAR2, Examples: ['2000', '2001', '2002']),
(FY_QUARTER_CODE:VARCHAR2, Examples: ['FY2000Q1', 'FY2000Q2', 'FY2000Q3']),
(FY_QUARTER_NAME:VARCHAR2, Examples: ['FY 2014 Quarter 1', 'FY 2026 Quarter 3', 'FY 2026 Quarter 4']),
(CY_QUARTER_CODE:VARCHAR2, Examples: ['CY2013Q3', 'CY2026Q1', 'CY2026Q2']),
(CY_QUARTER_NAME:VARCHAR2, Examples: ['CY 2013 Quarter 3', 'CY 2026 Quarter 1', 'CY 2026 Quarter 2']),
(CALENDAR_YEAR:VARCHAR2, Examples: ['2013', '2026', '2004']),
(QUARTER_START_DATE:DATE, Examples: ['01-JUL-13', '01-JAN-26', '01-APR-26']),
(QUARTER_END_DATE:DATE, Examples: ['30-SEP-13', '31-MAR-26', '30-JUN-26']),
(QUARTER_START_FP:VARCHAR2, Examples: ['201401', '202607', '202610']),
(QUARTER_END_FP:VARCHAR2, Examples: ['201403', '202609', '202612']),
(QUARTER_CERT_OPEN:DATE, Examples: ['01-OCT-13', '01-APR-26', '01-JUL-26']),
(QUARTER_CERT_EXPECTED:DATE, Examples: ['30-NOV-13', '31-MAY-26', '31-AUG-26']),
(QUARTER_CERT_DUE:DATE, Examples: ['31-DEC-13', '30-JUN-26', '30-SEP-26']),
(IS_CURRENT_QUARTER:VARCHAR2, Examples: ['N', 'Y']),
(IS_NEXT_QUARTER:VARCHAR2, Examples: ['N']),
(IS_PREVIOUS_QUARTER:VARCHAR2, Examples: ['N']),
(IS_PAST_QUARTER:VARCHAR2, Examples: ['Y', 'N']),
(IS_FUTURE_QUARTER:VARCHAR2, Examples: ['N', 'Y']),
(PAYROLL_EDACCA_CERT_SCHED_KEY:VARCHAR2, Examples: ['201401', '202603', '202604']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each financial aid year and academic year, list the number of fiscal periods, quarters, the start term date, the end term date, and number of distinct department-level term parameters.

(Hints: Schema Mapping Hints:
- 'financial aid year' is related to ACADEMIC_TERMS.FINANCIAL_AID_YEAR
- 'academic year' is related to ACADEMIC_TERMS.ACADEMIC_YEAR
- 'fiscal periods' is related to TIME_MONTH.FISCAL_PERIOD
- 'quarters' is related to TIME_QUARTER.FY_QUARTER_CODE
- 'start term date' is related to TIME_DAY.START_DATE
- 'end term date' is related to TIME_DAY.END_DATE
- 'department-level term parameters' is related to ACADEMIC_TERM_PARAMETER.TERM_PARAMETER

Join Information: (ACADEMIC_TERMS.TERM_START_DATE = TIME_DAY.CALENDAR_DATE), (TIME_DAY.FISCAL_PERIOD = TIME_MONTH.FISCAL_PERIOD), (TIME_QUARTER.FISCAL_YEAR = TIME_MONTH.FISCAL_YEAR), (ACADEMIC_TERM_PARAMETER.TERM_CODE = ACADEMIC_TERMS.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoXgflZaDOf04fyrwWCiFvA6KzSI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    AT.FINANCIAL_AID_YEAR,\n    AT.ACADEMIC_YEAR,\n    COUNT(DISTINCT TM.FISCAL_PERIOD) AS fiscal_periods,\n    COUNT(DISTINCT TQ.FY_QUARTER_CODE) AS quarters,\n    AT.TERM_START_DATE AS start_term_date,\n    AT.TERM_END_DATE AS end_term_date,\n    COUNT(DISTINCT ATP.TERM_PARAMETER) AS distinct_term_parameters\nFROM \n    ACADEMIC_TERMS AT\nJOIN \n    TIME_DAY TD ON AT.TERM_START_DATE = TD.CALENDAR_DATE\nJOIN \n    TIME_MONTH TM ON TD.FISCAL_PERIOD = TM.FISCAL_PERIOD\nJOIN \n    TIME_QUARTER TQ ON TM.FISCAL_YEAR = TQ.FISCAL_YEAR\nLEFT JOIN \n    ACADEMIC_TERM_PARAMETER ATP ON AT.TERM_CODE = ATP.TERM_CODE\nGROUP BY \n    AT.FINANCIAL_AID_YEAR,\n    AT.ACADEMIC_YEAR,\n    AT.TERM_START_DATE,\n    AT.TERM_END_DATE;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180032, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=218, prompt_tokens=2855, total_tokens=3073, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=218, prompt_tokens=2855, total_tokens=3073, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    AT.FINANCIAL_AID_YEAR,
    AT.ACADEMIC_YEAR,
    COUNT(DISTINCT TM.FISCAL_PERIOD) AS fiscal_periods,
    COUNT(DISTINCT TQ.FY_QUARTER_CODE) AS quarters,
    AT.TERM_START_DATE AS start_term_date,
    AT.TERM_END_DATE AS end_term_date,
    COUNT(DISTINCT ATP.TERM_PARAMETER) AS distinct_term_parameters
FROM 
    ACADEMIC_TERMS AT
JOIN 
    TIME_DAY TD ON AT.TERM_START_DATE = TD.CALENDAR_DATE
JOIN 
    TIME_MONTH TM ON TD.FISCAL_PERIOD = TM.FISCAL_PERIOD
JOIN 
    TIME_QUARTER TQ ON TM.FISCAL_YEAR = TQ.FISCAL_YEAR
LEFT JOIN 
    ACADEMIC_TERM_PARAMETER ATP ON AT.TERM_CODE = ATP.TERM_CODE
GROUP BY 
    AT.FINANCIAL_AID_YEAR,
    AT.ACADEMIC_YEAR,
    AT.TERM_START_DATE,
    AT.TERM_END_DATE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2855, 218
TOTAL                  : 189898, 173240, 16658
AVG                    : 2466.21, 2249.87, 216.34
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_BUILDING_ADDRESS
[
(FCLT_BUILDING_ADDRESS_KEY:VARCHAR2, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(FCLT_BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['66', '68', '76']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FCLT_FLOOR
[
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(EXT_GROSS_AREA:NUMBER, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:VARCHAR2, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group buildings by campus sectors. For each group, list the campus sector, name of the building, city and state where the building is located, total number of floors, total assignable area, total number of rooms, total number of organizations, ownership type, and a rank column indicating the order (1-indexed) of this row within each sector based on the descending order of assignable area. Include subtotals for each sector and a grand total across all sectors. The subtotal and grand total only need to computed over the total number of floors and assignable area.

(Hints: Schema Mapping Hints:
- 'campus sector' is related to FCLT_BUILDING.CAMPUS_SECTOR
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME_LONG
- 'city' is related to FCLT_BUILDING_ADDRESS.CITY
- 'state' is related to FCLT_BUILDING_ADDRESS.STATE
- 'floors' is related to FCLT_FLOOR.FLOOR
- 'area' is related to FCLT_BUILDING.ASSIGNABLE_AREA
- 'rooms' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY
- 'ownership type' is related to FCLT_BUILDING.OWNERSHIP_TYPE

Join Information: (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_FLOOR.FCLT_BUILDING_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_BUILDING_ADDRESS.FCLT_BUILDING_KEY), (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoXkGi1AqAQvnsEhlZqzGz38MJow', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nWITH BuildingSummary AS (\n    SELECT \n        B.CAMPUS_SECTOR,\n        B.BUILDING_NAME_LONG,\n        A.CITY,\n        A.STATE,\n        COUNT(DISTINCT F.FLOOR) AS total_floors,\n        SUM(B.ASSIGNABLE_AREA) AS total_assignable_area,\n        COUNT(DISTINCT R.FCLT_ROOM_KEY) AS total_rooms,\n        COUNT(DISTINCT O.FCLT_ORGANIZATION_KEY) AS total_organizations,\n        B.OWNERSHIP_TYPE\n    FROM \n        FCLT_BUILDING B\n    JOIN \n        FCLT_BUILDING_ADDRESS A ON B.FCLT_BUILDING_KEY = A.FCLT_BUILDING_KEY\n    JOIN \n        FCLT_FLOOR F ON B.FCLT_BUILDING_KEY = F.FCLT_BUILDING_KEY\n    JOIN \n        FCLT_ROOMS R ON B.FCLT_BUILDING_KEY = R.FCLT_BUILDING_KEY\n    JOIN \n        FCLT_ORGANIZATION O ON R.FCLT_ORGANIZATION_KEY = O.FCLT_ORGANIZATION_KEY\n    GROUP BY \n        B.CAMPUS_SECTOR, B.BUILDING_NAME_LONG, A.CITY, A.STATE, B.OWNERSHIP_TYPE\n),\nRankedBuildings AS (\n    SELECT \n        *, \n        ROW_NUMBER() OVER (PARTITION BY CAMPUS_SECTOR ORDER BY total_assignable_area DESC) AS rank\n    FROM \n        BuildingSummary\n),\nSectorSubtotals AS (\n    SELECT \n        CAMPUS_SECTOR,\n        NULL AS BUILDING_NAME_LONG,\n        NULL AS CITY,\n        NULL AS STATE,\n        SUM(total_floors) AS total_floors,\n        SUM(total_assignable_area) AS total_assignable_area,\n        NULL AS total_rooms,\n        NULL AS total_organizations,\n        NULL AS OWNERSHIP_TYPE,\n        0 AS rank\n    FROM \n        BuildingSummary\n    GROUP BY \n        CAMPUS_SECTOR\n)\nSELECT \n    CAMPUS_SECTOR,\n    BUILDING_NAME_LONG,\n    CITY,\n    STATE,\n    total_floors,\n    total_assignable_area,\n    total_rooms,\n    total_organizations,\n    rank\nFROM \n    RankedBuildings\n\nUNION ALL\n\nSELECT \n    CAMPUS_SECTOR,\n    BUILDING_NAME_LONG,\n    CITY,\n    STATE,\n    total_floors,\n    total_assignable_area,\n    total_rooms,\n    total_organizations,\n    rank\nFROM \n    SectorSubtotals\n\nORDER BY\n    CAMPUS_SECTOR,\n    rank;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180036, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=534, prompt_tokens=3008, total_tokens=3542, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=534, prompt_tokens=3008, total_tokens=3542, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH BuildingSummary AS (
    SELECT 
        B.CAMPUS_SECTOR,
        B.BUILDING_NAME_LONG,
        A.CITY,
        A.STATE,
        COUNT(DISTINCT F.FLOOR) AS total_floors,
        SUM(B.ASSIGNABLE_AREA) AS total_assignable_area,
        COUNT(DISTINCT R.FCLT_ROOM_KEY) AS total_rooms,
        COUNT(DISTINCT O.FCLT_ORGANIZATION_KEY) AS total_organizations,
        B.OWNERSHIP_TYPE
    FROM 
        FCLT_BUILDING B
    JOIN 
        FCLT_BUILDING_ADDRESS A ON B.FCLT_BUILDING_KEY = A.FCLT_BUILDING_KEY
    JOIN 
        FCLT_FLOOR F ON B.FCLT_BUILDING_KEY = F.FCLT_BUILDING_KEY
    JOIN 
        FCLT_ROOMS R ON B.FCLT_BUILDING_KEY = R.FCLT_BUILDING_KEY
    JOIN 
        FCLT_ORGANIZATION O ON R.FCLT_ORGANIZATION_KEY = O.FCLT_ORGANIZATION_KEY
    GROUP BY 
        B.CAMPUS_SECTOR, B.BUILDING_NAME_LONG, A.CITY, A.STATE, B.OWNERSHIP_TYPE
),
RankedBuildings AS (
    SELECT 
        *, 
        ROW_NUMBER() OVER (PARTITION BY CAMPUS_SECTOR ORDER BY total_assignable_area DESC) AS rank
    FROM 
        BuildingSummary
),
SectorSubtotals AS (
    SELECT 
        CAMPUS_SECTOR,
        NULL AS BUILDING_NAME_LONG,
        NULL AS CITY,
        NULL AS STATE,
        SUM(total_floors) AS total_floors,
        SUM(total_assignable_area) AS total_assignable_area,
        NULL AS total_rooms,
        NULL AS total_organizations,
        NULL AS OWNERSHIP_TYPE,
        0 AS rank
    FROM 
        BuildingSummary
    GROUP BY 
        CAMPUS_SECTOR
)
SELECT 
    CAMPUS_SECTOR,
    BUILDING_NAME_LONG,
    CITY,
    STATE,
    total_floors,
    total_assignable_area,
    total_rooms,
    total_organizations,
    rank
FROM 
    RankedBuildings

UNION ALL

SELECT 
    CAMPUS_SECTOR,
    BUILDING_NAME_LONG,
    CITY,
    STATE,
    total_floors,
    total_assignable_area,
    total_rooms,
    total_organizations,
    rank
FROM 
    SectorSubtotals

ORDER BY
    CAMPUS_SECTOR,
    rank;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3008, 534
TOTAL                  : 193440, 176248, 17192
AVG                    : 2480.00, 2259.59, 220.41
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each department, list the name of the department, the title of the TIP material associated with the department, author, ISBN, library term code, and whether it is available in the library reserves ('Available in Library' if yes and 'Not Available in Library' otherwise), the total number of instructors per library book for the department, the total number of materials available in the library for the department, and the total number of available materials across all departments.

(Hints: Schema Mapping Hints:
- 'name of the department' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'title of the TIP material' is related to TIP_MATERIAL.TITLE
- 'author' is related to TIP_MATERIAL.AUTHOR
- 'ISBN' is related to TIP_MATERIAL.ISBN
- 'library term code' is related to LIBRARY_RESERVE_MATRL_DETAIL.TERM_CODE
- 'available in the library reserves' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN
- 'instructors' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME

Join Information: (TIP_MATERIAL.TIP_MATERIAL_KEY = TIP_DETAIL.TIP_MATERIAL_KEY), (TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY = TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoXxQYsLOUaNrrTbV2WTUGt7D2RV', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    tso.OFFER_DEPT_NAME,\n    tm.TITLE AS 'TIP Material Title',\n    tm.AUTHOR AS 'Author',\n    tm.ISBN,\n    tso.TERM_CODE AS 'Library Term Code',\n    CASE \n        WHEN lrc.CATALOG_ISBN IS NOT NULL THEN 'Available in Library' \n        ELSE 'Not Available in Library' \n    END AS 'Availability in Library',\n    COUNT(DISTINCT lci.LIBRARY_COURSE_INSTRUCTOR_KEY) AS 'Total Instructors',\n    COUNT(DISTINCT td.TIP_MATERIAL_KEY) AS 'Total Materials',\n    (SELECT COUNT(DISTINCT tm1.TIP_MATERIAL_KEY) \n     FROM TIP_MATERIAL tm1 \n     JOIN TIP_DETAIL td1 ON tm1.TIP_MATERIAL_KEY = td1.TIP_MATERIAL_KEY) AS 'Total Available Materials Across All Departments'\nFROM \n    TIP_SUBJECT_OFFERED tso\nJOIN \n    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY\nJOIN \n    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY\nLEFT JOIN \n    LIBRARY_RESERVE_MATRL_DETAIL lrd ON tso.LIBRARY_SUBJECT_OFFERED_KEY = lrd.LIBRARY_SUBJECT_OFFERED_KEY\nLEFT JOIN \n    LIBRARY_RESERVE_CATALOG lrc ON lrd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY\nLEFT JOIN \n    LIBRARY_COURSE_INSTRUCTOR lci ON lrd.LIBRARY_COURSE_INSTRUCTOR_KEY = lci.LIBRARY_COURSE_INSTRUCTOR_KEY\nGROUP BY \n    tso.OFFER_DEPT_NAME, \n    tm.TITLE, \n    tm.AUTHOR, \n    tm.ISBN,\n    tso.TERM_CODE,\n    lrc.CATALOG_ISBN\nORDER BY \n    tso.OFFER_DEPT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180049, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=408, prompt_tokens=2850, total_tokens=3258, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=408, prompt_tokens=2850, total_tokens=3258, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    tso.OFFER_DEPT_NAME,
    tm.TITLE AS 'TIP Material Title',
    tm.AUTHOR AS 'Author',
    tm.ISBN,
    tso.TERM_CODE AS 'Library Term Code',
    CASE 
        WHEN lrc.CATALOG_ISBN IS NOT NULL THEN 'Available in Library' 
        ELSE 'Not Available in Library' 
    END AS 'Availability in Library',
    COUNT(DISTINCT lci.LIBRARY_COURSE_INSTRUCTOR_KEY) AS 'Total Instructors',
    COUNT(DISTINCT td.TIP_MATERIAL_KEY) AS 'Total Materials',
    (SELECT COUNT(DISTINCT tm1.TIP_MATERIAL_KEY) 
     FROM TIP_MATERIAL tm1 
     JOIN TIP_DETAIL td1 ON tm1.TIP_MATERIAL_KEY = td1.TIP_MATERIAL_KEY) AS 'Total Available Materials Across All Departments'
FROM 
    TIP_SUBJECT_OFFERED tso
JOIN 
    TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY
JOIN 
    TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY
LEFT JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL lrd ON tso.LIBRARY_SUBJECT_OFFERED_KEY = lrd.LIBRARY_SUBJECT_OFFERED_KEY
LEFT JOIN 
    LIBRARY_RESERVE_CATALOG lrc ON lrd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY
LEFT JOIN 
    LIBRARY_COURSE_INSTRUCTOR lci ON lrd.LIBRARY_COURSE_INSTRUCTOR_KEY = lci.LIBRARY_COURSE_INSTRUCTOR_KEY
GROUP BY 
    tso.OFFER_DEPT_NAME, 
    tm.TITLE, 
    tm.AUTHOR, 
    tm.ISBN,
    tso.TERM_CODE,
    lrc.CATALOG_ISBN
ORDER BY 
    tso.OFFER_DEPT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2850, 408
TOTAL                  : 196698, 179098, 17600
AVG                    : 2489.85, 2267.06, 222.78
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL_STATUS
[
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TIP_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['PC', 'NL', '  ']),
(TIP_MATERIAL_STATUS:VARCHAR2, Examples: ['Val-u option', 'Course has no materials', 'Electronic options']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
For each department and material status, list the name of the department, the material status, the number of TIP materials associated with this department and status, the number of library materials associated with this department and status, the total number of TIP and library materials associated with this department and status. Include a subtotal for each department and a grand total across all departments.

(Hints: Schema Mapping Hints:
- 'name of the department' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'material status' is related to TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS
- 'TIP materials' is related to TIP_DETAIL.TIP_MATERIAL_KEY
- 'library materials' is related to LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY

Join Information: (TIP_DETAIL.TIP_SUBJECT_OFFERED_KEY = TIP_SUBJECT_OFFERED.TIP_SUBJECT_OFFERED_KEY), (TIP_MATERIAL_STATUS.TIP_MATERIAL_STATUS_KEY = TIP_DETAIL.TIP_MATERIAL_STATUS_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoY6mpco3esld8fPBKwZdPYl34Ip', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nWITH TIP_STATS AS (\n    SELECT \n        TSO.OFFER_DEPT_NAME,\n        TMS.TIP_MATERIAL_STATUS,\n        COUNT(DISTINCT TD.TIP_MATERIAL_KEY) AS TIP_MATERIAL_COUNT\n    FROM \n        TIP_DETAIL TD\n    JOIN \n        TIP_SUBJECT_OFFERED TSO ON TD.TIP_SUBJECT_OFFERED_KEY = TSO.TIP_SUBJECT_OFFERED_KEY\n    JOIN \n        TIP_MATERIAL_STATUS TMS ON TMS.TIP_MATERIAL_STATUS_KEY = TD.TIP_MATERIAL_STATUS_KEY\n    GROUP BY \n        TSO.OFFER_DEPT_NAME, TMS.TIP_MATERIAL_STATUS\n),\nLIBRARY_STATS AS (\n    SELECT \n        LSO.OFFER_DEPT_NAME,\n        LMS.LIBRARY_MATERIAL_STATUS,\n        COUNT(DISTINCT LRM.LIBRARY_RESERVE_CATALOG_KEY) AS LIBRARY_MATERIAL_COUNT\n    FROM \n        LIBRARY_RESERVE_MATRL_DETAIL LRM\n    JOIN \n        LIBRARY_SUBJECT_OFFERED LSO ON LRM.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY\n    JOIN \n        LIBRARY_MATERIAL_STATUS LMS ON LMS.LIBRARY_MATERIAL_STATUS_KEY = LRM.LIBRARY_MATERIAL_STATUS_KEY\n    GROUP BY \n        LSO.OFFER_DEPT_NAME, LMS.LIBRARY_MATERIAL_STATUS\n)\nSELECT \n    COALESCE(TS.OFFER_DEPT_NAME, LS.OFFER_DEPT_NAME) AS DEPARTMENT,\n    COALESCE(TS.TIP_MATERIAL_STATUS, LS.LIBRARY_MATERIAL_STATUS) AS MATERIAL_STATUS,\n    COALESCE(TS.TIP_MATERIAL_COUNT, 0) AS TIP_MATERIAL_COUNT,\n    COALESCE(LS.LIBRARY_MATERIAL_COUNT, 0) AS LIBRARY_MATERIAL_COUNT,\n    COALESCE(TS.TIP_MATERIAL_COUNT, 0) + COALESCE(LS.LIBRARY_MATERIAL_COUNT, 0) AS TOTAL_MATERIAL_COUNT\nFROM \n    TIP_STATS TS\nFULL OUTER JOIN \n    LIBRARY_STATS LS ON TS.OFFER_DEPT_NAME = LS.OFFER_DEPT_NAME AND TS.TIP_MATERIAL_STATUS = LS.LIBRARY_MATERIAL_STATUS\nORDER BY \n    DEPARTMENT, MATERIAL_STATUS;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180058, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=481, prompt_tokens=2185, total_tokens=2666, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=481, prompt_tokens=2185, total_tokens=2666, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH TIP_STATS AS (
    SELECT 
        TSO.OFFER_DEPT_NAME,
        TMS.TIP_MATERIAL_STATUS,
        COUNT(DISTINCT TD.TIP_MATERIAL_KEY) AS TIP_MATERIAL_COUNT
    FROM 
        TIP_DETAIL TD
    JOIN 
        TIP_SUBJECT_OFFERED TSO ON TD.TIP_SUBJECT_OFFERED_KEY = TSO.TIP_SUBJECT_OFFERED_KEY
    JOIN 
        TIP_MATERIAL_STATUS TMS ON TMS.TIP_MATERIAL_STATUS_KEY = TD.TIP_MATERIAL_STATUS_KEY
    GROUP BY 
        TSO.OFFER_DEPT_NAME, TMS.TIP_MATERIAL_STATUS
),
LIBRARY_STATS AS (
    SELECT 
        LSO.OFFER_DEPT_NAME,
        LMS.LIBRARY_MATERIAL_STATUS,
        COUNT(DISTINCT LRM.LIBRARY_RESERVE_CATALOG_KEY) AS LIBRARY_MATERIAL_COUNT
    FROM 
        LIBRARY_RESERVE_MATRL_DETAIL LRM
    JOIN 
        LIBRARY_SUBJECT_OFFERED LSO ON LRM.LIBRARY_SUBJECT_OFFERED_KEY = LSO.LIBRARY_SUBJECT_OFFERED_KEY
    JOIN 
        LIBRARY_MATERIAL_STATUS LMS ON LMS.LIBRARY_MATERIAL_STATUS_KEY = LRM.LIBRARY_MATERIAL_STATUS_KEY
    GROUP BY 
        LSO.OFFER_DEPT_NAME, LMS.LIBRARY_MATERIAL_STATUS
)
SELECT 
    COALESCE(TS.OFFER_DEPT_NAME, LS.OFFER_DEPT_NAME) AS DEPARTMENT,
    COALESCE(TS.TIP_MATERIAL_STATUS, LS.LIBRARY_MATERIAL_STATUS) AS MATERIAL_STATUS,
    COALESCE(TS.TIP_MATERIAL_COUNT, 0) AS TIP_MATERIAL_COUNT,
    COALESCE(LS.LIBRARY_MATERIAL_COUNT, 0) AS LIBRARY_MATERIAL_COUNT,
    COALESCE(TS.TIP_MATERIAL_COUNT, 0) + COALESCE(LS.LIBRARY_MATERIAL_COUNT, 0) AS TOTAL_MATERIAL_COUNT
FROM 
    TIP_STATS TS
FULL OUTER JOIN 
    LIBRARY_STATS LS ON TS.OFFER_DEPT_NAME = LS.OFFER_DEPT_NAME AND TS.TIP_MATERIAL_STATUS = LS.LIBRARY_MATERIAL_STATUS
ORDER BY 
    DEPARTMENT, MATERIAL_STATUS;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2185, 481
TOTAL                  : 199364, 181283, 18081
AVG                    : 2492.05, 2266.04, 226.01
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]

### Question ###
For each building that is not a subdivision, list the building number, full name, street address, building type, occupancy date, ownership type, and site location. You should also include three rows at the end showing the number of owned, leased, all buildings at MIT that are not subdivisions, in the format of (null, #building Buildings, null, null, null, null, null).

(Hints: Schema Mapping Hints:
- 'subdivision' is related to FAC_BUILDING.PARENT_BUILDING_NUMBER
- 'building number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'full name' is related to FAC_BUILDING.BUILDING_NAME_LONG
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'building type' is related to FAC_BUILDING.BUILDING_TYPE
- 'occupancy date' is related to FAC_BUILDING.DATE_OCCUPIED
- 'ownership type' is related to FAC_BUILDING.OWNERSHIP_TYPE
- 'site location' is related to FAC_BUILDING.SITE

Join Information: (FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoYGP1Ql9UDOCzC4nzCXt5PUbqar', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    FB.BUILDING_NUMBER,\n    FB.BUILDING_NAME_LONG AS full_name,\n    B.BUILDING_STREET_ADDRESS AS street_address,\n    FB.BUILDING_TYPE,\n    FB.DATE_OCCUPIED AS occupancy_date,\n    FB.OWNERSHIP_TYPE,\n    FB.SITE\nFROM \n    FAC_BUILDING FB\nJOIN \n    BUILDINGS B ON FB.FAC_BUILDING_KEY = B.BUILDING_KEY\nLEFT JOIN \n    FAC_BUILDING_ADDRESS FBA ON FBA.BUILDING_KEY = FB.FAC_BUILDING_KEY\nWHERE \n    FB.PARENT_BUILDING_NUMBER IS NULL\n\nUNION ALL\n\nSELECT \n    NULL, \n    COUNT(*) AS owned_buildings, \n    NULL, \n    NULL, \n    NULL, \n    NULL, \n    NULL\nFROM \n    FAC_BUILDING \nWHERE \n    OWNERSHIP_TYPE = 'OWNED' AND \n    PARENT_BUILDING_NUMBER IS NULL\n\nUNION ALL\n\nSELECT \n    NULL, \n    COUNT(*) AS leased_buildings, \n    NULL, \n    NULL, \n    NULL, \n    NULL, \n    NULL\nFROM \n    FAC_BUILDING \nWHERE \n    OWNERSHIP_TYPE = 'LEASED' AND \n    PARENT_BUILDING_NUMBER IS NULL\n\nUNION ALL\n\nSELECT \n    NULL, \n    COUNT(*) AS all_buildings, \n    NULL, \n    NULL, \n    NULL, \n    NULL, \n    NULL\nFROM \n    FAC_BUILDING \nWHERE \n    PARENT_BUILDING_NUMBER IS NULL;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180068, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=323, prompt_tokens=1797, total_tokens=2120, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=323, prompt_tokens=1797, total_tokens=2120, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    FB.BUILDING_NUMBER,
    FB.BUILDING_NAME_LONG AS full_name,
    B.BUILDING_STREET_ADDRESS AS street_address,
    FB.BUILDING_TYPE,
    FB.DATE_OCCUPIED AS occupancy_date,
    FB.OWNERSHIP_TYPE,
    FB.SITE
FROM 
    FAC_BUILDING FB
JOIN 
    BUILDINGS B ON FB.FAC_BUILDING_KEY = B.BUILDING_KEY
LEFT JOIN 
    FAC_BUILDING_ADDRESS FBA ON FBA.BUILDING_KEY = FB.FAC_BUILDING_KEY
WHERE 
    FB.PARENT_BUILDING_NUMBER IS NULL

UNION ALL

SELECT 
    NULL, 
    COUNT(*) AS owned_buildings, 
    NULL, 
    NULL, 
    NULL, 
    NULL, 
    NULL
FROM 
    FAC_BUILDING 
WHERE 
    OWNERSHIP_TYPE = 'OWNED' AND 
    PARENT_BUILDING_NUMBER IS NULL

UNION ALL

SELECT 
    NULL, 
    COUNT(*) AS leased_buildings, 
    NULL, 
    NULL, 
    NULL, 
    NULL, 
    NULL
FROM 
    FAC_BUILDING 
WHERE 
    OWNERSHIP_TYPE = 'LEASED' AND 
    PARENT_BUILDING_NUMBER IS NULL

UNION ALL

SELECT 
    NULL, 
    COUNT(*) AS all_buildings, 
    NULL, 
    NULL, 
    NULL, 
    NULL, 
    NULL
FROM 
    FAC_BUILDING 
WHERE 
    PARENT_BUILDING_NUMBER IS NULL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1797, 323
TOTAL                  : 201484, 183080, 18404
AVG                    : 2487.46, 2260.25, 227.21
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]

### Question ###
For each owned building that is not a subdivision, list the construction start year, the building number, and the year of initial occupancy. Display the construction start year only if it differs from the previous row. If the year of initial occupancy or construction start year is unknown, display 'UNKNOWN'. You should also include a row at the end showing the total number of owned buildings that are not subdivisions, in the format of (null, #building Buildings, null).

(Hints: Schema Mapping Hints:
- 'subdivision' is related to FAC_BUILDING.PARENT_BUILDING_NUMBER
- 'construction start year' is related to FAC_BUILDING.DATE_BUILT
- 'building number' is related to FAC_BUILDING.PARENT_BUILDING_NUMBER
- 'year of initial occupancy' is related to FAC_BUILDING.DATE_OCCUPIED)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoYNmh6ckalfYCL9J8KQY0epB4F6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH OwnedBuildings AS (\n    SELECT \n        IFNULL(YEAR(FAC.DATE_BUILT), 'UNKNOWN') AS ConstructionYear,\n        FAC.BUILDING_NUMBER,\n        IFNULL(YEAR(FAC.DATE_OCCUPIED), 'UNKNOWN') AS OccupancyYear\n    FROM \n        FAC_BUILDING FAC\n    WHERE \n        FAC.OWNERSHIP_TYPE = 'OWNED' \n        AND FAC.PARENT_BUILDING_NUMBER IS NULL\n),\nDistinctYears AS (\n    SELECT \n        DISTINCT ConstructionYear,\n        BUILDING_NUMBER,\n        OccupancyYear\n    FROM \n        OwnedBuildings\n),\nFinalOutput AS (\n    SELECT \n        ConstructionYear,\n        BUILDING_NUMBER,\n        OccupancyYear\n    FROM (\n        SELECT \n            D. ConstructionYear,\n            D.BUILDING_NUMBER,\n            D.OccupancyYear,\n            @prevYear AS PrevYear,\n            @prevYear := D.ConstructionYear\n        FROM \n            DistinctYears D,\n            (SELECT @prevYear := NULL) AS init\n    ) AS Result\n    WHERE \n        Result.ConstructionYear <> Result.PrevYear OR Result.PrevYear IS NULL\n)\nSELECT \n    ConstructionYear, \n    BUILDING_NUMBER, \n    OccupancyYear \nFROM \n    FinalOutput\n\nUNION ALL\n\nSELECT \n    NULL, \n    COUNT(*) || ' owned buildings', \n    NULL \nFROM \n    FAC_BUILDING \nWHERE \n    OWNERSHIP_TYPE = 'OWNED' \n    AND PARENT_BUILDING_NUMBER IS NULL;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180075, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=314, prompt_tokens=1157, total_tokens=1471, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=314, prompt_tokens=1157, total_tokens=1471, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH OwnedBuildings AS (
    SELECT 
        IFNULL(YEAR(FAC.DATE_BUILT), 'UNKNOWN') AS ConstructionYear,
        FAC.BUILDING_NUMBER,
        IFNULL(YEAR(FAC.DATE_OCCUPIED), 'UNKNOWN') AS OccupancyYear
    FROM 
        FAC_BUILDING FAC
    WHERE 
        FAC.OWNERSHIP_TYPE = 'OWNED' 
        AND FAC.PARENT_BUILDING_NUMBER IS NULL
),
DistinctYears AS (
    SELECT 
        DISTINCT ConstructionYear,
        BUILDING_NUMBER,
        OccupancyYear
    FROM 
        OwnedBuildings
),
FinalOutput AS (
    SELECT 
        ConstructionYear,
        BUILDING_NUMBER,
        OccupancyYear
    FROM (
        SELECT 
            D. ConstructionYear,
            D.BUILDING_NUMBER,
            D.OccupancyYear,
            @prevYear AS PrevYear,
            @prevYear := D.ConstructionYear
        FROM 
            DistinctYears D,
            (SELECT @prevYear := NULL) AS init
    ) AS Result
    WHERE 
        Result.ConstructionYear <> Result.PrevYear OR Result.PrevYear IS NULL
)
SELECT 
    ConstructionYear, 
    BUILDING_NUMBER, 
    OccupancyYear 
FROM 
    FinalOutput

UNION ALL

SELECT 
    NULL, 
    COUNT(*) || ' owned buildings', 
    NULL 
FROM 
    FAC_BUILDING 
WHERE 
    OWNERSHIP_TYPE = 'OWNED' 
    AND PARENT_BUILDING_NUMBER IS NULL;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1157, 314
TOTAL                  : 202955, 184237, 18718
AVG                    : 2475.06, 2246.79, 228.27
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING_HIST
[
(FCLT_BUILDING_HIST_KEY:VARCHAR2, Examples: ['14S-201505', '46-201505', 'E14-201505']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['201505', '201506', '201507']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['14S', '46', 'E14']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['14', 'W61', 'W70']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY', 'MACGREGOR HOUSE', 'NEW HOUSE']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library', 'Frank S MacGregor House', 'New West Campus Houses']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library (South Wing)', 'Brain & Cognitive Sciences Complex', 'Building E14']),
(EXT_GROSS_AREA:NUMBER, Examples: [48622.2, 418663.0, 173875.0]),
(ASSIGNABLE_AREA:NUMBER, Examples: [34500.5, 218519.0, 73792.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [10286.5, 152699.0, 83752.7]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHWEST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['(NULL)', 'UGBA3', 'UGBI2']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['136.4', '82.8', '88.3']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3623, 42.3605, 42.3615]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0916, -71.0873, -71.0879]),
(EASTING_X_SPCS:NUMBER, Examples: [766530.0, 767698.0, 767547.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2957330.0, 2956650.0, 2957020.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['14S', '46', 'E14']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['SEELY G. MUDD', 'HORACE SAYFORD FORD JR.', 'SEBASTIAN S. KRESGE']),
(BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY (S)', 'BCSC', 'BUILDING E14']),
(DATE_BUILT:VARCHAR2, Examples: ['04/25/2003', '12/31/1932', '12/31/1920']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['05/01/1961', '12/31/1955', '12/31/1939']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['09/01/2005', '03/06/1975', '10/01/1964']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-DEC-14', '01-JAN-15', '01-FEB-15']),
(NUM_OF_ROOMS:NUMBER, Examples: [118, 1403, 341])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group all buildings at MIT into either owned or leased. For each group, state the ownership type, usage type, number of buildings, gross square footage, number of rooms, and the number of associated organizations. Display the ownership type only if it differs from the previous row. Include subtotals for each group and a grand total across all groups. The subtotal and grand total rows should not include ownership type and usage type. Footage should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'buildings at MIT' is related to FCLT_BUILDING_HIST.SITE
- 'ownership type' is related to FCLT_BUILDING_HIST.OWNERSHIP_TYPE
- 'usage type' is related to FCLT_BUILDING_HIST.BUILDING_USE
- 'buildings' is related to FCLT_BUILDING_HIST.PARENT_BUILDING_NUMBER, FCLT_BUILDING_HIST.FCLT_BUILDING_KEY
- 'gross square footage' is related to FCLT_BUILDING_HIST.EXT_GROSS_AREA
- 'rooms' is related to FCLT_ROOMS.FCLT_ROOM_KEY
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY

Join Information: (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING_HIST.FCLT_BUILDING_KEY), (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FCLT_ROOMS.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoYTS5rad9vDL4Gv3QDjOPI7lOsY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH BuildingStats AS (\n    SELECT \n        FCLT_BUILDING_HIST.OWNERSHIP_TYPE,\n        FCLT_BUILDING_HIST.BUILDING_USE,\n        COUNT(DISTINCT FCLT_BUILDING_HIST.FCLT_BUILDING_KEY) AS Num_Buildings,\n        ROUND(SUM(FCLT_BUILDING_HIST.EXT_GROSS_AREA)) AS Total_Gross_SQ_FT,\n        COUNT(DISTINCT FCLT_ROOMS.FCLT_ROOM_KEY) AS Num_Rooms,\n        COUNT(DISTINCT FCLT_ROOMS.FCLT_ORGANIZATION_KEY) AS Num_Organizations\n    FROM \n        FCLT_BUILDING_HIST\n    LEFT JOIN \n        FCLT_ROOMS ON FCLT_BUILDING_HIST.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY\n    WHERE \n        FCLT_BUILDING_HIST.SITE = 'MIT'\n    GROUP BY \n        FCLT_BUILDING_HIST.OWNERSHIP_TYPE, FCLT_BUILDING_HIST.BUILDING_USE\n),\nSubtotals AS (\n    SELECT \n        Ownership_Type, \n        SUM(Num_Buildings) AS Subtotal_Buildings,\n        SUM(Total_Gross_SQ_FT) AS Subtotal_Gross_SQ_FT,\n        SUM(Num_Rooms) AS Subtotal_Rooms,\n        SUM(Num_Organizations) AS Subtotal_Organizations\n    FROM \n        BuildingStats\n    GROUP BY \n        Ownership_Type\n),\nGrandTotal AS (\n    SELECT \n        SUM(Num_Buildings) AS Total_Buildings,\n        SUM(Total_Gross_SQ_FT) AS Total_Gross_SQ_FT,\n        SUM(Num_Rooms) AS Total_Rooms,\n        SUM(Num_Organizations) AS Total_Organizations\n    FROM \n        BuildingStats\n)\n\nSELECT \n    s.Ownership_Type,\n    s.Building_Use,\n    s.Num_Buildings,\n    s.Total_Gross_SQ_FT,\n    s.Num_Rooms,\n    s.Num_Organizations\nFROM \n    BuildingStats s\n\nUNION ALL\n\nSELECT \n    NULL,\n    NULL,\n    st.Subtotal_Buildings,\n    st.Subtotal_Gross_SQ_FT,\n    st.Subtotal_Rooms,\n    st.Subtotal_Organizations\nFROM \n    Subtotals st\n\nUNION ALL\n\nSELECT \n    NULL,\n    NULL,\n    gt.Total_Buildings,\n    gt.Total_Gross_SQ_FT,\n    gt.Total_Rooms,\n    gt.Total_Organizations\nFROM \n    GrandTotal gt\n\nORDER BY \n    Ownership_Type, Building_Use;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180081, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=567, prompt_tokens=2346, total_tokens=2913, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=567, prompt_tokens=2346, total_tokens=2913, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH BuildingStats AS (
    SELECT 
        FCLT_BUILDING_HIST.OWNERSHIP_TYPE,
        FCLT_BUILDING_HIST.BUILDING_USE,
        COUNT(DISTINCT FCLT_BUILDING_HIST.FCLT_BUILDING_KEY) AS Num_Buildings,
        ROUND(SUM(FCLT_BUILDING_HIST.EXT_GROSS_AREA)) AS Total_Gross_SQ_FT,
        COUNT(DISTINCT FCLT_ROOMS.FCLT_ROOM_KEY) AS Num_Rooms,
        COUNT(DISTINCT FCLT_ROOMS.FCLT_ORGANIZATION_KEY) AS Num_Organizations
    FROM 
        FCLT_BUILDING_HIST
    LEFT JOIN 
        FCLT_ROOMS ON FCLT_BUILDING_HIST.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY
    WHERE 
        FCLT_BUILDING_HIST.SITE = 'MIT'
    GROUP BY 
        FCLT_BUILDING_HIST.OWNERSHIP_TYPE, FCLT_BUILDING_HIST.BUILDING_USE
),
Subtotals AS (
    SELECT 
        Ownership_Type, 
        SUM(Num_Buildings) AS Subtotal_Buildings,
        SUM(Total_Gross_SQ_FT) AS Subtotal_Gross_SQ_FT,
        SUM(Num_Rooms) AS Subtotal_Rooms,
        SUM(Num_Organizations) AS Subtotal_Organizations
    FROM 
        BuildingStats
    GROUP BY 
        Ownership_Type
),
GrandTotal AS (
    SELECT 
        SUM(Num_Buildings) AS Total_Buildings,
        SUM(Total_Gross_SQ_FT) AS Total_Gross_SQ_FT,
        SUM(Num_Rooms) AS Total_Rooms,
        SUM(Num_Organizations) AS Total_Organizations
    FROM 
        BuildingStats
)

SELECT 
    s.Ownership_Type,
    s.Building_Use,
    s.Num_Buildings,
    s.Total_Gross_SQ_FT,
    s.Num_Rooms,
    s.Num_Organizations
FROM 
    BuildingStats s

UNION ALL

SELECT 
    NULL,
    NULL,
    st.Subtotal_Buildings,
    st.Subtotal_Gross_SQ_FT,
    st.Subtotal_Rooms,
    st.Subtotal_Organizations
FROM 
    Subtotals st

UNION ALL

SELECT 
    NULL,
    NULL,
    gt.Total_Buildings,
    gt.Total_Gross_SQ_FT,
    gt.Total_Rooms,
    gt.Total_Organizations
FROM 
    GrandTotal gt

ORDER BY 
    Ownership_Type, Building_Use;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2346, 567
TOTAL                  : 205868, 186583, 19285
AVG                    : 2480.34, 2247.99, 232.35
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each building use, list the type, the number of distinct buildings (excluding subdivisions) of this use, the total gross square footage of these buildings, and the number of unique organizations associated with the rooms in these buildings. If the building is used as a residence, display the usage type as "RESIDENTIAL." You should also include a row at the end showing the total number of buildings, the gross square footage, and the number of organizations across all types of building use. All numerical values should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'building use' is related to FCLT_BUILDING.BUILDING_USE
- 'buildings' is related to FCLT_BUILDING.PARENT_BUILDING_NUMBER, FCLT_BUILDING.FCLT_BUILDING_KEY
- 'gross square footage' is related to FCLT_BUILDING.EXT_GROSS_AREA
- 'organizations' is related to FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY

Join Information: (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoYdekjQFLy1gGYJQkpVIoACFKCT', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH BuildingStats AS (\n    SELECT \n        CASE \n            WHEN FB.BUILDING_USE = 'RESIDENT' THEN 'RESIDENTIAL' \n            ELSE FB.BUILDING_USE \n        END AS BUILDING_USE,\n        COUNT(DISTINCT FB.FCLT_BUILDING_KEY) AS num_buildings,\n        SUM(FB.EXT_GROSS_AREA) AS total_gross_area,\n        COUNT(DISTINCT FR.FCLT_ORGANIZATION_KEY) AS num_organizations\n    FROM \n        FCLT_BUILDING FB\n    JOIN \n        FCLT_ROOMS FR ON FB.FCLT_BUILDING_KEY = FR.FCLT_BUILDING_KEY\n    WHERE \n        FB.PARENT_BUILDING_NUMBER IS NULL\n    GROUP BY \n        CASE \n            WHEN FB.BUILDING_USE = 'RESIDENT' THEN 'RESIDENTIAL' \n            ELSE FB.BUILDING_USE \n        END\n), Summary AS (\n    SELECT \n        SUM(num_buildings) AS total_buildings,\n        SUM(total_gross_area) AS total_gross_area,\n        SUM(num_organizations) AS total_num_organizations\n    FROM \n        BuildingStats\n)\nSELECT \n    BUILDING_USE, \n    num_buildings AS building_type, \n    ROUND(total_gross_area) AS total_gross_sqft, \n    num_organizations AS unique_organizations\nFROM \n    BuildingStats\n\nUNION ALL\n\nSELECT \n    'TOTAL' AS BUILDING_USE, \n    total_buildings AS building_type, \n    ROUND(total_gross_area) AS total_gross_sqft, \n    total_num_organizations AS unique_organizations\nFROM \n    Summary\nORDER BY \n    BUILDING_USE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180091, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=351, prompt_tokens=2281, total_tokens=2632, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=351, prompt_tokens=2281, total_tokens=2632, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
WITH BuildingStats AS (
    SELECT 
        CASE 
            WHEN FB.BUILDING_USE = 'RESIDENT' THEN 'RESIDENTIAL' 
            ELSE FB.BUILDING_USE 
        END AS BUILDING_USE,
        COUNT(DISTINCT FB.FCLT_BUILDING_KEY) AS num_buildings,
        SUM(FB.EXT_GROSS_AREA) AS total_gross_area,
        COUNT(DISTINCT FR.FCLT_ORGANIZATION_KEY) AS num_organizations
    FROM 
        FCLT_BUILDING FB
    JOIN 
        FCLT_ROOMS FR ON FB.FCLT_BUILDING_KEY = FR.FCLT_BUILDING_KEY
    WHERE 
        FB.PARENT_BUILDING_NUMBER IS NULL
    GROUP BY 
        CASE 
            WHEN FB.BUILDING_USE = 'RESIDENT' THEN 'RESIDENTIAL' 
            ELSE FB.BUILDING_USE 
        END
), Summary AS (
    SELECT 
        SUM(num_buildings) AS total_buildings,
        SUM(total_gross_area) AS total_gross_area,
        SUM(num_organizations) AS total_num_organizations
    FROM 
        BuildingStats
)
SELECT 
    BUILDING_USE, 
    num_buildings AS building_type, 
    ROUND(total_gross_area) AS total_gross_sqft, 
    num_organizations AS unique_organizations
FROM 
    BuildingStats

UNION ALL

SELECT 
    'TOTAL' AS BUILDING_USE, 
    total_buildings AS building_type, 
    ROUND(total_gross_area) AS total_gross_sqft, 
    total_num_organizations AS unique_organizations
FROM 
    Summary
ORDER BY 
    BUILDING_USE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2281, 351
TOTAL                  : 208500, 188864, 19636
AVG                    : 2482.14, 2248.38, 233.76
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MASTER_DEPT_HIERARCHY
[
(HIERARCHY_TYPE:VARCHAR2, Examples: ['Standard Hierarchy']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_CODE:VARCHAR2, Examples: ['D_DOF_CORE', 'D_DOF_RESERVE', 'D_DOF_RESIDENCE']),
(DLC_NAME:VARCHAR2, Examples: ['Facilities Building Core (hallways, stairs, etc.)', 'Facilities Provost Reserved', 'Facilities Residences']),
(MASTER_DEPT_HIER_LEVEL_1_CODE:VARCHAR2, Examples: ['D_ALL']),
(MASTER_DEPT_HIER_LEVEL_1_NAME:VARCHAR2, Examples: ['All Departments']),
(MASTER_DEPT_HIER_LEVEL_2_CODE:VARCHAR2, Examples: ['D_EXECVP_AREA', 'D_PROVOST_AREA', 'D_PRES_AREA']),
(MASTER_DEPT_HIER_LEVEL_2_NAME:VARCHAR2, Examples: ['Executive Vice President's Area', 'Provost Area', 'President's area']),
(MASTER_DEPT_HIER_LEVEL_3_CODE:VARCHAR2, Examples: ['D_FINANCE_AREA', 'D_TREAS_AREA', 'D_SC_ENVP']),
(MASTER_DEPT_HIER_LEVEL_3_NAME:VARCHAR2, Examples: ['VP Finance Area', 'Treasurer's Area', 'Senior Council and Environmental Programs']),
(MASTER_DEPT_HIER_LEVEL_4_CODE:VARCHAR2, Examples: ['D_SOURCING_AREA', 'D_OSATT_AREA']),
(MASTER_DEPT_HIER_LEVEL_4_NAME:VARCHAR2, Examples: ['Sourcing Area', 'Office of Strategic Alliances & Tech Transfer Area']),
(MASTER_DEPT_HIER_LEVEL_5_CODE:VARCHAR2),
(MASTER_DEPT_HIER_LEVEL_5_NAME:VARCHAR2)
]

### Question ###
For each organization except Cambridge-MIT Institute, list its ID, number, level, formatted name according to level (if level is 2, there should be 1 space before the name, if level is 3, there should be 2 space before the name, up to level 6), whether it is assignable ('ASSIGNABLE' if assignable, 'NON-ASSIGNABLE' otherwise), total area, number of rooms, and average room area. Area and number of rooms should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'Cambridge-MIT Institute' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'ID' is related to FCLT_ORGANIZATION.ORGANIZATION_ID
- 'number' is related to FCLT_ORGANIZATION.ORGANIZATION_NUMBER
- 'level' is related to FCLT_ORGANIZATION.ORGANIZATION_LEVEL
- 'name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'assignable' is related to FCLT_ORGANIZATION.ASSIGNABLE
- 'area' is related to FCLT_ROOMS.AREA
- 'rooms' is related to FCLT_ROOMS.ROOM
- 'room area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FCLT_ROOMS.FCLT_ORGANIZATION_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY), (FCLT_ROOMS.FCLT_ORGANIZATION_KEY = FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY), (FCLT_ORGANIZATION.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoYkoi9OrzASfVGC2i1o5x3CwcVY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    FO.ORGANIZATION_ID, \n    FORMAT(FO.ORGANIZATION_NUMBER, 'N0') AS ORGANIZATION_NUMBER,\n    FO.ORGANIZATION_LEVEL,\n    REPLACE(REPLACE(IF(FO.ORGANIZATION_LEVEL = '1', FO.ORGANIZATION_NAME,\n        IF(FO.ORGANIZATION_LEVEL = '2', CONCAT(' ', FO.ORGANIZATION_NAME),\n        IF(FO.ORGANIZATION_LEVEL = '3', CONCAT('  ', FO.ORGANIZATION_NAME),\n        IF(FO.ORGANIZATION_LEVEL = '4', CONCAT('   ', FO.ORGANIZATION_NAME),\n        IF(FO.ORGANIZATION_LEVEL = '5', CONCAT('    ', FO.ORGANIZATION_NAME),\n        IF(FO.ORGANIZATION_LEVEL = '6', CONCAT('     ', FO.ORGANIZATION_NAME), FO.ORGANIZATION_NAME))))))), ' ', ' '),\n    FO.ASSIGNABLE, \n    FORMAT(SUM(FR.AREA), 'N0') AS TOTAL_AREA,\n    COUNT(DISTINCT FR.ROOM) AS NUMBER_OF_ROOMS,\n    FORMAT(AVG(FR.AREA), 'N0') AS AVERAGE_ROOM_AREA\nFROM \n    FCLT_ORGANIZATION FO\nJOIN \n    FCLT_ROOMS FR ON FO.FCLT_ORGANIZATION_KEY = FR.FCLT_ORGANIZATION_KEY\nWHERE \n    FO.ORGANIZATION_NAME <> 'Cambridge-MIT Institute'\nGROUP BY \n    FO.ORGANIZATION_ID, \n    FO.ORGANIZATION_NUMBER, \n    FO.ORGANIZATION_LEVEL, \n    FO.ORGANIZATION_NAME, \n    FO.ASSIGNABLE\nORDER BY \n    FO.ORGANIZATION_ID;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180098, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=349, prompt_tokens=1872, total_tokens=2221, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=349, prompt_tokens=1872, total_tokens=2221, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    FO.ORGANIZATION_ID, 
    FORMAT(FO.ORGANIZATION_NUMBER, 'N0') AS ORGANIZATION_NUMBER,
    FO.ORGANIZATION_LEVEL,
    REPLACE(REPLACE(IF(FO.ORGANIZATION_LEVEL = '1', FO.ORGANIZATION_NAME,
        IF(FO.ORGANIZATION_LEVEL = '2', CONCAT(' ', FO.ORGANIZATION_NAME),
        IF(FO.ORGANIZATION_LEVEL = '3', CONCAT('  ', FO.ORGANIZATION_NAME),
        IF(FO.ORGANIZATION_LEVEL = '4', CONCAT('   ', FO.ORGANIZATION_NAME),
        IF(FO.ORGANIZATION_LEVEL = '5', CONCAT('    ', FO.ORGANIZATION_NAME),
        IF(FO.ORGANIZATION_LEVEL = '6', CONCAT('     ', FO.ORGANIZATION_NAME), FO.ORGANIZATION_NAME))))))), ' ', ' '),
    FO.ASSIGNABLE, 
    FORMAT(SUM(FR.AREA), 'N0') AS TOTAL_AREA,
    COUNT(DISTINCT FR.ROOM) AS NUMBER_OF_ROOMS,
    FORMAT(AVG(FR.AREA), 'N0') AS AVERAGE_ROOM_AREA
FROM 
    FCLT_ORGANIZATION FO
JOIN 
    FCLT_ROOMS FR ON FO.FCLT_ORGANIZATION_KEY = FR.FCLT_ORGANIZATION_KEY
WHERE 
    FO.ORGANIZATION_NAME <> 'Cambridge-MIT Institute'
GROUP BY 
    FO.ORGANIZATION_ID, 
    FO.ORGANIZATION_NUMBER, 
    FO.ORGANIZATION_LEVEL, 
    FO.ORGANIZATION_NAME, 
    FO.ASSIGNABLE
ORDER BY 
    FO.ORGANIZATION_ID;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1872, 349
TOTAL                  : 210721, 190736, 19985
AVG                    : 2479.07, 2243.95, 235.12
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_MAJOR_USE
[
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE:VARCHAR2, Examples: ['BLDG SRV', 'CIRCULAT', 'CLASSRMS']),
(DESCRIPTION:VARCHAR2, Examples: ['BLDG SERVICE AREA', 'CIRCULATION AREA', 'CLASSROOMS']),
(ASSIGNABLE:VARCHAR2, Examples: ['0', '1']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group all rooms into whether or not they are assignable and the major use descriptions. For each group, state "ASSIGNABLE" if the room is assignable and "NON-ASSIGNABLE" otherwise, the major use description, the total number of rooms, total area, and average area. Include subtotals for each group and a grand total across all groups. The assignable status and major use descriptions should only be displayed when they differ from the previous row. Do not include rooms whose major use or major use description starts with 'ZUSE.' The results should be sorted by assignable status and major use description. The subtotal and grand total rows should not include assignable status or major use description.

(Hints: Schema Mapping Hints:
- 'rooms' is related to FCLT_ROOMS.ROOM
- 'assignable' is related to FCLT_MAJOR_USE.ASSIGNABLE
- 'major use description' is related to FCLT_MAJOR_USE.MAJOR_USE, FCLT_ROOMS.MAJOR_USE_DESC, FCLT_MAJOR_USE.DESCRIPTION
- 'area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_ROOMS.FCLT_MAJOR_USE_KEY = FCLT_MAJOR_USE.FCLT_MAJOR_USE_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoYq6lYlI0YWisQXfZpd9xTHIQrI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH RoomData AS (\n    SELECT \n        CASE WHEN fr.ASSIGNABLE = '1' THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END AS Assignable_Status,\n        fm.DESCRIPTION AS Major_Use_Description,\n        COUNT(fr.ROOM) AS Total_Rooms,\n        SUM(fr.AREA) AS Total_Area,\n        AVG(fr.AREA) AS Average_Area\n    FROM \n        FCLT_ROOMS fr\n    JOIN \n        FCLT_MAJOR_USE fm ON fr.FCLT_MAJOR_USE_KEY = fm.FCLT_MAJOR_USE_KEY\n    WHERE \n        fm.DESCRIPTION NOT LIKE 'ZUSE%'\n    GROUP BY \n        Assignable_Status, fm.DESCRIPTION\n)\nSELECT \n    Assignable_Status,\n    Major_Use_Description,\n    Total_Rooms,\n    Total_Area,\n    Average_Area\nFROM \n    RoomData\nUNION ALL\nSELECT \n    NULL AS Assignable_Status,\n    NULL AS Major_Use_Description,\n    SUM(Total_Rooms) AS Total_Rooms,\n    SUM(Total_Area) AS Total_Area,\n    AVG(Average_Area) AS Average_Area\nFROM \n    RoomData\nGROUP BY \n    NULL\nORDER BY \n    Assignable_Status, Major_Use_Description;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180104, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=276, prompt_tokens=1003, total_tokens=1279, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=276, prompt_tokens=1003, total_tokens=1279, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH RoomData AS (
    SELECT 
        CASE WHEN fr.ASSIGNABLE = '1' THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END AS Assignable_Status,
        fm.DESCRIPTION AS Major_Use_Description,
        COUNT(fr.ROOM) AS Total_Rooms,
        SUM(fr.AREA) AS Total_Area,
        AVG(fr.AREA) AS Average_Area
    FROM 
        FCLT_ROOMS fr
    JOIN 
        FCLT_MAJOR_USE fm ON fr.FCLT_MAJOR_USE_KEY = fm.FCLT_MAJOR_USE_KEY
    WHERE 
        fm.DESCRIPTION NOT LIKE 'ZUSE%'
    GROUP BY 
        Assignable_Status, fm.DESCRIPTION
)
SELECT 
    Assignable_Status,
    Major_Use_Description,
    Total_Rooms,
    Total_Area,
    Average_Area
FROM 
    RoomData
UNION ALL
SELECT 
    NULL AS Assignable_Status,
    NULL AS Major_Use_Description,
    SUM(Total_Rooms) AS Total_Rooms,
    SUM(Total_Area) AS Total_Area,
    AVG(Average_Area) AS Average_Area
FROM 
    RoomData
GROUP BY 
    NULL
ORDER BY 
    Assignable_Status, Major_Use_Description;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1003, 276
TOTAL                  : 212000, 191739, 20261
AVG                    : 2465.12, 2229.52, 235.59
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]

### Question ###
List each floor key and department name within the Stata building, as well as the number of rooms, total area, and average area per department on each floor. Include subtotals for each floor and a grand total across all floors. Sort the results by floor key and department name in ascending order. Exclude departments without any rooms in the building. Only the first row of each floor group should include the floor key, and the subtotal and grand total rows should not include floor key or department name. Number of rooms and area should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'floor key' is related to FAC_FLOOR.FLOOR_KEY
- 'department name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'Stata building' is related to BUILDINGS.BUILDING_NAME
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY
- 'area' is related to FAC_ROOMS.AREA

Join Information: (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = FAC_ROOMS.ORGANIZATION_KEY), (BUILDINGS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoYwYiFpBdfYQA6T6FMwFx97KS8G', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH RoomData AS (\n    SELECT \n        F.FLOOR_KEY,\n        FO.ORGANIZATION_NAME,\n        COUNT(R.FAC_ROOM_KEY) AS number_of_rooms,\n        SUM(R.AREA) AS total_area,\n        SUM(R.AREA) / NULLIF(COUNT(R.FAC_ROOM_KEY), 0) AS average_area\n    FROM \n        FAC_ROOMS R\n    JOIN \n        FCLT_ORGANIZATION FO ON R.ORGANIZATION_KEY = FO.FCLT_ORGANIZATION_KEY\n    JOIN \n        FAC_FLOOR F ON R.FLOOR_KEY = F.FLOOR_KEY\n    JOIN \n        BUILDINGS B ON R.BUILDING_KEY = B.BUILDING_KEY\n    WHERE \n        B.BUILDING_NAME = 'Stata building'\n    GROUP BY \n        F.FLOOR_KEY, FO.ORGANIZATION_NAME\n),\nSubtotalData AS (\n    SELECT \n        FLOOR_KEY,\n        NULL AS ORGANIZATION_NAME,\n        SUM(number_of_rooms) AS number_of_rooms,\n        SUM(total_area) AS total_area,\n        AVG(average_area) AS average_area\n    FROM \n        RoomData\n    GROUP BY \n        FLOOR_KEY\n)\nSELECT \n    CASE \n        WHEN R.FLOOR_KEY IS NOT NULL THEN R.FLOOR_KEY \n        ELSE NULL \n    END AS FLOOR_KEY,\n    CASE \n        WHEN R.ORGANIZATION_NAME IS NOT NULL THEN R.ORGANIZATION_NAME \n        ELSE NULL \n    END AS DEPARTMENT_NAME,\n    CAST(REGEXP_REPLACE(ROUND(R.number_of_rooms), '(\\\\d)(?=(\\\\d{3})+(?!\\\\d))', '\\\\1,') AS VARCHAR) AS number_of_rooms,\n    CAST(REGEXP_REPLACE(ROUND(R.total_area), '(\\\\d)(?=(\\\\d{3})+(?!\\\\d))', '\\\\1,') AS VARCHAR) AS total_area,\n    CAST(ROUND(R.average_area) AS VARCHAR) AS average_area\nFROM \n    RoomData R\nUNION ALL\nSELECT \n    NULL, \n    NULL, \n    CAST(REGEXP_REPLACE(ROUND(S.number_of_rooms), '(\\\\d)(?=(\\\\d{3})+(?!\\\\d))', '\\\\1,') AS VARCHAR) AS number_of_rooms,\n    CAST(REGEXP_REPLACE(ROUND(S.total_area), '(\\\\d)(?=(\\\\d{3})+(?!\\\\d))', '\\\\1,') AS VARCHAR) AS total_area,\n    NULL AS average_area\nFROM \n    SubtotalData S\nORDER BY \n    FLOOR_KEY, DEPARTMENT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180110, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=536, prompt_tokens=1814, total_tokens=2350, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=536, prompt_tokens=1814, total_tokens=2350, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH RoomData AS (
    SELECT 
        F.FLOOR_KEY,
        FO.ORGANIZATION_NAME,
        COUNT(R.FAC_ROOM_KEY) AS number_of_rooms,
        SUM(R.AREA) AS total_area,
        SUM(R.AREA) / NULLIF(COUNT(R.FAC_ROOM_KEY), 0) AS average_area
    FROM 
        FAC_ROOMS R
    JOIN 
        FCLT_ORGANIZATION FO ON R.ORGANIZATION_KEY = FO.FCLT_ORGANIZATION_KEY
    JOIN 
        FAC_FLOOR F ON R.FLOOR_KEY = F.FLOOR_KEY
    JOIN 
        BUILDINGS B ON R.BUILDING_KEY = B.BUILDING_KEY
    WHERE 
        B.BUILDING_NAME = 'Stata building'
    GROUP BY 
        F.FLOOR_KEY, FO.ORGANIZATION_NAME
),
SubtotalData AS (
    SELECT 
        FLOOR_KEY,
        NULL AS ORGANIZATION_NAME,
        SUM(number_of_rooms) AS number_of_rooms,
        SUM(total_area) AS total_area,
        AVG(average_area) AS average_area
    FROM 
        RoomData
    GROUP BY 
        FLOOR_KEY
)
SELECT 
    CASE 
        WHEN R.FLOOR_KEY IS NOT NULL THEN R.FLOOR_KEY 
        ELSE NULL 
    END AS FLOOR_KEY,
    CASE 
        WHEN R.ORGANIZATION_NAME IS NOT NULL THEN R.ORGANIZATION_NAME 
        ELSE NULL 
    END AS DEPARTMENT_NAME,
    CAST(REGEXP_REPLACE(ROUND(R.number_of_rooms), '(\\d)(?=(\\d{3})+(?!\\d))', '\\1,') AS VARCHAR) AS number_of_rooms,
    CAST(REGEXP_REPLACE(ROUND(R.total_area), '(\\d)(?=(\\d{3})+(?!\\d))', '\\1,') AS VARCHAR) AS total_area,
    CAST(ROUND(R.average_area) AS VARCHAR) AS average_area
FROM 
    RoomData R
UNION ALL
SELECT 
    NULL, 
    NULL, 
    CAST(REGEXP_REPLACE(ROUND(S.number_of_rooms), '(\\d)(?=(\\d{3})+(?!\\d))', '\\1,') AS VARCHAR) AS number_of_rooms,
    CAST(REGEXP_REPLACE(ROUND(S.total_area), '(\\d)(?=(\\d{3})+(?!\\d))', '\\1,') AS VARCHAR) AS total_area,
    NULL AS average_area
FROM 
    SubtotalData S
ORDER BY 
    FLOOR_KEY, DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1814, 536
TOTAL                  : 214350, 193553, 20797
AVG                    : 2463.79, 2224.75, 239.05
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List each building key and floor key within the department of facilities, the number of rooms, total area, average area per floor, building name, access level, zip code, and city. Include subtotals for each building and a grand total across all buildings. The subtotals and grand total should not include zip code or city. Numbers of rooms and area should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'building key' is related to FAC_ROOMS.BUILDING_KEY
- 'floor key' is related to FAC_ROOMS.FLOOR_KEY
- 'department' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY
- 'area' is related to FAC_ROOMS.AREA
- 'building name' is related to FAC_BUILDING.BUILDING_NAME_LONG
- 'access level' is related to FAC_BUILDING.ACCESS_LEVEL_NAME
- 'zip code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY

Join Information: (FAC_ORGANIZATION.ORGANIZATION_KEY = FAC_ROOMS.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoZ6Hs74wVfufwtgavpvZ4YmxKa5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH RoomData AS (\n    SELECT \n        FR.BUILDING_KEY,\n        FR.FLOOR_KEY,\n        COUNT(FR.FAC_ROOM_KEY) AS NumOfRooms,\n        ROUND(SUM(FR.AREA)) AS TotalArea\n    FROM FAC_ROOMS FR\n    JOIN FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY\n    WHERE FO.ORGANIZATION_NAME = 'FACILITIES'\n    GROUP BY FR.BUILDING_KEY, FR.FLOOR_KEY\n),\nBuildingData AS (\n    SELECT \n        FB.FAC_BUILDING_KEY AS BuildingKey,\n        FB.BUILDING_NAME_LONG AS BuildingName,\n        FB.ACCESS_LEVEL_NAME AS AccessLevel,\n        BA.POSTAL_CODE AS ZipCode,\n        BA.CITY AS City,\n        SUM(RD.NumOfRooms) AS TotalRooms,\n        SUM(RD.TotalArea) AS TotalArea,\n        COUNT(DISTINCT RD.FLOOR_KEY) AS TotalFloors\n    FROM FAC_BUILDING FB\n    JOIN RoomData RD ON FB.FAC_BUILDING_KEY = RD.BUILDING_KEY\n    JOIN FAC_BUILDING_ADDRESS BA ON FB.FAC_BUILDING_KEY = BA.BUILDING_KEY\n    GROUP BY FB.FAC_BUILDING_KEY, FB.BUILDING_NAME_LONG, FB.ACCESS_LEVEL_NAME, BA.POSTAL_CODE, BA.CITY\n)\nSELECT \n    BuildingKey,\n    FLOOR_KEY,\n    TotalRooms,\n    TotalArea,\n    ROUND((TotalArea * 1.0 / NULLIF(TotalFloors, 0))) AS AvgAreaPerFloor,\n    BuildingName,\n    AccessLevel,\n    ZipCode,\n    City\nFROM BuildingData\nUNION ALL\nSELECT \n    'SUBTOTAL' AS BuildingKey,\n    NULL AS FLOOR_KEY,\n    SUM(TotalRooms) AS TotalRooms,\n    SUM(TotalArea) AS TotalArea,\n    ROUND(SUM(TotalArea * 1.0) / NULLIF(SUM(TotalFloors), 0)) AS AvgAreaPerFloor,\n    NULL AS BuildingName,\n    NULL AS AccessLevel,\n    NULL AS ZipCode,\n    NULL AS City\nFROM BuildingData\nUNION ALL\nSELECT \n    'GRAND TOTAL' AS BuildingKey,\n    NULL AS FLOOR_KEY,\n    SUM(TotalRooms) AS TotalRooms,\n    SUM(TotalArea) AS TotalArea,\n    ROUND(SUM(TotalArea * 1.0) / NULLIF(SUM(TotalFloors), 0)) AS AvgAreaPerFloor,\n    NULL AS BuildingName,\n    NULL AS AccessLevel,\n    NULL AS ZipCode,\n    NULL AS City\nFROM BuildingData;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180120, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=546, prompt_tokens=2720, total_tokens=3266, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=546, prompt_tokens=2720, total_tokens=3266, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
WITH RoomData AS (
    SELECT 
        FR.BUILDING_KEY,
        FR.FLOOR_KEY,
        COUNT(FR.FAC_ROOM_KEY) AS NumOfRooms,
        ROUND(SUM(FR.AREA)) AS TotalArea
    FROM FAC_ROOMS FR
    JOIN FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY
    WHERE FO.ORGANIZATION_NAME = 'FACILITIES'
    GROUP BY FR.BUILDING_KEY, FR.FLOOR_KEY
),
BuildingData AS (
    SELECT 
        FB.FAC_BUILDING_KEY AS BuildingKey,
        FB.BUILDING_NAME_LONG AS BuildingName,
        FB.ACCESS_LEVEL_NAME AS AccessLevel,
        BA.POSTAL_CODE AS ZipCode,
        BA.CITY AS City,
        SUM(RD.NumOfRooms) AS TotalRooms,
        SUM(RD.TotalArea) AS TotalArea,
        COUNT(DISTINCT RD.FLOOR_KEY) AS TotalFloors
    FROM FAC_BUILDING FB
    JOIN RoomData RD ON FB.FAC_BUILDING_KEY = RD.BUILDING_KEY
    JOIN FAC_BUILDING_ADDRESS BA ON FB.FAC_BUILDING_KEY = BA.BUILDING_KEY
    GROUP BY FB.FAC_BUILDING_KEY, FB.BUILDING_NAME_LONG, FB.ACCESS_LEVEL_NAME, BA.POSTAL_CODE, BA.CITY
)
SELECT 
    BuildingKey,
    FLOOR_KEY,
    TotalRooms,
    TotalArea,
    ROUND((TotalArea * 1.0 / NULLIF(TotalFloors, 0))) AS AvgAreaPerFloor,
    BuildingName,
    AccessLevel,
    ZipCode,
    City
FROM BuildingData
UNION ALL
SELECT 
    'SUBTOTAL' AS BuildingKey,
    NULL AS FLOOR_KEY,
    SUM(TotalRooms) AS TotalRooms,
    SUM(TotalArea) AS TotalArea,
    ROUND(SUM(TotalArea * 1.0) / NULLIF(SUM(TotalFloors), 0)) AS AvgAreaPerFloor,
    NULL AS BuildingName,
    NULL AS AccessLevel,
    NULL AS ZipCode,
    NULL AS City
FROM BuildingData
UNION ALL
SELECT 
    'GRAND TOTAL' AS BuildingKey,
    NULL AS FLOOR_KEY,
    SUM(TotalRooms) AS TotalRooms,
    SUM(TotalArea) AS TotalArea,
    ROUND(SUM(TotalArea * 1.0) / NULLIF(SUM(TotalFloors), 0)) AS AvgAreaPerFloor,
    NULL AS BuildingName,
    NULL AS AccessLevel,
    NULL AS ZipCode,
    NULL AS City
FROM BuildingData;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2720, 546
TOTAL                  : 217616, 196273, 21343
AVG                    : 2472.91, 2230.38, 242.53
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERM_PARAMETER
[
(TERM_PARAMETER:VARCHAR2, Examples: ['SIS_CURRENT_TERM', 'SIS_PREVIOUS_TERM', 'SIS_UPCOMING_TERM']),
(TERM_INDICATOR:VARCHAR2, Examples: ['C', 'P', 'F']),
(TERM_CODE:VARCHAR2, Examples: ['2024SU', '2025FA', '2025JA']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Fall Term 2024-2025', 'Summer Term 2024', 'January Term 2024-2025']),
(TERM_START_DATE:DATE, Examples: ['03-SEP-24', '10-JUN-24', '06-JAN-25']),
(TERM_END_DATE:DATE, Examples: ['20-DEC-24', '20-AUG-24', '31-JAN-25']),
(TERM_LAST_DAY_BEFORE_NEXT_TERM:DATE, Examples: ['05-JAN-25', '02-SEP-24', '31-JAN-25']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['Y', 'N'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
List the department, school, course number, subject title, total number of enrolled students, term code, and count of distinct catalog ISBNs. Add a summary row at the bottom showing the total number of students and distinct catalog ISBNs for the current term in the format of ('TOTAL:', null, null, null, total number of students, null, number of distinct catalog ISBNs).

(Hints: Schema Mapping Hints:
- 'department' is related to LIBRARY_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'school' is related to LIBRARY_SUBJECT_OFFERED.OFFER_SCHOOL_NAME
- 'course number' is related to LIBRARY_SUBJECT_OFFERED.COURSE_NUMBER
- 'subject title' is related to LIBRARY_SUBJECT_OFFERED.SUBJECT_TITLE
- 'enrolled students' is related to LIBRARY_SUBJECT_OFFERED.NUM_ENROLLED_STUDENTS
- 'term code' is related to LIBRARY_SUBJECT_OFFERED.TERM_CODE
- 'catalog ISBNs' is related to LIBRARY_RESERVE_CATALOG.CATALOG_ISBN

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (ACADEMIC_TERM_PARAMETER.TERM_CODE = LIBRARY_SUBJECT_OFFERED.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoZHy4pALULnPVUINWcMMTwmuBXO', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    LSO.OFFER_DEPT_NAME AS department,\n    LSO.OFFER_SCHOOL_NAME AS school,\n    LSO.COURSE_NUMBER AS course_number,\n    LSO.SUBJECT_TITLE AS subject_title,\n    SUM(LSO.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,\n    LSO.TERM_CODE AS term_code,\n    COUNT(DISTINCT LRC.CATALOG_ISBN) AS distinct_catalog_isbns\nFROM \n    LIBRARY_SUBJECT_OFFERED LSO\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRMD.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    ACADEMIC_TERM_PARAMETER ATP ON LSO.TERM_CODE = ATP.TERM_CODE\nWHERE \n    ATP.IS_CURRENT_TERM = 'Y'\nGROUP BY \n    LSO.OFFER_DEPT_NAME, \n    LSO.OFFER_SCHOOL_NAME, \n    LSO.COURSE_NUMBER, \n    LSO.SUBJECT_TITLE, \n    LSO.TERM_CODE\n\nUNION ALL\n\nSELECT \n    'TOTAL:' AS department,\n    NULL AS school,\n    NULL AS course_number,\n    NULL AS subject_title,\n    SUM(LSO.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,\n    NULL AS term_code,\n    COUNT(DISTINCT LRC.CATALOG_ISBN) AS distinct_catalog_isbns\nFROM \n    LIBRARY_SUBJECT_OFFERED LSO\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRMD.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    ACADEMIC_TERM_PARAMETER ATP ON LSO.TERM_CODE = ATP.TERM_CODE\nWHERE \n    ATP.IS_CURRENT_TERM = 'Y';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180131, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=452, prompt_tokens=1964, total_tokens=2416, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=452, prompt_tokens=1964, total_tokens=2416, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    LSO.OFFER_DEPT_NAME AS department,
    LSO.OFFER_SCHOOL_NAME AS school,
    LSO.COURSE_NUMBER AS course_number,
    LSO.SUBJECT_TITLE AS subject_title,
    SUM(LSO.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,
    LSO.TERM_CODE AS term_code,
    COUNT(DISTINCT LRC.CATALOG_ISBN) AS distinct_catalog_isbns
FROM 
    LIBRARY_SUBJECT_OFFERED LSO
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRMD.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    ACADEMIC_TERM_PARAMETER ATP ON LSO.TERM_CODE = ATP.TERM_CODE
WHERE 
    ATP.IS_CURRENT_TERM = 'Y'
GROUP BY 
    LSO.OFFER_DEPT_NAME, 
    LSO.OFFER_SCHOOL_NAME, 
    LSO.COURSE_NUMBER, 
    LSO.SUBJECT_TITLE, 
    LSO.TERM_CODE

UNION ALL

SELECT 
    'TOTAL:' AS department,
    NULL AS school,
    NULL AS course_number,
    NULL AS subject_title,
    SUM(LSO.NUM_ENROLLED_STUDENTS) AS total_enrolled_students,
    NULL AS term_code,
    COUNT(DISTINCT LRC.CATALOG_ISBN) AS distinct_catalog_isbns
FROM 
    LIBRARY_SUBJECT_OFFERED LSO
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRMD ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRMD.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG LRC ON LRMD.LIBRARY_RESERVE_CATALOG_KEY = LRC.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    ACADEMIC_TERM_PARAMETER ATP ON LSO.TERM_CODE = ATP.TERM_CODE
WHERE 
    ATP.IS_CURRENT_TERM = 'Y';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1964, 452
TOTAL                  : 220032, 198237, 21795
AVG                    : 2472.27, 2227.38, 244.89
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each mailing list that involves subscribers that work in departments with names starting with 'Computer Science', state the ownership type, the list name, the number of owners, and the number of subscribers. Display the ownership type only if it differs from the previous entry. Include subtotals (the corresponding type field shoud be 'SUBTOTAL') for each ownership type and a grand total (the corresponding type field shoud be 'TOTAL') across all ownership types.

(Hints: Schema Mapping Hints:
- 'departments with names starting with 'Computer Science'' is related to EMPLOYEE_DIRECTORY.DEPARTMENT_NAME
- 'ownership type' is related to MOIRA_LIST_OWNER.OWNER_TYPE
- 'list name' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'owners' is related to MOIRA_LIST_OWNER.OWNER
- 'subscribers' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (EMPLOYEE_DIRECTORY.MIT_ID = MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER_MIT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoZPEz2ShmTesSG7s5U5qr5Z009k', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH DepartmentSubscribers AS (\n    SELECT \n        ML.MOIRA_LIST_NAME,\n        MO.OWNER_TYPE,\n        MO.MOIRA_LIST_OWNER_KEY,\n        COUNT(DISTINCT MO.OWNER) AS OwnerCount,\n        COUNT(DISTINCT MD.MOIRA_LIST_MEMBER_MIT_ID) AS SubscriberCount\n    FROM \n        MOIRA_LIST ML\n    JOIN \n        MOIRA_LIST_OWNER MO ON ML.MOIRA_LIST_KEY = MO.MOIRA_LIST_OWNER_KEY\n    JOIN \n        MOIRA_LIST_DETAIL MD ON ML.MOIRA_LIST_KEY = MD.MOIRA_LIST_KEY\n    JOIN \n        EMPLOYEE_DIRECTORY ED ON MD.MOIRA_LIST_MEMBER_MIT_ID = ED.MIT_ID\n    WHERE \n        ED.DEPARTMENT_NAME LIKE 'Computer Science%'\n    GROUP BY \n        ML.MOIRA_LIST_NAME, MO.OWNER_TYPE\n), \nOwnershipSubtotals AS (\n    SELECT \n        OWNER_TYPE,\n        SUM(OwnerCount) AS TotalOwners,\n        SUM(SubscriberCount) AS TotalSubscribers\n    FROM \n        DepartmentSubscribers\n    GROUP BY \n        OWNER_TYPE\n),\nFinalOutput AS (\n    SELECT \n        OWNER_TYPE,\n        MOIRA_LIST_NAME,\n        OwnerCount,\n        SubscriberCount\n    FROM \n        DepartmentSubscribers\n    UNION ALL\n    SELECT \n        'SUBTOTAL' AS OWNER_TYPE,\n        NULL AS MOIRA_LIST_NAME,\n        TotalOwners,\n        TotalSubscribers\n    FROM \n        OwnershipSubtotals\n    UNION ALL\n    SELECT \n        'TOTAL' AS OWNER_TYPE,\n        NULL AS MOIRA_LIST_NAME,\n        SUM(TotalOwners),\n        SUM(TotalSubscribers)\n    FROM \n        OwnershipSubtotals\n)\nSELECT \n    OWNER_TYPE,\n    MOIRA_LIST_NAME,\n    OwnerCount,\n    SubscriberCount\nFROM \n    FinalOutput\nORDER BY \n    OWNER_TYPE, MOIRA_LIST_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180139, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=388, prompt_tokens=1529, total_tokens=1917, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=388, prompt_tokens=1529, total_tokens=1917, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
WITH DepartmentSubscribers AS (
    SELECT 
        ML.MOIRA_LIST_NAME,
        MO.OWNER_TYPE,
        MO.MOIRA_LIST_OWNER_KEY,
        COUNT(DISTINCT MO.OWNER) AS OwnerCount,
        COUNT(DISTINCT MD.MOIRA_LIST_MEMBER_MIT_ID) AS SubscriberCount
    FROM 
        MOIRA_LIST ML
    JOIN 
        MOIRA_LIST_OWNER MO ON ML.MOIRA_LIST_KEY = MO.MOIRA_LIST_OWNER_KEY
    JOIN 
        MOIRA_LIST_DETAIL MD ON ML.MOIRA_LIST_KEY = MD.MOIRA_LIST_KEY
    JOIN 
        EMPLOYEE_DIRECTORY ED ON MD.MOIRA_LIST_MEMBER_MIT_ID = ED.MIT_ID
    WHERE 
        ED.DEPARTMENT_NAME LIKE 'Computer Science%'
    GROUP BY 
        ML.MOIRA_LIST_NAME, MO.OWNER_TYPE
), 
OwnershipSubtotals AS (
    SELECT 
        OWNER_TYPE,
        SUM(OwnerCount) AS TotalOwners,
        SUM(SubscriberCount) AS TotalSubscribers
    FROM 
        DepartmentSubscribers
    GROUP BY 
        OWNER_TYPE
),
FinalOutput AS (
    SELECT 
        OWNER_TYPE,
        MOIRA_LIST_NAME,
        OwnerCount,
        SubscriberCount
    FROM 
        DepartmentSubscribers
    UNION ALL
    SELECT 
        'SUBTOTAL' AS OWNER_TYPE,
        NULL AS MOIRA_LIST_NAME,
        TotalOwners,
        TotalSubscribers
    FROM 
        OwnershipSubtotals
    UNION ALL
    SELECT 
        'TOTAL' AS OWNER_TYPE,
        NULL AS MOIRA_LIST_NAME,
        SUM(TotalOwners),
        SUM(TotalSubscribers)
    FROM 
        OwnershipSubtotals
)
SELECT 
    OWNER_TYPE,
    MOIRA_LIST_NAME,
    OwnerCount,
    SubscriberCount
FROM 
    FinalOutput
ORDER BY 
    OWNER_TYPE, MOIRA_LIST_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1529, 388
TOTAL                  : 221949, 199766, 22183
AVG                    : 2466.10, 2219.62, 246.48
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each IAP category, list its name, number of unique sessions, total number of attendees, active period (in the format of 'beginning term code-end term code'), the most common sponsor name, and the most common session start time. Include a grand total row showing the total number of sessions and attendees across all categories in the format of ('TOTAL', number of sessions, number of attendees, null, null, null).

(Hints: Schema Mapping Hints:
- 'name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'attendees' is related to IAP_SUBJECT_DETAIL.MAX_ENROLLMENT
- 'active period' is related to IAP_SUBJECT_DETAIL.TERM_CODE
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'session start time' is related to IAP_SUBJECT_SESSION.SESSION_START_TIME

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY), (IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoZXeyJSEqhg9tpF7GajCg4Vonvc', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CategoryStats AS (\n    SELECT \n        c.IAP_CATEGORY_NAME,\n        COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS unique_sessions,\n        SUM(d.MAX_ENROLLMENT) AS total_attendees,\n        MIN(d.TERM_CODE) || '-' || MAX(d.TERM_CODE) AS active_period,\n        (SELECT s2.SPONSOR_NAME \n         FROM IAP_SUBJECT_SPONSOR s2 \n         JOIN IAP_SUBJECT_DETAIL d2 ON s2.IAP_SUBJECT_SPONSOR_KEY = d2.IAP_SUBJECT_SPONSOR_KEY\n         WHERE d2.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY\n         GROUP BY s2.SPONSOR_NAME \n         ORDER BY COUNT(*) DESC LIMIT 1) AS most_common_sponsor,\n        (SELECT s3.SESSION_START_TIME \n         FROM IAP_SUBJECT_SESSION s3 \n         JOIN IAP_SUBJECT_DETAIL d3 ON s3.IAP_SUBJECT_SESSION_KEY = d3.IAP_SUBJECT_SESSION_KEY\n         WHERE d3.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY\n         GROUP BY s3.SESSION_START_TIME \n         ORDER BY COUNT(*) DESC LIMIT 1) AS most_common_start_time\n    FROM \n        IAP_SUBJECT_CATEGORY c\n    JOIN \n        IAP_SUBJECT_DETAIL d ON c.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY\n    JOIN \n        IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY\n    GROUP BY \n        c.IAP_CATEGORY_NAME\n),\nTotalStats AS (\n    SELECT \n        'TOTAL' AS name,\n        COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS total_sessions,\n        SUM(d.MAX_ENROLLMENT) AS total_attendees,\n        NULL AS active_period,\n        NULL AS most_common_sponsor,\n        NULL AS most_common_start_time\n    FROM \n        IAP_SUBJECT_DETAIL d\n    JOIN \n        IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY\n)\n\nSELECT * FROM CategoryStats\nUNION ALL\nSELECT * FROM TotalStats;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180147, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=459, prompt_tokens=1891, total_tokens=2350, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=459, prompt_tokens=1891, total_tokens=2350, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
WITH CategoryStats AS (
    SELECT 
        c.IAP_CATEGORY_NAME,
        COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS unique_sessions,
        SUM(d.MAX_ENROLLMENT) AS total_attendees,
        MIN(d.TERM_CODE) || '-' || MAX(d.TERM_CODE) AS active_period,
        (SELECT s2.SPONSOR_NAME 
         FROM IAP_SUBJECT_SPONSOR s2 
         JOIN IAP_SUBJECT_DETAIL d2 ON s2.IAP_SUBJECT_SPONSOR_KEY = d2.IAP_SUBJECT_SPONSOR_KEY
         WHERE d2.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY
         GROUP BY s2.SPONSOR_NAME 
         ORDER BY COUNT(*) DESC LIMIT 1) AS most_common_sponsor,
        (SELECT s3.SESSION_START_TIME 
         FROM IAP_SUBJECT_SESSION s3 
         JOIN IAP_SUBJECT_DETAIL d3 ON s3.IAP_SUBJECT_SESSION_KEY = d3.IAP_SUBJECT_SESSION_KEY
         WHERE d3.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY
         GROUP BY s3.SESSION_START_TIME 
         ORDER BY COUNT(*) DESC LIMIT 1) AS most_common_start_time
    FROM 
        IAP_SUBJECT_CATEGORY c
    JOIN 
        IAP_SUBJECT_DETAIL d ON c.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY
    JOIN 
        IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY
    GROUP BY 
        c.IAP_CATEGORY_NAME
),
TotalStats AS (
    SELECT 
        'TOTAL' AS name,
        COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS total_sessions,
        SUM(d.MAX_ENROLLMENT) AS total_attendees,
        NULL AS active_period,
        NULL AS most_common_sponsor,
        NULL AS most_common_start_time
    FROM 
        IAP_SUBJECT_DETAIL d
    JOIN 
        IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY
)

SELECT * FROM CategoryStats
UNION ALL
SELECT * FROM TotalStats;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1891, 459
TOTAL                  : 224299, 201657, 22642
AVG                    : 2464.82, 2216.01, 248.81
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: BUILDINGS
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NAME:VARCHAR2, Examples: ['BUILDING NW32', 'Ashdown House', 'BUILDING NW36']),
(BUILDING_STREET_ADDRESS:VARCHAR2, Examples: ['230 ALBANY STREET', '235  ALBANY ST', '250 ALBANY STREET']),
(BUILDING_MAILING_ADDRESS:VARCHAR2),
(BLDG_GROSS_SQUARE_FOOTAGE:NUMBER, Examples: [30053, 252747, 2045]),
(BLDG_ASSIGNABLE_SQUARE_FOOTAGE:NUMBER, Examples: [18919, 158677, 1605]),
(BUILDING_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]
# Table: FCLT_BUILDING_HIST
[
(FCLT_BUILDING_HIST_KEY:VARCHAR2, Examples: ['14S-201505', '46-201505', 'E14-201505']),
(FISCAL_PERIOD:VARCHAR2, Examples: ['201505', '201506', '201507']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['14S', '46', 'E14']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['14', 'W61', 'W70']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY', 'MACGREGOR HOUSE', 'NEW HOUSE']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library', 'Frank S MacGregor House', 'New West Campus Houses']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['Charles Hayden Memorial Library (South Wing)', 'Brain & Cognitive Sciences Complex', 'Building E14']),
(EXT_GROSS_AREA:NUMBER, Examples: [48622.2, 418663.0, 173875.0]),
(ASSIGNABLE_AREA:NUMBER, Examples: [34500.5, 218519.0, 73792.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [10286.5, 152699.0, 83752.7]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHWEST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['(NULL)', 'UGBA3', 'UGBI2']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['136.4', '82.8', '88.3']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3623, 42.3605, 42.3615]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0916, -71.0873, -71.0879]),
(EASTING_X_SPCS:NUMBER, Examples: [766530.0, 767698.0, 767547.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2957330.0, 2956650.0, 2957020.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['14S', '46', 'E14']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['SEELY G. MUDD', 'HORACE SAYFORD FORD JR.', 'SEBASTIAN S. KRESGE']),
(BUILDING_NAME:VARCHAR2, Examples: ['HAYDEN MEMORIAL LIBRARY (S)', 'BCSC', 'BUILDING E14']),
(DATE_BUILT:VARCHAR2, Examples: ['04/25/2003', '12/31/1932', '12/31/1920']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['05/01/1961', '12/31/1955', '12/31/1939']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['09/01/2005', '03/06/1975', '10/01/1964']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-DEC-14', '01-JAN-15', '01-FEB-15']),
(NUM_OF_ROOMS:NUMBER, Examples: [118, 1403, 341])
]

### Question ###
For each building type, list the name of the building type, the number of buildings that are not subdivisions, number of employees, number of unique building street address, number of unique city, number of unique state, number of unique postal code, and average gross square footage per employee. For building type of 'resident', display it as 'RESIDENTIAL'. Include a grand total across all building types (the corresponding type field is 'TOTAL').

(Hints: Schema Mapping Hints:
- 'name of the building type' is related to FCLT_BUILDING_HIST.BUILDING_TYPE
- 'buildings that are not subdivisions' is related to FCLT_BUILDING_HIST.FCLT_BUILDING_KEY, FCLT_BUILDING_HIST.PARENT_BUILDING_NUMBER
- 'employees' is related to EMPLOYEE_DIRECTORY.MIT_ID
- 'street address' is related to BUILDINGS.BUILDING_STREET_ADDRESS, FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE
- 'city' is related to FAC_BUILDING_ADDRESS.CITY
- 'state' is related to FAC_BUILDING_ADDRESS.STATE
- 'postal code' is related to FAC_BUILDING_ADDRESS.POSTAL_CODE
- 'gross square footage' is related to FCLT_BUILDING_HIST.EXT_GROSS_AREA

Join Information: (FAC_BUILDING_ADDRESS.BUILDING_KEY = FCLT_BUILDING_HIST.FCLT_BUILDING_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (EMPLOYEE_DIRECTORY.OFFICE_LOCATION = FAC_ROOMS.FAC_ROOM_KEY), (FCLT_BUILDING_HIST.FCLT_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_BUILDING_ADDRESS.BUILDING_KEY = BUILDINGS.BUILDING_KEY), (BUILDINGS.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_ROOMS.FAC_ROOM_KEY = EMPLOYEE_DIRECTORY.OFFICE_LOCATION))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoZewFKEZbkvhHyEEJ8zjmCIoqE5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH BuildingCounts AS (\n    SELECT \n        CASE \n            WHEN FCLT.BUILDING_TYPE = 'resident' THEN 'RESIDENTIAL' \n            ELSE FCLT.BUILDING_TYPE \n        END AS building_type,\n        COUNT(DISTINCT FCLT.FCLT_BUILDING_KEY) AS num_buildings,\n        COUNT(DISTINCT EMP.MIT_ID) AS num_employees,\n        COUNT(DISTINCT BA.BUILDING_STREET_ADDRESS) AS num_unique_street_addresses,\n        COUNT(DISTINCT BA.CITY) AS num_unique_cities,\n        COUNT(DISTINCT BA.STATE) AS num_unique_states,\n        COUNT(DISTINCT BA.POSTAL_CODE) AS num_unique_postal_codes,\n        AVG(FCLT.EXT_GROSS_AREA) AS avg_gross_sq_ft\n    FROM FCLT_BUILDING_HIST FCLT\n    LEFT JOIN FAC_BUILDING_ADDRESS BA ON FCLT.FCLT_BUILDING_KEY = BA.BUILDING_KEY\n    LEFT JOIN BUILDINGS B ON BA.BUILDING_KEY = B.BUILDING_KEY\n    LEFT JOIN FAC_ROOMS R ON B.BUILDING_KEY = R.BUILDING_KEY\n    LEFT JOIN EMPLOYEE_DIRECTORY EMP ON R.FAC_ROOM_KEY = EMP.OFFICE_LOCATION\n    WHERE FCLT.PARENT_BUILDING_NUMBER IS NULL\n    GROUP BY \n        CASE \n            WHEN FCLT.BUILDING_TYPE = 'resident' THEN 'RESIDENTIAL' \n            ELSE FCLT.BUILDING_TYPE \n        END\n), GrandTotal AS (\n    SELECT\n        'TOTAL' AS building_type,\n        SUM(num_buildings) AS num_buildings,\n        SUM(num_employees) AS num_employees,\n        SUM(num_unique_street_addresses) AS num_unique_street_addresses,\n        SUM(num_unique_cities) AS num_unique_cities,\n        SUM(num_unique_states) AS num_unique_states,\n        SUM(num_unique_postal_codes) AS num_unique_postal_codes,\n        AVG(avg_gross_sq_ft) AS avg_gross_sq_ft\n    FROM BuildingCounts\n)\nSELECT * FROM BuildingCounts\nUNION ALL\nSELECT * FROM GrandTotal;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180154, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=448, prompt_tokens=3004, total_tokens=3452, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=448, prompt_tokens=3004, total_tokens=3452, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
WITH BuildingCounts AS (
    SELECT 
        CASE 
            WHEN FCLT.BUILDING_TYPE = 'resident' THEN 'RESIDENTIAL' 
            ELSE FCLT.BUILDING_TYPE 
        END AS building_type,
        COUNT(DISTINCT FCLT.FCLT_BUILDING_KEY) AS num_buildings,
        COUNT(DISTINCT EMP.MIT_ID) AS num_employees,
        COUNT(DISTINCT BA.BUILDING_STREET_ADDRESS) AS num_unique_street_addresses,
        COUNT(DISTINCT BA.CITY) AS num_unique_cities,
        COUNT(DISTINCT BA.STATE) AS num_unique_states,
        COUNT(DISTINCT BA.POSTAL_CODE) AS num_unique_postal_codes,
        AVG(FCLT.EXT_GROSS_AREA) AS avg_gross_sq_ft
    FROM FCLT_BUILDING_HIST FCLT
    LEFT JOIN FAC_BUILDING_ADDRESS BA ON FCLT.FCLT_BUILDING_KEY = BA.BUILDING_KEY
    LEFT JOIN BUILDINGS B ON BA.BUILDING_KEY = B.BUILDING_KEY
    LEFT JOIN FAC_ROOMS R ON B.BUILDING_KEY = R.BUILDING_KEY
    LEFT JOIN EMPLOYEE_DIRECTORY EMP ON R.FAC_ROOM_KEY = EMP.OFFICE_LOCATION
    WHERE FCLT.PARENT_BUILDING_NUMBER IS NULL
    GROUP BY 
        CASE 
            WHEN FCLT.BUILDING_TYPE = 'resident' THEN 'RESIDENTIAL' 
            ELSE FCLT.BUILDING_TYPE 
        END
), GrandTotal AS (
    SELECT
        'TOTAL' AS building_type,
        SUM(num_buildings) AS num_buildings,
        SUM(num_employees) AS num_employees,
        SUM(num_unique_street_addresses) AS num_unique_street_addresses,
        SUM(num_unique_cities) AS num_unique_cities,
        SUM(num_unique_states) AS num_unique_states,
        SUM(num_unique_postal_codes) AS num_unique_postal_codes,
        AVG(avg_gross_sq_ft) AS avg_gross_sq_ft
    FROM BuildingCounts
)
SELECT * FROM BuildingCounts
UNION ALL
SELECT * FROM GrandTotal;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3004, 448
TOTAL                  : 227751, 204661, 23090
AVG                    : 2475.55, 2224.58, 250.98
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: SPACE_DETAIL
[
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR_KEY:VARCHAR2, Examples: ['0', '00', '000']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['121000', '150000', '151000']),
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(BUILDING_ROOM_NAME:VARCHAR2, Examples: ['1-080', '1-082F', '1-025F']),
(ROOM_NUMBER:VARCHAR2, Examples: ['80', '82F', '25F']),
(ROOM_SQUARE_FOOTAGE:NUMBER, Examples: [1033, 147, 271]),
(ROOM_COUNTER:NUMBER, Examples: [1]),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_UNIT
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(SPACE_UNIT_KEY:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['10000', '121000', '150000']),
(SPACE_UNIT:VARCHAR2, Examples: ['Technology & Policy Program', 'Division Of Comparative Medicine', 'Physics']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SPACE_USAGE
[
(SPACE_USAGE_KEY:NUMBER, Examples: [1, 2, 3]),
(SPACE_USAGE:VARCHAR2, Examples: ['ARC ROOM', 'TST ROOM', 'RSRC RM']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: ZPM_ROOMS_LOAD
[
(BUILDING_ROOM:VARCHAR2, Examples: ['1-073', '1-035', '1-061']),
(BUILDING_COMPONENT:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['0', '1', '2']),
(SPACE_USAGE:VARCHAR2, Examples: ['DSGN STUDIO', 'ARC ROOM', 'DINING RM']),
(SPACE_UNIT_CODE:VARCHAR2, Examples: ['121000', '150000', '151000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000267', '10000270', '10000272']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['3', '0', '2'])
]

### Question ###
Group spaces in the Stata building by the access level and usage type. For each group, state the access level, usage type, name of the space, the number of spaces, total area across all rooms in the space, and average area across all rooms in the space. Display the access level only if it differs from the previous entry. Include subtotals for each access level, usage type, and space name, subtotals for each access level, and a grand total across all access levels. Exclude usage type that includes "STORAGE". All numerical values should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'Stata building' is related to SPACE_DETAIL.BUILDING_KEY
- 'access level' is related to ZPM_ROOMS_LOAD.ACCESS_LEVEL
- 'usage type' is related to SPACE_USAGE.SPACE_USAGE
- 'name of the space' is related to FCLT_ORGANIZATION.DLC_NAME
- 'spaces' is related to SPACE_UNIT.SPACE_UNIT
- 'area' is related to SPACE_DETAIL.ROOM_SQUARE_FOOTAGE

Join Information: (FCLT_ORGANIZATION.FCLT_ORGANIZATION_KEY = SPACE_UNIT.FCLT_ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoZnO44DxfF4OeUAS2k4tezMmU2J', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    CASE WHEN @prev_access_level <> z.ACCESS_LEVEL THEN z.ACCESS_LEVEL END AS access_level,\n    su.SPACE_USAGE AS usage_type,\n    fo.DLC_NAME AS space_name,\n    COUNT(sd.BUILDING_ROOM) AS number_of_spaces,\n    ROUND(SUM(sd.ROOM_SQUARE_FOOTAGE)) AS total_area,\n    ROUND(AVG(sd.ROOM_SQUARE_FOOTAGE)) AS average_area\nFROM \n    SPACE_DETAIL sd\nJOIN \n    ZPM_ROOMS_LOAD z ON sd.BUILDING_ROOM = z.BUILDING_ROOM\nJOIN \n    SPACE_USAGE su ON z.SPACE_USAGE = su.SPACE_USAGE\nJOIN \n    SPACE_UNIT su2 ON z.SPACE_UNIT_CODE = su2.SPACE_UNIT_CODE\nJOIN \n    FCLT_ORGANIZATION fo ON su2.FCLT_ORGANIZATION_KEY = fo.FCLT_ORGANIZATION_KEY\nWHERE \n    sd.BUILDING_KEY = '1' AND \n    su.SPACE_USAGE NOT LIKE '%STORAGE%'\nGROUP BY \n    z.ACCESS_LEVEL, su.SPACE_USAGE, fo.DLC_NAME\nORDER BY \n    z.ACCESS_LEVEL, su.SPACE_USAGE, fo.DLC_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180163, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=249, prompt_tokens=1469, total_tokens=1718, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=249, prompt_tokens=1469, total_tokens=1718, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    CASE WHEN @prev_access_level <> z.ACCESS_LEVEL THEN z.ACCESS_LEVEL END AS access_level,
    su.SPACE_USAGE AS usage_type,
    fo.DLC_NAME AS space_name,
    COUNT(sd.BUILDING_ROOM) AS number_of_spaces,
    ROUND(SUM(sd.ROOM_SQUARE_FOOTAGE)) AS total_area,
    ROUND(AVG(sd.ROOM_SQUARE_FOOTAGE)) AS average_area
FROM 
    SPACE_DETAIL sd
JOIN 
    ZPM_ROOMS_LOAD z ON sd.BUILDING_ROOM = z.BUILDING_ROOM
JOIN 
    SPACE_USAGE su ON z.SPACE_USAGE = su.SPACE_USAGE
JOIN 
    SPACE_UNIT su2 ON z.SPACE_UNIT_CODE = su2.SPACE_UNIT_CODE
JOIN 
    FCLT_ORGANIZATION fo ON su2.FCLT_ORGANIZATION_KEY = fo.FCLT_ORGANIZATION_KEY
WHERE 
    sd.BUILDING_KEY = '1' AND 
    su.SPACE_USAGE NOT LIKE '%STORAGE%'
GROUP BY 
    z.ACCESS_LEVEL, su.SPACE_USAGE, fo.DLC_NAME
ORDER BY 
    z.ACCESS_LEVEL, su.SPACE_USAGE, fo.DLC_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1469, 249
TOTAL                  : 229469, 206130, 23339
AVG                    : 2467.41, 2216.45, 250.96
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FCLT_ORGANIZATION
[
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION:VARCHAR2, Examples: ['A/VSVC', 'ACT', 'ADMISS']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['AUDIO-VISUAL SVC', 'ART CULT & TECH', 'ADMISSIONS']),
(FCLT_ORG_PARENT_KEY:VARCHAR2, Examples: ['160', '247', '152']),
(ORG_PARENT:VARCHAR2, Examples: ['ENTSVC', 'SAP', 'OVC']),
(FCLT_MAJOR_ORG_KEY:VARCHAR2, Examples: ['129', '230', '105']),
(MAJOR_ORG:VARCHAR2, Examples: ['CHNCLR', 'PROVST', 'ALL']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['6', '5', '1']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['874100', '38000', '446100']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101030309', '101060034', '101030402']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['16', '21A', '4']),
(DESCRIPTION:VARCHAR2, Examples: ['Department of Aeronautics and Astronautics', 'Anthropology Program', 'Department of Architecture']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACT', 'D_ADM', 'D_AEROASTRO']),
(DLC_NAME:VARCHAR2, Examples: ['Audiovisual Services', 'Program in Art Culture & Technology', 'Admissions']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '150000']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000265', '10000267', '10000270']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Audio Visual Services', 'Program in Art, Culture and Technology', 'Admissions Office'])
]
# Table: HR_FACULTY_ROSTER
[
(MIT_ID:VARCHAR2, Examples: ['999319439', '927924992', '903738061']),
(LAST_NAME:VARCHAR2, Examples: ['Frederick', 'Hooper', 'Frost']),
(FIRST_NAME:VARCHAR2, Examples: ['Floyd', 'Kade', 'Matthew']),
(MIDDLE_NAME:VARCHAR2, Examples: ['W', 'G', 'Garrison']),
(TERMINAL_DEGREE:VARCHAR2, Examples: ['Doctoral Degree', 'Post-Doctoral Degree', 'Bachelor's Degree']),
(APPOINTMENT_TYPE:VARCHAR2, Examples: ['Primary Appointment', 'Dual Appointment']),
(JOB_TITLE:VARCHAR2, Examples: ['Associate Professor', 'Professor', 'Assistant Professor']),
(HR_ORG_UNIT_TITLE:VARCHAR2, Examples: ['Aeronautics and Astronautics', 'Anthropology Program', 'Architecture']),
(POSITION_TITLE:VARCHAR2),
(ADMIN_ORG_UNIT_TITLE:VARCHAR2),
(ADMIN_POSITION_TITLE:VARCHAR2),
(ADMIN_JOB_TITLE:VARCHAR2),
(DIRECTORY_ORG_UNIT_TITLE:VARCHAR2, Examples: ['Department of Mechanical Engineering', 'Department of Linguistics and Philosophy', 'Division of Comparative Medicine']),
(ENDOWED_CHAIR:VARCHAR2),
(EMERITUS_STATUS:CHAR, Examples: ['Emeritus']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: HR_ORG_UNIT
[
(HR_ORG_UNIT_KEY:VARCHAR2, Examples: ['O10000333', 'O10005059', 'O10004909']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['0', '10000000', '10000001']),
(HR_ORG_UNIT_TITLE:VARCHAR2, Examples: ['[MEDIA82] OXMAN /NERI', 'Abdul Latif Jameel Poverty Action Lab', 'Academic Media Production Services']),
(HR_ORG_UNIT_LEVEL:VARCHAR2, Examples: ['DEPARTMENTS', 'ORGANIZATION LEVEL', 'SUB DEPARTMENT']),
(HR_DEPARTMENT_ID:VARCHAR2, Examples: ['10000333', '10005059', '10004909']),
(HR_DEPARTMENT_CODE:VARCHAR2, Examples: ['HR-068100', 'HR-404511', 'HR-402400']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['10000', '121000', '121002']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'VPF - Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(HR_DEPARTMENT_NAME_LONG:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'VPF - Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(HR_DEPARTMENT_NAME_ALPHA:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'VPF - Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(ORG_HIER_SCHOOL_AREA_NAME:VARCHAR2, Examples: ['Schwarzman College of Computing Area', 'VP for Finance Area', 'VP Research']),
(ORG_HIER_TOP_LEVEL_NAME:VARCHAR2, Examples: ['Provost Area', 'Executive Vice President Area', 'President & Chair of the Corporation']),
(ORG_HIER_ROOT_NAME:VARCHAR2, Examples: ['MIT-All']),
(HR_ORG_LEVEL1_ID:VARCHAR2, Examples: ['10000000']),
(HR_ORG_LEVEL1_SORT:VARCHAR2, Examples: ['1']),
(HR_ORG_LEVEL1_NAME:VARCHAR2, Examples: ['MIT-All']),
(HR_ORG_LEVEL2_ID:VARCHAR2, Examples: ['10000001', '10000002', '10000003']),
(HR_ORG_LEVEL2_SORT:VARCHAR2, Examples: ['2', '3', '4']),
(HR_ORG_LEVEL2_NAME:VARCHAR2, Examples: ['Provost Area', 'Executive Vice President Area', 'President & Chair of the Corporation']),
(HR_ORG_LEVEL3_ID:VARCHAR2, Examples: ['10005758', '10003333', '10000032']),
(HR_ORG_LEVEL3_SORT:VARCHAR2, Examples: ['513', '326', '18']),
(HR_ORG_LEVEL3_NAME:VARCHAR2, Examples: ['Schwarzman College of Computing Area', 'VP for Finance Area', 'VP Research']),
(HR_ORG_LEVEL4_ID:VARCHAR2, Examples: ['10000333', '10005058', '10004909']),
(HR_ORG_LEVEL4_SORT:VARCHAR2, Examples: ['59', '425', '414']),
(HR_ORG_LEVEL4_NAME:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'Office of the Treasurer Area', 'MIT Environmental Solutions Initiative']),
(HR_ORG_LEVEL5_ID:VARCHAR2, Examples: ['10005059', '10005810', '10005668']),
(HR_ORG_LEVEL5_SORT:VARCHAR2, Examples: ['426', '517', '504']),
(HR_ORG_LEVEL5_NAME:VARCHAR2, Examples: ['VPF - Treasury and Planning', 'Strategic Alliances & Tech Transfer Area', 'Office of the First Year Area']),
(HR_ORG_LEVEL6_ID:VARCHAR2, Examples: ['10000671', '10002483', '10000289']),
(HR_ORG_LEVEL6_SORT:VARCHAR2, Examples: ['168', '272', '42']),
(HR_ORG_LEVEL6_NAME:VARCHAR2, Examples: ['OSATT-Corporate Relations', 'Concourse', 'Terrascope']),
(HR_ORG_LEVEL7_ID:VARCHAR2, Examples: ['10005113', '10005110', '10005109']),
(HR_ORG_LEVEL7_SORT:VARCHAR2, Examples: ['434', '431', '430']),
(HR_ORG_LEVEL7_NAME:VARCHAR2, Examples: ['Open Learning, Corp & Prof, MIT xPRO', 'Open Learning, ODL, K-12', 'Open Learning, Supporting Unit, Bus/Ops']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_NAME:VARCHAR2, Examples: ['Institute for Data, Systems, and Society', 'Office of Treasury and Planning', 'MIT Environmental Solutions Initiative']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-DEC-24', '13-DEC-24'])
]
# Table: MASTER_DEPT_HIERARCHY
[
(HIERARCHY_TYPE:VARCHAR2, Examples: ['Standard Hierarchy']),
(DLC_KEY:VARCHAR2, Examples: ['D_ACAD', 'D_ACT', 'D_ADM']),
(DLC_CODE:VARCHAR2, Examples: ['D_DOF_CORE', 'D_DOF_RESERVE', 'D_DOF_RESIDENCE']),
(DLC_NAME:VARCHAR2, Examples: ['Facilities Building Core (hallways, stairs, etc.)', 'Facilities Provost Reserved', 'Facilities Residences']),
(MASTER_DEPT_HIER_LEVEL_1_CODE:VARCHAR2, Examples: ['D_ALL']),
(MASTER_DEPT_HIER_LEVEL_1_NAME:VARCHAR2, Examples: ['All Departments']),
(MASTER_DEPT_HIER_LEVEL_2_CODE:VARCHAR2, Examples: ['D_EXECVP_AREA', 'D_PROVOST_AREA', 'D_PRES_AREA']),
(MASTER_DEPT_HIER_LEVEL_2_NAME:VARCHAR2, Examples: ['Executive Vice President's Area', 'Provost Area', 'President's area']),
(MASTER_DEPT_HIER_LEVEL_3_CODE:VARCHAR2, Examples: ['D_FINANCE_AREA', 'D_TREAS_AREA', 'D_SC_ENVP']),
(MASTER_DEPT_HIER_LEVEL_3_NAME:VARCHAR2, Examples: ['VP Finance Area', 'Treasurer's Area', 'Senior Council and Environmental Programs']),
(MASTER_DEPT_HIER_LEVEL_4_CODE:VARCHAR2, Examples: ['D_SOURCING_AREA', 'D_OSATT_AREA']),
(MASTER_DEPT_HIER_LEVEL_4_NAME:VARCHAR2, Examples: ['Sourcing Area', 'Office of Strategic Alliances & Tech Transfer Area']),
(MASTER_DEPT_HIER_LEVEL_5_CODE:VARCHAR2),
(MASTER_DEPT_HIER_LEVEL_5_NAME:VARCHAR2)
]

### Question ###
List each organization's break group, ID, name, and formatted name according to its level, along with whether its members are emeritus or non-emeritus. Also, include the organization number, level, employer count, and hierarchy type for each organization. Exclude organizations '139' and '250'. Sort the results by hierarchy type and ensure totals for employer counts are displayed.

(Hints: Schema Mapping Hints:
- 'break group' is related to FCLT_ORGANIZATION.ORGANIZATION_SORT
- 'ID' is related to FCLT_ORGANIZATION.ORGANIZATION_ID
- 'name' is related to FCLT_ORGANIZATION.ORGANIZATION_NAME
- 'level' is related to FCLT_ORGANIZATION.ORGANIZATION_LEVEL
- 'number' is related to FCLT_ORGANIZATION.ORGANIZATION_NUMBER
- 'employer' is related to HR_FACULTY_ROSTER.MIT_ID
- 'hierarchy type' is related to MASTER_DEPT_HIERARCHY.HIERARCHY_TYPE

Join Information: (FCLT_ORGANIZATION.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY), (FCLT_ORGANIZATION.DLC_KEY = HR_ORG_UNIT.DLC_KEY), (HR_ORG_UNIT.HR_ORG_UNIT_TITLE = HR_FACULTY_ROSTER.HR_ORG_UNIT_TITLE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoZrcnq6Yg59CGDzlAHaD1GEUJyA', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    FCLT_ORG.ORGANIZATION_SORT AS break_group,\n    FCLT_ORG.ORGANIZATION_ID AS ID,\n    FCLT_ORG.ORGANIZATION_NAME AS name,\n    FCLT_ORG.ORGANIZATION_LEVEL AS level,\n    FCLT_ORG.ORGANIZATION_NUMBER AS number,\n    COUNT(HR_FACULTY.MIT_ID) AS employer_count,\n    MDH.HIERARCHY_TYPE AS hierarchy_type,\n    CASE \n        WHEN HR_FACULTY.EMERITUS_STATUS = 'Emeritus' THEN 'Emeritus' \n        ELSE 'Non-Emeritus' \n    END AS status\nFROM \n    FCLT_ORGANIZATION FCLT_ORG\nJOIN \n    MASTER_DEPT_HIERARCHY MDH ON FCLT_ORG.DLC_KEY = MDH.DLC_KEY\nJOIN \n    HR_ORG_UNIT HR_UNIT ON FCLT_ORG.DLC_KEY = HR_UNIT.DLC_KEY\nJOIN \n    HR_FACULTY_ROSTER HR_FACULTY ON HR_UNIT.HR_ORG_UNIT_TITLE = HR_FACULTY.HR_ORG_UNIT_TITLE\nWHERE \n    FCLT_ORG.ORGANIZATION_ID NOT IN ('139', '250')\nGROUP BY \n    FCLT_ORG.ORGANIZATION_SORT, \n    FCLT_ORG.ORGANIZATION_ID, \n    FCLT_ORG.ORGANIZATION_NAME, \n    FCLT_ORG.ORGANIZATION_LEVEL, \n    FCLT_ORG.ORGANIZATION_NUMBER, \n    MDH.HIERARCHY_TYPE, \n    HR_FACULTY.EMERITUS_STATUS\nORDER BY \n    MDH.HIERARCHY_TYPE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180167, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=362, prompt_tokens=2632, total_tokens=2994, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=362, prompt_tokens=2632, total_tokens=2994, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    FCLT_ORG.ORGANIZATION_SORT AS break_group,
    FCLT_ORG.ORGANIZATION_ID AS ID,
    FCLT_ORG.ORGANIZATION_NAME AS name,
    FCLT_ORG.ORGANIZATION_LEVEL AS level,
    FCLT_ORG.ORGANIZATION_NUMBER AS number,
    COUNT(HR_FACULTY.MIT_ID) AS employer_count,
    MDH.HIERARCHY_TYPE AS hierarchy_type,
    CASE 
        WHEN HR_FACULTY.EMERITUS_STATUS = 'Emeritus' THEN 'Emeritus' 
        ELSE 'Non-Emeritus' 
    END AS status
FROM 
    FCLT_ORGANIZATION FCLT_ORG
JOIN 
    MASTER_DEPT_HIERARCHY MDH ON FCLT_ORG.DLC_KEY = MDH.DLC_KEY
JOIN 
    HR_ORG_UNIT HR_UNIT ON FCLT_ORG.DLC_KEY = HR_UNIT.DLC_KEY
JOIN 
    HR_FACULTY_ROSTER HR_FACULTY ON HR_UNIT.HR_ORG_UNIT_TITLE = HR_FACULTY.HR_ORG_UNIT_TITLE
WHERE 
    FCLT_ORG.ORGANIZATION_ID NOT IN ('139', '250')
GROUP BY 
    FCLT_ORG.ORGANIZATION_SORT, 
    FCLT_ORG.ORGANIZATION_ID, 
    FCLT_ORG.ORGANIZATION_NAME, 
    FCLT_ORG.ORGANIZATION_LEVEL, 
    FCLT_ORG.ORGANIZATION_NUMBER, 
    MDH.HIERARCHY_TYPE, 
    HR_FACULTY.EMERITUS_STATUS
ORDER BY 
    MDH.HIERARCHY_TYPE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2632, 362
TOTAL                  : 232463, 208762, 23701
AVG                    : 2473.01, 2220.87, 252.14
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, list its title, name of the building of the course location, duration (in terms of days), and a running average of the duration (in terms of days) using a window of two preceding and two following courses (partitioned by academic year and sorted by course start date).

(Hints: Schema Mapping Hints:
- 'title' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME
- 'duration' is related to ACADEMIC_TERMS.TERM_END_DATE, ACADEMIC_TERMS.TERM_START_DATE

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.EFFECTIVE_TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (FCLT_ROOMS.FCLT_BUILDING_KEY = FCLT_BUILDING.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoZyZB7rxprdyXzg5tcnU4j0D8DG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    c.SUBJECT_TITLE,\n    b.BUILDING_NAME,\n    julianday(at.TERM_END_DATE) - julianday(at.TERM_START_DATE) AS duration,\n    AVG(julianday(at2.TERM_END_DATE) - julianday(at2.TERM_START_DATE)) OVER (PARTITION BY c.ACADEMIC_YEAR ORDER BY at.TERM_START_DATE ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS running_avg_duration\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN \n    ACADEMIC_TERMS at ON c.EFFECTIVE_TERM_CODE = at.TERM_CODE\nJOIN \n    FCLT_ROOMS r ON r.FCLT_ROOM_KEY = c.SUBJECT_ID\nJOIN \n    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY\nORDER BY \n    c.ACADEMIC_YEAR, at.TERM_START_DATE;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180174, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=197, prompt_tokens=4275, total_tokens=4472, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=197, prompt_tokens=4275, total_tokens=4472, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    c.SUBJECT_TITLE,
    b.BUILDING_NAME,
    julianday(at.TERM_END_DATE) - julianday(at.TERM_START_DATE) AS duration,
    AVG(julianday(at2.TERM_END_DATE) - julianday(at2.TERM_START_DATE)) OVER (PARTITION BY c.ACADEMIC_YEAR ORDER BY at.TERM_START_DATE ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS running_avg_duration
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED c
JOIN 
    ACADEMIC_TERMS at ON c.EFFECTIVE_TERM_CODE = at.TERM_CODE
JOIN 
    FCLT_ROOMS r ON r.FCLT_ROOM_KEY = c.SUBJECT_ID
JOIN 
    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY
ORDER BY 
    c.ACADEMIC_YEAR, at.TERM_START_DATE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4275, 197
TOTAL                  : 236935, 213037, 23898
AVG                    : 2494.05, 2242.49, 251.56
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, list its name, name of the building of the course location, the start date, the name of the course before it, and the name of the course after it, access level of the building, and the assignable area of the room used for the course, sorted by the ascending order start date and course name.

(Hints: Schema Mapping Hints:
- 'name' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME_LONG
- 'start date' is related to ACADEMIC_TERMS.TERM_START_DATE
- 'name of the course' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'access level' is related to FCLT_BUILDING.ACCESS_LEVEL_NAME
- 'area' is related to FCLT_ROOMS.AREA

Join Information: (FCLT_BUILDING.FCLT_BUILDING_KEY = FCLT_ROOMS.FCLT_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Csoa2IiwYgC9SUZFRMrsCq7w54JCv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    C.SUBJECT_TITLE AS course_name,\n    B.BUILDING_NAME_LONG AS building_name,\n    A.TERM_START_DATE AS start_date,\n    LAG(C.SUBJECT_TITLE) OVER (ORDER BY A.TERM_START_DATE, C.SUBJECT_TITLE) AS previous_course_name,\n    LEAD(C.SUBJECT_TITLE) OVER (ORDER BY A.TERM_START_DATE, C.SUBJECT_TITLE) AS next_course_name,\n    B.ACCESS_LEVEL_NAME AS access_level,\n    R.AREA AS assignable_area\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED C\nJOIN \n    ACADEMIC_TERMS A ON C.TERM_CODE = A.TERM_CODE\nJOIN \n    FCLT_ROOMS R ON R.BUILDING_ROOM = C.SUBJECT_ID\nJOIN \n    FCLT_BUILDING B ON R.FCLT_BUILDING_KEY = B.FCLT_BUILDING_KEY\nORDER BY \n    A.TERM_START_DATE ASC, C.SUBJECT_TITLE ASC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180178, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=207, prompt_tokens=4304, total_tokens=4511, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3968)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=207, prompt_tokens=4304, total_tokens=4511, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3968))

***** FINAL SQL QUERY *****
SELECT 
    C.SUBJECT_TITLE AS course_name,
    B.BUILDING_NAME_LONG AS building_name,
    A.TERM_START_DATE AS start_date,
    LAG(C.SUBJECT_TITLE) OVER (ORDER BY A.TERM_START_DATE, C.SUBJECT_TITLE) AS previous_course_name,
    LEAD(C.SUBJECT_TITLE) OVER (ORDER BY A.TERM_START_DATE, C.SUBJECT_TITLE) AS next_course_name,
    B.ACCESS_LEVEL_NAME AS access_level,
    R.AREA AS assignable_area
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED C
JOIN 
    ACADEMIC_TERMS A ON C.TERM_CODE = A.TERM_CODE
JOIN 
    FCLT_ROOMS R ON R.BUILDING_ROOM = C.SUBJECT_ID
JOIN 
    FCLT_BUILDING B ON R.FCLT_BUILDING_KEY = B.FCLT_BUILDING_KEY
ORDER BY 
    A.TERM_START_DATE ASC, C.SUBJECT_TITLE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4304, 207
TOTAL                  : 241446, 217341, 24105
AVG                    : 2515.06, 2263.97, 251.09
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: FCLT_BUILDING
[
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:VARCHAR2, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:VARCHAR2, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:NUMBER, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:NUMBER, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:VARCHAR2, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [0, 1, 2]),
(ACCESS_LEVEL_NAME:VARCHAR2, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:VARCHAR2, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1342002', '1345000', '1345300']),
(LATITUDE_WGS:NUMBER, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:NUMBER, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:NUMBER, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:NUMBER, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:VARCHAR2, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:VARCHAR2, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:VARCHAR2, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:NUMBER, Examples: [383, 250, 106])
]
# Table: FCLT_ROOMS
[
(FCLT_ROOM_KEY:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(BUILDING_ROOM:VARCHAR2, Examples: ['1-001C', '1-001E', '1-007B']),
(FCLT_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['15', '2', '1']),
(FCLT_FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['1573D', '293', '137']),
(SPACE_ID:VARCHAR2, Examples: ['E94-15-1573D', '39-2-293', '9-1-137']),
(FCLT_MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['OFFICES', 'LABS', 'MECHANIC']),
(FCLT_USE_KEY:VARCHAR2, Examples: ['158', '145', '154']),
(USE_DESC:VARCHAR2),
(FCLT_MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(FCLT_ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['S MGMT', 'MTL', 'DOF']),
(FCLT_MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:NUMBER, Examples: [61.77, 186.69, 359.03]),
(ROOM_FULL_NAME:VARCHAR2, Examples: ['DE ROTHSCHILD ROOM', 'NORTH LOBDELL BALCONY', 'WOMENS TEAM ROOM']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93400', '93300']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '1']),
(LATITUDE_WGS:NUMBER),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course, list its name, name of the building of the course location, and the cumulative number of courses, including the course itself, held in the same year or preceding years (partitioned by academic year and sorted in the ascending order of course start date).

(Hints: Schema Mapping Hints:
- 'name' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'name of the building' is related to FCLT_BUILDING.BUILDING_NAME
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'academic year' is related to COURSE_CATALOG_SUBJECT_OFFERED.ACADEMIC_YEAR
- 'course start date' is related to ACADEMIC_TERMS.TERM_START_DATE

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.EFFECTIVE_TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (COURSE_CATALOG_SUBJECT_OFFERED.MEET_PLACE = FCLT_ROOMS.FCLT_ROOM_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Csoa6xn5jJoucVJQMnVlcy4EdhRDe', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    c.SUBJECT_TITLE AS course_name,\n    b.BUILDING_NAME AS building_name,\n    COUNT(*) OVER (PARTITION BY c.ACADEMIC_YEAR ORDER BY a.TERM_START_DATE) AS cumulative_courses\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN \n    ACADEMIC_TERMS a ON c.EFFECTIVE_TERM_CODE = a.TERM_CODE\nJOIN \n    FCLT_ROOMS r ON c.MEET_PLACE = r.FCLT_ROOM_KEY\nJOIN \n    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY\nWHERE \n    c.ACADEMIC_YEAR <= a.ACADEMIC_YEAR\nORDER BY \n    a.TERM_START_DATE ASC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180182, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=160, prompt_tokens=4302, total_tokens=4462, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3968)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=160, prompt_tokens=4302, total_tokens=4462, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3968))

***** FINAL SQL QUERY *****
SELECT 
    c.SUBJECT_TITLE AS course_name,
    b.BUILDING_NAME AS building_name,
    COUNT(*) OVER (PARTITION BY c.ACADEMIC_YEAR ORDER BY a.TERM_START_DATE) AS cumulative_courses
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED c
JOIN 
    ACADEMIC_TERMS a ON c.EFFECTIVE_TERM_CODE = a.TERM_CODE
JOIN 
    FCLT_ROOMS r ON c.MEET_PLACE = r.FCLT_ROOM_KEY
JOIN 
    FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY
WHERE 
    c.ACADEMIC_YEAR <= a.ACADEMIC_YEAR
ORDER BY 
    a.TERM_START_DATE ASC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 4302, 160
TOTAL                  : 245908, 221643, 24265
AVG                    : 2535.13, 2284.98, 250.15
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_SUMMARY
[
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese I', 'ESD Graduate Thesis', 'Advanced Organic Chemistry']),
(SUBJECT_OR_CLUSTER:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.004']),
(ULT_MASTER_SUBJECT_ID:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['J', 'S', 'M']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['Joint subject', 'SWE: School-Wide Electives', 'Meeting Together']),
(CLUSTER_LIST:VARCHAR2, Examples: ['3.43, 6.720', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012', '21A.344, STS.062']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['21F', 'ESD', '5']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Global Studies & Languages', 'Engineering Systems Division', 'Chemistry']),
(SCHOOL_CODE:VARCHAR2, Examples: ['H', 'E', 'S']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Hum, Arts & Social Sciences', 'Engineering', 'Science']),
(TOTAL_UNITS:NUMBER, Examples: [12, 1, 15]),
(LECTURE_UNITS:NUMBER, Examples: [4, 0, 3]),
(LAB_UNITS:NUMBER, Examples: [0, 1, 12]),
(PREP_UNITS:NUMBER, Examples: [8, 0, 9]),
(DESIGN_UNITS:NUMBER, Examples: [0, 4, 6]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [45, 203, 26]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [30, 235, 59]),
(SUBJECT_GROUP_ID:VARCHAR2, Examples: ['86CD64962C150327E0440003BACE90BC', 'F9E8CEBB9F5A7CCFE0433D2F091294A0', '86CD6495D8560327E0440003BACE90BC']),
(SUBJECT_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(CLUSTER_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(SUBJECT_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(CLUSTER_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(SUBJECT_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(SUBJECT_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(CLUSTER_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(SUBJECT_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(CLUSTER_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(SUBJECT_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(CLUSTER_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
Group courses in the biology and chemistry department by whether they are current or not and the cluster type. For each group, list the current status ('CURRENT' if yes and 'NON-CURRENT' otherwise), cluster type, the maximum duration of courses (in terms of days), the maximum units, average duration (in terms of days), and average units. Include subtotals for each current status (the corresponding current status field is 'SUBTOTAL') and a grand total across all current status (the corresponding current status field is 'TOTAL'). Do not repeat the current status if it is the same as the previous row. Sort the table by current status and cluster type.

(Hints: Schema Mapping Hints:
- 'biology and chemistry department' is related to SUBJECT_SUMMARY.DEPARTMENT_NAME
- 'current status' is related to ACADEMIC_TERMS_ALL.IS_CURRENT_TERM
- 'cluster type' is related to SUBJECT_SUMMARY.CLUSTER_TYPE
- 'duration' is related to ACADEMIC_TERMS_ALL.TERM_END_DATE, ACADEMIC_TERMS_ALL.TERM_START_DATE
- 'units' is related to SUBJECT_SUMMARY.TOTAL_UNITS

Join Information: (ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_SUMMARY.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Csoa9l3n2BZ2tqjVGFBUlAFsorHlT', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CourseDetails AS (\n    SELECT \n        A.IS_CURRENT_TERM,\n        S.CLUSTER_TYPE,\n        JULIANDAY(A.TERM_END_DATE) - JULIANDAY(A.TERM_START_DATE) AS DurationDays,\n        S.TOTAL_UNITS\n    FROM \n        ACADEMIC_TERMS_ALL A\n    JOIN \n        SUBJECT_SUMMARY S ON A.TERM_CODE = S.TERM_CODE\n    WHERE \n        S.DEPARTMENT_NAME IN ('Biology', 'Chemistry')\n),\nAggregated AS (\n    SELECT \n        IS_CURRENT_TERM,\n        CLUSTER_TYPE,\n        MAX(DurationDays) AS MaxDurationDays,\n        MAX(TOTAL_UNITS) AS MaxUnits,\n        AVG(DurationDays) AS AvgDurationDays,\n        AVG(TOTAL_UNITS) AS AvgUnits\n    FROM \n        CourseDetails\n    GROUP BY \n        IS_CURRENT_TERM, CLUSTER_TYPE\n),\nSubtotal AS (\n    SELECT \n        IS_CURRENT_TERM,\n        CLUSTER_TYPE,\n        MaxDurationDays,\n        MaxUnits,\n        AvgDurationDays,\n        AvgUnits\n    FROM \n        Aggregated\n    UNION ALL\n    SELECT \n        'SUBTOTAL' AS IS_CURRENT_TERM,\n        CLUSTER_TYPE,\n        MAX(MaxDurationDays),\n        MAX(MaxUnits),\n        AVG(AvgDurationDays),\n        AVG(AvgUnits)\n    FROM \n        Aggregated\n    GROUP BY \n        CLUSTER_TYPE\n),\nGrandTotal AS (\n    SELECT \n        'TOTAL' AS IS_CURRENT_TERM,\n        NULL AS CLUSTER_TYPE,\n        MAX(MaxDurationDays) AS MaxDurationDays,\n        MAX(MaxUnits) AS MaxUnits,\n        AVG(AvgDurationDays) AS AvgDurationDays,\n        AVG(AvgUnits) AS AvgUnits\n    FROM \n        Aggregated\n)\nSELECT \n    IS_CURRENT_TERM,\n    CLUSTER_TYPE,\n    MaxDurationDays,\n    MaxUnits,\n    AvgDurationDays,\n    AvgUnits\nFROM \n    Subtotal\nUNION ALL\nSELECT \n    IS_CURRENT_TERM,\n    CLUSTER_TYPE,\n    MaxDurationDays,\n    MaxUnits,\n    AvgDurationDays,\n    AvgUnits\nFROM \n    GrandTotal\nORDER BY \n    IS_CURRENT_TERM, \n    CLUSTER_TYPE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180185, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=455, prompt_tokens=2092, total_tokens=2547, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=455, prompt_tokens=2092, total_tokens=2547, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH CourseDetails AS (
    SELECT 
        A.IS_CURRENT_TERM,
        S.CLUSTER_TYPE,
        JULIANDAY(A.TERM_END_DATE) - JULIANDAY(A.TERM_START_DATE) AS DurationDays,
        S.TOTAL_UNITS
    FROM 
        ACADEMIC_TERMS_ALL A
    JOIN 
        SUBJECT_SUMMARY S ON A.TERM_CODE = S.TERM_CODE
    WHERE 
        S.DEPARTMENT_NAME IN ('Biology', 'Chemistry')
),
Aggregated AS (
    SELECT 
        IS_CURRENT_TERM,
        CLUSTER_TYPE,
        MAX(DurationDays) AS MaxDurationDays,
        MAX(TOTAL_UNITS) AS MaxUnits,
        AVG(DurationDays) AS AvgDurationDays,
        AVG(TOTAL_UNITS) AS AvgUnits
    FROM 
        CourseDetails
    GROUP BY 
        IS_CURRENT_TERM, CLUSTER_TYPE
),
Subtotal AS (
    SELECT 
        IS_CURRENT_TERM,
        CLUSTER_TYPE,
        MaxDurationDays,
        MaxUnits,
        AvgDurationDays,
        AvgUnits
    FROM 
        Aggregated
    UNION ALL
    SELECT 
        'SUBTOTAL' AS IS_CURRENT_TERM,
        CLUSTER_TYPE,
        MAX(MaxDurationDays),
        MAX(MaxUnits),
        AVG(AvgDurationDays),
        AVG(AvgUnits)
    FROM 
        Aggregated
    GROUP BY 
        CLUSTER_TYPE
),
GrandTotal AS (
    SELECT 
        'TOTAL' AS IS_CURRENT_TERM,
        NULL AS CLUSTER_TYPE,
        MAX(MaxDurationDays) AS MaxDurationDays,
        MAX(MaxUnits) AS MaxUnits,
        AVG(AvgDurationDays) AS AvgDurationDays,
        AVG(AvgUnits) AS AvgUnits
    FROM 
        Aggregated
)
SELECT 
    IS_CURRENT_TERM,
    CLUSTER_TYPE,
    MaxDurationDays,
    MaxUnits,
    AvgDurationDays,
    AvgUnits
FROM 
    Subtotal
UNION ALL
SELECT 
    IS_CURRENT_TERM,
    CLUSTER_TYPE,
    MaxDurationDays,
    MaxUnits,
    AvgDurationDays,
    AvgUnits
FROM 
    GrandTotal
ORDER BY 
    IS_CURRENT_TERM, 
    CLUSTER_TYPE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2092, 455
TOTAL                  : 248455, 223735, 24720
AVG                    : 2535.26, 2283.01, 252.24
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SUBJECT_OFFERED
[
(SUBJECT_KEY:VARCHAR2, Examples: ['HAA16560002012JA', 'HAA50580002012JA', 'HAA50580002014JA']),
(SUBJECT_OFFERED_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(MASTER_SUBJECT_KEY:VARCHAR2, Examples: ['HAA00000002012JA', 'HAA00000002014JA', 'HAA00000002011SP']),
(COMPOSITE_SUBJECT_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.206']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['HAA', 'HAK', 'HAL']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Harvard, Arts and Sciences', 'Harvard, Kennedy School', 'Harvard, Law']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Industial East Asia', 'Spanish 44:Spanish Culture', 'Gov 1747:Contemp Glob Pol']),
(SECTION_ID:VARCHAR2, Examples: ['0', '000', 'B01']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Harvard Cross-Enrollment Prog', 'Wellesley Cross-Enrollment Pro', 'Non-Institute-MFA/MCA']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'Engineering', 'MIT, academic']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Taylor, Aadam', 'Downs, Francesco', 'Lindsey, Wanda']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['MW2', 'TR12', 'TR1,F2']),
(MEET_PLACE:VARCHAR2, Examples: ['(Italy)', '*', '* ARRANGED']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['S', 'M', 'J']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['SWE: School-Wide Electives', 'Meeting Together', 'Joint subject']),
(CLUSTER_LIST:VARCHAR2, Examples: ['HAA.0000, HAA.0023, HAA.0029, HAA.0031, HAA.0042, HAA.0062, HAA.0071, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.010', 'HAA.0000, HAA.0018, HAA.0021, HAA.0023, HAA.0025, HAA.0026, HAA.0029, HAA.0031, HAA.0033, HAA.0036, HAA.0042, HAA.0062, HAA.007', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'N']),
(HGN_CODE_DESC:VARCHAR2, Examples: ['Not for graduate credit', 'Higher level graduate program', 'Graduate program']),
(FORM_TYPE:VARCHAR2, Examples: ['H', 'E']),
(FORM_TYPE_DESC:VARCHAR2, Examples: ['Hass', 'Sci/Eng']),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 1, 2]),
(SECTION_ENROLLMENT_NUMBER:VARCHAR2, Examples: ['1', '2', '7']),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [0, 206, 215]),
(EVALUATE_THIS_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_OSE_SUBJECT:VARCHAR2, Examples: ['N', 'Y']),
(IS_CREATED_BY_DATA_WAREHOUSE:VARCHAR2, Examples: ['N', 'Y']),
(SUBJECT_GROUPING_KEY:VARCHAR2, Examples: ['002D096E6CE20509E0533D2F091292DC', '002D096E6CE30509E0533D2F091292DC', '0030CFCD85837BE0E0633D2F09128557']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [0, 1, 2]),
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(IS_REPEATABLE_SUBJECT:VARCHAR2, Examples: ['N', 'Y'])
]
# Table: SUBJECT_SUMMARY
[
(SUBJECT_SUMMARY_KEY:VARCHAR2, Examples: ['1.0002015FA', '1.0002016FA', '1.0002017FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1987FA', '1987SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intermediate Japanese I', 'ESD Graduate Thesis', 'Advanced Organic Chemistry']),
(SUBJECT_OR_CLUSTER:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.004']),
(ULT_MASTER_SUBJECT_ID:VARCHAR2, Examples: ['21F.503', 'ESD.THG', '5.43']),
(CLUSTER_TYPE:VARCHAR2, Examples: ['J', 'S', 'M']),
(CLUSTER_TYPE_DESC:VARCHAR2, Examples: ['Joint subject', 'SWE: School-Wide Electives', 'Meeting Together']),
(CLUSTER_LIST:VARCHAR2, Examples: ['3.43, 6.720', 'HAA.0000, HAA.0062, HAA.0074, HAA.0090, HAA.0094, HAA.0096, HAA.0104, HAA.0105, HAA.0107, HAA.0119, HAA.0120, HAA.0121, HAA.012', '21A.344, STS.062']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['21F', 'ESD', '5']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Global Studies & Languages', 'Engineering Systems Division', 'Chemistry']),
(SCHOOL_CODE:VARCHAR2, Examples: ['H', 'E', 'S']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Hum, Arts & Social Sciences', 'Engineering', 'Science']),
(TOTAL_UNITS:NUMBER, Examples: [12, 1, 15]),
(LECTURE_UNITS:NUMBER, Examples: [4, 0, 3]),
(LAB_UNITS:NUMBER, Examples: [0, 1, 12]),
(PREP_UNITS:NUMBER, Examples: [8, 0, 9]),
(DESIGN_UNITS:NUMBER, Examples: [0, 4, 6]),
(SUBJECT_ENROLLMENT_NUMBER:NUMBER, Examples: [45, 203, 26]),
(CLUSTER_ENROLLMENT_NUMBER:NUMBER, Examples: [30, 235, 59]),
(SUBJECT_GROUP_ID:VARCHAR2, Examples: ['86CD64962C150327E0440003BACE90BC', 'F9E8CEBB9F5A7CCFE0433D2F091294A0', '86CD6495D8560327E0440003BACE90BC']),
(SUBJECT_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(CLUSTER_ENROLLMENT_FIRST_WEEK:NUMBER, Examples: [51, 205, 27]),
(SUBJECT_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(CLUSTER_ENROLLMENT_FIFTH_WEEK:NUMBER, Examples: [48, 204, 26]),
(SUBJECT_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(SUBJECT_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_CREDIT:NUMBER, Examples: [43, 203, 26]),
(CLUSTER_ENROLLMENT_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(SUBJECT_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_1ST_CREDIT:NUMBER, Examples: [49, 205, 27]),
(CLUSTER_ENROLLMENT_1ST_LISTEN:NUMBER, Examples: [2, 0, 5]),
(SUBJECT_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(SUBJECT_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(CLUSTER_ENROLLMENT_5TH_CREDIT:NUMBER, Examples: [46, 204, 26]),
(CLUSTER_ENROLLMENT_5TH_LISTEN:NUMBER, Examples: [2, 0, 5]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
Group courses in the biology and chemistry department by whether they are current or not and the department name. For each group, list the current status ('CURRENT' if yes and 'NON-CURRENT' otherwise), department name, the maximum duration of courses (in terms of days), the maximum units, average duration (in terms of days), and average units. Include subtotals for each current status (the corresponding current status field is 'SUBTOTAL') and a grand total across all current status (the corresponding current status field is 'TOTAL'). Do not repeat the current status if it is the same as the previous row. Sort the table by current status and department.

(Hints: Schema Mapping Hints:
- 'biology and chemistry department' is related to SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'current status' is related to ACADEMIC_TERMS_ALL.IS_CURRENT_TERM
- 'duration' is related to ACADEMIC_TERMS_ALL.TERM_END_DATE, ACADEMIC_TERMS_ALL.TERM_START_DATE
- 'units' is related to SUBJECT_SUMMARY.TOTAL_UNITS

Join Information: (ACADEMIC_TERMS_ALL.TERM_CODE = SUBJECT_SUMMARY.TERM_CODE), (SUBJECT_SUMMARY.SUBJECT_ID = SUBJECT_OFFERED.SUBJECT_ID))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoaIZuqeS5v4YEmGfcCUmbeSzVMy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CourseDurations AS (\n    SELECT \n        A.IS_CURRENT_TERM,\n        SO.OFFER_DEPT_NAME,\n        JULIANDAY(A.TERM_END_DATE) - JULIANDAY(A.TERM_START_DATE) AS DurationDays,\n        SS.TOTAL_UNITS\n    FROM \n        ACADEMIC_TERMS_ALL A\n    JOIN \n        SUBJECT_OFFERED SO ON A.TERM_CODE = SO.TERM_CODE\n    JOIN \n        SUBJECT_SUMMARY SS ON SO.SUBJECT_ID = SS.SUBJECT_ID\n    WHERE \n        SO.OFFER_DEPT_NAME IN ('Biology', 'Chemistry')\n),\nAggregatedResults AS (\n    SELECT \n        ISNULL(IS_CURRENT_TERM, 'NON-CURRENT') AS CurrentStatus,\n        OFFER_DEPT_NAME,\n        MAX(DurationDays) AS MaxDurationDays,\n        MAX(TOTAL_UNITS) AS MaxUnits,\n        AVG(DurationDays) AS AvgDurationDays,\n        AVG(TOTAL_UNITS) AS AvgUnits\n    FROM \n        CourseDurations\n    GROUP BY \n        IS_CURRENT_TERM, OFFER_DEPT_NAME\n),\nSubtotalResults AS (\n    SELECT \n        CurrentStatus,\n        OFFER_DEPT_NAME,\n        MAXDurationDays,\n        MAXUnits,\n        AvgDurationDays,\n        AvgUnits\n    FROM \n        AggregatedResults\n    UNION ALL\n    SELECT \n        'SUBTOTAL' AS CurrentStatus,\n        OFFER_DEPT_NAME,\n        MAX(MaxDurationDays) AS MaxDurationDays,\n        MAX(MaxUnits) AS MaxUnits,\n        AVG(AvgDurationDays) AS AvgDurationDays,\n        AVG(AvgUnits) AS AvgUnits\n    FROM \n        AggregatedResults\n    GROUP BY \n        OFFER_DEPT_NAME\n),\nGrandTotal AS (\n    SELECT \n        'TOTAL' AS CurrentStatus,\n        NULL AS OFFER_DEPT_NAME,\n        MAX(MaxDurationDays) AS MaxDurationDays,\n        MAX(MaxUnits) AS MaxUnits,\n        AVG(AvgDurationDays) AS AvgDurationDays,\n        AVG(AvgUnits) AS AvgUnits\n    FROM \n        AggregatedResults\n)\nSELECT * \nFROM SubtotalResults \nUNION ALL \nSELECT * \nFROM GrandTotal\nORDER BY CurrentStatus, OFFER_DEPT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180194, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=456, prompt_tokens=3518, total_tokens=3974, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=456, prompt_tokens=3518, total_tokens=3974, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH CourseDurations AS (
    SELECT 
        A.IS_CURRENT_TERM,
        SO.OFFER_DEPT_NAME,
        JULIANDAY(A.TERM_END_DATE) - JULIANDAY(A.TERM_START_DATE) AS DurationDays,
        SS.TOTAL_UNITS
    FROM 
        ACADEMIC_TERMS_ALL A
    JOIN 
        SUBJECT_OFFERED SO ON A.TERM_CODE = SO.TERM_CODE
    JOIN 
        SUBJECT_SUMMARY SS ON SO.SUBJECT_ID = SS.SUBJECT_ID
    WHERE 
        SO.OFFER_DEPT_NAME IN ('Biology', 'Chemistry')
),
AggregatedResults AS (
    SELECT 
        ISNULL(IS_CURRENT_TERM, 'NON-CURRENT') AS CurrentStatus,
        OFFER_DEPT_NAME,
        MAX(DurationDays) AS MaxDurationDays,
        MAX(TOTAL_UNITS) AS MaxUnits,
        AVG(DurationDays) AS AvgDurationDays,
        AVG(TOTAL_UNITS) AS AvgUnits
    FROM 
        CourseDurations
    GROUP BY 
        IS_CURRENT_TERM, OFFER_DEPT_NAME
),
SubtotalResults AS (
    SELECT 
        CurrentStatus,
        OFFER_DEPT_NAME,
        MAXDurationDays,
        MAXUnits,
        AvgDurationDays,
        AvgUnits
    FROM 
        AggregatedResults
    UNION ALL
    SELECT 
        'SUBTOTAL' AS CurrentStatus,
        OFFER_DEPT_NAME,
        MAX(MaxDurationDays) AS MaxDurationDays,
        MAX(MaxUnits) AS MaxUnits,
        AVG(AvgDurationDays) AS AvgDurationDays,
        AVG(AvgUnits) AS AvgUnits
    FROM 
        AggregatedResults
    GROUP BY 
        OFFER_DEPT_NAME
),
GrandTotal AS (
    SELECT 
        'TOTAL' AS CurrentStatus,
        NULL AS OFFER_DEPT_NAME,
        MAX(MaxDurationDays) AS MaxDurationDays,
        MAX(MaxUnits) AS MaxUnits,
        AVG(AvgDurationDays) AS AvgDurationDays,
        AVG(AvgUnits) AS AvgUnits
    FROM 
        AggregatedResults
)
SELECT * 
FROM SubtotalResults 
UNION ALL 
SELECT * 
FROM GrandTotal
ORDER BY CurrentStatus, OFFER_DEPT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3518, 456
TOTAL                  : 252429, 227253, 25176
AVG                    : 2549.79, 2295.48, 254.30
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: TIP_DETAIL
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002015FA', '0010000002017FA', '0010000002018FA']),
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(TIP_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['  ', 'BR', 'CL']),
(TERM_CODE:VARCHAR2, Examples: ['2010FA', '2010JA', '2010SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(ISBN:VARCHAR2, Examples: ['9780486113647', '9780486112152', '8220102799158']),
(RECORD_COUNT:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]
# Table: TIP_MATERIAL
[
(TIP_MATERIAL_KEY:VARCHAR2, Examples: ['0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142016FA', '0 AMERICAN POPULAR MUSIC-TEXT ONLY4TH 142017FA', '0 BASIC MANDARIN CHINESE:RDG.+WRTG.-TEXT172019JA']),
(ISBN:VARCHAR2, Examples: ['9780486161976', '9780486153803', '9780486111452']),
(TITLE:VARCHAR2, Examples: ['Course has no materials', 'Ebk The Emperor Of Ice-Cream And Other ', 'Ebk Imagist Poetry                     ']),
(AUTHOR:VARCHAR2, Examples: ['Course has no materials', 'Stevens       ', 'Blaisdell     ']),
(EDITION:VARCHAR2, Examples: ['Ann    ', '       ', 'Fourth ']),
(PUBLISHER:VARCHAR2, Examples: ['Yuzu      ', 'Vst', 'Dgtl Bncom']),
(YEAR:VARCHAR2, Examples: ['2000', '1996', '2011']),
(NEW_SHELF_PRICE:NUMBER, Examples: [0, 6, 4]),
(USED_SHELF_PRICE:NUMBER, Examples: [0, 70, 80]),
(RENTAL_NEW_PRICE:NUMBER, Examples: [0, 10, 53]),
(RENTAL_USED_PRICE:NUMBER, Examples: [0, 7, 39]),
(MATERIAL_INFO_SOURCE:VARCHAR2, Examples: ['ISBN', 'COOP', 'OTI'])
]
# Table: TIP_SUBJECT_OFFERED
[
(TIP_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['0010000002016FA', '0010000002017FA', '0010000002020FA']),
(TERM_CODE:VARCHAR2, Examples: ['1986FA', '1992FA', '1993FA']),
(IS_NO_COURSE_MATERIAL:VARCHAR2, Examples: ['Y', 'N']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.004']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.041', '  1.141', '  1.212']),
(COURSE_NUMBER:VARCHAR2, Examples: ['5', '18', '15']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  5', ' 18', ' 15']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.000', '  1.001']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Chemistry Lab Techniques', 'Undergrad Research Wellesley', 'Special Seminar in Management']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Chemistry', 'Mathematics', 'Management']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Science', 'Sloan School of Management', 'Hum, Arts & Social Sciences']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Ryan, Mario', 'Newman, Halima', 'Morales, Brianna']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [8, 1, 55]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['20-DEC-24'])
]

### Question ###
Group master courses by department. For each group, state the name of the department, the master course code, the number of subjects, the total new shelf price of associated TIP materials, and the number of unique TIP materials. Display the department and master course only if it differs from the previous entry. Include subtotals for each department and a grand total across all departments. All numerical values should be rounded to integers and formatted using commas as thousands separators.

(Hints: Schema Mapping Hints:
- 'name of the department' is related to TIP_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'master course code' is related to TIP_SUBJECT_OFFERED.MASTER_COURSE_NUMBER
- 'subjects' is related to TIP_SUBJECT_OFFERED.SUBJECT_ID
- 'new shelf price' is related to TIP_MATERIAL.NEW_SHELF_PRICE
- 'TIP materials' is related to TIP_MATERIAL.ISBN

Join Information: (TIP_DETAIL.TIP_MATERIAL_KEY = TIP_MATERIAL.TIP_MATERIAL_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoaRamQt6iG5t8wiLeEY0tf32iEi', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nWITH DepartmentCourse AS (\n    SELECT \n        o.OFFER_DEPT_NAME AS Department,\n        o.MASTER_COURSE_NUMBER AS MasterCourse,\n        COUNT(DISTINCT o.SUBJECT_ID) AS NumberOfSubjects,\n        SUM(ROUND(m.NEW_SHELF_PRICE)) AS TotalNewShelfPrice,\n        COUNT(DISTINCT m.ISBN) AS UniqueTIPMaterials\n    FROM \n        TIP_SUBJECT_OFFERED o\n    LEFT JOIN \n        TIP_DETAIL d ON o.TIP_SUBJECT_OFFERED_KEY = d.TIP_SUBJECT_OFFERED_KEY\n    LEFT JOIN \n        TIP_MATERIAL m ON d.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY\n    GROUP BY \n        o.OFFER_DEPT_NAME, o.MASTER_COURSE_NUMBER\n),\nDepartmentTotal AS (\n    SELECT \n        Department,\n        SUM(NumberOfSubjects) AS NumberOfSubjectsTotal,\n        SUM(TotalNewShelfPrice) AS TotalNewShelfPriceTotal,\n        SUM(UniqueTIPMaterials) AS UniqueTIPMaterialsTotal\n    FROM \n        DepartmentCourse\n    GROUP BY \n        Department\n),\nGrandTotal AS (\n    SELECT \n        SUM(NumberOfSubjects) AS GrandNumberOfSubjects,\n        SUM(TotalNewShelfPrice) AS GrandTotalNewShelfPrice,\n        SUM(UniqueTIPMaterials) AS GrandUniqueTIPMaterials\n    FROM \n        DepartmentTotal\n)\n\nSELECT \n    dc.Department,\n    dc.MasterCourse,\n    dc.NumberOfSubjects,\n    FORMAT(dc.TotalNewShelfPrice, 0) AS TotalNewShelfPrice,\n    dc.UniqueTIPMaterials,\n    dt.NumberOfSubjectsTotal,\n    FORMAT(dt.TotalNewShelfPriceTotal, 0) AS TotalNewShelfPriceTotal,\n    dt.UniqueTIPMaterialsTotal,\n    gt.GrandNumberOfSubjects,\n    FORMAT(gt.GrandTotalNewShelfPrice, 0) AS GrandTotalNewShelfPrice,\n    gt.GrandUniqueTIPMaterials\nFROM \n    DepartmentCourse dc\nJOIN \n    DepartmentTotal dt ON dc.Department = dt.Department\nCROSS JOIN \n    GrandTotal gt\nORDER BY \n    dc.Department, dc.MasterCourse;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180203, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=435, prompt_tokens=1470, total_tokens=1905, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=435, prompt_tokens=1470, total_tokens=1905, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
WITH DepartmentCourse AS (
    SELECT 
        o.OFFER_DEPT_NAME AS Department,
        o.MASTER_COURSE_NUMBER AS MasterCourse,
        COUNT(DISTINCT o.SUBJECT_ID) AS NumberOfSubjects,
        SUM(ROUND(m.NEW_SHELF_PRICE)) AS TotalNewShelfPrice,
        COUNT(DISTINCT m.ISBN) AS UniqueTIPMaterials
    FROM 
        TIP_SUBJECT_OFFERED o
    LEFT JOIN 
        TIP_DETAIL d ON o.TIP_SUBJECT_OFFERED_KEY = d.TIP_SUBJECT_OFFERED_KEY
    LEFT JOIN 
        TIP_MATERIAL m ON d.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY
    GROUP BY 
        o.OFFER_DEPT_NAME, o.MASTER_COURSE_NUMBER
),
DepartmentTotal AS (
    SELECT 
        Department,
        SUM(NumberOfSubjects) AS NumberOfSubjectsTotal,
        SUM(TotalNewShelfPrice) AS TotalNewShelfPriceTotal,
        SUM(UniqueTIPMaterials) AS UniqueTIPMaterialsTotal
    FROM 
        DepartmentCourse
    GROUP BY 
        Department
),
GrandTotal AS (
    SELECT 
        SUM(NumberOfSubjects) AS GrandNumberOfSubjects,
        SUM(TotalNewShelfPrice) AS GrandTotalNewShelfPrice,
        SUM(UniqueTIPMaterials) AS GrandUniqueTIPMaterials
    FROM 
        DepartmentTotal
)

SELECT 
    dc.Department,
    dc.MasterCourse,
    dc.NumberOfSubjects,
    FORMAT(dc.TotalNewShelfPrice, 0) AS TotalNewShelfPrice,
    dc.UniqueTIPMaterials,
    dt.NumberOfSubjectsTotal,
    FORMAT(dt.TotalNewShelfPriceTotal, 0) AS TotalNewShelfPriceTotal,
    dt.UniqueTIPMaterialsTotal,
    gt.GrandNumberOfSubjects,
    FORMAT(gt.GrandTotalNewShelfPrice, 0) AS GrandTotalNewShelfPrice,
    gt.GrandUniqueTIPMaterials
FROM 
    DepartmentCourse dc
JOIN 
    DepartmentTotal dt ON dc.Department = dt.Department
CROSS JOIN 
    GrandTotal gt
ORDER BY 
    dc.Department, dc.MasterCourse;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1470, 435
TOTAL                  : 254334, 228723, 25611
AVG                    : 2543.34, 2287.23, 256.11
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each term and department, list the term, department, the number of courses, average number of equivalent subjects, the school name, and department phone number. Include subtotals for each term (the corresponding term field is 'SUBTOTAL') and a grand total across all terms (the corresponding term field is 'TOTAL'). Do not repeat the term if it is the same as the previous row. Sort the table by term and department.

(Hints: Schema Mapping Hints:
- 'term' is related to COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE
- 'department' is related to COURSE_CATALOG_SUBJECT_OFFERED.DEPARTMENT_NAME
- 'courses' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID
- 'equivalent subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.EQUIVALENT_SUBJECTS
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'department phone number' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER

Join Information: (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoaZ1v4izjMvXwgC2WaKthnrFAu8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH CourseStats AS (\n    SELECT \n        CCSO.TERM_CODE,\n        CCSO.DEPARTMENT_NAME,\n        COUNT(DISTINCT CCSO.SUBJECT_ID) AS course_count,\n        AVG(CASE WHEN CCSO.EQUIVALENT_SUBJECTS IS NOT NULL THEN 1 ELSE 0 END) AS avg_equivalent_subjects,\n        SD.SCHOOL_NAME,\n        SAD.DEPARTMENT_PHONE_NUMBER\n    FROM \n        COURSE_CATALOG_SUBJECT_OFFERED CCSO\n    JOIN \n        SIS_DEPARTMENT SD ON CCSO.DEPARTMENT_CODE = SD.DEPARTMENT_CODE\n    JOIN \n        SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE\n    GROUP BY \n        CCSO.TERM_CODE, CCSO.DEPARTMENT_NAME, SD.SCHOOL_NAME, SAD.DEPARTMENT_PHONE_NUMBER\n),\nTermTotals AS (\n    SELECT \n        TERM_CODE,\n        'SUBTOTAL' AS DEPARTMENT_NAME,\n        SUM(course_count) AS course_count,\n        AVG(avg_equivalent_subjects) AS avg_equivalent_subjects,\n        FIRST_VALUE(SCHOOL_NAME) OVER (PARTITION BY TERM_CODE ORDER BY DEPARTMENT_NAME) AS SCHOOL_NAME,\n        FIRST_VALUE(DEPARTMENT_PHONE_NUMBER) OVER (PARTITION BY TERM_CODE ORDER BY DEPARTMENT_NAME) AS DEPARTMENT_PHONE_NUMBER\n    FROM \n        CourseStats\n    GROUP BY \n        TERM_CODE\n),\nGrandTotal AS (\n    SELECT \n        'TOTAL' AS TERM_CODE,\n        NULL AS DEPARTMENT_NAME,\n        SUM(course_count) AS course_count,\n        AVG(avg_equivalent_subjects) AS avg_equivalent_subjects,\n        NULL AS SCHOOL_NAME,\n        NULL AS DEPARTMENT_PHONE_NUMBER\n    FROM \n        CourseStats\n)\n\nSELECT * FROM CourseStats\nUNION ALL\nSELECT * FROM TermTotals\nUNION ALL\nSELECT * FROM GrandTotal\nORDER BY TERM_CODE, DEPARTMENT_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180211, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=402, prompt_tokens=2833, total_tokens=3235, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1920)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=402, prompt_tokens=2833, total_tokens=3235, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1920))

***** FINAL SQL QUERY *****
WITH CourseStats AS (
    SELECT 
        CCSO.TERM_CODE,
        CCSO.DEPARTMENT_NAME,
        COUNT(DISTINCT CCSO.SUBJECT_ID) AS course_count,
        AVG(CASE WHEN CCSO.EQUIVALENT_SUBJECTS IS NOT NULL THEN 1 ELSE 0 END) AS avg_equivalent_subjects,
        SD.SCHOOL_NAME,
        SAD.DEPARTMENT_PHONE_NUMBER
    FROM 
        COURSE_CATALOG_SUBJECT_OFFERED CCSO
    JOIN 
        SIS_DEPARTMENT SD ON CCSO.DEPARTMENT_CODE = SD.DEPARTMENT_CODE
    JOIN 
        SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE
    GROUP BY 
        CCSO.TERM_CODE, CCSO.DEPARTMENT_NAME, SD.SCHOOL_NAME, SAD.DEPARTMENT_PHONE_NUMBER
),
TermTotals AS (
    SELECT 
        TERM_CODE,
        'SUBTOTAL' AS DEPARTMENT_NAME,
        SUM(course_count) AS course_count,
        AVG(avg_equivalent_subjects) AS avg_equivalent_subjects,
        FIRST_VALUE(SCHOOL_NAME) OVER (PARTITION BY TERM_CODE ORDER BY DEPARTMENT_NAME) AS SCHOOL_NAME,
        FIRST_VALUE(DEPARTMENT_PHONE_NUMBER) OVER (PARTITION BY TERM_CODE ORDER BY DEPARTMENT_NAME) AS DEPARTMENT_PHONE_NUMBER
    FROM 
        CourseStats
    GROUP BY 
        TERM_CODE
),
GrandTotal AS (
    SELECT 
        'TOTAL' AS TERM_CODE,
        NULL AS DEPARTMENT_NAME,
        SUM(course_count) AS course_count,
        AVG(avg_equivalent_subjects) AS avg_equivalent_subjects,
        NULL AS SCHOOL_NAME,
        NULL AS DEPARTMENT_PHONE_NUMBER
    FROM 
        CourseStats
)

SELECT * FROM CourseStats
UNION ALL
SELECT * FROM TermTotals
UNION ALL
SELECT * FROM GrandTotal
ORDER BY TERM_CODE, DEPARTMENT_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2833, 402
TOTAL                  : 257569, 231556, 26013
AVG                    : 2550.19, 2292.63, 257.55
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_CODE:VARCHAR2, Examples: ['1995FA', '1995JA', '1995SP']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['January Term 1994-1995', 'Summer Term 1995', 'Fall Term 1995-1996']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1995JA-January Term 1994-1995', '1995SU-Summer Term 1995', '1996FA-Fall Term 1995-1996']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-10', '01-FEB-16', '01-FEB-20']),
(TERM_END_DATE:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1995', '1996', '1997']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1994-1995', 'Academic Year 1995-1996', 'Academic Year 1996-1997']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(IS_REGULAR_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(TERM_STATUS:VARCHAR2, Examples: ['Previous', 'Unspecified', 'Future']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1996', '1997', '1998']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['03-FEB-95', '22-AUG-95', '22-DEC-95']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-95', '05-MAY-96', '01-MAY-96']),
(REGISTRATION_DAY:DATE, Examples: ['09-JAN-95', '12-JUN-95', '05-SEP-95']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['09-JAN-95', '12-JUN-95', '06-SEP-95']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['03-FEB-95', '22-AUG-95', '13-DEC-95']),
(ADD_DATE:DATE, Examples: ['06-OCT-95', '08-MAR-96', '07-MAR-97']),
(DROP_DATE:DATE, Examples: ['17-NOV-95', '26-APR-96', '18-APR-97']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['01-JUN-95', '01-SEP-95', '16-JAN-96']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-AUG-95', '15-JAN-96', '31-MAY-96']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
Group sessions by their current term status. For each group, state the status ('CURRENT' if is current term and 'NOT CURRENT' otherwise), name of the session, number of IAP sessions, total IAP session time in days, and average IAP session time in days. Show a subtotal for each current status and a grand total row across all status. Order the results by current status and cluster type. Display the the current status only if it differs from the previous entry.

(Hints: Schema Mapping Hints:
- 'current term status' is related to ACADEMIC_TERMS.IS_CURRENT_TERM
- 'name of the session' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'IAP sessions' is related to IAP_SUBJECT_SESSION.SESSION_DATE
- 'session time' is related to IAP_SUBJECT_SESSION.SESSION_START_TIME, IAP_SUBJECT_SESSION.SESSION_END_TIME

Join Information: (IAP_SUBJECT_DETAIL.TERM_CODE = ACADEMIC_TERMS.TERM_CODE), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsoagIg0AiD6bI1jN0bbisdLg4BYM', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nWITH SessionDurations AS (\n    SELECT \n        IAC.IAP_CATEGORY_NAME,\n        CASE \n            WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' \n            ELSE 'NOT CURRENT' \n        END AS Current_Status,\n        COUNT(ISD.IAP_SUBJECT_SESSION_KEY) AS Number_of_Sessions,\n        SUM(JULIANDAY(IAP_SESSION.SESSION_END_TIME) - JULIANDAY(IAP_SESSION.SESSION_START_TIME)) AS Total_Session_Time,\n        AVG(JULIANDAY(IAP_SESSION.SESSION_END_TIME) - JULIANDAY(IAP_SESSION.SESSION_START_TIME)) AS Average_Session_Time\n    FROM \n        ACADEMIC_TERMS AT \n    JOIN \n        IAP_SUBJECT_DETAIL ISD ON AT.TERM_CODE = ISD.TERM_CODE \n    JOIN \n        IAP_SUBJECT_SESSION IAP_SESSION ON ISD.IAP_SUBJECT_SESSION_KEY = IAP_SESSION.IAP_SUBJECT_SESSION_KEY \n    JOIN \n        IAP_SUBJECT_CATEGORY IAC ON ISD.IAP_SUBJECT_CATEGORY_KEY = IAC.IAP_SUBJECT_CATEGORY_KEY \n    GROUP BY \n        Current_Status, IAC.IAP_CATEGORY_NAME\n),\nStatusTotals AS (\n    SELECT \n        Current_Status,\n        SUM(Number_of_Sessions) AS Total_Sessions,\n        SUM(Total_Session_Time) AS Total_Time,\n        AVG(Average_Session_Time) AS Avg_Time\n    FROM \n        SessionDurations\n    GROUP BY \n        Current_Status\n)\nSELECT \n    Current_Status,\n    IAP_CATEGORY_NAME,\n    Number_of_Sessions,\n    Total_Session_Time,\n    Average_Session_Time\nFROM \n    SessionDurations\nUNION ALL\nSELECT \n    Current_Status,\n    'Subtotal' AS IAP_CATEGORY_NAME,\n    SUM(Number_of_Sessions) AS Number_of_Sessions,\n    SUM(Total_Session_Time) AS Total_Session_Time,\n    AVG(Average_Session_Time) AS Average_Session_Time\nFROM \n    SessionDurations\nGROUP BY \n    Current_Status\nUNION ALL\nSELECT \n    'Grand Total' AS Current_Status,\n    'All Sessions' AS IAP_CATEGORY_NAME,\n    SUM(Number_of_Sessions) AS Number_of_Sessions,\n    SUM(Total_Session_Time) AS Total_Session_Time,\n    AVG(Average_Session_Time) AS Average_Session_Time\nFROM \n    SessionDurations\nORDER BY \n    Current_Status, IAP_CATEGORY_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180218, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=511, prompt_tokens=2366, total_tokens=2877, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=511, prompt_tokens=2366, total_tokens=2877, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
WITH SessionDurations AS (
    SELECT 
        IAC.IAP_CATEGORY_NAME,
        CASE 
            WHEN AT.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' 
            ELSE 'NOT CURRENT' 
        END AS Current_Status,
        COUNT(ISD.IAP_SUBJECT_SESSION_KEY) AS Number_of_Sessions,
        SUM(JULIANDAY(IAP_SESSION.SESSION_END_TIME) - JULIANDAY(IAP_SESSION.SESSION_START_TIME)) AS Total_Session_Time,
        AVG(JULIANDAY(IAP_SESSION.SESSION_END_TIME) - JULIANDAY(IAP_SESSION.SESSION_START_TIME)) AS Average_Session_Time
    FROM 
        ACADEMIC_TERMS AT 
    JOIN 
        IAP_SUBJECT_DETAIL ISD ON AT.TERM_CODE = ISD.TERM_CODE 
    JOIN 
        IAP_SUBJECT_SESSION IAP_SESSION ON ISD.IAP_SUBJECT_SESSION_KEY = IAP_SESSION.IAP_SUBJECT_SESSION_KEY 
    JOIN 
        IAP_SUBJECT_CATEGORY IAC ON ISD.IAP_SUBJECT_CATEGORY_KEY = IAC.IAP_SUBJECT_CATEGORY_KEY 
    GROUP BY 
        Current_Status, IAC.IAP_CATEGORY_NAME
),
StatusTotals AS (
    SELECT 
        Current_Status,
        SUM(Number_of_Sessions) AS Total_Sessions,
        SUM(Total_Session_Time) AS Total_Time,
        AVG(Average_Session_Time) AS Avg_Time
    FROM 
        SessionDurations
    GROUP BY 
        Current_Status
)
SELECT 
    Current_Status,
    IAP_CATEGORY_NAME,
    Number_of_Sessions,
    Total_Session_Time,
    Average_Session_Time
FROM 
    SessionDurations
UNION ALL
SELECT 
    Current_Status,
    'Subtotal' AS IAP_CATEGORY_NAME,
    SUM(Number_of_Sessions) AS Number_of_Sessions,
    SUM(Total_Session_Time) AS Total_Session_Time,
    AVG(Average_Session_Time) AS Average_Session_Time
FROM 
    SessionDurations
GROUP BY 
    Current_Status
UNION ALL
SELECT 
    'Grand Total' AS Current_Status,
    'All Sessions' AS IAP_CATEGORY_NAME,
    SUM(Number_of_Sessions) AS Number_of_Sessions,
    SUM(Total_Session_Time) AS Total_Session_Time,
    AVG(Average_Session_Time) AS Average_Session_Time
FROM 
    SessionDurations
ORDER BY 
    Current_Status, IAP_CATEGORY_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2366, 511
TOTAL                  : 260446, 233922, 26524
AVG                    : 2553.39, 2293.35, 260.04
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]

### Question ###
List each academic year, the term code, and the number of newly introduced subjects in this term. Display the academic year only if it differs from the previous entry. Include a grand total (the corresponding year field should be 'TOTAL') stating the total number of subjects across all academic years.

(Hints: Schema Mapping Hints:
- 'academic year' is related to ACADEMIC_TERMS_ALL.ACADEMIC_YEAR
- 'term code' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'subjects' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_ID)

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Csoarvm9NGJ3lJBOJ2qfMgwf3QRX5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    COALESCE(academic_year, 'TOTAL') AS academic_year, \n    term_code, \n    COUNT(subject_id) AS num_of_new_subjects\nFROM (\n    SELECT \n        AACADEMIC_YEAR, \n        TERM_CODE, \n        SUBJECT_ID, \n        ROW_NUMBER() OVER (PARTITION BY AACADEMIC_YEAR, TERM_CODE ORDER BY SUBJECT_ID) AS rn \n    FROM \n        ACADEMIC_TERMS_ALL a\n    JOIN \n        COURSE_CATALOG_SUBJECT_OFFERED c ON a.TERM_CODE = c.TERM_CODE\n    WHERE \n        rn = 1\n) t\nGROUP BY \n    ROLLUP(academic_year, term_code)\nHAVING \n    COUNT(subject_id) > 0\nORDER BY \n    academic_year, term_code;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180229, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=171, prompt_tokens=2772, total_tokens=2943, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=171, prompt_tokens=2772, total_tokens=2943, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=2176))

***** FINAL SQL QUERY *****
SELECT 
    COALESCE(academic_year, 'TOTAL') AS academic_year, 
    term_code, 
    COUNT(subject_id) AS num_of_new_subjects
FROM (
    SELECT 
        AACADEMIC_YEAR, 
        TERM_CODE, 
        SUBJECT_ID, 
        ROW_NUMBER() OVER (PARTITION BY AACADEMIC_YEAR, TERM_CODE ORDER BY SUBJECT_ID) AS rn 
    FROM 
        ACADEMIC_TERMS_ALL a
    JOIN 
        COURSE_CATALOG_SUBJECT_OFFERED c ON a.TERM_CODE = c.TERM_CODE
    WHERE 
        rn = 1
) t
GROUP BY 
    ROLLUP(academic_year, term_code)
HAVING 
    COUNT(subject_id) > 0
ORDER BY 
    academic_year, term_code;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 2772, 171
TOTAL                  : 263389, 236694, 26695
AVG                    : 2557.17, 2298.00, 259.17
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]

### Question ###
For email lists with names starting with e (case insensitive), containing 10 to 20 members inclusive, and where over 75% are computer science students, provide the list name, owner, and member count.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'computer science' is related to MIT_STUDENT_DIRECTORY.DEPARTMENT
- 'owner' is related to MOIRA_LIST_OWNER.OWNER

Join Information: (SE_PERSON.FULL_NAME = MIT_STUDENT_DIRECTORY.FULL_NAME), (MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER = SE_PERSON.KRB_NAME), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Csoave5GskIPb8pzsi4o2eh6M0G0q', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT ml.MOIRA_LIST_NAME, mo.OWNER, COUNT(mld.MOIRA_LIST_MEMBER) AS member_count\nFROM MOIRA_LIST ml\nJOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\nJOIN MOIRA_LIST_OWNER mo ON mld.MOIRA_LIST_OWNER_KEY = mo.MOIRA_LIST_OWNER_KEY\nJOIN SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME\nJOIN MIT_STUDENT_DIRECTORY msd ON sp.FULL_NAME = msd.FULL_NAME\nWHERE ml.MOIRA_LIST_NAME LIKE 'e%' \nGROUP BY ml.MOIRA_LIST_NAME, mo.OWNER\nHAVING COUNT(mld.MOIRA_LIST_MEMBER) BETWEEN 10 AND 20 \n   AND SUM(CASE WHEN msd.DEPARTMENT = '10' THEN 1 ELSE 0 END) * 1.0 / COUNT(mld.MOIRA_LIST_MEMBER) > 0.75;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180233, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=207, prompt_tokens=1429, total_tokens=1636, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=207, prompt_tokens=1429, total_tokens=1636, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT ml.MOIRA_LIST_NAME, mo.OWNER, COUNT(mld.MOIRA_LIST_MEMBER) AS member_count
FROM MOIRA_LIST ml
JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
JOIN MOIRA_LIST_OWNER mo ON mld.MOIRA_LIST_OWNER_KEY = mo.MOIRA_LIST_OWNER_KEY
JOIN SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME
JOIN MIT_STUDENT_DIRECTORY msd ON sp.FULL_NAME = msd.FULL_NAME
WHERE ml.MOIRA_LIST_NAME LIKE 'e%' 
GROUP BY ml.MOIRA_LIST_NAME, mo.OWNER
HAVING COUNT(mld.MOIRA_LIST_MEMBER) BETWEEN 10 AND 20 
   AND SUM(CASE WHEN msd.DEPARTMENT = '10' THEN 1 ELSE 0 END) * 1.0 / COUNT(mld.MOIRA_LIST_MEMBER) > 0.75;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1429, 207
TOTAL                  : 265025, 238123, 26902
AVG                    : 2548.32, 2289.64, 258.67
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For students with last names starting with K, list their names, the phone numbers of departments they belong to, total number of mailing lists each student is in, and the average size of the mailing lists each student is in.

(Hints: Schema Mapping Hints:
- 'last names' is related to MIT_STUDENT_DIRECTORY.LAST_NAME
- 'names' is related to MIT_STUDENT_DIRECTORY.FULL_NAME
- 'phone numbers' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'mailing lists' is related to MOIRA_LIST.MOIRA_LIST_KEY

Join Information: (MOIRA_LIST_DETAIL.MOIRA_LIST_KEY = MOIRA_LIST.MOIRA_LIST_KEY), (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_DEPARTMENT.DEPARTMENT_CODE = SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE), (MIT_STUDENT_DIRECTORY.FULL_NAME = SE_PERSON.FULL_NAME), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Csob0kS4clOz95wxHElsgyurhXMiy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    MSD.FULL_NAME, \n    SAD.DEPARTMENT_PHONE_NUMBER, \n    COUNT(MLD.MOIRA_LIST_KEY) AS total_maillists, \n    AVG(SIZE) AS avg_maillist_size\nFROM \n    MIT_STUDENT_DIRECTORY MSD\nJOIN \n    SIS_DEPARTMENT SD ON MSD.DEPARTMENT = SD.DEPARTMENT_CODE\nJOIN \n    SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE\nLEFT JOIN \n    MOIRA_LIST_DETAIL MLD ON MSD.FULL_NAME = MLD.MOIRA_LIST_MEMBER_FULL_NAME\nLEFT JOIN \n    (SELECT MOIRA_LIST_KEY, COUNT(MOIRA_LIST_MEMBER) AS SIZE\n     FROM MOIRA_LIST_DETAIL\n     GROUP BY MOIRA_LIST_KEY) AS ML_SIZE ON MLD.MOIRA_LIST_KEY = ML_SIZE.MOIRA_LIST_KEY\nWHERE \n    MSD.LAST_NAME LIKE 'K%' \nGROUP BY \n    MSD.FULL_NAME, SAD.DEPARTMENT_PHONE_NUMBER;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180238, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=215, prompt_tokens=1867, total_tokens=2082, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=215, prompt_tokens=1867, total_tokens=2082, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    MSD.FULL_NAME, 
    SAD.DEPARTMENT_PHONE_NUMBER, 
    COUNT(MLD.MOIRA_LIST_KEY) AS total_maillists, 
    AVG(SIZE) AS avg_maillist_size
FROM 
    MIT_STUDENT_DIRECTORY MSD
JOIN 
    SIS_DEPARTMENT SD ON MSD.DEPARTMENT = SD.DEPARTMENT_CODE
JOIN 
    SIS_ADMIN_DEPARTMENT SAD ON SD.DEPARTMENT_CODE = SAD.SIS_ADMIN_DEPARTMENT_CODE
LEFT JOIN 
    MOIRA_LIST_DETAIL MLD ON MSD.FULL_NAME = MLD.MOIRA_LIST_MEMBER_FULL_NAME
LEFT JOIN 
    (SELECT MOIRA_LIST_KEY, COUNT(MOIRA_LIST_MEMBER) AS SIZE
     FROM MOIRA_LIST_DETAIL
     GROUP BY MOIRA_LIST_KEY) AS ML_SIZE ON MLD.MOIRA_LIST_KEY = ML_SIZE.MOIRA_LIST_KEY
WHERE 
    MSD.LAST_NAME LIKE 'K%' 
GROUP BY 
    MSD.FULL_NAME, SAD.DEPARTMENT_PHONE_NUMBER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1867, 215
TOTAL                  : 267107, 239990, 27117
AVG                    : 2543.88, 2285.62, 258.26
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SE_PERSON
[
(MIT_ID:VARCHAR2, Examples: ['900007147', '900010861', '900032543']),
(KRB_NAME:VARCHAR2, Examples: ['hattiem', 'eliseh5', 'tv5']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Aiza', 'Abbott, Alessandro', 'Abbott, Audrey']),
(PAYROLL_RANK:VARCHAR2, Examples: ['Grad Std RA', 'Grad Std Fellow', 'Grad Std TA']),
(POSITION_TITLE:VARCHAR2),
(IS_ACTIVE:CHAR, Examples: ['Y']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['37-392H', '8-110', '18-146C']),
(ORGANIZATION:VARCHAR2, Examples: ['Chemistry', 'Operations Research Center', 'Mechanical Engineering']),
(FIRST_NAME:VARCHAR2, Examples: ['Hattie', 'Elise', 'Troy']),
(LAST_NAME:VARCHAR2, Examples: ['Morse', 'Holland', 'Vance']),
(MIDDLE_NAME:VARCHAR2, Examples: ['Curry', 'Y', 'B']),
(EMPLOYEE_TYPE:VARCHAR2, Examples: ['Student', 'Other Academic Group', 'Faculty'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
From the 100 email lists with the most number of subscribers, list their names, their total number of subscribers, their public status, the name of the department with the most presence in the list, and the number of students from this department in the list.

(Hints: Schema Mapping Hints:
- 'names' is related to MOIRA_LIST.MOIRA_LIST_NAME
- 'subscribers' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER
- 'public status' is related to MOIRA_LIST.IS_PUBLIC
- 'department' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'students' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (SIS_DEPARTMENT.DEPARTMENT_CODE = MIT_STUDENT_DIRECTORY.DEPARTMENT))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Csob4PyTgSEPsUiHJi33tlptl3Miv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nWITH SubscriberCounts AS (\n    SELECT \n        ml.MOIRA_LIST_NAME,\n        COUNT(mld.MOIRA_LIST_MEMBER) AS total_subscribers,\n        ml.IS_PUBLIC,\n        mld.MOIRA_LIST_MEMBER_MIT_ID\n    FROM \n        MOIRA_LIST ml\n    JOIN \n        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\n    GROUP BY \n        ml.MOIRA_LIST_NAME, ml.IS_PUBLIC\n),\nDepartmentCounts AS (\n    SELECT \n        sc.MOIRA_LIST_NAME,\n        sd.DEPARTMENT_NAME,\n        COUNT(*) AS student_count\n    FROM \n        SubscriberCounts sc\n    JOIN \n        MIT_STUDENT_DIRECTORY msd ON sc.MOIRA_LIST_MEMBER_MIT_ID = msd.FULL_NAME_UPPERCASE\n    JOIN \n        SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE\n    GROUP BY \n        sc.MOIRA_LIST_NAME, sd.DEPARTMENT_NAME\n),\nMaxDepartments AS (\n    SELECT \n        dc.MOIRA_LIST_NAME,\n        dc.DEPARTMENT_NAME,\n        dc.student_count,\n        ROW_NUMBER() OVER (PARTITION BY dc.MOIRA_LIST_NAME ORDER BY dc.student_count DESC) AS rn\n    FROM \n        DepartmentCounts dc\n)\nSELECT \n    sc.MOIRA_LIST_NAME,\n    sc.total_subscribers,\n    sc.IS_PUBLIC,\n    md.DEPARTMENT_NAME,\n    md.student_count\nFROM \n    SubscriberCounts sc\nLEFT JOIN \n    MaxDepartments md ON sc.MOIRA_LIST_NAME = md.MOIRA_LIST_NAME AND md.rn = 1\nORDER BY \n    sc.total_subscribers DESC\nLIMIT 100;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180242, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=361, prompt_tokens=1684, total_tokens=2045, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=361, prompt_tokens=1684, total_tokens=2045, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
WITH SubscriberCounts AS (
    SELECT 
        ml.MOIRA_LIST_NAME,
        COUNT(mld.MOIRA_LIST_MEMBER) AS total_subscribers,
        ml.IS_PUBLIC,
        mld.MOIRA_LIST_MEMBER_MIT_ID
    FROM 
        MOIRA_LIST ml
    JOIN 
        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY
    GROUP BY 
        ml.MOIRA_LIST_NAME, ml.IS_PUBLIC
),
DepartmentCounts AS (
    SELECT 
        sc.MOIRA_LIST_NAME,
        sd.DEPARTMENT_NAME,
        COUNT(*) AS student_count
    FROM 
        SubscriberCounts sc
    JOIN 
        MIT_STUDENT_DIRECTORY msd ON sc.MOIRA_LIST_MEMBER_MIT_ID = msd.FULL_NAME_UPPERCASE
    JOIN 
        SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE
    GROUP BY 
        sc.MOIRA_LIST_NAME, sd.DEPARTMENT_NAME
),
MaxDepartments AS (
    SELECT 
        dc.MOIRA_LIST_NAME,
        dc.DEPARTMENT_NAME,
        dc.student_count,
        ROW_NUMBER() OVER (PARTITION BY dc.MOIRA_LIST_NAME ORDER BY dc.student_count DESC) AS rn
    FROM 
        DepartmentCounts dc
)
SELECT 
    sc.MOIRA_LIST_NAME,
    sc.total_subscribers,
    sc.IS_PUBLIC,
    md.DEPARTMENT_NAME,
    md.student_count
FROM 
    SubscriberCounts sc
LEFT JOIN 
    MaxDepartments md ON sc.MOIRA_LIST_NAME = md.MOIRA_LIST_NAME AND md.rn = 1
ORDER BY 
    sc.total_subscribers DESC
LIMIT 100;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1684, 361
TOTAL                  : 269152, 241674, 27478
AVG                    : 2539.17, 2279.94, 259.23
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
Calculate the total assignable and non-assignable area for each building by summing up the respective areas of all its floors. For each building, list the building name, building number, total assignable area, total non-assignable area, and total room count, sorted in descending order of the total assignable area.

(Hints: Schema Mapping Hints:
- 'building name' is related to FAC_BUILDING.BUILDING_NAME
- 'building number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'assignable area' is related to FAC_FLOOR.ASSIGNABLE_AREA
- 'non-assignable area' is related to FAC_FLOOR.NON_ASSIGNABLE_AREA
- 'room' is related to FAC_ROOMS.FAC_ROOM_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_FLOOR.BUILDING_KEY), (FAC_FLOOR.BUILDING_KEY = FAC_ROOMS.BUILDING_KEY), (FAC_FLOOR.FLOOR = FAC_ROOMS.FLOOR))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobDSSLEDKVCR90k3JfxPm9T0rS0', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    b.BUILDING_NAME AS building_name,\n    b.BUILDING_NUMBER AS building_number,\n    SUM(f.ASSIGNABLE_AREA) AS total_assignable_area,\n    SUM(f.NON_ASSIGNABLE_AREA) AS total_non_assignable_area,\n    COUNT(r.FAC_ROOM_KEY) AS total_room_count\nFROM \n    FAC_BUILDING b\nJOIN \n    FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY\nJOIN \n    FAC_ROOMS r ON f.BUILDING_KEY = r.BUILDING_KEY AND f.FLOOR = r.FLOOR\nGROUP BY \n    b.BUILDING_NAME, b.BUILDING_NUMBER\nORDER BY \n    total_assignable_area DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180251, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=155, prompt_tokens=1961, total_tokens=2116, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1152)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=155, prompt_tokens=1961, total_tokens=2116, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1152))

***** FINAL SQL QUERY *****
SELECT 
    b.BUILDING_NAME AS building_name,
    b.BUILDING_NUMBER AS building_number,
    SUM(f.ASSIGNABLE_AREA) AS total_assignable_area,
    SUM(f.NON_ASSIGNABLE_AREA) AS total_non_assignable_area,
    COUNT(r.FAC_ROOM_KEY) AS total_room_count
FROM 
    FAC_BUILDING b
JOIN 
    FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY
JOIN 
    FAC_ROOMS r ON f.BUILDING_KEY = r.BUILDING_KEY AND f.FLOOR = r.FLOOR
GROUP BY 
    b.BUILDING_NAME, b.BUILDING_NUMBER
ORDER BY 
    total_assignable_area DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1961, 155
TOTAL                  : 271268, 243635, 27633
AVG                    : 2535.21, 2276.96, 258.25
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_MAJOR_USE
[
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE:VARCHAR2, Examples: ['BLDG SRV', 'CIRCULAT', 'CLASSRMS']),
(DESCRIPTION:VARCHAR2, Examples: ['BLDG SERVICE AREA', 'CIRCULATION AREA', 'CLASSROOMS']),
(ASSIGNABLE:VARCHAR2, Examples: ['0', '1']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: FAC_ORGANIZATION
[
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_ID:VARCHAR2, Examples: ['189', '194', '206']),
(ORGANIZATION:VARCHAR2, Examples: ['LIBRAR', 'LM&P', 'MUSEUM']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['LIBRARIES', 'LAB FOR MFG&PROD', 'MIT MUSEUM']),
(ORG_PARENT_KEY:VARCHAR2, Examples: ['148', '199', '108']),
(ORG_PARENT:VARCHAR2, Examples: ['DIRLIB', 'MECH', 'APRART']),
(MAJOR_ORG_KEY:VARCHAR2, Examples: ['230', '210', '129']),
(MAJOR_ORG:VARCHAR2, Examples: ['PROVST', 'OFPRES', 'CHNCLR']),
(ORGANIZATION_LEVEL:VARCHAR2, Examples: ['5', '6', '4']),
(ORGANIZATION_NUMBER:VARCHAR2, Examples: ['271000', '69700', '401811']),
(ORGANIZATION_SORT:VARCHAR2, Examples: ['101060018', '101060122', '101060012']),
(ASSIGNABLE:VARCHAR2, Examples: ['1', '0']),
(COURSE:VARCHAR2, Examples: ['14', '21F', '21L']),
(DESCRIPTION:VARCHAR2, Examples: ['MIT.Nano', 'Department of Economics', 'Global Studies and Languages']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(D_CODE:VARCHAR2, Examples: ['D_LIBRARIES', 'D_MECHE', 'D_MUSEUM']),
(HR_DEPARTMENT_CODE_OLD:VARCHAR2, Examples: ['271000', '69700', '401811']),
(HR_ORG_UNIT_ID:VARCHAR2, Examples: ['10000579', '10000352', '10000604']),
(HR_DEPARTMENT_NAME:VARCHAR2, Examples: ['Libraries', 'Lab for Manufacturing & Productivity', 'Museum'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List all rooms in building 45, including their full name, area, major use, the organization that occupies them, the count of rooms per major use, and the total area occupied by rooms for each organization.

(Hints: Schema Mapping Hints:
- 'building 45' is related to FAC_ROOMS.BUILDING_KEY
- 'full name' is related to FAC_ROOMS.ROOM_FULL_NAME
- 'area' is related to FAC_ROOMS.AREA
- 'major use' is related to FAC_MAJOR_USE.MAJOR_USE
- 'organization' is related to FAC_ORGANIZATION.ORGANIZATION_NAME
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY

Join Information: (FAC_ROOMS.MAJOR_USE_KEY = FAC_MAJOR_USE.MAJOR_USE_KEY), (FAC_ROOMS.ORGANIZATION_KEY = FAC_ORGANIZATION.ORGANIZATION_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobHda3mjmXdIggEZ4yAaBWAebPC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    FR.ROOM_FULL_NAME,\n    FR.AREA,\n    FMU.MAJOR_USE,\n    FO.ORGANIZATION_NAME,\n    COUNT(FR.FAC_ROOM_KEY) OVER (PARTITION BY FMU.MAJOR_USE) AS room_count_per_major_use,\n    SUM(FR.AREA) OVER (PARTITION BY FO.ORGANIZATION_NAME) AS total_area_per_organization\nFROM \n    FAC_ROOMS FR\nJOIN \n    FAC_MAJOR_USE FMU ON FR.MAJOR_USE_KEY = FMU.MAJOR_USE_KEY\nJOIN \n    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY\nWHERE \n    FR.BUILDING_KEY = '45';\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180255, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=147, prompt_tokens=1310, total_tokens=1457, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=147, prompt_tokens=1310, total_tokens=1457, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    FR.ROOM_FULL_NAME,
    FR.AREA,
    FMU.MAJOR_USE,
    FO.ORGANIZATION_NAME,
    COUNT(FR.FAC_ROOM_KEY) OVER (PARTITION BY FMU.MAJOR_USE) AS room_count_per_major_use,
    SUM(FR.AREA) OVER (PARTITION BY FO.ORGANIZATION_NAME) AS total_area_per_organization
FROM 
    FAC_ROOMS FR
JOIN 
    FAC_MAJOR_USE FMU ON FR.MAJOR_USE_KEY = FMU.MAJOR_USE_KEY
JOIN 
    FAC_ORGANIZATION FO ON FR.ORGANIZATION_KEY = FO.ORGANIZATION_KEY
WHERE 
    FR.BUILDING_KEY = '45';

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1310, 147
TOTAL                  : 272725, 244945, 27780
AVG                    : 2525.23, 2268.01, 257.22
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_BUILDING_ADDRESS
[
(BUILDING_ADDRESS_KEY:DATE, Examples: ['66-STREET', '68-E911_1', '68-MAIL']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(ADDRESS_PURPOSE:VARCHAR2, Examples: ['STREET', 'E911_1', 'MAIL']),
(ADDRESS_CITY_ID:VARCHAR2, Examples: ['25344', '25345', '708']),
(IS_E911_ADDRESS:VARCHAR2),
(STREET_NUMBER:VARCHAR2, Examples: ['25', '31', '77']),
(STREET_NUMBER_SUFFIX:VARCHAR2, Examples: ['R']),
(PRE_DIRECTIONAL:VARCHAR2),
(STREET_NAME:VARCHAR2, Examples: ['AMES', 'MASSACHUSETTS', 'MAIN']),
(STREET_SUFFIX:VARCHAR2, Examples: ['ST', 'AVE', 'DR']),
(POST_DIRECTIONAL:VARCHAR2, Examples: ['(Rear)', 'NE', 'NW']),
(CITY:VARCHAR2, Examples: ['CAMBRIDGE', 'DEDHAM', 'BOSTON']),
(STATE:VARCHAR2, Examples: ['MA', 'DC']),
(POSTAL_CODE:VARCHAR2, Examples: ['2142', '2139', '2026']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List the name, number, construction date, and type of all buildings, along with the count of addresses associated with each building, the average gross area of the buildings, and the total number of rooms in each building. Sort the results by building name.

(Hints: Schema Mapping Hints:
- 'name' is related to FAC_BUILDING.BUILDING_NAME
- 'number' is related to FAC_BUILDING.BUILDING_NUMBER
- 'construction date' is related to FAC_BUILDING.DATE_BUILT
- 'type' is related to FAC_BUILDING.BUILDING_TYPE
- 'addresses' is related to FAC_BUILDING_ADDRESS.BUILDING_ADDRESS_KEY
- 'gross area' is related to FAC_BUILDING.EXT_GROSS_AREA
- 'rooms' is related to FAC_ROOMS.FAC_ROOM_KEY

Join Information: (FAC_BUILDING.FAC_BUILDING_KEY = FAC_BUILDING_ADDRESS.BUILDING_KEY), (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobKoB4oWkkxlABpT4y3Rfatyy4d', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    FB.BUILDING_NAME AS name,\n    FB.BUILDING_NUMBER AS number,\n    FB.DATE_BUILT AS construction_date,\n    FB.BUILDING_TYPE AS type,\n    COUNT(DISTINCT FBA.BUILDING_ADDRESS_KEY) AS address_count,\n    AVG(CAST(FB.EXT_GROSS_AREA AS FLOAT)) AS average_gross_area,\n    COUNT(DISTINCT FR.FAC_ROOM_KEY) AS total_rooms\nFROM \n    FAC_BUILDING FB\nLEFT JOIN \n    FAC_BUILDING_ADDRESS FBA ON FB.FAC_BUILDING_KEY = FBA.BUILDING_KEY\nLEFT JOIN \n    FAC_ROOMS FR ON FB.FAC_BUILDING_KEY = FR.BUILDING_KEY\nGROUP BY \n    FB.BUILDING_NAME, FB.BUILDING_NUMBER, FB.DATE_BUILT, FB.BUILDING_TYPE\nORDER BY \n    FB.BUILDING_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180258, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=186, prompt_tokens=1928, total_tokens=2114, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=186, prompt_tokens=1928, total_tokens=2114, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    FB.BUILDING_NAME AS name,
    FB.BUILDING_NUMBER AS number,
    FB.DATE_BUILT AS construction_date,
    FB.BUILDING_TYPE AS type,
    COUNT(DISTINCT FBA.BUILDING_ADDRESS_KEY) AS address_count,
    AVG(CAST(FB.EXT_GROSS_AREA AS FLOAT)) AS average_gross_area,
    COUNT(DISTINCT FR.FAC_ROOM_KEY) AS total_rooms
FROM 
    FAC_BUILDING FB
LEFT JOIN 
    FAC_BUILDING_ADDRESS FBA ON FB.FAC_BUILDING_KEY = FBA.BUILDING_KEY
LEFT JOIN 
    FAC_ROOMS FR ON FB.FAC_BUILDING_KEY = FR.BUILDING_KEY
GROUP BY 
    FB.BUILDING_NAME, FB.BUILDING_NUMBER, FB.DATE_BUILT, FB.BUILDING_TYPE
ORDER BY 
    FB.BUILDING_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1928, 186
TOTAL                  : 274839, 246873, 27966
AVG                    : 2521.46, 2264.89, 256.57
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each department, list its name, number of unique courses offered, the number of unique reserved materials, and the number of unique instructors associated with those courses, sorted by the number of unique courses offered in descending order.

(Hints: Schema Mapping Hints:
- 'name' is related to LIBRARY_SUBJECT_OFFERED.OFFER_DEPT_NAME
- 'course' is related to LIBRARY_SUBJECT_OFFERED.MASTER_COURSE_NUMBER
- 'reserved materials' is related to LIBRARY_RESERVE_CATALOG.CATALOG_TITLE
- 'instructors' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME

Join Information: (LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobOO9PX0z2xnW78RDBOOjyeYVt5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    so.OFFER_DEPT_NAME AS department_name,\n    COUNT(DISTINCT so.MASTER_COURSE_NUMBER) AS unique_courses,\n    COUNT(DISTINCT rc.CATALOG_TITLE) AS unique_reserved_materials,\n    COUNT(DISTINCT ci.INSTRUCTOR_NAME) AS unique_instructors\nFROM \n    LIBRARY_SUBJECT_OFFERED so\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL md ON so.LIBRARY_SUBJECT_OFFERED_KEY = md.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG rc ON md.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_COURSE_INSTRUCTOR ci ON md.LIBRARY_COURSE_INSTRUCTOR_KEY = ci.LIBRARY_COURSE_INSTRUCTOR_KEY\nGROUP BY \n    so.OFFER_DEPT_NAME\nORDER BY \n    unique_courses DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180262, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=196, prompt_tokens=1872, total_tokens=2068, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=196, prompt_tokens=1872, total_tokens=2068, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    so.OFFER_DEPT_NAME AS department_name,
    COUNT(DISTINCT so.MASTER_COURSE_NUMBER) AS unique_courses,
    COUNT(DISTINCT rc.CATALOG_TITLE) AS unique_reserved_materials,
    COUNT(DISTINCT ci.INSTRUCTOR_NAME) AS unique_instructors
FROM 
    LIBRARY_SUBJECT_OFFERED so
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL md ON so.LIBRARY_SUBJECT_OFFERED_KEY = md.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG rc ON md.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_COURSE_INSTRUCTOR ci ON md.LIBRARY_COURSE_INSTRUCTOR_KEY = ci.LIBRARY_COURSE_INSTRUCTOR_KEY
GROUP BY 
    so.OFFER_DEPT_NAME
ORDER BY 
    unique_courses DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1872, 196
TOTAL                  : 276907, 248745, 28162
AVG                    : 2517.34, 2261.32, 256.02
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]
# Table: LIBRARY_SUBJECT_OFFERED
[
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012011FA']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(MASTER_COURSE_NUMBER:VARCHAR2, Examples: ['1', '2', '3']),
(MASTER_COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', '  2', '  3']),
(MASTER_COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Mechanical Engineering', 'Materials Science and Eng']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.004', '1.010']),
(MASTER_SUBJECT_ID_SORT:VARCHAR2, Examples: ['  2.089', '  2.S997', '  4.221']),
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(COURSE_NUMBER_SORT:VARCHAR2, Examples: ['  1', ' 10', ' 11']),
(COURSE_NUMBER_DESC:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(SUBJECT_ID_SORT:VARCHAR2, Examples: ['  1.00', '  1.001', '  1.002']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Intro Comp & Engr Prob Solving', 'Eng Computation & Data Science', 'Intro to Computers & Eng Prob']),
(OFFER_DEPT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(OFFER_DEPT_NAME:VARCHAR2, Examples: ['Civil and Environmental Eng', 'Chemical Engineering', 'Urban Studies and Planning']),
(OFFER_SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Frank, Antonia', 'Mejia, Zaara', 'Jacobs, Riya']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900286928']),
(NUM_ENROLLED_STUDENTS:NUMBER, Examples: [122, 99, 111]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each course title, list the title, the total number of reserved materials, and the count of distinct material status associated with those materials, sorted by the total number of reserved materials in descending order.

(Hints: Schema Mapping Hints:
- 'title' is related to LIBRARY_SUBJECT_OFFERED.SUBJECT_TITLE
- 'reserved materials' is related to LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY
- 'material status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS

Join Information: (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobSeNpn0ilZm1SwrH13QwXxPn8C', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    LSO.SUBJECT_TITLE, \n    COUNT(DISTINCT LRM.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials,\n    COUNT(DISTINCT LMS.LIBRARY_MATERIAL_STATUS) AS distinct_material_status_count\nFROM \n    LIBRARY_SUBJECT_OFFERED LSO\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL LRM ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRM.LIBRARY_SUBJECT_OFFERED_KEY\nJOIN \n    LIBRARY_MATERIAL_STATUS LMS ON LRM.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY\nGROUP BY \n    LSO.SUBJECT_TITLE\nORDER BY \n    total_reserved_materials DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180266, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=155, prompt_tokens=1199, total_tokens=1354, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=155, prompt_tokens=1199, total_tokens=1354, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    LSO.SUBJECT_TITLE, 
    COUNT(DISTINCT LRM.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials,
    COUNT(DISTINCT LMS.LIBRARY_MATERIAL_STATUS) AS distinct_material_status_count
FROM 
    LIBRARY_SUBJECT_OFFERED LSO
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL LRM ON LSO.LIBRARY_SUBJECT_OFFERED_KEY = LRM.LIBRARY_SUBJECT_OFFERED_KEY
JOIN 
    LIBRARY_MATERIAL_STATUS LMS ON LRM.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY
GROUP BY 
    LSO.SUBJECT_TITLE
ORDER BY 
    total_reserved_materials DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1199, 155
TOTAL                  : 278261, 249944, 28317
AVG                    : 2506.86, 2251.75, 255.11
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]

### Question ###
For each instructor, list their name, the number of unique courses they teach, the total number of material assignments, average publication year, and number of distinct status, sorted by the number of unique courses in descending order.

(Hints: Schema Mapping Hints:
- 'name' is related to LIBRARY_COURSE_INSTRUCTOR.INSTRUCTOR_NAME
- 'course' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME
- 'material assignments' is related to LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY
- 'publication year' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS

Join Information: (LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobW1rL8pynIOkDP8IPwWLi2CZWp', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    ci.INSTRUCTOR_NAME, \n    COUNT(DISTINCT ci.COURSE_NAME) AS unique_courses, \n    COUNT(rm.LIBRARY_RESERVE_CATALOG_KEY) AS total_material_assignments, \n    AVG(CAST(rc.CATALOG_YEAR AS INTEGER)) AS average_publication_year, \n    COUNT(DISTINCT ms.LIBRARY_MATERIAL_STATUS_CODE) AS distinct_status\nFROM \n    LIBRARY_COURSE_INSTRUCTOR ci\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL rm ON ci.LIBRARY_COURSE_INSTRUCTOR_KEY = rm.LIBRARY_COURSE_INSTRUCTOR_KEY\nJOIN \n    LIBRARY_RESERVE_CATALOG rc ON rm.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_MATERIAL_STATUS ms ON rm.LIBRARY_MATERIAL_STATUS_KEY = ms.LIBRARY_MATERIAL_STATUS_KEY\nGROUP BY \n    ci.INSTRUCTOR_NAME\nORDER BY \n    unique_courses DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180270, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=208, prompt_tokens=1435, total_tokens=1643, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=208, prompt_tokens=1435, total_tokens=1643, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    ci.INSTRUCTOR_NAME, 
    COUNT(DISTINCT ci.COURSE_NAME) AS unique_courses, 
    COUNT(rm.LIBRARY_RESERVE_CATALOG_KEY) AS total_material_assignments, 
    AVG(CAST(rc.CATALOG_YEAR AS INTEGER)) AS average_publication_year, 
    COUNT(DISTINCT ms.LIBRARY_MATERIAL_STATUS_CODE) AS distinct_status
FROM 
    LIBRARY_COURSE_INSTRUCTOR ci
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL rm ON ci.LIBRARY_COURSE_INSTRUCTOR_KEY = rm.LIBRARY_COURSE_INSTRUCTOR_KEY
JOIN 
    LIBRARY_RESERVE_CATALOG rc ON rm.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_MATERIAL_STATUS ms ON rm.LIBRARY_MATERIAL_STATUS_KEY = ms.LIBRARY_MATERIAL_STATUS_KEY
GROUP BY 
    ci.INSTRUCTOR_NAME
ORDER BY 
    unique_courses DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1435, 208
TOTAL                  : 279904, 251379, 28525
AVG                    : 2499.14, 2244.46, 254.69
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: LIBRARY_COURSE_INSTRUCTOR
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(COURSE_NAME:VARCHAR2, Examples: ['Graduate Technical Writing Workshop', 'Practical Programming in C', 'System Architecture']),
(INSTRUCTOR_NAME:VARCHAR2, Examples: ['Abbott, Aadam', 'Abbott, Adele', 'Abbott, Ahmed']),
(DEPARTMENT:VARCHAR2, Examples: ['21W - Writing & Humanistic Studies', '06 - Electrical Eng & Computer Sci', 'Engineering Systems Division']),
(DATE_FROM:DATE, Examples: ['04-JAN-10', '07-SEP-10', '11-FEB-08']),
(DATE_TO:DATE, Examples: ['31-JAN-10', '29-JAN-10', '02-JAN-11']),
(UNIT_CODE:VARCHAR2, Examples: ['Hayden', 'ENG', 'DEW']),
(UNIT:VARCHAR2, Examples: ['Hayden', 'Barker', 'Dewey']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['01-FEB-10', '18-NOV-10', '09-MAY-08'])
]
# Table: LIBRARY_MATERIAL_STATUS
[
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(LIBRARY_MATERIAL_STATUS_CODE:VARCHAR2, Examples: ['U', 'R', 'N']),
(LIBRARY_MATERIAL_STATUS:VARCHAR2, Examples: ['Unknown', 'Non-Required Course Material', 'Reserve only']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['23-DEC-21'])
]
# Table: LIBRARY_RESERVE_CATALOG
[
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['1', '10', '1000']),
(CATALOG_TITLE:VARCHAR2, Examples: ['This course is cross-listed with 6.021. See URL for course reading list.', 'ON GOLD MOUNTAIN : THE ONE-HUNDRED-YEAR ODYSSEY OF MY CHINESE-AMERICAN FAMILY.', 'More treasures from American film archives, 1894-1931 [videorecording] : 50 films / produced by the']),
(CATALOG_AUTHOR_NAME:VARCHAR2, Examples: ['SEE, LISA', 'Xenakis, Iannis, 1922-', 'Iriye, Akira.']),
(CATALOG_YEAR:VARCHAR2, Examples: ['2000', '0', '2004']),
(CATALOG_PUBLISHER:VARCHAR2, Examples: ['NEW YORK VINTAGE 1996', 'United States : Image Entertainment, 2004.', 'Boston, Mass. ; London : Artech House, c2006.']),
(CATALOG_CALL_NUMBER:VARCHAR2, Examples: ['PN1993.5.U6.T742 2004', 'RC683.5.E5.A38 2006', 'Phon X2 W']),
(CATALOG_ISBN:VARCHAR2, Examples: ['9780795304941', '0974709913', '1580539661']),
(CATALOG_SYSTEM_NUMBER:VARCHAR2, Examples: ['74053', '3847', '26379']),
(CATALOG_RECORD_CREATE_DATE:DATE, Examples: ['19-APR-12', '28-SEP-01', '19-JAN-05']),
(CATALOG_RECORD_UPDATE_DATE:DATE, Examples: ['02-FEB-13', '19-SEP-02', '05-JAN-06']),
(RECORD_COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['03-FEB-13', '13-MAR-08', '29-MAY-14'])
]
# Table: LIBRARY_RESERVE_MATRL_DETAIL
[
(LIBRARY_COURSE_INSTRUCTOR_KEY:VARCHAR2, Examples: ['1.00-BRADFORD2009FA:1.00', '1.00-BRYANT132014FA:1.00', '1.00-CASE212021SP:1.00']),
(LIBRARY_RESERVE_CATALOG_KEY:VARCHAR2, Examples: ['100050', '100051', '100053']),
(LIBRARY_SUBJECT_OFFERED_KEY:VARCHAR2, Examples: ['1.0012008SP', '1.0012010SP', '1.0012010SU']),
(LIBRARY_MATERIAL_STATUS_KEY:VARCHAR2, Examples: ['N', 'O', 'R']),
(TERM_CODE:VARCHAR2, Examples: ['2008SP', '2008SU', '2009FA']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.001', '1.002']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['07-MAY-10', '09-MAY-08', '08-MAY-09'])
]

### Question ###
For each publication year, list the year, the total number of reserved materials, the average length of their titles, distinct number of status, and number of courses, sorted by publication year in descending order.

(Hints: Schema Mapping Hints:
- 'publication year' is related to LIBRARY_RESERVE_CATALOG.CATALOG_YEAR
- 'reserved materials' is related to LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY
- 'title' is related to LIBRARY_RESERVE_CATALOG.CATALOG_TITLE
- 'status' is related to LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS
- 'courses' is related to LIBRARY_COURSE_INSTRUCTOR.COURSE_NAME

Join Information: (LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_MATERIAL_STATUS_KEY = LIBRARY_MATERIAL_STATUS.LIBRARY_MATERIAL_STATUS_KEY), (LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobaSPnAwYlSVMUi23owZ1rb4Whb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    CATALOG_YEAR AS publication_year,\n    COUNT(DISTINCT RLC.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials,\n    AVG(LENGTH(RLC.CATALOG_TITLE)) AS average_title_length,\n    COUNT(DISTINCT LMS.LIBRARY_MATERIAL_STATUS) AS distinct_status_count,\n    COUNT(DISTINCT I.COURSE_NAME) AS total_courses\nFROM \n    LIBRARY_RESERVE_CATALOG RLC\nJOIN \n    LIBRARY_RESERVE_MATRL_DETAIL RMD ON RLC.LIBRARY_RESERVE_CATALOG_KEY = RMD.LIBRARY_RESERVE_CATALOG_KEY\nJOIN \n    LIBRARY_MATERIAL_STATUS LMS ON RMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY\nJOIN \n    LIBRARY_COURSE_INSTRUCTOR I ON RMD.LIBRARY_COURSE_INSTRUCTOR_KEY = I.LIBRARY_COURSE_INSTRUCTOR_KEY\nGROUP BY \n    CATALOG_YEAR\nORDER BY \n    publication_year DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180274, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=212, prompt_tokens=1429, total_tokens=1641, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=212, prompt_tokens=1429, total_tokens=1641, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    CATALOG_YEAR AS publication_year,
    COUNT(DISTINCT RLC.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials,
    AVG(LENGTH(RLC.CATALOG_TITLE)) AS average_title_length,
    COUNT(DISTINCT LMS.LIBRARY_MATERIAL_STATUS) AS distinct_status_count,
    COUNT(DISTINCT I.COURSE_NAME) AS total_courses
FROM 
    LIBRARY_RESERVE_CATALOG RLC
JOIN 
    LIBRARY_RESERVE_MATRL_DETAIL RMD ON RLC.LIBRARY_RESERVE_CATALOG_KEY = RMD.LIBRARY_RESERVE_CATALOG_KEY
JOIN 
    LIBRARY_MATERIAL_STATUS LMS ON RMD.LIBRARY_MATERIAL_STATUS_KEY = LMS.LIBRARY_MATERIAL_STATUS_KEY
JOIN 
    LIBRARY_COURSE_INSTRUCTOR I ON RMD.LIBRARY_COURSE_INSTRUCTOR_KEY = I.LIBRARY_COURSE_INSTRUCTOR_KEY
GROUP BY 
    CATALOG_YEAR
ORDER BY 
    publication_year DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1429, 212
TOTAL                  : 281545, 252808, 28737
AVG                    : 2491.55, 2237.24, 254.31
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each IAP category, list the category name, the sponsor name, the number of activities offered, and the average fee per activity, sorted by the number of activities in descending order.

(Hints: Schema Mapping Hints:
- 'category name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'activities' is related to IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE

Join Information: (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobfmuMjbxToGeUlIqGAxV66fYs2', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    isc.IAP_CATEGORY_NAME, \n    iss.SPONSOR_NAME, \n    COUNT(isd.IAP_SUBJECT_SESSION_KEY) AS number_of_activities, \n    AVG(isd.FEE) AS average_fee \nFROM \n    IAP_SUBJECT_CATEGORY isc\nJOIN \n    IAP_SUBJECT_DETAIL isd ON isc.IAP_SUBJECT_CATEGORY_KEY = isd.IAP_SUBJECT_CATEGORY_KEY\nJOIN \n    IAP_SUBJECT_SPONSOR iss ON isd.IAP_SUBJECT_SPONSOR_KEY = iss.IAP_SUBJECT_SPONSOR_KEY\nGROUP BY \n    isc.IAP_CATEGORY_NAME, iss.SPONSOR_NAME \nORDER BY \n    number_of_activities DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180279, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=148, prompt_tokens=1424, total_tokens=1572, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=148, prompt_tokens=1424, total_tokens=1572, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    isc.IAP_CATEGORY_NAME, 
    iss.SPONSOR_NAME, 
    COUNT(isd.IAP_SUBJECT_SESSION_KEY) AS number_of_activities, 
    AVG(isd.FEE) AS average_fee 
FROM 
    IAP_SUBJECT_CATEGORY isc
JOIN 
    IAP_SUBJECT_DETAIL isd ON isc.IAP_SUBJECT_CATEGORY_KEY = isd.IAP_SUBJECT_CATEGORY_KEY
JOIN 
    IAP_SUBJECT_SPONSOR iss ON isd.IAP_SUBJECT_SPONSOR_KEY = iss.IAP_SUBJECT_SPONSOR_KEY
GROUP BY 
    isc.IAP_CATEGORY_NAME, iss.SPONSOR_NAME 
ORDER BY 
    number_of_activities DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1424, 148
TOTAL                  : 283117, 254232, 28885
AVG                    : 2483.48, 2230.11, 253.38
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SESSION
[
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(SESSION_SEQUENCE:NUMBER),
(SESSION_TITLE:VARCHAR2, Examples: ['Module 3', 'Module 1', 'Module 2']),
(SESSION_DESCRIPTION:VARCHAR2, Examples: ['<p>Module 3 will provide information on NIH proposals more broadly, with an emphasis on biostatistics and COVID related medical', '<p>Module 1 will introduce the physiological monitoring technologies used in MIT's COVID-19 Surveillance Study, a joint initiat', '<p>Module 2 will provide foundational awareness in constraints associated with human subjects research, including ethical and r']),
(SESSION_LOCATION:VARCHAR2, Examples: ['https://mit.zoom.us/', 'NE45', 'On line']),
(SESSION_DATE:DATE, Examples: ['14-JAN-21', '15-JAN-21', '20-JAN-21']),
(SESSION_START_TIME:VARCHAR2, Examples: ['1100AM', '1030AM', '0500PM']),
(SESSION_END_TIME:VARCHAR2, Examples: ['1200PM', '1130AM', '0600PM']),
(HAS_SESSION_INFO:VARCHAR2, Examples: ['Y', 'N']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_SPONSOR
[
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(SPONSOR_NAME:VARCHAR2, Examples: ['Office of Religious, Spiritual, and Ethical Life', 'Sloan School of Management', 'Global Studies and Languages']),
(SPONSOR_TYPE:VARCHAR2, Examples: ['Administrative Department', 'Academic Department', 'Student Group']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each sponsor, list the sponsor name, the number of IAP sessions hosted, and the number of unique subjects organized.

(Hints: Schema Mapping Hints:
- 'sponsor name' is related to IAP_SUBJECT_SPONSOR.SPONSOR_NAME
- 'IAP sessions' is related to IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY
- 'subjects' is related to IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY

Join Information: (IAP_SUBJECT_SESSION.IAP_SUBJECT_SESSION_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_SESSION_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_SPONSOR_KEY = IAP_SUBJECT_SPONSOR.IAP_SUBJECT_SPONSOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobikdC2NZBAlgYydcTaEUUnk1yH', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    s.SPONSOR_NAME,\n    COUNT(DISTINCT ses.IAP_SUBJECT_SESSION_KEY) AS num_iap_sessions,\n    COUNT(DISTINCT det.IAP_SUBJECT_CATEGORY_KEY) AS num_unique_subjects\nFROM \n    IAP_SUBJECT_SPONSOR s\nLEFT JOIN \n    IAP_SUBJECT_DETAIL det ON s.IAP_SUBJECT_SPONSOR_KEY = det.IAP_SUBJECT_SPONSOR_KEY\nLEFT JOIN \n    IAP_SUBJECT_SESSION ses ON det.IAP_SUBJECT_SESSION_KEY = ses.IAP_SUBJECT_SESSION_KEY\nGROUP BY \n    s.SPONSOR_NAME;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180282, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=131, prompt_tokens=1535, total_tokens=1666, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=131, prompt_tokens=1535, total_tokens=1666, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    s.SPONSOR_NAME,
    COUNT(DISTINCT ses.IAP_SUBJECT_SESSION_KEY) AS num_iap_sessions,
    COUNT(DISTINCT det.IAP_SUBJECT_CATEGORY_KEY) AS num_unique_subjects
FROM 
    IAP_SUBJECT_SPONSOR s
LEFT JOIN 
    IAP_SUBJECT_DETAIL det ON s.IAP_SUBJECT_SPONSOR_KEY = det.IAP_SUBJECT_SPONSOR_KEY
LEFT JOIN 
    IAP_SUBJECT_SESSION ses ON det.IAP_SUBJECT_SESSION_KEY = ses.IAP_SUBJECT_SESSION_KEY
GROUP BY 
    s.SPONSOR_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1535, 131
TOTAL                  : 284783, 255767, 29016
AVG                    : 2476.37, 2224.06, 252.31
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: IAP_SUBJECT_CATEGORY
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_CATEGORY_NAME:VARCHAR2, Examples: ['Global Opportunities', 'Management and Entrepreneurship', 'Computers: Web Design and Development']),
(IAP_CATEGORY_DESC:VARCHAR2, Examples: ['Featuring explorations on entrepreneurship and technological innovation, leadership, marketing, systems dynamics, and operation', 'Including accesibility issues, web design applications, and working with GIFs and animation.', 'Including writing techniques and support groups, effective speaking, and presentation skills.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_DETAIL
[
(IAP_SUBJECT_CATEGORY_KEY:VARCHAR2, Examples: ['9289af8d58f2d2ba0158fdf98fc30270', '9289af8f50a3a6fb0150a483f24c0000', '9289af8f517c291d0151921beca0022b']),
(IAP_SUBJECT_SPONSOR_KEY:VARCHAR2, Examples: ['923dd085363aeb5a01363af9e91c0001', '9289af8d3a1d9153013a219643070002', '9289af8d3ba8cc8d013bb3910ef00114']),
(IAP_SUBJECT_SESSION_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f0175324c2314001a', '9289afec754ffaf20175769fd4930015', '9289afec754ffaf201759a818f9b0036']),
(ACTIVITY_TITLE:VARCHAR2, Examples: ['Mathematics of Big Data & Machine Learning', 'Private Pilot Ground School (16.687 Special Topics in Aeronautics and Astronautics)', 'Biomechanics in everyday life']),
(ACTIVITY_DESCRIPTION:VARCHAR2, Examples: ['<p>Big Data describes a new era in the digital age where the volume, velocity, and variety of data created across a wide range ', '<p>Would you like to fly a plane, helicopter, or commercial drone? Or understand the engineering behind today's human-occupied ', '<p>Most of us learn to breathe and walk and move&#160;at a time that we can&#8217;t recall much from and use these skills throu']),
(TERM_CODE:VARCHAR2, Examples: ['2021JA']),
(ENROLLMENT_TYPE:VARCHAR2, Examples: ['Advance sign-up required', 'No advance sign-up', 'Other']),
(MAX_ENROLLMENT:NUMBER, Examples: [30, 25, 20]),
(ATTENDANCE:VARCHAR2, Examples: ['Participants must attend all sessions', 'Participants welcome at individual sessions', 'Other']),
(PREREQUISITES:VARCHAR2, Examples: ['Matrix Mathematics', 'Register for 16.687 (U-level; 3 units; graded PDF)', 'none']),
(FEE:NUMBER, Examples: [10, 168, 36]),
(FEE_REASON:VARCHAR2, Examples: ['Class Registration', 'employee, $105 stu/postdoc/spouse, $136.50 trad/retiree', 'one lesson, packages of lessons have a discount per lesson']),
(PREREG_DEADLINE:DATE, Examples: ['31-JAN-21', '10-JAN-20', '26-JAN-21']),
(CREATE_DATE:DATE, Examples: ['16-OCT-20', '29-OCT-20', '05-NOV-20']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['26-OCT-20', '02-NOV-20', '13-NOV-20']),
(IS_MULTIPLE_SESSION:VARCHAR2, Examples: ['Y', 'N']),
(IS_CANCELLED:VARCHAR2, Examples: ['N', 'Y']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: IAP_SUBJECT_PERSON
[
(IAP_SUBJECT_PERSON_KEY:VARCHAR2, Examples: ['9289afec70152d3f01752dbcd728000f', '9289afec70152d3f0175324c2314001a', '9289afec754ffaf201756da4b165000e']),
(PERSON_ROLE:VARCHAR2, Examples: ['Activity leader', 'Session leader', 'Contact person']),
(PERSON_MIT_AFFILIATION:VARCHAR2, Examples: ['Staff', 'Senior Lecturer', 'Other MIT']),
(PERSON_NAME:VARCHAR2, Examples: ['Willie Hewitt', 'Junaid Ochoa', 'Rufus Armstrong']),
(PERSON_LOCATION:VARCHAR2, Examples: ['Register for Zoom ID', 'NE48', 'E15-413']),
(PERSON_EMAIL:VARCHAR2, Examples: ['anac@worker.com', 'ec@worker.com', 'pv@worker.com']),
(PERSON_ORGANIZATION:VARCHAR2),
(PERSON_TITLE:VARCHAR2),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each person role and IAP category, list the role, the category name, the number of people in this role, and the average fee, sorted by the role count in descending order.

(Hints: Schema Mapping Hints:
- 'role' is related to IAP_SUBJECT_PERSON.PERSON_ROLE
- 'category name' is related to IAP_SUBJECT_CATEGORY.IAP_CATEGORY_NAME
- 'people' is related to IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY
- 'fee' is related to IAP_SUBJECT_DETAIL.FEE

Join Information: (IAP_SUBJECT_PERSON.IAP_SUBJECT_PERSON_KEY = IAP_SUBJECT_DETAIL.IAP_SUBJECT_PERSON_KEY), (IAP_SUBJECT_DETAIL.IAP_SUBJECT_CATEGORY_KEY = IAP_SUBJECT_CATEGORY.IAP_SUBJECT_CATEGORY_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Csobm7Z2F63cTwU5UAmKsSK7gJM8I', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    sp.PERSON_ROLE, \n    sc.IAP_CATEGORY_NAME, \n    COUNT(sp.IAP_SUBJECT_PERSON_KEY) AS number_of_people, \n    AVG(sd.FEE) AS average_fee \nFROM \n    IAP_SUBJECT_PERSON sp \nJOIN \n    IAP_SUBJECT_DETAIL sd ON sp.IAP_SUBJECT_PERSON_KEY = sd.IAP_SUBJECT_PERSON_KEY \nJOIN \n    IAP_SUBJECT_CATEGORY sc ON sd.IAP_SUBJECT_CATEGORY_KEY = sc.IAP_SUBJECT_CATEGORY_KEY \nGROUP BY \n    sp.PERSON_ROLE, sc.IAP_CATEGORY_NAME \nORDER BY \n    number_of_people DESC;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180286, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=135, prompt_tokens=1500, total_tokens=1635, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=135, prompt_tokens=1500, total_tokens=1635, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    sp.PERSON_ROLE, 
    sc.IAP_CATEGORY_NAME, 
    COUNT(sp.IAP_SUBJECT_PERSON_KEY) AS number_of_people, 
    AVG(sd.FEE) AS average_fee 
FROM 
    IAP_SUBJECT_PERSON sp 
JOIN 
    IAP_SUBJECT_DETAIL sd ON sp.IAP_SUBJECT_PERSON_KEY = sd.IAP_SUBJECT_PERSON_KEY 
JOIN 
    IAP_SUBJECT_CATEGORY sc ON sd.IAP_SUBJECT_CATEGORY_KEY = sc.IAP_SUBJECT_CATEGORY_KEY 
GROUP BY 
    sp.PERSON_ROLE, sc.IAP_CATEGORY_NAME 
ORDER BY 
    number_of_people DESC;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1500, 135
TOTAL                  : 286418, 257267, 29151
AVG                    : 2469.12, 2217.82, 251.30
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: FAC_BUILDING
[
(FAC_BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(BUILDING_NUMBER:VARCHAR2, Examples: ['2', '39', '41']),
(PARENT_BUILDING_NUMBER:DATE, Examples: ['62', '64', 'W85DE']),
(PARENT_BUILDING_NAME:NUMBER, Examples: ['ALUMNI HOUSES: MUNROE HAYDEN WOOD', 'EAST CAMPUS: WALCOTT BEMIS GOODALE', 'WESTGATE (DE)']),
(PARENT_BUILDING_NAME_LONG:VARCHAR2, Examples: ['Alumni Houses: Munroe Hayden Wood', 'Alumni Houses: Walcott Bemis Goodale', 'Westgate DE']),
(BUILDING_NAME_LONG:VARCHAR2, Examples: ['THE SIMONS BUILDING', 'Stanley Gordon Brown Building', 'Building 41']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [133168.0, 76639.9, 26148.2]),
(ASSIGNABLE_AREA:VARCHAR2, Examples: [73695.2, 39391.1, 20058.6]),
(NON_ASSIGNABLE_AREA:VARCHAR2, Examples: [43048.0, 30704.7, 4407.76]),
(SITE:VARCHAR2, Examples: ['MIT', 'BATES', 'HAY']),
(CAMPUS_SECTOR:NUMBER, Examples: ['MAIN GROUP', 'EAST', 'NORTHEAST']),
(ACCESS_LEVEL_CODE:NUMBER, Examples: [2, 0, 1]),
(ACCESS_LEVEL_NAME:NUMBER, Examples: ['2', '0', '1']),
(BUILDING_TYPE:VARCHAR2, Examples: ['ACADEMIC', 'SERVICE', 'RESIDENT']),
(OWNERSHIP_TYPE:VARCHAR2, Examples: ['OWNED', 'LEASED']),
(BUILDING_USE:NUMBER, Examples: ['AER', 'OTH', 'DHOA']),
(OCCUPANCY_CLASS:VARCHAR2, Examples: ['UGBA3', 'UGB', '(NULL)']),
(BUILDING_HEIGHT:VARCHAR2, Examples: ['82.6', '91.1', '61.2']),
(COST_CENTER_CODE:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(COST_COLLECTOR_KEY:VARCHAR2, Examples: ['1810200', '1813900', '1814100']),
(LATITUDE_WGS:VARCHAR2, Examples: [42.3588, 42.3609, 42.3608]),
(LONGITUDE_WGS:VARCHAR2, Examples: [-71.0902, -71.0927, -71.0942]),
(EASTING_X_SPCS:VARCHAR2, Examples: [766931.0, 766239.0, 765853.0]),
(NORTHING_Y_SPCS:VARCHAR2, Examples: [2956050.0, 2956790.0, 2956750.0]),
(BUILDING_SORT:NUMBER, Examples: ['02', '39', '41']),
(BUILDING_NAMED_FOR:NUMBER, Examples: ['James H. and Marilyn Simons', 'GORDON STANLEY BROWN', '-']),
(BUILDING_NAME:NUMBER, Examples: ['THE SIMONS BUILDING', 'BROWN BUILDING', 'BUILDING 41']),
(DATE_BUILT:NUMBER, Examples: ['07/01/1913', '08/01/1966', '12/31/1915']),
(DATE_ACQUIRED:VARCHAR2, Examples: ['10/01/1958', '02/13/2024', '07/01/2016']),
(DATE_OCCUPIED:VARCHAR2, Examples: ['12/31/1916', '12/31/1968', '12/31/1917']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24']),
(NUM_OF_ROOMS:VARCHAR2, Examples: [383, 250, 106])
]
# Table: FAC_FLOOR
[
(BUILDING_KEY:DATE, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['4', '5', '1']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(EXT_GROSS_AREA:VARCHAR2, Examples: [15472.5, 1045.28, 6443.95]),
(ASSIGNABLE_AREA:NUMBER, Examples: [5264.78, 309.76, 6910.44]),
(NON_ASSIGNABLE_AREA:NUMBER, Examples: [8451.17, 534.72, 711.61]),
(FLOOR_SORT_SEQUENCE:NUMBER, Examples: ['4', '5', '1']),
(LEVEL_ID:VARCHAR2, Examples: ['4', '5', '1']),
(BUILDING_WINGS_ID:VARCHAR2, Examples: ['W61A.3', 'W61E.2 W61F.2 W61G.2 W61H.2 W61J.2 W61M.2', 'W61E.3 W61F.3 W61G.3 W61H.3 W61J.3 W61M.3']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['2', '0', '3']),
(WAREHOUSE_LOAD_DATE:VARCHAR2, Examples: ['19-DEC-24'])
]
# Table: FAC_ROOMS
[
(FAC_ROOM_KEY:DATE, Examples: ['1-001C', '1-001E', '1-002']),
(BUILDING_KEY:VARCHAR2, Examples: ['1', '10', '11']),
(FLOOR:VARCHAR2, Examples: ['1', '0', '3']),
(FLOOR_KEY:VARCHAR2, Examples: ['1-0', '1-1', '1-2']),
(ROOM:VARCHAR2, Examples: ['000', '0000', '000012']),
(SPACE_ID:VARCHAR2, Examples: ['1-1-175', '1-1-195F', '1-1-140']),
(MAJOR_USE_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(MAJOR_USE_DESC:VARCHAR2, Examples: ['MECHANIC', 'BLDG SRV', 'CIRCULAT']),
(USE_KEY:VARCHAR2, Examples: ['153', '155', '156']),
(USE_DESC:VARCHAR2),
(MINOR_USE_KEY:VARCHAR2),
(MINOR_USE_DESC:VARCHAR2),
(ORGANIZATION_KEY:VARCHAR2, Examples: ['101', '102', '103']),
(ORGANIZATION_NAME:VARCHAR2, Examples: ['DOF', 'MIBR', 'PILM']),
(MINOR_ORGANIZATION_KEY:VARCHAR2),
(MINOR_ORGANIZATION:VARCHAR2),
(AREA:VARCHAR2, Examples: [7.11, 10.0, 45.42]),
(ROOM_FULL_NAME:NUMBER, Examples: ['KRESGE LOBBY', 'WEST LOUNGE', 'SALA DE PUERTO RICO']),
(DEPT_CODE:VARCHAR2, Examples: ['93700', '93800', '93400']),
(ACCESS_LEVEL:VARCHAR2, Examples: ['0', '1', '3']),
(LATITUDE_WGS:VARCHAR2),
(LONGITUDE_WGS:NUMBER),
(NORTHING_SPCS:NUMBER),
(EASTING_SPCS:NUMBER),
(WAREHOUSE_LOAD_DATE:NUMBER, Examples: ['19-DEC-24'])
]

### Question ###
List the names of the buildings with the most floors. If there are ties, list each one separately.

(Hints: Schema Mapping Hints:
- 'name of the buildings' is related to FAC_BUILDING.BUILDING_NAME
- 'floors' is related to FAC_FLOOR.LEVEL_ID

Join Information: (FAC_ROOMS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY), (FAC_FLOOR.FLOOR_KEY = FAC_ROOMS.FLOOR_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobpjZF1hcOud4Ojf7E8qIpql34G', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT b.BUILDING_NAME\nFROM FAC_BUILDING b\nJOIN FAC_ROOMS r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY\nJOIN FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY\nGROUP BY b.BUILDING_NAME\nHAVING COUNT(DISTINCT f.LEVEL_ID) = (\n    SELECT MAX(floor_count)\n    FROM (\n        SELECT COUNT(DISTINCT f2.LEVEL_ID) AS floor_count\n        FROM FAC_BUILDING b2\n        JOIN FAC_ROOMS r2 ON b2.FAC_BUILDING_KEY = r2.BUILDING_KEY\n        JOIN FAC_FLOOR f2 ON r2.FLOOR_KEY = f2.FLOOR_KEY\n        GROUP BY b2.BUILDING_NAME\n    ) AS subquery\n);\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180289, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=173, prompt_tokens=1847, total_tokens=2020, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=173, prompt_tokens=1847, total_tokens=2020, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT b.BUILDING_NAME
FROM FAC_BUILDING b
JOIN FAC_ROOMS r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY
JOIN FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY
GROUP BY b.BUILDING_NAME
HAVING COUNT(DISTINCT f.LEVEL_ID) = (
    SELECT MAX(floor_count)
    FROM (
        SELECT COUNT(DISTINCT f2.LEVEL_ID) AS floor_count
        FROM FAC_BUILDING b2
        JOIN FAC_ROOMS r2 ON b2.FAC_BUILDING_KEY = r2.BUILDING_KEY
        JOIN FAC_FLOOR f2 ON r2.FLOOR_KEY = f2.FLOOR_KEY
        GROUP BY b2.BUILDING_NAME
    ) AS subquery
);

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1847, 173
TOTAL                  : 288438, 259114, 29324
AVG                    : 2465.28, 2214.65, 250.63
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: ACADEMIC_TERMS_ALL
[
(ACADEMIC_TERMS_KEY:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_CODE:VARCHAR2, Examples: ['1951FA', '1951SP', '1951SU']),
(TERM_DESCRIPTION:VARCHAR2, Examples: ['Spring Term 1981-1982', 'Spring Term 1982-1983', 'Spring Term 1959-1960']),
(TERM_SELECTOR:VARCHAR2, Examples: ['1982SP-Spring Term 1981-1982', '1983SP-Spring Term 1982-1983', '1960SP-Spring Term 1959-1960']),
(TERM_START_DATE:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(TERM_END_DATE:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(ACADEMIC_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(ACADEMIC_YEAR_DESC:VARCHAR2, Examples: ['Academic Year 1981-1982', 'Academic Year 1982-1983', 'Academic Year 1959-1960']),
(IS_CURRENT_TERM:VARCHAR2, Examples: ['N', 'Y']),
(TERM_STATUS_INDICATOR:VARCHAR2, Examples: ['P', 'F', 'C']),
(FINANCIAL_AID_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(DEGREE_YEAR:VARCHAR2, Examples: ['1982', '1983', '1960']),
(LAST_DAY_OF_FINAL_EXAM:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(PRE_REGISTRATION_START_DAY:DATE, Examples: ['01-MAY-85', '01-MAY-86', '01-MAY-87']),
(REGISTRATION_DAY:DATE, Examples: ['01-FEB-82', '31-JAN-83', '08-FEB-60']),
(FIRST_DAY_OF_CLASSES:DATE, Examples: ['02-FEB-82', '01-FEB-83', '09-FEB-60']),
(LAST_DAY_OF_CLASSES:DATE, Examples: ['20-MAY-82', '18-MAY-83', '03-JUN-60']),
(GRADUATE_AWARD_START_DATE:DATE, Examples: ['16-JAN-82', '16-JAN-83', '01-JUN-85']),
(GRADUATE_AWARD_END_DATE:DATE, Examples: ['31-MAY-82', '31-MAY-83', '31-AUG-85']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: COURSE_CATALOG_SUBJECT_OFFERED
[
(ACADEMIC_YEAR:VARCHAR2, Examples: ['2016', '2013', '2008']),
(TERM_CODE:VARCHAR2, Examples: ['2002FA', '2002JA', '2002SP']),
(SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.001']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_NUMBER:VARCHAR2, Examples: ['003', '981', '07']),
(SOURCE_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(PRINT_SUBJECT_ID:VARCHAR2, Examples: ['6.003', '6.981', '5.07']),
(IS_PRINTED_IN_BULLETIN:VARCHAR2, Examples: ['Y', 'N', 'S']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Electrical Eng & Computer Sci', 'Chemistry', 'Edgerton Center']),
(EFFECTIVE_TERM_CODE:VARCHAR2, Examples: ['1989FA', '1990FA', '1991FA']),
(SUBJECT_SHORT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Elec Engr & Comp Sci', 'Biological Chemistry']),
(SUBJECT_TITLE:VARCHAR2, Examples: ['Signals and Systems', 'Teaching Electrical Engineering and Computer Science', 'Biological Chemistry I']),
(IS_VARIABLE_UNITS:VARCHAR2, Examples: ['N', 'Y']),
(LECTURE_UNITS:NUMBER, Examples: [5, 0, 4]),
(LAB_UNITS:NUMBER, Examples: [0, 8, 1]),
(PREPARATION_UNITS:NUMBER, Examples: [7, 0, 8]),
(TOTAL_UNITS:NUMBER, Examples: [12, 0, 6]),
(DESIGN_UNITS:NUMBER, Examples: [4, 0, 3]),
(GRADE_TYPE:VARCHAR2, Examples: ['L', 'P']),
(GRADE_TYPE_DESC:VARCHAR2, Examples: ['Letter graded', 'P/D/F']),
(GRADE_RULE:VARCHAR2, Examples: ['N', 'R', 'J']),
(GRADE_RULE_DESC:VARCHAR2, Examples: ['Not repeatable for credit', 'Can be repeated for credit', 'Continuing and Repeatable']),
(HGN_CODE:VARCHAR2, Examples: ['G', 'H', 'U']),
(HGN_DESC:VARCHAR2, Examples: ['Undergraduate', 'Graduate', 'High Graduate']),
(HGN_EXCEPT:VARCHAR2, Examples: ['(H except 18)', '(H except 2, 6, 8, 12, 13, 16, 18, 22)', '(H except XVIII)']),
(GIR_ATTRIBUTE:VARCHAR2, Examples: ['REST', 'HE', 'HD1']),
(GIR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Rest Elec in Sci & Tech', 'HASS Elective', 'HASS-D, Category 1']),
(COMM_REQ_ATTRIBUTE:VARCHAR2, Examples: ['CIM', 'CIH', 'CIHW']),
(COMM_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Communication Intensive Major', 'Communication Intensive HASS', 'Communication Intensive Writing']),
(TUITION_ATTRIBUTE:VARCHAR2, Examples: ['NTRN', 'RESH', 'COOP']),
(TUITION_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Internship', 'Pre-thesis Research Subject', 'Co-op Subject']),
(WRITE_REQ_ATTRIBUTE:VARCHAR2, Examples: ['WRT1', 'WRT2']),
(WRITE_REQ_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Writing Requirement, Phase I', 'Writing Requirement, Phase II']),
(SUPERVISOR_ATTRIBUTE:VARCHAR2, Examples: ['THG', 'UROP', 'INDP']),
(SUPERVISOR_ATTRIBUTE_DESC:VARCHAR2, Examples: ['Grad Thesis', 'UROP subject', 'Independent Study']),
(PREREQUISITES:VARCHAR2, Examples: ['GIR:PHY2, 18.03', '5.12', '1.260, 15.760, or 15.761']),
(SUBJECT_DESCRIPTION:VARCHAR2, Examples: ['Presents the fundamentals of signal and system analysis. Topics include discrete-time and continuous-time signals, Fourier seri', 'For Teaching Assistants in Electrical Engineering and Computer Science, in cases where teaching assignment is approved for acad', 'Chemical and physical properties of the cell and its building blocks. Structures of proteins and principles of catalysis. The c']),
(JOINT_SUBJECTS:VARCHAR2, Examples: ['1.274J, ESD.268J', '17.007J, WGS.301J', '21M.608J']),
(SCHOOL_WIDE_ELECTIVES:VARCHAR2, Examples: ['1.155, 2.943, 3.577, 6.938, 10.816, 13.621, 16.862, 22.82, ESD.72', '1.021, 3.021, 10.333', '1.EPE, 2.EPE, 3.EPE, 6.EPE, 10.EPE, 22.EPE']),
(MEETS_WITH_SUBJECTS:VARCHAR2, Examples: ['17.006J, 24.637J', '11.474', '10.27, 10.29']),
(EQUIVALENT_SUBJECTS:VARCHAR2, Examples: ['7.05', '8.05', '21F.871']),
(IS_OFFERED_THIS_YEAR:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_FALL_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_IAP:VARCHAR2, Examples: ['N', 'Y']),
(IS_OFFERED_SPRING_TERM:VARCHAR2, Examples: ['Y', 'N']),
(IS_OFFERED_SUMMER_TERM:VARCHAR2, Examples: ['N', 'Y']),
(FALL_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(SPRING_INSTRUCTORS:VARCHAR2, Examples: ['E. M. Harper, M. F. Hebert, A. C. Espinoza', 'H. W. Thompson, S. Richardson', 'M. K. Newman, F. L. Doherty']),
(STATUS_CHANGE:VARCHAR2, Examples: ['New subject', 'New joint child (2005: Switch from joint child to subject)', 'Old number: 15.995']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['12-MAR-15', '28-DEC-11', '14-MAR-08']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24']),
(MASTER_SUBJECT_ID:VARCHAR2, Examples: ['1.00', '1.000', '1.007']),
(HASS_ATTRIBUTE:VARCHAR2, Examples: ['HA', 'HA,HH', 'HE']),
(HASS_ATTRIBUTE_DESC:VARCHAR2, Examples: ['HASS Humanities', 'HASS Arts', 'HASS Social Sciences']),
(TERM_DURATION:VARCHAR2, Examples: ['Full Term Subject', 'First Half Term Subject', 'Partial Term Subject']),
(GLOBAL_REGIONS:VARCHAR2, Examples: ['Global (all regions)', 'Europe', 'Middle East']),
(GLOBAL_COUNTRIES:VARCHAR2, Examples: ['United States of America|India|South Africa', 'Spain', 'Japan']),
(ON_LINE_PAGE_NUMBER:VARCHAR2, Examples: ['http://student.mit.edu/catalog/m6a.html', 'http://student.mit.edu/catalog/m6c.html', 'http://student.mit.edu/catalog/mECa.html']),
(SECTION_ID:VARCHAR2, Examples: ['000', 'B01', 'B02']),
(IS_MASTER_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LECTURE_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_LAB_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(IS_RECITATION_SECTION:VARCHAR2, Examples: ['Y', 'N']),
(IS_DESIGN_SECTION:VARCHAR2, Examples: ['N', 'Y']),
(RESPONSIBLE_FACULTY_NAME:VARCHAR2, Examples: ['Garcia, Elsa', 'Wilkinson, Eugene', 'Mooney, Willie']),
(RESPONSIBLE_FACULTY_MIT_ID:VARCHAR2, Examples: ['900013216', '900026651', '900043308']),
(MEET_TIME:VARCHAR2, Examples: ['WF11', 'R12', 'MW8.30-10 (BEGINS MARCH 31)']),
(MEET_PLACE:VARCHAR2, Examples: ['*TO BE ARRANGED', '1-001E', '1-037E'])
]
# Table: EMPLOYEE_DIRECTORY
[
(MIT_ID:VARCHAR2, Examples: ['900013216', '900018937', '900019389']),
(LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell']),
(FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(MIDDLE_NAME:VARCHAR2, Examples: ['C', 'Lucero', 'R']),
(FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(DIRECTORY_FULL_NAME:VARCHAR2, Examples: ['Austin, Sasha', 'Hopkins, Jamal C.', 'Bell, Mahir']),
(OFFICE_LOCATION:VARCHAR2, Examples: ['1', '1-018', '1-037E']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1593468096', '8028104479', '285881157']),
(DIRECTORY_TITLE:VARCHAR2),
(PRIMARY_TITLE:VARCHAR2),
(DEPARTMENT_NUMBER:VARCHAR2, Examples: ['402000', '871060', '310000']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['David H Koch Institute for Integrative Cancer Res', 'Alumni Association Alumni Relations', 'Lincoln Laboratory']),
(KRB_NAME:VARCHAR2, Examples: ['aa', 'aadama', 'aadamb']),
(KRB_NAME_UPPERCASE:VARCHAR2, Examples: ['SASHAA', 'JH3', 'MAHIRB']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['sashaa@worker.com', 'jh3@worker.com', 'mahirb@gmail.business.com']),
(PERSONAL_URL:VARCHAR2, Examples: ['http://www.darrent.net', 'http://www.lilir.com', 'https://www.zahras.edu']),
(NAME_KNOWN_BY:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(EMAIL_ADDRESS_UPPERCASE:VARCHAR2, Examples: ['SASHAA@WORKER.COM', 'JH3@WORKER.COM', 'MAHIRB@GMAIL.BUSINESS.COM']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['AUSTIN, SASHA', 'HOPKINS, JAMAL C.', 'BELL, MAHIR']),
(PREFERRED_FIRST_NAME_UPPER:VARCHAR2, Examples: ['SASHA', 'JAMAL', 'MAHIR']),
(PREFERRED_LAST_NAME_UPPER:VARCHAR2, Examples: ['AUSTIN', 'HOPKINS', 'BELL']),
(PREFERRED_FIRST_NAME:VARCHAR2, Examples: ['Sasha', 'Jamal', 'Mahir']),
(PREFERRED_MIDDLE_NAME:VARCHAR2, Examples: ['Lucero', 'R', 'Mcgee']),
(PREFERRED_LAST_NAME:VARCHAR2, Examples: ['Austin', 'Hopkins', 'Bell'])
]

### Question ###
For subjects offered in the summer term, list the subject titles, number of instructors, and the length of the longest instructor name.

(Hints: Schema Mapping Hints:
- 'summer term' is related to ACADEMIC_TERMS_ALL.TERM_CODE
- 'subject titles' is related to COURSE_CATALOG_SUBJECT_OFFERED.SUBJECT_TITLE
- 'instructors' is related to EMPLOYEE_DIRECTORY.FULL_NAME
- 'instructor name' is related to EMPLOYEE_DIRECTORY.FULL_NAME

Join Information: (COURSE_CATALOG_SUBJECT_OFFERED.RESPONSIBLE_FACULTY_MIT_ID = EMPLOYEE_DIRECTORY.MIT_ID), (COURSE_CATALOG_SUBJECT_OFFERED.TERM_CODE = ACADEMIC_TERMS_ALL.TERM_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobsBsbxGVzjgKUhF4KS3ZXf7B4c', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    CCSO.SUBJECT_TITLE, \n    COUNT(ED.FULL_NAME) AS NUMBER_OF_INSTRUCTORS, \n    MAX(LENGTH(ED.FULL_NAME)) AS LENGTH_OF_LONGEST_INSTRUCTOR_NAME\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED CCSO\nJOIN \n    EMPLOYEE_DIRECTORY ED ON CCSO.RESPONSIBLE_FACULTY_MIT_ID = ED.MIT_ID\nJOIN \n    ACADEMIC_TERMS_ALL ATA ON CCSO.TERM_CODE = ATA.TERM_CODE\nWHERE \n    ATA.IS_CURRENT_TERM = 'Y' AND \n    CCSO.IS_OFFERED_SUMMER_TERM = 'Y'\nGROUP BY \n    CCSO.SUBJECT_TITLE;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180292, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=149, prompt_tokens=3412, total_tokens=3561, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3200)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=149, prompt_tokens=3412, total_tokens=3561, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=3200))

***** FINAL SQL QUERY *****
SELECT 
    CCSO.SUBJECT_TITLE, 
    COUNT(ED.FULL_NAME) AS NUMBER_OF_INSTRUCTORS, 
    MAX(LENGTH(ED.FULL_NAME)) AS LENGTH_OF_LONGEST_INSTRUCTOR_NAME
FROM 
    COURSE_CATALOG_SUBJECT_OFFERED CCSO
JOIN 
    EMPLOYEE_DIRECTORY ED ON CCSO.RESPONSIBLE_FACULTY_MIT_ID = ED.MIT_ID
JOIN 
    ACADEMIC_TERMS_ALL ATA ON CCSO.TERM_CODE = ATA.TERM_CODE
WHERE 
    ATA.IS_CURRENT_TERM = 'Y' AND 
    CCSO.IS_OFFERED_SUMMER_TERM = 'Y'
GROUP BY 
    CCSO.SUBJECT_TITLE;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 3412, 149
TOTAL                  : 291999, 262526, 29473
AVG                    : 2474.57, 2224.80, 249.77
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MOIRA_LIST
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-emerald', 'amber-amber-frog']),
(MOIRA_LIST_NAME:VARCHAR2, Examples: ['cat-duo-users', 'quince-mountain', 'quest-fortune-iguana']),
(MOIRA_LIST_DESCRIPTION:VARCHAR2),
(IS_ACTIVE:VARCHAR2, Examples: ['Y']),
(IS_MOIRA_MAILING_LIST:VARCHAR2, Examples: ['Y', 'N']),
(IS_MOIRA_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_NFS_GROUP:VARCHAR2, Examples: ['N', 'Y']),
(IS_PUBLIC:VARCHAR2, Examples: ['N', 'Y']),
(IS_HIDDEN:VARCHAR2, Examples: ['N'])
]
# Table: MOIRA_LIST_DETAIL
[
(MOIRA_LIST_KEY:VARCHAR2, Examples: ['amber-amber', 'amber-amber-uplift', 'amber-ant']),
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROSapple-raspberry', 'KERBEROSbeacon-bear']),
(MOIRA_LIST_MEMBER:VARCHAR2, Examples: ['aa', 'aa@aol.com', 'aa@employee.com']),
(MOIRA_LIST_MEMBER_FULL_NAME:VARCHAR2, Examples: ['Sloan, Axel', 'Griffith, Ronnie', 'Frost, Georgina']),
(MOIRA_LIST_MEMBER_MIT_ID:VARCHAR2, Examples: ['900000167', '900012716', '900013216']),
(LAST_UPDATE_DATE:DATE, Examples: ['17-OCT-23', '12-AUG-21', '18-SEP-21']),
(COUNTER:NUMBER, Examples: [1]),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: MOIRA_LIST_OWNER
[
(MOIRA_LIST_OWNER_KEY:VARCHAR2, Examples: ['KERBEROS32.550-raspberry-nectar', 'KERBEROS45.604-kangaroo-courage', 'KERBEROSapple-raspberry']),
(OWNER:VARCHAR2, Examples: ['56.928-tangerine-snake', '69.377-keeper-xenon', '75.187-vivid-fortune']),
(OWNER_TYPE:VARCHAR2, Examples: ['LIST', 'USER', 'KERBEROS']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For the mailing list with owner key LIST69.377-keeper-xenon, list the owner, total number of mailing lists, and total number of members across all these mailing lists.

(Hints: Schema Mapping Hints:
- 'owner key' is related to MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY
- 'owner' is related to MOIRA_LIST_OWNER.OWNER
- 'mailing lists' is related to MOIRA_LIST.MOIRA_LIST_KEY
- 'members' is related to MOIRA_LIST_DETAIL.MOIRA_LIST_MEMBER

Join Information: (MOIRA_LIST.MOIRA_LIST_KEY = MOIRA_LIST_DETAIL.MOIRA_LIST_KEY), (MOIRA_LIST_DETAIL.MOIRA_LIST_OWNER_KEY = MOIRA_LIST_OWNER.MOIRA_LIST_OWNER_KEY))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobvyDrAtUtq9pUhnk1mPXDeDw1C', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    o.OWNER,\n    COUNT(DISTINCT l.MOIRA_LIST_KEY) AS total_mailing_lists,\n    COUNT(ld.MOIRA_LIST_MEMBER) AS total_members\nFROM \n    MOIRA_LIST_OWNER o\nJOIN \n    MOIRA_LIST l ON o.MOIRA_LIST_OWNER_KEY = l.MOIRA_LIST_OWNER_KEY\nJOIN \n    MOIRA_LIST_DETAIL ld ON l.MOIRA_LIST_KEY = ld.MOIRA_LIST_KEY\nWHERE \n    o.MOIRA_LIST_OWNER_KEY = 'LIST69.377-keeper-xenon'\nGROUP BY \n    o.OWNER;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180295, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=128, prompt_tokens=827, total_tokens=955, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=128, prompt_tokens=827, total_tokens=955, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    o.OWNER,
    COUNT(DISTINCT l.MOIRA_LIST_KEY) AS total_mailing_lists,
    COUNT(ld.MOIRA_LIST_MEMBER) AS total_members
FROM 
    MOIRA_LIST_OWNER o
JOIN 
    MOIRA_LIST l ON o.MOIRA_LIST_OWNER_KEY = l.MOIRA_LIST_OWNER_KEY
JOIN 
    MOIRA_LIST_DETAIL ld ON l.MOIRA_LIST_KEY = ld.MOIRA_LIST_KEY
WHERE 
    o.MOIRA_LIST_OWNER_KEY = 'LIST69.377-keeper-xenon'
GROUP BY 
    o.OWNER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 827, 128
TOTAL                  : 292954, 263353, 29601
AVG                    : 2461.80, 2213.05, 248.75
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: SIS_COURSE_DESCRIPTION
[
(SIS_COURSE_DESCRIPTION_KEY:VARCHAR2, Examples: ['10::G', '10::U', '10:A:G']),
(COURSE:VARCHAR2, Examples: ['1', '1 12', '1 A']),
(COURSE_DESCRIPTION:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Eng Practice-SM', 'Chemical Eng Practice-Doctoral']),
(COURSE_DESCRIPTION_LONG:VARCHAR2, Examples: ['Chemical Engineering', 'Chemical Engineering (Course 10)', 'Chemical-Biological Engineering (Course 10-B)']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Chemical Engineering', 'Urban Studies and Planning', 'Earth, Atmos & Planetary Sci']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Department of Chemical Engineering', 'Department of Urban Studies and Planning', 'Department of Earth, Atmospheric, and Planetary Sciences']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Engineering', 'Architecture and Planning', 'Science']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['School of Engineering', 'School of Architecture and Planning', 'School of Science']),
(FROM_TERM:VARCHAR2, Examples: ['000000', '2000FA', '2004SP']),
(FROM_TERM_DESCRIPTION:VARCHAR2, Examples: ['Beginning of Time', 'Fall Term 1999-2000', 'Spring Term 2003-2004']),
(THRU_TERM:VARCHAR2, Examples: ['999999', '2018SU', '2004SU']),
(THRU_TERM_DESCRIPTION:VARCHAR2, Examples: ['End of Time', 'Summer Term 2018', 'Summer Term 2004']),
(COURSE_OPTION:VARCHAR2, Examples: ['A', 'AD', 'B']),
(COURSE_LEVEL:VARCHAR2, Examples: ['G', 'U']),
(CIP_PROGRAM_CODE:VARCHAR2, Examples: ['110101', '110102', '110701']),
(IS_DEGREE_GRANTING:CHAR, Examples: ['N', 'Y']),
(DEFAULT_ULTIMATE_DEGREE:VARCHAR2, Examples: ['NDG', 'SB', 'SM']),
(GRADAUTE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(GRADUATE_LEVEL:VARCHAR2, Examples: ['Masters', 'Doctoral']),
(LAST_ACTIVITY_DATE:DATE, Examples: ['23-JUL-15', '13-SEP-19', '25-APR-05']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_SUBJECT_CODE
[
(COURSE_NUMBER:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(SUBJECT_CODE_DESC:VARCHAR2, Examples: ['Wellesley, Cinema & Media Stud', 'Concourse', 'Liberal Arts']),
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Wellesley Cross-Enrollment Pro', 'Concourse', 'Non-Institute-MFA/MCA']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Non-MIT', 'MIT, academic', 'Architecture and Planning']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each school, list the school name, total number of courses that appear in SIS subject code catalog, and the total number of degree-granting courses that appear in SIS subject code catalog.

(Hints: Schema Mapping Hints:
- 'school name' is related to SIS_DEPARTMENT.SCHOOL_NAME
- 'courses' is related to SIS_COURSE_DESCRIPTION.COURSE
- 'degree-granting courses' is related to SIS_COURSE_DESCRIPTION.IS_DEGREE_GRANTING

Join Information: (SIS_COURSE_DESCRIPTION.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_COURSE_DESCRIPTION.COURSE = SIS_SUBJECT_CODE.COURSE_NUMBER))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-CsobymkslgCPWkDiNaNkFjWQEfD9g', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content="```sql\nSELECT \n    d.SCHOOL_NAME, \n    COUNT(DISTINCT s.COURSE_NUMBER) AS total_courses, \n    COUNT(DISTINCT CASE WHEN c.IS_DEGREE_GRANTING = 'Y' THEN s.COURSE_NUMBER END) AS total_degree_granting_courses\nFROM \n    SIS_DEPARTMENT d\nJOIN \n    SIS_COURSE_DESCRIPTION c ON d.DEPARTMENT_CODE = c.DEPARTMENT\nJOIN \n    SIS_SUBJECT_CODE s ON c.COURSE = s.COURSE_NUMBER\nGROUP BY \n    d.SCHOOL_NAME;\n```", refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180298, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=124, prompt_tokens=1400, total_tokens=1524, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=124, prompt_tokens=1400, total_tokens=1524, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=1024))

***** FINAL SQL QUERY *****
SELECT 
    d.SCHOOL_NAME, 
    COUNT(DISTINCT s.COURSE_NUMBER) AS total_courses, 
    COUNT(DISTINCT CASE WHEN c.IS_DEGREE_GRANTING = 'Y' THEN s.COURSE_NUMBER END) AS total_degree_granting_courses
FROM 
    SIS_DEPARTMENT d
JOIN 
    SIS_COURSE_DESCRIPTION c ON d.DEPARTMENT_CODE = c.DEPARTMENT
JOIN 
    SIS_SUBJECT_CODE s ON c.COURSE = s.COURSE_NUMBER
GROUP BY 
    d.SCHOOL_NAME;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1400, 124
TOTAL                  : 294478, 264753, 29725
AVG                    : 2453.98, 2206.28, 247.71
******************************************************************************************************************************************************
******************************************************************************************************************************************************

***** FINAL PROMPT *****
### System Instructions ###
You are an expert SQL developer.
You must generate an accurate and efficient MySQL query based on the provided database schema and natural language question.
Never use tables or columns that are not specified in the schema.
Do not add any explanations other than the final SQL query.
Now generate MySQL SQL query to answer the given "Question" without any explanation.

### Schema ###
[DB_ID] dw
# Schema
# Table: MIT_STUDENT_DIRECTORY
[
(FIRST_NAME:VARCHAR2, Examples: ['Pauline', 'Luis', 'Tariq']),
(MIDDLE_NAME:VARCHAR2, Examples: ['B', 'M', 'Lee']),
(LAST_NAME:VARCHAR2, Examples: ['Brandt', 'Buckley', 'Lee']),
(FULL_NAME:VARCHAR2, Examples: ['Abbott, Adele', 'Abbott, Alastair', 'Abbott, Aleksander']),
(OFFICE_LOCATION:VARCHAR2, Examples: [': 75 Amherst St-37408', '1-018', '1-221']),
(OFFICE_PHONE:VARCHAR2, Examples: ['1046285219', '1052224257', '9901815658']),
(EMAIL_ADDRESS:VARCHAR2, Examples: ['paulineb@worker.com', 'luisb@worker.com', 'tariql@worker.com']),
(DEPARTMENT:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Materials Science and Eng', 'Mechanical Engineering', 'Electrical Eng & Computer Sci']),
(STUDENT_YEAR:VARCHAR2, Examples: ['G', '2', '1']),
(FULL_NAME_UPPERCASE:VARCHAR2, Examples: ['BRANDT, PAULINE B.', 'BUCKLEY, LUIS M.', 'LEE, TARIQ LEE.']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_ADMIN_DEPARTMENT
[
(SIS_ADMIN_DEPARTMENT_CODE:DATE, Examples: ['1', '10', '11']),
(SIS_ADMIN_DEPARTMENT_NAME:VARCHAR2, Examples: ['Admissions Office', 'Student Financial Services', 'Campus Police']),
(DEPARTMENT_PHONE_AREA_CODE:VARCHAR2),
(DEPARTMENT_PHONE_NUMBER:VARCHAR2, Examples: ['2683470', '6547381', '3240096']),
(CLEARING_COST_COLLECTOR:VARCHAR2, Examples: ['1133500', '1646800', '1130000']),
(LAST_ACTIVITY_DATE:VARCHAR2, Examples: ['12-AUG-96', '15-OCT-98', '05-NOV-91']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]
# Table: SIS_DEPARTMENT
[
(DEPARTMENT_CODE:VARCHAR2, Examples: ['1', '10', '11']),
(DEPARTMENT_NAME:VARCHAR2, Examples: ['Inst for Data, Syst, & Soc', 'Engineering Systems Division', 'Interphase/Seminar XL']),
(DEPARTMENT_FULL_NAME:VARCHAR2, Examples: ['IDS-Inst for Data, Syst, & Soc', 'ESD-Engineering Systems Division', 'PXL-Interphase/Seminar XL']),
(SCHOOL_CODE:VARCHAR2, Examples: ['A', 'E', 'H']),
(SCHOOL_NAME:VARCHAR2, Examples: ['Schwarzman Coll of Comp', 'Engineering', 'MIT, non-academic']),
(DEPT_BUDGET_CODE:VARCHAR2, Examples: ['68100', '67000', '441000']),
(IS_DEGREE_GRANTING:VARCHAR2, Examples: ['Y', 'N']),
(DEPT_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Institute for Data, Systems, & Society', 'Engineering Systems Division', 'Department of Ocean Engineering']),
(SCHOOL_NAME_IN_COMMENCEMENT_BK:VARCHAR2, Examples: ['Schwarzman College of Computing', 'School of Engineering', 'Sloan School of Management']),
(DEPARTMENT_NAME_HISTORY:VARCHAR2, Examples: ['Was in Sch of Eng until 12/31/2019', 'Civil Eng (    )', 'Anthropol/Archaeol until 1998-99']),
(DEPARTMENT_LAST_ACTIVITY_DATE:DATE, Examples: ['07-OCT-20', '18-NOV-99', '27-MAR-12']),
(DLC_KEY:VARCHAR2, Examples: ['D_IDSS', 'D_STU_SPECIAL', 'D_OCEAN']),
(WAREHOUSE_LOAD_DATE:DATE, Examples: ['19-DEC-24'])
]

### Question ###
For each department, list the department name, department phone number, number of students, and the length of the longest student full name in that department.

(Hints: Schema Mapping Hints:
- 'department name' is related to SIS_DEPARTMENT.DEPARTMENT_NAME
- 'department phone number' is related to SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER
- 'students' is related to MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS
- 'student full name' is related to MIT_STUDENT_DIRECTORY.FULL_NAME

Join Information: (MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE), (SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE))

### Generated SQL Query ###
Generated SQL: 


***** RESPONSE *****
ChatCompletion(id='chatcmpl-Csoc17IL6zAmbOQhvx5wRZFmeo4Xj', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='```sql\nSELECT \n    SIS_DEPARTMENT.DEPARTMENT_NAME,\n    SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER,\n    COUNT(MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS) AS number_of_students,\n    MAX(LENGTH(MIT_STUDENT_DIRECTORY.FULL_NAME)) AS longest_student_full_name_length\nFROM \n    SIS_DEPARTMENT\nJOIN \n    SIS_ADMIN_DEPARTMENT ON SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE\nLEFT JOIN \n    MIT_STUDENT_DIRECTORY ON MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE\nGROUP BY \n    SIS_DEPARTMENT.DEPARTMENT_NAME, \n    SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER;\n```', refusal=None, role='assistant', annotations=[], audio=None, function_call=None, tool_calls=None))], created=1767180301, model='gpt-4o-mini-2024-07-18', object='chat.completion', service_tier='default', system_fingerprint='fp_c4585b5b9c', usage=CompletionUsage(completion_tokens=151, prompt_tokens=1136, total_tokens=1287, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0)))

***** TOKEN INFO *****
CompletionUsage(completion_tokens=151, prompt_tokens=1136, total_tokens=1287, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=0, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=0), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0))

***** FINAL SQL QUERY *****
SELECT 
    SIS_DEPARTMENT.DEPARTMENT_NAME,
    SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER,
    COUNT(MIT_STUDENT_DIRECTORY.EMAIL_ADDRESS) AS number_of_students,
    MAX(LENGTH(MIT_STUDENT_DIRECTORY.FULL_NAME)) AS longest_student_full_name_length
FROM 
    SIS_DEPARTMENT
JOIN 
    SIS_ADMIN_DEPARTMENT ON SIS_ADMIN_DEPARTMENT.SIS_ADMIN_DEPARTMENT_CODE = SIS_DEPARTMENT.DEPARTMENT_CODE
LEFT JOIN 
    MIT_STUDENT_DIRECTORY ON MIT_STUDENT_DIRECTORY.DEPARTMENT = SIS_DEPARTMENT.DEPARTMENT_CODE
GROUP BY 
    SIS_DEPARTMENT.DEPARTMENT_NAME, 
    SIS_ADMIN_DEPARTMENT.DEPARTMENT_PHONE_NUMBER;

***** TOKEN MONITORING *****
TOKEN PER ITERATION    : 1136, 151
TOTAL                  : 295765, 265889, 29876
AVG                    : 2444.34, 2197.43, 246.91
******************************************************************************************************************************************************
******************************************************************************************************************************************************

