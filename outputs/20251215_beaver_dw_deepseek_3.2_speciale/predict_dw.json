{
    "0": "SELECT DISTINCT     b.BUILDING_KEY AS \"building key\",     b.BUILDING_STREET_ADDRESS AS \"building street address\",     a.CITY AS \"city\",     a.STATE AS \"state\",     a.POSTAL_CODE AS \"postal code\" FROM BUILDINGS b JOIN FCLT_BUILDING_ADDRESS a ON b.BUILDING_KEY = a.FCLT_BUILDING_KEY AND a.ADDRESS_PURPOSE = 'STREET' JOIN FCLT_ROOMS r ON b.BUILDING_KEY = r.FCLT_BUILDING_KEY JOIN FCLT_ORG_DLC_KEY o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY JOIN MASTER_DEPT_HIERARCHY h ON o.DLC_KEY = h.DLC_KEY WHERE LOWER(h.DLC_NAME) = 'history department';\t----- bird -----\tdw",
    "1": "SELECT DISTINCT d.ACTIVITY_TITLE, s.SESSION_LOCATION, a.TERM_START_DATE, p.PERSON_NAME AS SUPERVISOR_NAME FROM IAP_SUBJECT_DETAIL d INNER JOIN ACADEMIC_TERMS_ALL a ON d.TERM_CODE = a.TERM_CODE INNER JOIN IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY INNER JOIN IAP_SUBJECT_PERSON p ON d.IAP_SUBJECT_PERSON_KEY = p.IAP_SUBJECT_PERSON_KEY ORDER BY a.TERM_START_DATE ASC;\t----- bird -----\tdw",
    "2": "SELECT ci.INSTRUCTOR_NAME, so.SUBJECT_TITLE, COUNT(rc.CATALOG_ISBN) AS amount_of_material FROM LIBRARY_COURSE_INSTRUCTOR ci JOIN LIBRARY_RESERVE_MATRL_DETAIL rm ON ci.LIBRARY_COURSE_INSTRUCTOR_KEY = rm.LIBRARY_COURSE_INSTRUCTOR_KEY JOIN LIBRARY_SUBJECT_OFFERED so ON rm.LIBRARY_SUBJECT_OFFERED_KEY = so.LIBRARY_SUBJECT_OFFERED_KEY JOIN LIBRARY_RESERVE_CATALOG rc ON rm.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY GROUP BY ci.LIBRARY_COURSE_INSTRUCTOR_KEY, so.LIBRARY_SUBJECT_OFFERED_KEY;\t----- bird -----\tdw",
    "3": "SELECT     FR.ROOM,     FR.FLOOR,     FR.BUILDING_KEY,     B.BUILDING_STREET_ADDRESS,     FBA.CITY,     FBA.STATE,     FBA.POSTAL_CODE FROM     EMPLOYEE_DIRECTORY ED     INNER JOIN FAC_ROOMS FR ON ED.OFFICE_LOCATION = FR.FAC_ROOM_KEY     INNER JOIN FAC_BUILDING_ADDRESS FBA ON FR.BUILDING_KEY = FBA.BUILDING_KEY AND FBA.ADDRESS_PURPOSE = 'STREET'     INNER JOIN BUILDINGS B ON FBA.BUILDING_KEY = B.BUILDING_KEY WHERE     (ED.FIRST_NAME = 'Summer' AND ED.LAST_NAME = 'Haynes')     OR (ED.PREFERRED_FIRST_NAME = 'Summer' AND ED.PREFERRED_LAST_NAME = 'Haynes')     OR ED.FULL_NAME LIKE 'Haynes, Summer%';\t----- bird -----\tdw",
    "4": "SELECT DISTINCT     R.ROOM_FULL_NAME AS `full room name`,     B.BUILDING_NAME AS `building name`,     B.BUILDING_STREET_ADDRESS AS `street address`,     A.CITY AS `city`,     A.STATE AS `state`,     A.POSTAL_CODE AS `postal code`,     FB.BUILDING_HEIGHT AS `building height` FROM     COURSE_CATALOG_SUBJECT_OFFERED C     JOIN FCLT_ROOMS R ON C.MEET_PLACE = R.FCLT_ROOM_KEY     JOIN BUILDINGS B ON R.FCLT_BUILDING_KEY = B.BUILDING_KEY     JOIN FCLT_BUILDING FB ON R.FCLT_BUILDING_KEY = FB.FCLT_BUILDING_KEY     JOIN FCLT_BUILDING_ADDRESS A ON R.FCLT_BUILDING_KEY = A.FCLT_BUILDING_KEY AND A.ADDRESS_PURPOSE = 'STREET' WHERE     C.DEPARTMENT_NAME LIKE '%Computer Science%';\t----- bird -----\tdw",
    "5": "SELECT DISTINCT     s.TERM_CODE,     s.SUBJECT_TITLE,     r.ROOM,     r.FLOOR,     b.BUILDING_KEY,     b.BUILDING_STREET_ADDRESS,     a.CITY,     a.STATE,     a.POSTAL_CODE,     s.FORM_TYPE AS formats,     s.NUM_ENROLLED_STUDENTS FROM SUBJECT_OFFERED s JOIN FCLT_ROOMS r ON s.MEET_PLACE = r.FCLT_ROOM_KEY JOIN BUILDINGS b ON r.FCLT_BUILDING_KEY = b.BUILDING_KEY JOIN FCLT_BUILDING_ADDRESS a ON r.FCLT_BUILDING_KEY = a.FCLT_BUILDING_KEY AND a.ADDRESS_PURPOSE = 'STREET' WHERE s.NUM_ENROLLED_STUDENTS > 300;\t----- bird -----\tdw",
    "6": "SELECT     tso.SUBJECT_TITLE,     tm.TITLE AS MATERIAL_TITLE,     tm.ISBN,     tm.NEW_SHELF_PRICE,     SUM(tm.NEW_SHELF_PRICE) OVER (PARTITION BY tso.SUBJECT_TITLE) AS TOTAL_COST FROM     TIP_DETAIL td     JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY     JOIN TIP_SUBJECT_OFFERED tso ON td.SUBJECT_ID = tso.SUBJECT_ID ORDER BY     tm.NEW_SHELF_PRICE ASC;\t----- bird -----\tdw",
    "7": "WITH employee_counts AS (     SELECT r.FCLT_BUILDING_KEY, COUNT(DISTINCT e.MIT_ID) AS num_employees     FROM EMPLOYEE_DIRECTORY e     JOIN FCLT_ROOMS r ON e.OFFICE_LOCATION = r.BUILDING_ROOM     GROUP BY r.FCLT_BUILDING_KEY     HAVING COUNT(DISTINCT e.MIT_ID) > 100 ), latest_building AS (     SELECT h.FCLT_BUILDING_KEY, h.BUILDING_NAME_LONG, h.DATE_BUILT     FROM FCLT_BUILDING_HIST h     INNER JOIN (         SELECT FCLT_BUILDING_KEY, MAX(FISCAL_PERIOD) AS max_period         FROM FCLT_BUILDING_HIST         GROUP BY FCLT_BUILDING_KEY     ) t ON h.FCLT_BUILDING_KEY = t.FCLT_BUILDING_KEY AND h.FISCAL_PERIOD = t.max_period ) SELECT b.BUILDING_NAME_LONG,        CAST(SUBSTR(b.DATE_BUILT, -4) AS INTEGER) AS built_year,        e.num_employees FROM employee_counts e JOIN latest_building b ON b.FCLT_BUILDING_KEY = e.FCLT_BUILDING_KEY WHERE CAST(SUBSTR(b.DATE_BUILT, -4) AS INTEGER) < 1950 ORDER BY b.BUILDING_NAME_LONG;\t----- bird -----\tdw",
    "8": "SELECT b.FCLT_BUILDING_KEY AS building_key, b.BUILDING_NAME AS building_name, COUNT(DISTINCT c.SUBJECT_ID) AS number_of_courses FROM CIS_COURSE_CATALOG c JOIN COURSE_CATALOG_SUBJECT_OFFERED o ON c.SUBJECT_ID = o.SUBJECT_ID JOIN FCLT_ROOMS r ON o.MEET_PLACE = r.FCLT_ROOM_KEY JOIN FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY WHERE c.DEPARTMENT_NAME = 'Center for International Studies' GROUP BY b.FCLT_BUILDING_KEY, b.BUILDING_NAME ORDER BY b.FCLT_BUILDING_KEY;\t----- bird -----\tdw",
    "9": "SELECT b.BUILDING_NAME, COUNT(*) AS student_count FROM MIT_STUDENT_DIRECTORY s JOIN FCLT_ROOMS r ON s.OFFICE_LOCATION = r.BUILDING_ROOM JOIN FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY GROUP BY b.FCLT_BUILDING_KEY, b.BUILDING_NAME ORDER BY student_count DESC LIMIT 1;\t----- bird -----\tdw",
    "10": "SELECT b.BUILDING_NAME, f.FLOOR FROM FAC_BUILDING b JOIN FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY WHERE CAST(f.FLOOR AS SIGNED) = (SELECT MAX(CAST(FLOOR AS SIGNED)) FROM FAC_FLOOR);\t----- bird -----\tdw",
    "11": "SELECT      c.IAP_CATEGORY_NAME AS category_name,     t.ACADEMIC_YEAR AS academic_year,     SUM(d.FEE) AS total_fee_collected,     COUNT(*) AS total_subjects,     MIN(d.MAX_ENROLLMENT) AS min_enrollment,     MAX(d.MAX_ENROLLMENT) AS max_enrollment FROM IAP_SUBJECT_DETAIL d JOIN IAP_SUBJECT_CATEGORY c ON d.IAP_SUBJECT_CATEGORY_KEY = c.IAP_SUBJECT_CATEGORY_KEY JOIN (SELECT DISTINCT ACADEMIC_TERM_CODE, ACADEMIC_YEAR FROM TIME_DAY) t ON d.TERM_CODE = t.ACADEMIC_TERM_CODE GROUP BY c.IAP_CATEGORY_NAME, t.ACADEMIC_YEAR ORDER BY c.IAP_CATEGORY_NAME, t.ACADEMIC_YEAR;\t----- bird -----\tdw",
    "12": "SELECT      sp.SPONSOR_NAME,     COUNT(DISTINCT d.IAP_SUBJECT_SESSION_KEY) AS `number of sessions held`,     COALESCE(SUM(d.MAX_ENROLLMENT), 0) AS `total number of enrollment`,     MIN(d.FEE) AS `minimum fee`,     MAX(d.FEE) AS `maximum fee`,     COUNT(DISTINCT CASE WHEN sess.HAS_SESSION_INFO = 'Y' THEN d.IAP_SUBJECT_SESSION_KEY END) AS `number of sessions with info`,     COUNT(DISTINCT CASE WHEN sess.HAS_SESSION_INFO = 'N' THEN d.IAP_SUBJECT_SESSION_KEY END) AS `number of sessions without info` FROM IAP_SUBJECT_DETAIL d JOIN IAP_SUBJECT_SESSION sess ON d.IAP_SUBJECT_SESSION_KEY = sess.IAP_SUBJECT_SESSION_KEY JOIN IAP_SUBJECT_SPONSOR sp ON d.IAP_SUBJECT_SPONSOR_KEY = sp.IAP_SUBJECT_SPONSOR_KEY GROUP BY sp.IAP_SUBJECT_SPONSOR_KEY, sp.SPONSOR_NAME;\t----- bird -----\tdw",
    "13": "SELECT      p.PERSON_EMAIL AS email,     p.PERSON_NAME AS name,     t.ACADEMIC_YEAR AS academic_year,     COUNT(*) AS total_subjects,     MIN(d.FEE) AS min_fee,     MAX(d.FEE) AS max_fee,     SUM(d.MAX_ENROLLMENT) AS total_enrollment FROM IAP_SUBJECT_DETAIL d JOIN IAP_SUBJECT_PERSON p ON d.IAP_SUBJECT_PERSON_KEY = p.IAP_SUBJECT_PERSON_KEY JOIN (     SELECT DISTINCT ACADEMIC_TERM_CODE, ACADEMIC_YEAR     FROM TIME_DAY     WHERE ACADEMIC_TERM_CODE IS NOT NULL ) t ON d.TERM_CODE = t.ACADEMIC_TERM_CODE GROUP BY p.IAP_SUBJECT_PERSON_KEY, t.ACADEMIC_YEAR;\t----- bird -----\tdw",
    "14": "SELECT      a.TERM_CODE,     a.TERM_DESCRIPTION,     COUNT(DISTINCT s.IAP_SUBJECT_SESSION_KEY) AS total_sessions,     SUM(d.FEE) AS total_fee,     MIN(d.MAX_ENROLLMENT) AS min_enrollment,     MAX(d.MAX_ENROLLMENT) AS max_enrollment FROM ACADEMIC_TERMS_ALL a JOIN IAP_SUBJECT_DETAIL d ON a.TERM_CODE = d.TERM_CODE JOIN IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY GROUP BY a.TERM_CODE, a.TERM_DESCRIPTION ORDER BY a.TERM_CODE;\t----- bird -----\tdw",
    "15": "WITH session_data AS (     SELECT          B.BUILDING_NUMBER,         B.BUILDING_NAME,         D.ACTIVITY_TITLE,         D.FEE,         S.SESSION_START_TIME,         S.SESSION_END_TIME,         (TIME_TO_SEC(STR_TO_DATE(S.SESSION_END_TIME, '%h%i%p')) - TIME_TO_SEC(STR_TO_DATE(S.SESSION_START_TIME, '%h%i%p'))) / 60 AS duration_min     FROM IAP_SUBJECT_SESSION S     INNER JOIN IAP_SUBJECT_DETAIL D ON S.IAP_SUBJECT_SESSION_KEY = D.IAP_SUBJECT_SESSION_KEY     INNER JOIN BUILDINGS B ON S.SESSION_LOCATION = B.BUILDING_NUMBER ),  subject_agg AS (     SELECT          BUILDING_NUMBER,         COUNT(DISTINCT ACTIVITY_TITLE) AS total_subjects,         SUM(FEE) AS total_fee     FROM (         SELECT DISTINCT BUILDING_NUMBER, ACTIVITY_TITLE, FEE         FROM session_data     ) AS distinct_subjects     GROUP BY BUILDING_NUMBER ), duration_agg AS (     SELECT          BUILDING_NUMBER,         MIN(duration_min) AS shortest_session_min,         MAX(duration_min) AS longest_session_min     FROM session_data     GROUP BY BUILDING_NUMBER ) SELECT      B.BUILDING_NAME,     SA.total_subjects,     SA.total_fee,     DA.shortest_session_min,     DA.longest_session_min FROM BUILDINGS B JOIN subject_agg SA ON B.BUILDING_NUMBER = SA.BUILDING_NUMBER JOIN duration_agg DA ON B.BUILDING_NUMBER = DA.BUILDING_NUMBER ORDER BY B.BUILDING_NAME;\t----- bird -----\tdw",
    "16": "WITH virtual_sessions AS (     SELECT d.ACTIVITY_TITLE, d.FEE,            STR_TO_DATE(TRIM(s.SESSION_START_TIME), '%h%i%p') AS start_time,            STR_TO_DATE(TRIM(s.SESSION_END_TIME), '%h%i%p') AS end_time     FROM IAP_SUBJECT_DETAIL d     INNER JOIN IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY     LEFT JOIN BUILDINGS b ON s.SESSION_LOCATION = b.BUILDING_NUMBER     WHERE b.BUILDING_NUMBER IS NULL ), subject_summary AS (     SELECT ACTIVITY_TITLE, MIN(FEE) AS subject_fee     FROM virtual_sessions     GROUP BY ACTIVITY_TITLE ) SELECT      (SELECT COUNT(*) FROM subject_summary) AS total_subjects,     (SELECT SUM(subject_fee) FROM subject_summary) AS total_fee,     MIN(TIMESTAMPDIFF(MINUTE, start_time, end_time)) AS shortest_session_minutes,     MAX(TIMESTAMPDIFF(MINUTE, start_time, end_time)) AS longest_session_minutes FROM virtual_sessions;\t----- bird -----\tdw",
    "17": "SELECT      sc.SCHOOL_CODE,     sc.SCHOOL_NAME,     d.DEPARTMENT_FULL_NAME,     cd.COURSE_LEVEL,     COUNT(DISTINCT cd.COURSE) AS total_courses,     COUNT(DISTINCT CASE WHEN cd.IS_DEGREE_GRANTING = 'Y' THEN cd.COURSE END) AS degree_granting_courses FROM SIS_COURSE_DESCRIPTION cd JOIN SIS_DEPARTMENT d ON cd.DEPARTMENT = d.DEPARTMENT_CODE JOIN SIS_SUBJECT_CODE sc ON cd.COURSE = sc.SUBJECT_CODE GROUP BY sc.SCHOOL_CODE, sc.SCHOOL_NAME, d.DEPARTMENT_FULL_NAME, cd.COURSE_LEVEL ORDER BY sc.SCHOOL_CODE, d.DEPARTMENT_FULL_NAME, cd.COURSE_LEVEL;\t----- bird -----\tdw",
    "18": "WITH course_agg AS (     SELECT          s.SCHOOL_CODE,         s.SCHOOL_NAME,         d.DEPARTMENT_CODE,         a.SIS_ADMIN_DEPARTMENT_NAME AS DEPARTMENT_NAME,         c.COURSE_LEVEL,         COUNT(*) AS level_count     FROM SIS_COURSE_DESCRIPTION c     JOIN SIS_SUBJECT_CODE s ON c.COURSE = s.SUBJECT_CODE     JOIN SIS_DEPARTMENT d ON c.DEPARTMENT = d.DEPARTMENT_CODE     JOIN SIS_ADMIN_DEPARTMENT a ON d.DEPARTMENT_CODE = a.SIS_ADMIN_DEPARTMENT_CODE     GROUP BY s.SCHOOL_CODE, s.SCHOOL_NAME, d.DEPARTMENT_CODE, a.SIS_ADMIN_DEPARTMENT_NAME, c.COURSE_LEVEL ), ranked AS (     SELECT          SCHOOL_CODE,         SCHOOL_NAME,         DEPARTMENT_CODE,         DEPARTMENT_NAME,         COURSE_LEVEL,         level_count,         ROW_NUMBER() OVER (PARTITION BY SCHOOL_CODE, SCHOOL_NAME, DEPARTMENT_CODE, DEPARTMENT_NAME ORDER BY level_count DESC, COURSE_LEVEL) AS rn     FROM course_agg ) SELECT      SCHOOL_CODE,     SCHOOL_NAME,     DEPARTMENT_CODE,     DEPARTMENT_NAME,     (SELECT COUNT(DISTINCT DEPARTMENT_PHONE_NUMBER) FROM SIS_ADMIN_DEPARTMENT WHERE SIS_ADMIN_DEPARTMENT_CODE = DEPARTMENT_CODE) AS total_phone_numbers,     COURSE_LEVEL AS most_common_course_level FROM ranked WHERE rn = 1;\t----- bird -----\tdw",
    "19": "SELECT      ssc.SCHOOL_CODE,     ssc.SCHOOL_NAME,     GROUP_CONCAT(DISTINCT sd.DLC_KEY ORDER BY sd.DLC_KEY) AS `DLC_key`,     scd.GRADUATE_LEVEL,     COUNT(DISTINCT ssc.SUBJECT_CODE) AS `total_SIS_subjects`,     MIN(CAST(ssc.COURSE_NUMBER AS UNSIGNED)) AS `min_course_number`,     MAX(CAST(ssc.COURSE_NUMBER AS UNSIGNED)) AS `max_course_number`,     COUNT(DISTINCT sd.DEPARTMENT_CODE) AS `total_departments_offering_subjects` FROM SIS_SUBJECT_CODE ssc INNER JOIN SIS_COURSE_DESCRIPTION scd ON ssc.SUBJECT_CODE = scd.COURSE INNER JOIN SIS_DEPARTMENT sd ON scd.DEPARTMENT = sd.DEPARTMENT_CODE GROUP BY ssc.SCHOOL_CODE, ssc.SCHOOL_NAME, scd.GRADUATE_LEVEL;\t----- bird -----\tdw",
    "20": "WITH building_stats AS (     SELECT         sd.BUILDING_COMPONENT,         MAX(b.BUILDING_NAME) AS building_name,         SUM(sd.ROOM_SQUARE_FOOTAGE) AS total_sqft,         COUNT(DISTINCT sf.FLOOR) AS total_floors,         COUNT(DISTINCT sd.BUILDING_ROOM) AS total_rooms,         COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) AS total_facility_orgs     FROM SPACE_DETAIL sd     INNER JOIN BUILDINGS b ON b.BUILDING_KEY = sd.BUILDING_COMPONENT     INNER JOIN SPACE_FLOOR sf ON sd.FLOOR_KEY = sf.FLOOR_KEY     INNER JOIN SPACE_UNIT su ON sd.SPACE_UNIT_KEY = su.SPACE_UNIT_KEY     GROUP BY sd.BUILDING_COMPONENT ), supervisor_agg AS (     SELECT         sd.BUILDING_COMPONENT,         ssu.MIT_ID,         MAX(ssu.NUM_OF_SUPERVISEES) AS num_supervisees     FROM SPACE_DETAIL sd     JOIN SPACE_UNIT su ON sd.SPACE_UNIT_KEY = su.SPACE_UNIT_KEY     JOIN SPACE_SUPERVISOR_USAGE ssu ON FIND_IN_SET(su.DLC_KEY, ssu.DEPT_NAMES) > 0     GROUP BY sd.BUILDING_COMPONENT, ssu.MIT_ID ), supervisor_stats AS (     SELECT         BUILDING_COMPONENT,         COUNT(MIT_ID) AS total_supervisors,         SUM(num_supervisees) AS total_supervisees     FROM supervisor_agg     GROUP BY BUILDING_COMPONENT ) SELECT     bs.BUILDING_COMPONENT AS building_component,     bs.building_name,     bs.total_sqft AS square_footage,     bs.total_floors,     bs.total_rooms,     bs.total_facility_orgs,     COALESCE(ss.total_supervisors, 0) AS total_supervisors,     COALESCE(ss.total_supervisees, 0) AS total_supervisees FROM building_stats bs LEFT JOIN supervisor_stats ss ON bs.BUILDING_COMPONENT = ss.BUILDING_COMPONENT ORDER BY bs.BUILDING_COMPONENT;\t----- bird -----\tdw",
    "21": "WITH dlc_org AS (     SELECT DISTINCT u.DLC_KEY, o.DLC_NAME     FROM SPACE_UNIT u     JOIN FCLT_ORGANIZATION o ON u.DLC_KEY = o.DLC_KEY ), facility_org AS (     SELECT DLC_KEY, COUNT(DISTINCT FCLT_ORGANIZATION_KEY) AS total_facility_orgs     FROM SPACE_UNIT     GROUP BY DLC_KEY ), space_agg AS (     SELECT          u.DLC_KEY,         SUM(d.ROOM_SQUARE_FOOTAGE) AS total_sqft,         COUNT(DISTINCT CONCAT(d.BUILDING_KEY, '|', d.FLOOR_KEY)) AS total_floors     FROM SPACE_UNIT u     JOIN SPACE_DETAIL d ON u.SPACE_UNIT_KEY = d.SPACE_UNIT_KEY     GROUP BY u.DLC_KEY ), building_height_agg AS (     SELECT          db.DLC_KEY,         SUM(CAST(b.BUILDING_HEIGHT AS DECIMAL(10,2))) AS total_building_heights     FROM (         SELECT DISTINCT u.DLC_KEY, d.BUILDING_KEY         FROM SPACE_UNIT u         JOIN SPACE_DETAIL d ON u.SPACE_UNIT_KEY = d.SPACE_UNIT_KEY     ) db     JOIN FCLT_BUILDING b ON db.BUILDING_KEY = b.FCLT_BUILDING_KEY     GROUP BY db.DLC_KEY ), supervisor_agg AS (     SELECT          u.DLC_KEY,         COUNT(DISTINCT s.MIT_ID) AS total_supervisors,         SUM(s.NUM_OF_SUPERVISEES) AS total_supervisees     FROM SPACE_UNIT u     JOIN SPACE_SUPERVISOR_USAGE s ON u.DLC_KEY = s.DEPT_NAMES     GROUP BY u.DLC_KEY ) SELECT      d.DLC_KEY,     d.DLC_NAME,     COALESCE(sa.total_floors, 0) AS total_number_of_floors,     COALESCE(sa.total_sqft, 0) AS total_square_footage,     COALESCE(fo.total_facility_orgs, 0) AS total_number_of_facility_organizations,     COALESCE(sup.total_supervisors, 0) AS total_number_of_supervisors,     COALESCE(sup.total_supervisees, 0) AS total_number_of_supervisees,     COALESCE(bh.total_building_heights, 0) AS total_building_heights FROM dlc_org d LEFT JOIN facility_org fo ON d.DLC_KEY = fo.DLC_KEY LEFT JOIN space_agg sa ON d.DLC_KEY = sa.DLC_KEY LEFT JOIN building_height_agg bh ON d.DLC_KEY = bh.DLC_KEY LEFT JOIN supervisor_agg sup ON d.DLC_KEY = sup.DLC_KEY ORDER BY d.DLC_KEY;\t----- bird -----\tdw",
    "22": "SELECT      s.OFFER_DEPT_NAME,     s.subject_types,     s.total_enrolled,     r.min_rental_new_price,     r.max_rental_new_price FROM      (SELECT OFFER_DEPT_NAME,             COUNT(DISTINCT SUBJECT_ID) AS subject_types,             SUM(NUM_ENROLLED_STUDENTS) AS total_enrolled      FROM TIP_SUBJECT_OFFERED      GROUP BY OFFER_DEPT_NAME) s LEFT JOIN     (SELECT o.OFFER_DEPT_NAME,             MIN(m.RENTAL_NEW_PRICE) AS min_rental_new_price,             MAX(m.RENTAL_NEW_PRICE) AS max_rental_new_price      FROM TIP_SUBJECT_OFFERED o      JOIN TIP_DETAIL d ON o.TIP_SUBJECT_OFFERED_KEY = d.TIP_SUBJECT_OFFERED_KEY      JOIN TIP_MATERIAL m ON d.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY      GROUP BY o.OFFER_DEPT_NAME) r ON s.OFFER_DEPT_NAME = r.OFFER_DEPT_NAME;\t----- bird -----\tdw",
    "23": "SELECT     c.ACADEMIC_YEAR,     a.TERM_CODE,     s.HGN_CODE,     COUNT(*) AS total_number_of_courses,     AVG(c.TOTAL_UNITS) AS average_number_of_units,     c.DEPARTMENT_NAME,     e.FULL_NAME AS person_in_charge_name,     e.EMAIL_ADDRESS AS person_in_charge_email FROM ACADEMIC_TERMS a JOIN COURSE_CATALOG_SUBJECT_OFFERED c ON c.TERM_CODE = a.TERM_CODE JOIN SUBJECT_OFFERED s ON s.SUBJECT_ID = c.SUBJECT_ID AND s.TERM_CODE = a.TERM_CODE JOIN EMPLOYEE_DIRECTORY e ON e.MIT_ID = s.RESPONSIBLE_FACULTY_MIT_ID WHERE a.IS_CURRENT_TERM = 'Y'   AND c.IS_MASTER_SECTION = 'Y'   AND s.IS_MASTER_SECTION = 'Y' GROUP BY c.ACADEMIC_YEAR, a.TERM_CODE, s.HGN_CODE, c.DEPARTMENT_NAME, e.FULL_NAME, e.EMAIL_ADDRESS;\t----- bird -----\tdw",
    "24": "SELECT      d.ACTIVITY_TITLE,     c.IAP_CATEGORY_NAME,     s.SESSION_TITLE,     s.SESSION_START_TIME,     s.SESSION_END_TIME,     sp.SPONSOR_NAME,     COUNT(*) OVER (PARTITION BY d.IAP_SUBJECT_CATEGORY_KEY, d.IAP_SUBJECT_SPONSOR_KEY, d.ACTIVITY_TITLE) AS total_sessions FROM IAP_SUBJECT_DETAIL d JOIN IAP_SUBJECT_CATEGORY c ON d.IAP_SUBJECT_CATEGORY_KEY = c.IAP_SUBJECT_CATEGORY_KEY JOIN IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY JOIN IAP_SUBJECT_SPONSOR sp ON d.IAP_SUBJECT_SPONSOR_KEY = sp.IAP_SUBJECT_SPONSOR_KEY;\t----- bird -----\tdw",
    "25": "SELECT      d.DEPARTMENT_NAME,     s.SUBJECT_CODE,     s.SUBJECT_CODE_DESC,     c.GRADUATE_LEVEL,     COUNT(DISTINCT c.COURSE) AS total_courses FROM SIS_DEPARTMENT d INNER JOIN SIS_COURSE_DESCRIPTION c ON d.DEPARTMENT_CODE = c.DEPARTMENT INNER JOIN SIS_SUBJECT_CODE s ON c.COURSE = s.COURSE_NUMBER GROUP BY      d.DEPARTMENT_NAME,     s.SUBJECT_CODE,     s.SUBJECT_CODE_DESC,     c.GRADUATE_LEVEL;\t----- bird -----\tdw",
    "26": "SELECT      a.TERM_CODE,     a.TERM_DESCRIPTION,     CASE          WHEN a.TERM_CODE = (SELECT TERM_CODE FROM ACADEMIC_TERM_PARAMETER WHERE IS_CURRENT_TERM = 'Y') THEN 'Y'          ELSE 'N'      END AS IS_CURRENT,     COUNT(DISTINCT          CASE              WHEN RIGHT(a.TERM_CODE, 2) = 'FA' AND c.IS_OFFERED_FALL_TERM = 'Y' THEN c.SUBJECT_ID             WHEN RIGHT(a.TERM_CODE, 2) = 'SP' AND c.IS_OFFERED_SPRING_TERM = 'Y' THEN c.SUBJECT_ID             WHEN RIGHT(a.TERM_CODE, 2) = 'SU' AND c.IS_OFFERED_SUMMER_TERM = 'Y' THEN c.SUBJECT_ID             WHEN RIGHT(a.TERM_CODE, 2) = 'JA' AND c.IS_OFFERED_IAP = 'Y' THEN c.SUBJECT_ID             ELSE NULL         END     ) AS TOTAL_CIS_COURSES FROM ACADEMIC_TERMS_ALL a LEFT JOIN CIS_COURSE_CATALOG c ON a.ACADEMIC_YEAR = c.ACADEMIC_YEAR GROUP BY a.TERM_CODE, a.TERM_DESCRIPTION ORDER BY a.TERM_CODE;\t----- bird -----\tdw",
    "27": "SELECT TM.AUTHOR, SD.SCHOOL_NAME, TMS.TIP_MATERIAL_STATUS AS MATERIAL_STATUS, SUM(TD.RECORD_COUNT) AS TOTAL_RECORD_COUNTS, COUNT(DISTINCT TD.SUBJECT_ID) AS TOTAL_NUMBER_OF_TYPES_OF_COURSES FROM TIP_DETAIL TD JOIN TIP_MATERIAL TM ON TD.TIP_MATERIAL_KEY = TM.TIP_MATERIAL_KEY JOIN TIP_MATERIAL_STATUS TMS ON TD.TIP_MATERIAL_STATUS_KEY = TMS.TIP_MATERIAL_STATUS_KEY JOIN TIP_SUBJECT_OFFERED TSO ON TD.TIP_SUBJECT_OFFERED_KEY = TSO.TIP_SUBJECT_OFFERED_KEY JOIN STUDENT_DEPARTMENT SD ON TSO.OFFER_DEPT_CODE = SD.DEPARTMENT_CODE GROUP BY TM.AUTHOR, SD.SCHOOL_NAME, TMS.TIP_MATERIAL_STATUS;\t----- bird -----\tdw",
    "28": "WITH base AS (     SELECT          O.COURSE_NUMBER,         O.SUBJECT_TITLE,         S.TIP_MATERIAL_STATUS,         M.TIP_MATERIAL_KEY,         M.NEW_SHELF_PRICE,         M.USED_SHELF_PRICE,         O.OFFER_SCHOOL_NAME     FROM TIP_DETAIL D     JOIN TIP_MATERIAL M ON D.TIP_MATERIAL_KEY = M.TIP_MATERIAL_KEY     JOIN TIP_MATERIAL_STATUS S ON D.TIP_MATERIAL_STATUS_KEY = S.TIP_MATERIAL_STATUS_KEY     JOIN TIP_SUBJECT_OFFERED O ON D.TIP_SUBJECT_OFFERED_KEY = O.TIP_SUBJECT_OFFERED_KEY ), material_dedup AS (     SELECT DISTINCT         COURSE_NUMBER,         SUBJECT_TITLE,         TIP_MATERIAL_STATUS,         TIP_MATERIAL_KEY,         NEW_SHELF_PRICE,         USED_SHELF_PRICE     FROM base ), material_agg AS (     SELECT         COURSE_NUMBER,         SUBJECT_TITLE,         TIP_MATERIAL_STATUS,         COUNT(*) AS TOTAL_MATERIALS,         SUM(NEW_SHELF_PRICE) AS TOTAL_NEW_SHELF_PRICE,         MIN(NEW_SHELF_PRICE) AS MIN_NEW_SHELF_PRICE,         MAX(NEW_SHELF_PRICE) AS MAX_NEW_SHELF_PRICE,         SUM(USED_SHELF_PRICE) AS TOTAL_USED_SHELF_PRICE,         MIN(USED_SHELF_PRICE) AS MIN_USED_SHELF_PRICE,         MAX(USED_SHELF_PRICE) AS MAX_USED_SHELF_PRICE     FROM material_dedup     GROUP BY COURSE_NUMBER, SUBJECT_TITLE, TIP_MATERIAL_STATUS ), school_agg AS (     SELECT         COURSE_NUMBER,         SUBJECT_TITLE,         TIP_MATERIAL_STATUS,         COUNT(DISTINCT OFFER_SCHOOL_NAME) AS TOTAL_SCHOOLS     FROM base     GROUP BY COURSE_NUMBER, SUBJECT_TITLE, TIP_MATERIAL_STATUS ) SELECT     m.COURSE_NUMBER,     m.SUBJECT_TITLE,     m.TIP_MATERIAL_STATUS,     m.TOTAL_NEW_SHELF_PRICE,     m.MIN_NEW_SHELF_PRICE,     m.MAX_NEW_SHELF_PRICE,     m.TOTAL_USED_SHELF_PRICE,     m.MIN_USED_SHELF_PRICE,     m.MAX_USED_SHELF_PRICE,     s.TOTAL_SCHOOLS,     m.TOTAL_MATERIALS FROM material_agg m JOIN school_agg s     ON m.COURSE_NUMBER = s.COURSE_NUMBER     AND m.SUBJECT_TITLE = s.SUBJECT_TITLE     AND m.TIP_MATERIAL_STATUS = s.TIP_MATERIAL_STATUS ORDER BY m.COURSE_NUMBER, m.SUBJECT_TITLE, m.TIP_MATERIAL_STATUS;\t----- bird -----\tdw",
    "29": "SELECT      tms.TIP_MATERIAL_STATUS AS material_status,     COUNT(DISTINCT td.TIP_MATERIAL_KEY) AS total_materials,     COUNT(DISTINCT td.SUBJECT_ID) AS total_subjects,     COUNT(DISTINCT sd.SCHOOL_NAME) AS total_schools,     MAX(tm.YEAR) AS most_recent_publication_year FROM TIP_DETAIL td JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY JOIN TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY JOIN STUDENT_DEPARTMENT sd ON tso.OFFER_DEPT_CODE = sd.DEPARTMENT_CODE GROUP BY tms.TIP_MATERIAL_STATUS;\t----- bird -----\tdw",
    "30": "SELECT     a.TERM_CODE,     a.TERM_DESCRIPTION,     a.IS_CURRENT_TERM,     COUNT(DISTINCT s.COURSE_NUMBER) AS subjects_offered_count,     COUNT(DISTINCT m.ISBN) AS materials_needed_count,     MIN(s.NUM_ENROLLED_STUDENTS) AS min_enrolled,     MAX(s.NUM_ENROLLED_STUDENTS) AS max_enrolled,     COUNT(DISTINCT s.OFFER_SCHOOL_NAME) AS schools_count,     COALESCE(SUM(d.RECORD_COUNT), 0) AS total_records FROM     ACADEMIC_TERMS_ALL a     INNER JOIN TIP_SUBJECT_OFFERED s ON a.TERM_CODE = s.TERM_CODE     LEFT JOIN TIP_DETAIL d ON s.TIP_SUBJECT_OFFERED_KEY = d.TIP_SUBJECT_OFFERED_KEY     LEFT JOIN TIP_MATERIAL m ON d.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY     LEFT JOIN TIP_MATERIAL_STATUS ms ON d.TIP_MATERIAL_STATUS_KEY = ms.TIP_MATERIAL_STATUS_KEY GROUP BY     a.TERM_CODE, a.TERM_DESCRIPTION, a.IS_CURRENT_TERM ORDER BY     a.TERM_CODE;\t----- bird -----\tdw",
    "31": "SELECT      b.BUILDING_NAME,     b.BUILDING_NUMBER,     fb.BUILDING_HEIGHT,     b.BUILDING_STREET_ADDRESS,     fba.CITY,     fba.STATE,     fo.HR_DEPARTMENT_NAME,     b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE AS assignable_sqft,     SUM(CAST(fr.AREA AS DECIMAL(10,2))) AS total_sqft,     AVG(CAST(fr.AREA AS DECIMAL(10,2))) AS avg_sqft FROM BUILDINGS b INNER JOIN FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY INNER JOIN FAC_ROOMS fr ON b.BUILDING_KEY = fr.BUILDING_KEY INNER JOIN FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY INNER JOIN FAC_BUILDING_ADDRESS fba ON b.BUILDING_KEY = fba.BUILDING_KEY AND fba.ADDRESS_PURPOSE = 'STREET' GROUP BY      b.BUILDING_NAME,     b.BUILDING_NUMBER,     fb.BUILDING_HEIGHT,     b.BUILDING_STREET_ADDRESS,     fba.CITY,     fba.STATE,     fo.HR_DEPARTMENT_NAME,     b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE ORDER BY      assignable_sqft DESC,     total_sqft DESC,     avg_sqft DESC;\t----- bird -----\tdw",
    "32": "WITH term_total AS (     SELECT term_code, COUNT(DISTINCT subject_id) AS total_subjects     FROM COURSE_CATALOG_SUBJECT_OFFERED     WHERE term_code = '2023FA'     GROUP BY term_code ), instructor_total AS (     SELECT fall_instructors AS instructor, COUNT(DISTINCT subject_id) AS total_courses     FROM COURSE_CATALOG_SUBJECT_OFFERED     WHERE fall_instructors IS NOT NULL     GROUP BY fall_instructors ) SELECT      a.TERM_DESCRIPTION,     c.SUBJECT_TITLE,     c.PREREQUISITES,     tt.total_subjects AS total_subjects_per_term,     c.FALL_INSTRUCTORS AS instructor,     COALESCE(it.total_courses, 0) AS instructor_total_courses FROM COURSE_CATALOG_SUBJECT_OFFERED c JOIN ACADEMIC_TERMS a ON c.TERM_CODE = a.TERM_CODE JOIN term_total tt ON c.TERM_CODE = tt.term_code LEFT JOIN instructor_total it ON c.FALL_INSTRUCTORS = it.instructor WHERE c.TERM_CODE = '2023FA';\t----- bird -----\tdw",
    "33": "SELECT      r.ROOM_FULL_NAME,     b.BUILDING_NAME,     f.FLOOR,     o.ORGANIZATION_NAME,     o.HR_DEPARTMENT_NAME,     (r.AREA / f.ASSIGNABLE_AREA) * 100 AS pct_of_floor_assignable_area,     (r.AREA / b.ASSIGNABLE_AREA) * 100 AS pct_of_building_assignable_area FROM FAC_ROOMS r JOIN FAC_BUILDING b ON r.BUILDING_KEY = b.FAC_BUILDING_KEY JOIN FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY JOIN FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY;\t----- bird -----\tdw",
    "34": "SELECT     r.ROOM_FULL_NAME AS `Room Full Name`,     b.BUILDING_NAME AS `Building Name`,     f.FLOOR AS `Floor Number`,     o.ORGANIZATION_NAME AS `Organization`,     o.HR_DEPARTMENT_NAME AS `Department`,     ROUND((CAST(r.AREA AS DECIMAL) / SUM(CAST(r.AREA AS DECIMAL)) OVER (PARTITION BY r.FLOOR_KEY) * 100), 2) AS `% of Floor Area`,     ROUND((CAST(r.AREA AS DECIMAL) / SUM(CAST(r.AREA AS DECIMAL)) OVER (PARTITION BY r.BUILDING_KEY) * 100), 2) AS `% of Building Area` FROM FAC_ROOMS r LEFT JOIN FAC_BUILDING b ON r.BUILDING_KEY = b.FAC_BUILDING_KEY LEFT JOIN FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY LEFT JOIN FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY ORDER BY b.BUILDING_NAME, f.FLOOR, r.ROOM_FULL_NAME;\t----- bird -----\tdw",
    "35": "SELECT a.ACADEMIC_YEAR, e.FULL_NAME, COUNT(DISTINCT s.SUBJECT_ID) AS total_types_of_courses FROM SUBJECT_OFFERED s JOIN ACADEMIC_TERMS_ALL a ON s.TERM_CODE = a.TERM_CODE JOIN EMPLOYEE_DIRECTORY e ON s.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID WHERE a.ACADEMIC_YEAR = '2022' GROUP BY a.ACADEMIC_YEAR, e.FULL_NAME;\t----- bird -----\tdw",
    "36": "SELECT      b.FAC_BUILDING_KEY AS building_key,     b.BUILDING_NAME AS building_name,     GROUP_CONCAT(DISTINCT o.HR_DEPARTMENT_NAME ORDER BY o.HR_DEPARTMENT_NAME) AS department_names,     GROUP_CONCAT(DISTINCT o.ORGANIZATION ORDER BY o.ORGANIZATION) AS organizations,     MAX(CAST(f.LEVEL_ID AS SIGNED)) AS highest_floor_number,     MIN(CAST(f.LEVEL_ID AS SIGNED)) AS lowest_floor_number,     COUNT(DISTINCT r.FAC_ROOM_KEY) AS total_rooms FROM FAC_ROOMS r JOIN FAC_BUILDING b ON r.BUILDING_KEY = b.FAC_BUILDING_KEY JOIN FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY JOIN FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY GROUP BY b.FAC_BUILDING_KEY, b.BUILDING_NAME;\t----- bird -----\tdw",
    "37": "SELECT      m.FULL_NAME,     m.EMAIL_ADDRESS,     d.DEPARTMENT_NAME,     a.DEPARTMENT_PHONE_NUMBER,     d.SCHOOL_NAME,     c.total_students FROM MIT_STUDENT_DIRECTORY m INNER JOIN SIS_DEPARTMENT d ON m.DEPARTMENT = d.DEPARTMENT_CODE INNER JOIN SIS_ADMIN_DEPARTMENT a ON a.SIS_ADMIN_DEPARTMENT_CODE = d.DEPARTMENT_CODE INNER JOIN (     SELECT          d.DEPARTMENT_CODE,         d.SCHOOL_CODE,         COUNT(*) AS total_students     FROM MIT_STUDENT_DIRECTORY m     INNER JOIN SIS_DEPARTMENT d ON m.DEPARTMENT = d.DEPARTMENT_CODE     GROUP BY d.DEPARTMENT_CODE, d.SCHOOL_CODE ) c ON d.DEPARTMENT_CODE = c.DEPARTMENT_CODE AND d.SCHOOL_CODE = c.SCHOOL_CODE WHERE m.FIRST_NAME = 'Kevin';\t----- bird -----\tdw",
    "38": "SELECT DISTINCT     c.SUBJECT_TITLE AS subject_title,     e.FULL_NAME AS instructor_name,     e.EMAIL_ADDRESS AS instructor_email,     ic.total_subjects AS total_subjects_per_instructor FROM COURSE_CATALOG_SUBJECT_OFFERED c INNER JOIN ACADEMIC_TERMS_ALL t ON c.TERM_CODE = t.TERM_CODE INNER JOIN EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID INNER JOIN (     SELECT RESPONSIBLE_FACULTY_MIT_ID, COUNT(DISTINCT SUBJECT_TITLE) AS total_subjects     FROM COURSE_CATALOG_SUBJECT_OFFERED     GROUP BY RESPONSIBLE_FACULTY_MIT_ID ) ic ON ic.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID WHERE t.TERM_CODE LIKE '%FA' ORDER BY c.SUBJECT_TITLE, e.FULL_NAME;\t----- bird -----\tdw",
    "39": "WITH BuildingDept AS (     SELECT DISTINCT         r.BUILDING_KEY,         o.HR_DEPARTMENT_NAME     FROM FAC_ROOMS r     INNER JOIN FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY ), DeptCount AS (     SELECT BUILDING_KEY, COUNT(*) AS dept_count     FROM BuildingDept     GROUP BY BUILDING_KEY ) SELECT     b.BUILDING_KEY,     b.BUILDING_NAME,     bd.HR_DEPARTMENT_NAME,     b.BLDG_GROSS_SQUARE_FOOTAGE AS total_gross_sqft,     b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE AS total_assignable_sqft,     b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE / dc.dept_count AS avg_assignable_sqft,     YEAR(STR_TO_DATE(fb.DATE_BUILT, '%m/%d/%Y')) AS built_year FROM BUILDINGS b INNER JOIN FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY INNER JOIN BuildingDept bd ON b.BUILDING_KEY = bd.BUILDING_KEY INNER JOIN DeptCount dc ON b.BUILDING_KEY = dc.BUILDING_KEY ORDER BY b.BUILDING_KEY, bd.HR_DEPARTMENT_NAME;\t----- bird -----\tdw",
    "40": "SELECT      c.SUBJECT_TITLE,     c.SUBJECT_DESCRIPTION,     c.RESPONSIBLE_FACULTY_NAME,     e.EMAIL_ADDRESS,     b.BUILDING_NAME,     r.ROOM_FULL_NAME,     f.LEVEL_ID,     b.BUILDING_STREET_ADDRESS,     d.dept_course_count AS total_courses_per_department FROM COURSE_CATALOG_SUBJECT_OFFERED c JOIN ACADEMIC_TERMS t ON c.TERM_CODE = t.TERM_CODE JOIN EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID JOIN FAC_ROOMS r ON c.MEET_PLACE = r.FAC_ROOM_KEY JOIN FAC_FLOOR f ON r.FLOOR_KEY = f.FLOOR_KEY JOIN BUILDINGS b ON r.BUILDING_KEY = b.BUILDING_KEY JOIN (     SELECT DEPARTMENT_CODE, COUNT(DISTINCT MASTER_SUBJECT_ID) AS dept_course_count     FROM COURSE_CATALOG_SUBJECT_OFFERED     GROUP BY DEPARTMENT_CODE ) d ON c.DEPARTMENT_CODE = d.DEPARTMENT_CODE WHERE t.TERM_CODE LIKE '%SU';\t----- bird -----\tdw",
    "41": "SELECT      C.TERM_CODE,     A.TERM_DESCRIPTION,     C.HASS_ATTRIBUTE_DESC AS ATTRIBUTE_DESCRIPTION,     D.DEPARTMENT_NAME,     D.SCHOOL_NAME,     COUNT(DISTINCT C.SUBJECT_ID) AS NUMBER_OF_SUBJECTS FROM COURSE_CATALOG_SUBJECT_OFFERED C INNER JOIN ACADEMIC_TERMS_ALL A ON C.TERM_CODE = A.TERM_CODE INNER JOIN SIS_DEPARTMENT D ON C.DEPARTMENT_CODE = D.DEPARTMENT_CODE INNER JOIN CIS_HASS_ATTRIBUTE H ON C.HASS_ATTRIBUTE = H.HASS_ATTRIBUTE WHERE H.CIS_ATTRIBUTE_GROUP = 'H' GROUP BY C.TERM_CODE, A.TERM_DESCRIPTION, C.HASS_ATTRIBUTE_DESC, D.DEPARTMENT_NAME, D.SCHOOL_NAME ORDER BY C.TERM_CODE, A.TERM_DESCRIPTION, C.HASS_ATTRIBUTE_DESC, D.DEPARTMENT_NAME, D.SCHOOL_NAME;\t----- bird -----\tdw",
    "42": "SELECT      fb.FAC_BUILDING_KEY AS building_key,     fb.BUILDING_NAME,     fb.BUILDING_HEIGHT,     b.BUILDING_STREET_ADDRESS,     fba.CITY,     fba.STATE,     fba.POSTAL_CODE,     fb.EXT_GROSS_AREA AS gross_sq_ft,     fb.ASSIGNABLE_AREA AS assignable_sq_ft,     fa.min_floor AS smallest_floor,     fa.max_floor AS largest_floor,     COALESCE(ra.total_area, 0) AS total_room_area FROM FAC_BUILDING fb LEFT JOIN BUILDINGS b ON fb.FAC_BUILDING_KEY = b.BUILDING_KEY LEFT JOIN (     SELECT BUILDING_KEY,            MAX(CITY) AS CITY,            MAX(STATE) AS STATE,            MAX(POSTAL_CODE) AS POSTAL_CODE     FROM FAC_BUILDING_ADDRESS     WHERE ADDRESS_PURPOSE = 'STREET'     GROUP BY BUILDING_KEY ) fba ON fb.FAC_BUILDING_KEY = fba.BUILDING_KEY LEFT JOIN (     SELECT BUILDING_KEY,            MIN(CAST(LEVEL_ID AS INTEGER)) AS min_floor,            MAX(CAST(LEVEL_ID AS INTEGER)) AS max_floor     FROM FAC_FLOOR     GROUP BY BUILDING_KEY ) fa ON fb.FAC_BUILDING_KEY = fa.BUILDING_KEY LEFT JOIN (     SELECT BUILDING_KEY,            SUM(CAST(AREA AS REAL)) AS total_area     FROM FAC_ROOMS     GROUP BY BUILDING_KEY ) ra ON fb.FAC_BUILDING_KEY = ra.BUILDING_KEY;\t----- bird -----\tdw",
    "43": "SELECT      c.CATEGORY_CODE,     c.CATEGORY_TITLE,     c.VERSION,     d.DEPARTMENT_NAME,     d.SCHOOL_NAME,     COUNT(CASE WHEN cd.COURSE_LEVEL = 'U' THEN 1 END) AS Undergraduate_Courses,     COUNT(CASE WHEN cd.COURSE_LEVEL = 'G' THEN 1 END) AS Graduate_Courses,     COUNT(CASE WHEN cd.IS_DEGREE_GRANTING = 'Y' THEN 1 END) AS Degree_Granting_Courses FROM SIS_COURSE_DESCRIPTION cd JOIN CIP c ON cd.CIP_PROGRAM_CODE = c.PROGRAM_CODE JOIN SIS_DEPARTMENT d ON cd.DEPARTMENT = d.DEPARTMENT_CODE GROUP BY      c.CATEGORY_CODE,     c.CATEGORY_TITLE,     c.VERSION,     d.DEPARTMENT_NAME,     d.SCHOOL_NAME;\t----- bird -----\tdw",
    "44": "SELECT      i.COURSE_NAME,     COUNT(DISTINCT c.CATALOG_SYSTEM_NUMBER) AS total_library_materials,     MIN(CAST(c.CATALOG_YEAR AS UNSIGNED)) AS min_publication_year,     MAX(CAST(c.CATALOG_YEAR AS UNSIGNED)) AS max_publication_year,     COUNT(*) AS total_materials_status FROM LIBRARY_RESERVE_MATRL_DETAIL f INNER JOIN LIBRARY_COURSE_INSTRUCTOR i ON f.LIBRARY_COURSE_INSTRUCTOR_KEY = i.LIBRARY_COURSE_INSTRUCTOR_KEY INNER JOIN LIBRARY_RESERVE_CATALOG c ON f.LIBRARY_RESERVE_CATALOG_KEY = c.LIBRARY_RESERVE_CATALOG_KEY INNER JOIN LIBRARY_MATERIAL_STATUS s ON f.LIBRARY_MATERIAL_STATUS_KEY = s.LIBRARY_MATERIAL_STATUS_KEY GROUP BY i.COURSE_NAME;\t----- bird -----\tdw",
    "45": "SELECT      c.INSTRUCTOR_NAME,     c.total_materials,     c.min_pub_year AS min_publication_year,     c.max_pub_year AS max_publication_year,     COALESCE(e.total_enrolled_students, 0) AS total_enrolled_students FROM (     SELECT          i.INSTRUCTOR_NAME,         COUNT(DISTINCT c.LIBRARY_RESERVE_CATALOG_KEY) AS total_materials,         MIN(CAST(c.CATALOG_YEAR AS UNSIGNED)) AS min_pub_year,         MAX(CAST(c.CATALOG_YEAR AS UNSIGNED)) AS max_pub_year     FROM LIBRARY_COURSE_INSTRUCTOR i     INNER JOIN LIBRARY_RESERVE_MATRL_DETAIL d ON i.LIBRARY_COURSE_INSTRUCTOR_KEY = d.LIBRARY_COURSE_INSTRUCTOR_KEY     INNER JOIN LIBRARY_RESERVE_CATALOG c ON d.LIBRARY_RESERVE_CATALOG_KEY = c.LIBRARY_RESERVE_CATALOG_KEY     GROUP BY i.INSTRUCTOR_NAME ) c LEFT JOIN (     SELECT         inst_subj.INSTRUCTOR_NAME,         SUM(s.NUM_ENROLLED_STUDENTS) AS total_enrolled_students     FROM (         SELECT DISTINCT i.INSTRUCTOR_NAME, d.LIBRARY_SUBJECT_OFFERED_KEY         FROM LIBRARY_COURSE_INSTRUCTOR i         INNER JOIN LIBRARY_RESERVE_MATRL_DETAIL d ON i.LIBRARY_COURSE_INSTRUCTOR_KEY = d.LIBRARY_COURSE_INSTRUCTOR_KEY     ) inst_subj     INNER JOIN LIBRARY_SUBJECT_OFFERED s ON inst_subj.LIBRARY_SUBJECT_OFFERED_KEY = s.LIBRARY_SUBJECT_OFFERED_KEY     GROUP BY inst_subj.INSTRUCTOR_NAME ) e ON c.INSTRUCTOR_NAME = e.INSTRUCTOR_NAME ORDER BY c.INSTRUCTOR_NAME;\t----- bird -----\tdw",
    "46": "SELECT     lms.LIBRARY_MATERIAL_STATUS_CODE AS material_status_code,     ata.TERM_CODE AS term_code,     lms.LIBRARY_MATERIAL_STATUS AS material_status,     ata.TERM_DESCRIPTION AS term_description,     COUNT(DISTINCT lso.COURSE_NUMBER) AS total_courses,     COUNT(DISTINCT lrc.CATALOG_SYSTEM_NUMBER) AS total_materials,     COUNT(DISTINCT lso.OFFER_DEPT_CODE) AS total_departments,     COUNT(DISTINCT lso.OFFER_SCHOOL_NAME) AS total_schools,     COUNT(DISTINCT lci.INSTRUCTOR_NAME) AS total_instructors FROM LIBRARY_RESERVE_MATRL_DETAIL lrmd INNER JOIN LIBRARY_MATERIAL_STATUS lms ON lrmd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY INNER JOIN LIBRARY_SUBJECT_OFFERED lso ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY INNER JOIN LIBRARY_COURSE_INSTRUCTOR lci ON lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY = lci.LIBRARY_COURSE_INSTRUCTOR_KEY INNER JOIN LIBRARY_RESERVE_CATALOG lrc ON lrmd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY INNER JOIN ACADEMIC_TERMS_ALL ata ON lso.TERM_CODE = ata.TERM_CODE GROUP BY     lms.LIBRARY_MATERIAL_STATUS_CODE,     ata.TERM_CODE,     lms.LIBRARY_MATERIAL_STATUS,     ata.TERM_DESCRIPTION ORDER BY     lms.LIBRARY_MATERIAL_STATUS_CODE,     ata.TERM_CODE;\t----- bird -----\tdw",
    "47": "SELECT su.SPACE_UNIT, f.FLOOR, b.BUILDING_NAME, b.BUILDING_STREET_ADDRESS, u.SPACE_USAGE,        cnt.org_count, cnt.space_unit_count FROM SPACE_DETAIL sd JOIN BUILDINGS b ON sd.BUILDING_KEY = b.BUILDING_KEY JOIN SPACE_FLOOR f ON sd.FLOOR_KEY = f.FLOOR_KEY JOIN SPACE_UNIT su ON sd.SPACE_UNIT_KEY = su.SPACE_UNIT_KEY JOIN SPACE_USAGE u ON sd.SPACE_USAGE_KEY = u.SPACE_USAGE_KEY JOIN (     SELECT sd.BUILDING_KEY, sd.FLOOR_KEY,            COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) AS org_count,            COUNT(DISTINCT sd.SPACE_UNIT_KEY) AS space_unit_count     FROM SPACE_DETAIL sd     JOIN SPACE_UNIT su ON sd.SPACE_UNIT_KEY = su.SPACE_UNIT_KEY     JOIN BUILDINGS b ON sd.BUILDING_KEY = b.BUILDING_KEY     WHERE b.BUILDING_NUMBER = '36'     GROUP BY sd.BUILDING_KEY, sd.FLOOR_KEY ) cnt ON sd.BUILDING_KEY = cnt.BUILDING_KEY AND sd.FLOOR_KEY = cnt.FLOOR_KEY WHERE b.BUILDING_NUMBER = '36' ORDER BY f.FLOOR, su.SPACE_UNIT;\t----- bird -----\tdw",
    "48": "SELECT      ml.MOIRA_LIST_NAME AS name,     ml.IS_MOIRA_MAILING_LIST,     ml.IS_MOIRA_GROUP,     ml.IS_NFS_GROUP,     mo.OWNER AS owner,     COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS number_of_people FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN MOIRA_LIST_OWNER mo ON mld.MOIRA_LIST_OWNER_KEY = mo.MOIRA_LIST_OWNER_KEY WHERE UPPER(ml.MOIRA_LIST_NAME) LIKE 'A%' GROUP BY      ml.MOIRA_LIST_KEY,     ml.MOIRA_LIST_NAME,     ml.IS_MOIRA_MAILING_LIST,     ml.IS_MOIRA_GROUP,     ml.IS_NFS_GROUP,     mo.OWNER HAVING COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) > 1000 ORDER BY ml.MOIRA_LIST_NAME;\t----- bird -----\tdw",
    "49": "WITH list_member_counts AS (     SELECT          l.MOIRA_LIST_KEY,         l.MOIRA_LIST_NAME,         l.IS_PUBLIC,         l.IS_HIDDEN,         COUNT(DISTINCT d.MOIRA_LIST_MEMBER) AS member_count     FROM MOIRA_LIST l     LEFT JOIN MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY     WHERE l.IS_MOIRA_MAILING_LIST = 'Y'     GROUP BY l.MOIRA_LIST_KEY, l.MOIRA_LIST_NAME, l.IS_PUBLIC, l.IS_HIDDEN ), min_max AS (     SELECT          MIN(member_count) AS min_count,         MAX(member_count) AS max_count     FROM list_member_counts ), eligible_lists AS (     SELECT lmc.*     FROM list_member_counts lmc     CROSS JOIN min_max mm     WHERE lmc.member_count = mm.min_count OR lmc.member_count = mm.max_count ), list_owners AS (     SELECT DISTINCT          d.MOIRA_LIST_KEY,         o.OWNER     FROM MOIRA_LIST_DETAIL d     JOIN MOIRA_LIST_OWNER o ON d.MOIRA_LIST_OWNER_KEY = o.MOIRA_LIST_OWNER_KEY ) SELECT      e.MOIRA_LIST_NAME AS name,     lo.OWNER AS owner,     e.IS_PUBLIC AS public_status,     e.IS_HIDDEN AS hidden_status,     e.member_count AS number_of_members FROM eligible_lists e JOIN list_owners lo ON e.MOIRA_LIST_KEY = lo.MOIRA_LIST_KEY ORDER BY e.member_count DESC, e.MOIRA_LIST_NAME, lo.OWNER;\t----- bird -----\tdw",
    "50": "WITH faculty_ids AS (     SELECT DISTINCT c.RESPONSIBLE_FACULTY_MIT_ID AS faculty_mit_id     FROM COURSE_CATALOG_SUBJECT_OFFERED c     INNER JOIN ACADEMIC_TERMS a ON c.TERM_CODE = a.TERM_CODE     WHERE LOWER(a.TERM_DESCRIPTION) LIKE '%summer%'       AND CAST(a.FINANCIAL_AID_YEAR AS UNSIGNED) > 2001       AND c.RESPONSIBLE_FACULTY_MIT_ID IS NOT NULL ) SELECT      l.MOIRA_LIST_NAME,     COUNT(DISTINCT d.MOIRA_LIST_MEMBER) AS total_people,     COUNT(DISTINCT CASE WHEN f.faculty_mit_id IS NOT NULL THEN d.MOIRA_LIST_MEMBER_MIT_ID END) AS faculty_count FROM MOIRA_LIST l INNER JOIN MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY LEFT JOIN faculty_ids f ON d.MOIRA_LIST_MEMBER_MIT_ID = f.faculty_mit_id WHERE LOWER(l.MOIRA_LIST_NAME) LIKE 'c%' GROUP BY l.MOIRA_LIST_KEY, l.MOIRA_LIST_NAME HAVING faculty_count > 0;\t----- bird -----\tdw",
    "51": "SELECT      COUNT(DISTINCT msd.EMAIL_ADDRESS) AS student_count,     COUNT(DISTINCT sd.DEPARTMENT_CODE) AS department_count,     COUNT(DISTINCT sd.SCHOOL_CODE) AS school_count FROM MOIRA_LIST ml INNER JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY INNER JOIN MIT_STUDENT_DIRECTORY msd ON mld.MOIRA_LIST_MEMBER_FULL_NAME = msd.FULL_NAME INNER JOIN SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE WHERE ml.MOIRA_LIST_NAME = 'cat-duo-users';\t----- bird -----\tdw",
    "52": "WITH list_10 AS (   SELECT MOIRA_LIST_KEY   FROM MOIRA_LIST_DETAIL   GROUP BY MOIRA_LIST_KEY   HAVING COUNT(DISTINCT MOIRA_LIST_MEMBER) = 10 ) SELECT   ml.MOIRA_LIST_NAME AS mailing_list_name,   COUNT(DISTINCT e.MIT_ID) AS number_of_faculty,   COUNT(DISTINCT c.SUBJECT_ID) AS number_of_courses FROM list_10 l10 JOIN MOIRA_LIST ml ON l10.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY JOIN MOIRA_LIST_DETAIL mld ON l10.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN EMPLOYEE_DIRECTORY e ON mld.MOIRA_LIST_MEMBER = e.KRB_NAME JOIN COURSE_CATALOG_SUBJECT_OFFERED c ON e.MIT_ID = c.RESPONSIBLE_FACULTY_MIT_ID AND c.TERM_CODE = '2023FA' WHERE ml.IS_MOIRA_MAILING_LIST = 'Y' GROUP BY ml.MOIRA_LIST_KEY, ml.MOIRA_LIST_NAME ORDER BY ml.MOIRA_LIST_NAME;\t----- bird -----\tdw",
    "53": "WITH base_instructors AS (     SELECT DISTINCT sp.MIT_ID, sp.FULL_NAME AS instructor_name     FROM MOIRA_LIST ml     JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY     JOIN SE_PERSON sp ON mld.MOIRA_LIST_MEMBER_MIT_ID = sp.MIT_ID     JOIN LIBRARY_COURSE_INSTRUCTOR lci ON sp.FULL_NAME = lci.INSTRUCTOR_NAME     WHERE ml.MOIRA_LIST_NAME = 'keeper-zephyr'       AND ml.IS_MOIRA_MAILING_LIST = 'Y' ), mailing_lists AS (     SELECT DISTINCT mld.MOIRA_LIST_MEMBER_MIT_ID AS MIT_ID, ml.MOIRA_LIST_NAME     FROM MOIRA_LIST_DETAIL mld     JOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY     WHERE mld.MOIRA_LIST_MEMBER_MIT_ID IN (SELECT MIT_ID FROM base_instructors)       AND ml.IS_MOIRA_MAILING_LIST = 'Y' ), pub_years AS (     SELECT sp.MIT_ID,            MIN(CAST(lrc.CATALOG_YEAR AS UNSIGNED)) AS earliest_year,            MAX(CAST(lrc.CATALOG_YEAR AS UNSIGNED)) AS latest_year     FROM SE_PERSON sp     JOIN LIBRARY_COURSE_INSTRUCTOR lci ON sp.FULL_NAME = lci.INSTRUCTOR_NAME     JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY     JOIN LIBRARY_RESERVE_CATALOG lrc ON lrmd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY     WHERE sp.MIT_ID IN (SELECT MIT_ID FROM base_instructors)       AND lrc.CATALOG_YEAR REGEXP '^[0-9]+$'       AND lrc.CATALOG_YEAR != '0'     GROUP BY sp.MIT_ID ), enrollment AS (     SELECT instructor_mit_id AS MIT_ID, SUM(NUM_ENROLLED_STUDENTS) AS total_students     FROM (         SELECT DISTINCT sp.MIT_ID AS instructor_mit_id, lso.LIBRARY_SUBJECT_OFFERED_KEY, lso.NUM_ENROLLED_STUDENTS         FROM SE_PERSON sp         JOIN LIBRARY_COURSE_INSTRUCTOR lci ON sp.FULL_NAME = lci.INSTRUCTOR_NAME         JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY         JOIN LIBRARY_SUBJECT_OFFERED lso ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY         WHERE sp.MIT_ID IN (SELECT MIT_ID FROM base_instructors)     ) sub     GROUP BY MIT_ID ) SELECT      ml.MOIRA_LIST_NAME AS mailing_list_name,     bi.instructor_name,     py.earliest_year,     py.latest_year,     e.total_students FROM base_instructors bi JOIN mailing_lists ml ON bi.MIT_ID = ml.MIT_ID LEFT JOIN pub_years py ON bi.MIT_ID = py.MIT_ID LEFT JOIN enrollment e ON bi.MIT_ID = e.MIT_ID ORDER BY bi.instructor_name, ml.MOIRA_LIST_NAME;\t----- bird -----\tdw",
    "54": "SELECT     L.MOIRA_LIST_NAME AS name,     L.MOIRA_LIST_DESCRIPTION AS description,     MAX(O.OWNER) AS owner,     COUNT(DISTINCT D.MOIRA_LIST_MEMBER) AS total_people,     COUNT(DISTINCT CASE         WHEN LOWER(P.PAYROLL_RANK) LIKE '%professor%'         AND LOWER(P.PAYROLL_RANK) NOT LIKE '%assistant%'         THEN D.MOIRA_LIST_MEMBER     END) AS tenured_faculty_count FROM MOIRA_LIST L INNER JOIN MOIRA_LIST_DETAIL D ON L.MOIRA_LIST_KEY = D.MOIRA_LIST_KEY INNER JOIN MOIRA_LIST_OWNER O ON D.MOIRA_LIST_OWNER_KEY = O.MOIRA_LIST_OWNER_KEY LEFT JOIN SE_PERSON P ON D.MOIRA_LIST_MEMBER = P.KRB_NAME WHERE L.IS_MOIRA_MAILING_LIST = 'Y'   AND LOWER(L.MOIRA_LIST_NAME) LIKE 'r%'   AND EXISTS (       SELECT 1       FROM MOIRA_LIST_DETAIL D2       INNER JOIN SE_PERSON P2 ON D2.MOIRA_LIST_MEMBER = P2.KRB_NAME       WHERE P2.FULL_NAME = 'Hopkins, Ayden'         AND D2.MOIRA_LIST_KEY = L.MOIRA_LIST_KEY   ) GROUP BY L.MOIRA_LIST_KEY, L.MOIRA_LIST_NAME, L.MOIRA_LIST_DESCRIPTION;\t----- bird -----\tdw",
    "55": "WITH dept_counts AS (   SELECT l.MOIRA_LIST_NAME AS list_name,          dept.SIS_ADMIN_DEPARTMENT_NAME AS dept_name,          COUNT(DISTINCT p.MIT_ID) AS dept_count   FROM MOIRA_LIST l   INNER JOIN MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY   INNER JOIN SE_PERSON p ON d.MOIRA_LIST_MEMBER = p.KRB_NAME   INNER JOIN MIT_STUDENT_DIRECTORY s ON p.FULL_NAME = s.FULL_NAME   LEFT JOIN SIS_ADMIN_DEPARTMENT dept ON s.DEPARTMENT = dept.SIS_ADMIN_DEPARTMENT_CODE   WHERE l.MOIRA_LIST_NAME = 'date-destiny'   GROUP BY l.MOIRA_LIST_NAME, dept.SIS_ADMIN_DEPARTMENT_NAME ) SELECT list_name AS `name of the list`,        dept_name AS `department name`,        dept_count AS `number of students from the Management department`,        ROUND(dept_count * 100.0 / SUM(dept_count) OVER (PARTITION BY list_name), 2) AS `percentage` FROM dept_counts WHERE dept_name = 'Management';\t----- bird -----\tdw",
    "56": "WITH max_building AS (     SELECT BUILDING_KEY     FROM FAC_FLOOR     GROUP BY BUILDING_KEY     HAVING COUNT(DISTINCT LEVEL_ID) = (         SELECT MAX(cnt)         FROM (             SELECT COUNT(DISTINCT LEVEL_ID) AS cnt             FROM FAC_FLOOR             GROUP BY BUILDING_KEY         ) t     ) ) SELECT DISTINCT b.BUILDING_NAME, ml.MOIRA_LIST_NAME FROM max_building mb JOIN FAC_BUILDING b ON b.FAC_BUILDING_KEY = mb.BUILDING_KEY JOIN FAC_ROOMS r ON r.BUILDING_KEY = b.FAC_BUILDING_KEY JOIN EMPLOYEE_DIRECTORY e ON e.OFFICE_LOCATION = r.FAC_ROOM_KEY JOIN MOIRA_LIST_DETAIL mld ON mld.MOIRA_LIST_MEMBER = e.KRB_NAME JOIN MOIRA_LIST ml ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY WHERE LOWER(e.KRB_NAME) LIKE 'c%'   AND LOWER(ml.MOIRA_LIST_NAME) LIKE 'a%'   AND ml.IS_MOIRA_MAILING_LIST = 'Y';\t----- bird -----\tdw",
    "57": "SELECT      ml.MOIRA_LIST_NAME AS list_name,     COUNT(DISTINCT c.SUBJECT_ID) AS total_subjects,     COUNT(DISTINCT e.MIT_ID) AS num_faculty FROM EMPLOYEE_DIRECTORY e JOIN MOIRA_LIST_DETAIL mld ON e.MIT_ID = mld.MOIRA_LIST_MEMBER_MIT_ID JOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY LEFT JOIN COURSE_CATALOG_SUBJECT_OFFERED c ON e.MIT_ID = c.RESPONSIBLE_FACULTY_MIT_ID WHERE e.LAST_NAME LIKE 'Y%'   AND ml.IS_MOIRA_MAILING_LIST = 'Y' GROUP BY ml.MOIRA_LIST_KEY, ml.MOIRA_LIST_NAME ORDER BY ml.MOIRA_LIST_NAME;\t----- bird -----\tdw",
    "58": "SELECT DISTINCT     s.FULL_NAME AS student_name,     a.DEPARTMENT_PHONE_NUMBER AS department_phone,     (SELECT COUNT(DISTINCT d2.MOIRA_LIST_MEMBER)      FROM MOIRA_LIST_DETAIL d2      WHERE d2.MOIRA_LIST_KEY = l.MOIRA_LIST_KEY) AS mailing_list_size FROM MIT_STUDENT_DIRECTORY s JOIN SE_PERSON p ON s.FULL_NAME = p.FULL_NAME JOIN MOIRA_LIST_DETAIL d ON p.KRB_NAME = d.MOIRA_LIST_MEMBER JOIN MOIRA_LIST l ON d.MOIRA_LIST_KEY = l.MOIRA_LIST_KEY JOIN SIS_DEPARTMENT dept ON s.DEPARTMENT = dept.DEPARTMENT_CODE JOIN SIS_ADMIN_DEPARTMENT a ON dept.DEPARTMENT_CODE = a.SIS_ADMIN_DEPARTMENT_CODE WHERE s.LAST_NAME LIKE 'H%'   AND l.MOIRA_LIST_NAME = 'beacon-date-date';\t----- bird -----\tdw",
    "59": "WITH list_member_counts AS (     SELECT ml.MOIRA_LIST_KEY,            ml.MOIRA_LIST_NAME,            COUNT(DISTINCT p.MIT_ID) AS member_count     FROM MOIRA_LIST ml     JOIN MOIRA_LIST_DETAIL d ON ml.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY     JOIN SE_PERSON p ON d.MOIRA_LIST_MEMBER = p.KRB_NAME     WHERE ml.MOIRA_LIST_NAME LIKE 'B%'       AND ml.IS_MOIRA_MAILING_LIST = 'Y'       AND p.ORGANIZATION = 'Electrical Engineering and Computer Science'     GROUP BY ml.MOIRA_LIST_KEY, ml.MOIRA_LIST_NAME ) SELECT     (SELECT COUNT(*) FROM list_member_counts) AS total_lists,     (SELECT MOIRA_LIST_NAME FROM list_member_counts ORDER BY member_count DESC, MOIRA_LIST_NAME LIMIT 1) AS top_list_name,     (SELECT member_count FROM list_member_counts ORDER BY member_count DESC, MOIRA_LIST_NAME LIMIT 1) AS top_member_count;\t----- bird -----\tdw",
    "60": "SELECT      d.SIS_ADMIN_DEPARTMENT_NAME AS department_name,     COUNT(DISTINCT p.MIT_ID) AS student_count,     ROUND(COUNT(DISTINCT p.MIT_ID) * 100.0 / total.total_students, 2) AS percentage FROM MOIRA_LIST l JOIN MOIRA_LIST_DETAIL ld ON l.MOIRA_LIST_KEY = ld.MOIRA_LIST_KEY JOIN SE_PERSON p ON ld.MOIRA_LIST_MEMBER = p.KRB_NAME JOIN MIT_STUDENT_DIRECTORY msd ON p.FULL_NAME = msd.FULL_NAME JOIN SIS_ADMIN_DEPARTMENT d ON msd.DEPARTMENT = d.SIS_ADMIN_DEPARTMENT_CODE CROSS JOIN (     SELECT COUNT(DISTINCT p_inner.MIT_ID) AS total_students     FROM MOIRA_LIST l_inner     JOIN MOIRA_LIST_DETAIL ld_inner ON l_inner.MOIRA_LIST_KEY = ld_inner.MOIRA_LIST_KEY     JOIN SE_PERSON p_inner ON ld_inner.MOIRA_LIST_MEMBER = p_inner.KRB_NAME     JOIN MIT_STUDENT_DIRECTORY msd_inner ON p_inner.FULL_NAME = msd_inner.FULL_NAME     WHERE l_inner.MOIRA_LIST_NAME = 'kangaroo-inspire-yearn' ) total WHERE l.MOIRA_LIST_NAME = 'kangaroo-inspire-yearn' GROUP BY d.SIS_ADMIN_DEPARTMENT_NAME, total.total_students ORDER BY student_count DESC, department_name;\t----- bird -----\tdw",
    "61": "SELECT ml.MOIRA_LIST_NAME AS mailing_list_name,        COUNT(DISTINCT ed.MIT_ID) AS total_subscribers FROM MOIRA_LIST_DETAIL mld JOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY JOIN EMPLOYEE_DIRECTORY ed ON mld.MOIRA_LIST_MEMBER = ed.KRB_NAME WHERE ml.IS_MOIRA_MAILING_LIST = 'Y'   AND SUBSTRING_INDEX(ed.OFFICE_LOCATION, '-', 1) = '24' GROUP BY ml.MOIRA_LIST_KEY, ml.MOIRA_LIST_NAME ORDER BY total_subscribers DESC LIMIT 1;\t----- bird -----\tdw",
    "62": "SELECT      l.MOIRA_LIST_NAME AS list_name,     COUNT(DISTINCT CASE WHEN p.EMPLOYEE_TYPE = 'Support Staff' THEN p.MIT_ID END) AS support_staff_count,     COUNT(DISTINCT CASE WHEN p.EMPLOYEE_TYPE = 'Faculty' THEN p.MIT_ID END) AS faculty_count,     l.IS_ACTIVE AS active_status FROM MOIRA_LIST l JOIN MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY JOIN SE_PERSON p ON d.MOIRA_LIST_MEMBER_MIT_ID = p.MIT_ID WHERE p.EMPLOYEE_TYPE IN ('Support Staff', 'Faculty') GROUP BY l.MOIRA_LIST_KEY, l.MOIRA_LIST_NAME, l.IS_ACTIVE;\t----- bird -----\tdw",
    "63": "WITH department_counts AS (     SELECT         d.SIS_ADMIN_DEPARTMENT_NAME AS department_name,         d.DEPARTMENT_PHONE_NUMBER AS phone_number,         COUNT(DISTINCT p.MIT_ID) AS student_count     FROM         MOIRA_LIST l         JOIN MOIRA_LIST_DETAIL ld ON l.MOIRA_LIST_KEY = ld.MOIRA_LIST_KEY         JOIN SE_PERSON p ON ld.MOIRA_LIST_MEMBER = p.KRB_NAME         JOIN MIT_STUDENT_DIRECTORY s ON p.FULL_NAME = s.FULL_NAME         JOIN SIS_ADMIN_DEPARTMENT d ON s.DEPARTMENT = d.SIS_ADMIN_DEPARTMENT_CODE     WHERE         l.MOIRA_LIST_NAME = 'ocean-apple'         AND l.IS_MOIRA_MAILING_LIST = 'Y'     GROUP BY         d.SIS_ADMIN_DEPARTMENT_NAME,         d.DEPARTMENT_PHONE_NUMBER ) SELECT     department_name,     phone_number,     student_count FROM     department_counts WHERE     student_count = (SELECT MAX(student_count) FROM department_counts);\t----- bird -----\tdw",
    "64": "(SELECT      mo.OWNER AS owner,     mo.OWNER_TYPE AS owner_type,     CASE WHEN ml.IS_PUBLIC = 'Y' THEN 'Public Members' ELSE 'Hidden Members' END AS visibility,     COUNT(*) AS member_count  FROM MOIRA_LIST ml  INNER JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY  INNER JOIN MOIRA_LIST_OWNER mo ON mld.MOIRA_LIST_OWNER_KEY = mo.MOIRA_LIST_OWNER_KEY  WHERE ml.IS_MOIRA_MAILING_LIST = 'Y'  GROUP BY ml.MOIRA_LIST_KEY, mo.OWNER, mo.OWNER_TYPE, ml.IS_PUBLIC) UNION ALL (SELECT      mo.OWNER AS owner,     mo.OWNER_TYPE AS owner_type,     NULL AS visibility,     COUNT(*) AS member_count  FROM MOIRA_LIST ml  INNER JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY  INNER JOIN MOIRA_LIST_OWNER mo ON mld.MOIRA_LIST_OWNER_KEY = mo.MOIRA_LIST_OWNER_KEY  WHERE ml.IS_MOIRA_MAILING_LIST = 'Y'  GROUP BY mo.OWNER, mo.OWNER_TYPE) ORDER BY owner, owner_type, visibility IS NULL, visibility;\t----- bird -----\tdw",
    "65": "WITH subject_agg AS (     SELECT          s.CLUSTER_TYPE,         scd.COURSE_LEVEL,         GROUP_CONCAT(DISTINCT s.OFFER_DEPT_NAME) AS department_names,         GROUP_CONCAT(DISTINCT s.SUBJECT_TITLE) AS course_titles,         SUM(s.NUM_ENROLLED_STUDENTS) AS total_enrollments,         AVG(s.CLUSTER_ENROLLMENT_NUMBER) AS avg_cluster_enrollment     FROM SUBJECT_OFFERED_SUMMARY s     JOIN SIS_COURSE_DESCRIPTION scd ON s.COURSE_NUMBER = scd.COURSE     WHERE LOWER(s.OFFER_DEPT_NAME) LIKE '%biology%'     GROUP BY s.CLUSTER_TYPE, scd.COURSE_LEVEL ), tip_agg AS (     SELECT          s.CLUSTER_TYPE,         scd.COURSE_LEVEL,         COUNT(DISTINCT tm.TIP_MATERIAL_KEY) AS unique_materials,         AVG(tm.NEW_SHELF_PRICE) AS avg_new_price,         AVG(tm.USED_SHELF_PRICE) AS avg_used_price,         SUM(td.RECORD_COUNT) AS total_record_count     FROM TIP_DETAIL td     JOIN SUBJECT_OFFERED_SUMMARY s ON td.TIP_SUBJECT_OFFERED_KEY = s.SUBJECT_OFFERED_SUMMARY_KEY     JOIN SIS_COURSE_DESCRIPTION scd ON s.COURSE_NUMBER = scd.COURSE     LEFT JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY     WHERE LOWER(s.OFFER_DEPT_NAME) LIKE '%biology%'     GROUP BY s.CLUSTER_TYPE, scd.COURSE_LEVEL ), library_agg AS (     SELECT          s.CLUSTER_TYPE,         scd.COURSE_LEVEL,         COUNT(DISTINCT lrc.CATALOG_TITLE) AS unique_library_titles,         COUNT(DISTINCT lrc.CATALOG_ISBN) AS unique_library_isbns     FROM TIP_DETAIL td     JOIN SUBJECT_OFFERED_SUMMARY s ON td.TIP_SUBJECT_OFFERED_KEY = s.SUBJECT_OFFERED_SUMMARY_KEY     JOIN SIS_COURSE_DESCRIPTION scd ON s.COURSE_NUMBER = scd.COURSE     LEFT JOIN LIBRARY_RESERVE_CATALOG lrc ON td.ISBN = lrc.CATALOG_ISBN     WHERE LOWER(s.OFFER_DEPT_NAME) LIKE '%biology%'     GROUP BY s.CLUSTER_TYPE, scd.COURSE_LEVEL ) SELECT      sa.CLUSTER_TYPE,     sa.COURSE_LEVEL,     sa.department_names,     sa.course_titles,     sa.total_enrollments,     sa.avg_cluster_enrollment,     COALESCE(ta.unique_materials, 0) AS unique_course_materials,     COALESCE(ta.avg_new_price, 0) AS avg_new_price,     COALESCE(ta.avg_used_price, 0) AS avg_used_price,     COALESCE(ta.total_record_count, 0) AS total_material_record_count,     COALESCE(la.unique_library_titles, 0) AS unique_library_titles,     COALESCE(la.unique_library_isbns, 0) AS unique_library_isbns FROM subject_agg sa LEFT JOIN tip_agg ta ON sa.CLUSTER_TYPE = ta.CLUSTER_TYPE AND sa.COURSE_LEVEL = ta.COURSE_LEVEL LEFT JOIN library_agg la ON sa.CLUSTER_TYPE = la.CLUSTER_TYPE AND sa.COURSE_LEVEL = la.COURSE_LEVEL ORDER BY sa.CLUSTER_TYPE, sa.COURSE_LEVEL;\t----- bird -----\tdw",
    "66": "SELECT     c.DEPARTMENT_NAME AS department_name,     d.SCHOOL_NAME AS school_name,     c.SUBJECT_ID AS subject_id,     c.SUBJECT_TITLE AS subject_title,     sc.COURSE_LEVEL AS course_level,     c.TOTAL_UNITS AS total_units,     CASE         WHEN c.TERM_CODE LIKE '%FA' THEN 'Fall'         WHEN c.TERM_CODE LIKE '%SP' THEN 'Spring'     END AS term_offered,     a.TERM_DESCRIPTION AS term_description,     CASE         WHEN c.FALL_INSTRUCTORS IS NULL OR c.FALL_INSTRUCTORS = '' THEN 0         ELSE (LENGTH(c.FALL_INSTRUCTORS) - LENGTH(REPLACE(c.FALL_INSTRUCTORS, ',', '')) + 1)     END AS fall_instructor_count,     CASE         WHEN c.SPRING_INSTRUCTORS IS NULL OR c.SPRING_INSTRUCTORS = '' THEN 0         ELSE (LENGTH(c.SPRING_INSTRUCTORS) - LENGTH(REPLACE(c.SPRING_INSTRUCTORS, ',', '')) + 1)     END AS spring_instructor_count FROM     COURSE_CATALOG_SUBJECT_OFFERED c     INNER JOIN ACADEMIC_TERMS a ON c.TERM_CODE = a.TERM_CODE     INNER JOIN SIS_DEPARTMENT d ON c.DEPARTMENT_CODE = d.DEPARTMENT_CODE     INNER JOIN SIS_COURSE_DESCRIPTION sc ON c.SUBJECT_CODE = sc.COURSE WHERE     c.IS_OFFERED_THIS_YEAR = 'Y'     AND (c.TERM_CODE LIKE '%FA' OR c.TERM_CODE LIKE '%SP')     AND c.IS_MASTER_SECTION = 'Y' ORDER BY     c.DEPARTMENT_NAME, c.SUBJECT_ID, term_offered;\t----- bird -----\tdw",
    "67": "SELECT     c.HASS_ATTRIBUTE AS attribute_name,     c.HASS_ATTRIBUTE_DESC AS attribute_description,     COUNT(DISTINCT c.SUBJECT_ID) AS unique_subjects,     AVG(CAST(c.TOTAL_UNITS AS DECIMAL(5,2))) AS average_units,     COALESCE(SUM(s.NUM_ENROLLED_STUDENTS), 0) AS total_enrollment,     COUNT(DISTINCT CASE WHEN d.IS_DEGREE_GRANTING = 'Y' THEN d.DEPARTMENT_CODE END) AS degree_granting_depts,     MAX(sc.SUBJECT_CODE_DESC) AS subject_code_description FROM     CIS_COURSE_CATALOG c JOIN     SIS_SUBJECT_CODE sc ON c.SUBJECT_CODE = sc.SUBJECT_CODE JOIN     SIS_DEPARTMENT d ON sc.DEPARTMENT_CODE = d.DEPARTMENT_CODE LEFT JOIN     SUBJECT_OFFERED_SUMMARY s ON c.SUBJECT_ID = s.SUBJECT_ID WHERE     d.DEPARTMENT_NAME = 'Political Science'     AND c.HASS_ATTRIBUTE IS NOT NULL GROUP BY     c.HASS_ATTRIBUTE,     c.HASS_ATTRIBUTE_DESC;\t----- bird -----\tdw",
    "68": "SELECT      s.CLUSTER_TYPE,     s.OFFER_DEPT_NAME AS department_name,     d.SCHOOL_NAME AS school_name,     d.IS_DEGREE_GRANTING,     COUNT(DISTINCT s.SUBJECT_ID) AS total_subjects,     SUM(COALESCE(s.NUM_ENROLLED_STUDENTS, 0)) AS total_enrollment,     AVG(COALESCE(s.NUM_ENROLLED_STUDENTS, 0)) AS average_enrollment FROM SUBJECT_OFFERED_SUMMARY s INNER JOIN SIS_DEPARTMENT d ON s.OFFER_DEPT_CODE = d.DEPARTMENT_CODE GROUP BY s.CLUSTER_TYPE, s.OFFER_DEPT_NAME, d.SCHOOL_NAME, d.IS_DEGREE_GRANTING HAVING total_enrollment > 0;\t----- bird -----\tdw",
    "69": "SELECT      b.BUILDING_NAME AS building_name,     CASE          WHEN c.COURSE_LEVEL = 'G' THEN 'Graduate'         WHEN c.COURSE_LEVEL = 'U' THEN 'Undergraduate'         ELSE 'Other'     END AS course_level,     COUNT(DISTINCT s.SUBJECT_ID) AS total_unique_courses,     COUNT(DISTINCT s.RESPONSIBLE_FACULTY_NAME) AS total_instructors FROM FAC_BUILDING b JOIN SUBJECT_OFFERED s ON b.FAC_BUILDING_KEY = s.MEET_PLACE JOIN SIS_COURSE_DESCRIPTION c ON s.COURSE_NUMBER = c.COURSE WHERE b.SITE = 'MIT' GROUP BY b.BUILDING_NAME, c.COURSE_LEVEL UNION ALL SELECT      'All Buildings' AS building_name,     'All Levels' AS course_level,     COUNT(DISTINCT s.SUBJECT_ID) AS total_unique_courses,     COUNT(DISTINCT s.RESPONSIBLE_FACULTY_NAME) AS total_instructors FROM FAC_BUILDING b JOIN SUBJECT_OFFERED s ON b.FAC_BUILDING_KEY = s.MEET_PLACE JOIN SIS_COURSE_DESCRIPTION c ON s.COURSE_NUMBER = c.COURSE WHERE b.SITE = 'MIT' ORDER BY      (building_name = 'All Buildings'),     building_name,     course_level;\t----- bird -----\tdw",
    "70": "SELECT     C.MEET_PLACE AS room_number,     B.BUILDING_NAME,     B.BUILDING_NUMBER,     A.CITY AS building_city,     A.STATE AS building_state,     R.AREA,     R.ORGANIZATION_NAME,     U.MAJOR_USE AS room_usage,     C.TERM_CODE,     S.COURSE_LEVEL,     agg.total_subjects,     agg.unique_meeting_times,     agg.total_units FROM COURSE_CATALOG_SUBJECT_OFFERED C INNER JOIN FAC_ROOMS R ON C.MEET_PLACE = R.FAC_ROOM_KEY INNER JOIN FAC_BUILDING B ON R.BUILDING_KEY = B.FAC_BUILDING_KEY INNER JOIN FAC_MAJOR_USE U ON R.MAJOR_USE_KEY = U.MAJOR_USE_KEY INNER JOIN FAC_BUILDING_ADDRESS A ON B.FAC_BUILDING_KEY = A.BUILDING_KEY INNER JOIN SIS_COURSE_DESCRIPTION S ON C.SUBJECT_CODE = S.COURSE INNER JOIN (     SELECT         S.COURSE AS course_key,         C.TERM_CODE AS term_code,         COUNT(DISTINCT C.SUBJECT_ID) AS total_subjects,         COUNT(DISTINCT C.MEET_TIME) AS unique_meeting_times,         SUM(C.TOTAL_UNITS) AS total_units     FROM COURSE_CATALOG_SUBJECT_OFFERED C     INNER JOIN SIS_COURSE_DESCRIPTION S ON C.SUBJECT_CODE = S.COURSE     WHERE C.MEET_PLACE IS NOT NULL       AND C.MEET_TIME IS NOT NULL     GROUP BY S.COURSE, C.TERM_CODE ) agg ON S.COURSE = agg.course_key AND C.TERM_CODE = agg.term_code WHERE C.MEET_PLACE IS NOT NULL   AND C.MEET_TIME IS NOT NULL   AND A.ADDRESS_PURPOSE = 'STREET';\t----- bird -----\tdw",
    "71": "WITH base AS (     SELECT         sts.LIBRARY_MATERIAL_STATUS AS material_status,         sis.DEPARTMENT_NAME AS department_name,         cat.LIBRARY_RESERVE_CATALOG_KEY AS catalog_key,         subj.LIBRARY_SUBJECT_OFFERED_KEY AS subject_key,         subj.NUM_ENROLLED_STUDENTS AS enrolled_students     FROM LIBRARY_RESERVE_CATALOG cat     JOIN LIBRARY_RESERVE_MATRL_DETAIL det ON cat.LIBRARY_RESERVE_CATALOG_KEY = det.LIBRARY_RESERVE_CATALOG_KEY     JOIN LIBRARY_MATERIAL_STATUS sts ON det.LIBRARY_MATERIAL_STATUS_KEY = sts.LIBRARY_MATERIAL_STATUS_KEY     JOIN LIBRARY_SUBJECT_OFFERED subj ON det.LIBRARY_SUBJECT_OFFERED_KEY = subj.LIBRARY_SUBJECT_OFFERED_KEY     JOIN SIS_SUBJECT_CODE sis ON subj.COURSE_NUMBER = sis.COURSE_NUMBER     WHERE CAST(cat.CATALOG_YEAR AS UNSIGNED) >= 2000 ), catalog_agg AS (     SELECT material_status, department_name, COUNT(DISTINCT catalog_key) AS catalog_items     FROM base     GROUP BY material_status, department_name ), students_agg AS (     SELECT material_status, department_name, SUM(enrolled_students) AS total_students     FROM (         SELECT DISTINCT material_status, department_name, subject_key, enrolled_students         FROM base     ) AS distinct_subjects     GROUP BY material_status, department_name ), summary AS (     SELECT          ca.material_status,         ca.department_name,         ca.catalog_items,         sa.total_students     FROM catalog_agg ca     INNER JOIN students_agg sa ON ca.material_status = sa.material_status AND ca.department_name = sa.department_name ) SELECT     CASE WHEN GROUPING(material_status)=1 AND GROUPING(department_name)=1 THEN 'Grand Total' ELSE material_status END AS material_status,     department_name,     SUM(catalog_items) AS number_of_catalog_items,     SUM(total_students) AS total_enrolled_students FROM summary GROUP BY material_status, department_name WITH ROLLUP;\t----- bird -----\tdw",
    "72": "WITH   dept_course_offerings AS (     SELECT       lci.DEPARTMENT,       lso.LIBRARY_SUBJECT_OFFERED_KEY,       MAX(lso.NUM_ENROLLED_STUDENTS) AS enrollment     FROM       LIBRARY_COURSE_INSTRUCTOR lci       JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY       JOIN LIBRARY_SUBJECT_OFFERED lso ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY     GROUP BY       lci.DEPARTMENT,       lso.LIBRARY_SUBJECT_OFFERED_KEY   ),   dept_courses_agg AS (     SELECT       DEPARTMENT,       COUNT(*) AS total_courses,       SUM(enrollment) AS total_enrollment     FROM       dept_course_offerings     GROUP BY       DEPARTMENT   ),   dept_catalog_items AS (     SELECT       lci.DEPARTMENT,       COUNT(DISTINCT lrmd.LIBRARY_RESERVE_CATALOG_KEY) AS total_catalog_items     FROM       LIBRARY_COURSE_INSTRUCTOR lci       JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY     GROUP BY       lci.DEPARTMENT   ),   dept_results AS (     SELECT       dca.DEPARTMENT,       dca.total_courses,       dci.total_catalog_items,       dca.total_enrollment     FROM       dept_courses_agg dca       JOIN dept_catalog_items dci ON dca.DEPARTMENT = dci.DEPARTMENT   ) SELECT   DEPARTMENT,   total_courses,   total_catalog_items,   total_enrollment / total_courses AS avg_enrollment FROM   dept_results UNION ALL SELECT   'Grand Total',   SUM(total_courses),   SUM(total_catalog_items),   SUM(total_enrollment) / SUM(total_courses) FROM   dept_results ORDER BY   CASE WHEN DEPARTMENT = 'Grand Total' THEN 1 ELSE 0 END,   DEPARTMENT;\t----- bird -----\tdw",
    "73": "WITH base AS (     SELECT          tso.OFFER_DEPT_NAME AS dept_name,         sd.SCHOOL_NAME AS school_name,         tm.TIP_MATERIAL_KEY AS material_key,         tm.NEW_SHELF_PRICE,         tm.USED_SHELF_PRICE,         td.RECORD_COUNT,         tms.TIP_MATERIAL_STATUS AS material_status,         tso.SUBJECT_ID     FROM TIP_SUBJECT_OFFERED tso     JOIN TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY     JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY     JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY     JOIN SIS_DEPARTMENT sd ON sd.DEPARTMENT_CODE = tso.OFFER_DEPT_CODE     WHERE tso.IS_NO_COURSE_MATERIAL = 'N' ), detailed AS (     SELECT          dept_name,         school_name,         COUNT(DISTINCT material_key) AS num_unique_materials,         COUNT(DISTINCT SUBJECT_ID) AS num_courses,         AVG(CASE WHEN rn = 1 THEN NEW_SHELF_PRICE END) AS avg_new_price,         AVG(CASE WHEN rn = 1 THEN USED_SHELF_PRICE END) AS avg_used_price,         SUM(RECORD_COUNT) AS total_material_records,         COUNT(DISTINCT material_status) AS num_distinct_statuses     FROM (         SELECT *,             ROW_NUMBER() OVER (PARTITION BY dept_name, school_name, material_key ORDER BY (SELECT 0)) AS rn         FROM base     ) ranked     GROUP BY dept_name, school_name ), grand_total AS (     SELECT          NULL AS dept_name,         NULL AS school_name,         COUNT(DISTINCT material_key) AS num_unique_materials,         COUNT(DISTINCT SUBJECT_ID) AS num_courses,         AVG(CASE WHEN rn = 1 THEN NEW_SHELF_PRICE END) AS avg_new_price,         AVG(CASE WHEN rn = 1 THEN USED_SHELF_PRICE END) AS avg_used_price,         SUM(RECORD_COUNT) AS total_material_records,         COUNT(DISTINCT material_status) AS num_distinct_statuses     FROM (         SELECT *,             ROW_NUMBER() OVER (PARTITION BY material_key ORDER BY (SELECT 0)) AS rn         FROM base     ) ranked_global ) SELECT * FROM detailed UNION ALL SELECT * FROM grand_total ORDER BY school_name IS NULL, school_name, dept_name IS NULL, dept_name;\t----- bird -----\tdw",
    "74": "SELECT     CASE         WHEN GROUPING(s.TIP_MATERIAL_STATUS) = 1 THEN 'Grand Total'         WHEN s.TIP_MATERIAL_STATUS IS NULL THEN 'No material status'         ELSE s.TIP_MATERIAL_STATUS     END AS `Material Status`,     COUNT(DISTINCT d.TIP_MATERIAL_KEY) AS `Total Unique Materials`,     SUM(d.RECORD_COUNT) AS `Total Records`,     SUM(o.NUM_ENROLLED_STUDENTS) AS `Total Student Enrollment` FROM TIP_DETAIL d LEFT JOIN TIP_MATERIAL_STATUS s ON d.TIP_MATERIAL_STATUS_KEY = s.TIP_MATERIAL_STATUS_KEY INNER JOIN TIP_MATERIAL m ON d.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY INNER JOIN TIP_SUBJECT_OFFERED o ON d.TIP_SUBJECT_OFFERED_KEY = o.TIP_SUBJECT_OFFERED_KEY GROUP BY s.TIP_MATERIAL_STATUS WITH ROLLUP;\t----- bird -----\tdw",
    "75": "WITH base AS (     SELECT          b.FCLT_BUILDING_KEY AS building_key,         b.BUILDING_NAME_LONG AS building_name,         b.OWNERSHIP_TYPE,         f.FLOOR AS floor_number,         r.FCLT_ROOM_KEY AS room_key,         r.BUILDING_ROOM AS room_number,         o.ORGANIZATION_NAME AS org_name,         r.AREA     FROM FCLT_ROOMS r     JOIN FCLT_FLOOR f ON r.FCLT_FLOOR_KEY = f.FCLT_FLOOR_KEY     JOIN FCLT_BUILDING b ON f.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY     JOIN FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY ), building_totals AS (     SELECT         building_key,         SUM(AREA) AS building_total_area,         COUNT(room_key) AS building_room_count     FROM base     GROUP BY building_key ), overall_totals AS (     SELECT         SUM(AREA) AS overall_total_area,         COUNT(room_key) AS overall_room_count     FROM base ), room_details AS (     SELECT         building_name,         floor_number,         room_number,         OWNERSHIP_TYPE,         org_name AS organization_name,         1 AS num_rooms,         ROUND(AREA) AS area,         ROUND((AREA / bt.building_total_area) * 100, 2) AS percentage,         1 AS level,         building_key,         floor_number AS floor_sort,         room_number AS room_sort     FROM base     JOIN building_totals bt USING (building_key) ), floor_totals AS (     SELECT         MAX(building_name) AS building_name,         floor_number,         NULL AS room_number,         MAX(OWNERSHIP_TYPE) AS OWNERSHIP_TYPE,         NULL AS organization_name,         COUNT(room_key) AS num_rooms,         ROUND(SUM(AREA)) AS area,         ROUND((SUM(AREA) / MAX(bt.building_total_area)) * 100, 2) AS percentage,         2 AS level,         building_key,         floor_number AS floor_sort,         NULL AS room_sort     FROM base     JOIN building_totals bt USING (building_key)     GROUP BY building_key, floor_number ), building_totals_rows AS (     SELECT         MAX(building_name) AS building_name,         NULL AS floor_number,         NULL AS room_number,         MAX(OWNERSHIP_TYPE) AS OWNERSHIP_TYPE,         NULL AS organization_name,         COUNT(room_key) AS num_rooms,         ROUND(SUM(AREA)) AS area,         ROUND((SUM(AREA) / (SELECT overall_total_area FROM overall_totals)) * 100, 2) AS percentage,         3 AS level,         building_key,         NULL AS floor_sort,         NULL AS room_sort     FROM base     GROUP BY building_key ), grand_total AS (     SELECT         NULL AS building_name,         NULL AS floor_number,         NULL AS room_number,         NULL AS OWNERSHIP_TYPE,         NULL AS organization_name,         overall_room_count AS num_rooms,         ROUND(overall_total_area) AS area,         100.00 AS percentage,         4 AS level,         NULL AS building_key,         NULL AS floor_sort,         NULL AS room_sort     FROM overall_totals ), combined AS (     SELECT * FROM room_details     UNION ALL     SELECT * FROM floor_totals     UNION ALL     SELECT * FROM building_totals_rows     UNION ALL     SELECT * FROM grand_total ) SELECT     building_name,     floor_number,     room_number,     OWNERSHIP_TYPE,     organization_name,     num_rooms,     area,     percentage FROM combined ORDER BY     CASE WHEN building_key IS NULL THEN 1 ELSE 0 END,     building_key,     CASE WHEN floor_sort IS NULL THEN 1 ELSE 0 END,     floor_sort,     level,     room_sort;\t----- bird -----\tdw",
    "76": "SELECT      a.FINANCIAL_AID_YEAR,     a.ACADEMIC_YEAR,     COUNT(DISTINCT m.FISCAL_PERIOD) AS number_of_fiscal_periods,     COUNT(DISTINCT q.FY_QUARTER_CODE) AS number_of_quarters,     MIN(d.START_DATE) AS start_term_date,     MAX(d.END_DATE) AS end_term_date,     COUNT(DISTINCT p.TERM_PARAMETER) AS number_of_distinct_department_level_term_parameters FROM ACADEMIC_TERMS a JOIN TIME_DAY d ON a.TERM_START_DATE = d.CALENDAR_DATE JOIN TIME_MONTH m ON d.FISCAL_PERIOD = m.FISCAL_PERIOD JOIN TIME_QUARTER q ON m.FISCAL_YEAR = q.FISCAL_YEAR LEFT JOIN ACADEMIC_TERM_PARAMETER p ON a.TERM_CODE = p.TERM_CODE GROUP BY a.FINANCIAL_AID_YEAR, a.ACADEMIC_YEAR ORDER BY a.FINANCIAL_AID_YEAR, a.ACADEMIC_YEAR;\t----- bird -----\tdw",
    "77": "WITH  building_floors AS (     SELECT FCLT_BUILDING_KEY, COUNT(DISTINCT FLOOR) AS total_floors     FROM FCLT_FLOOR     GROUP BY FCLT_BUILDING_KEY ), building_rooms AS (     SELECT FCLT_BUILDING_KEY, COUNT(*) AS total_rooms     FROM FCLT_ROOMS     GROUP BY FCLT_BUILDING_KEY ), building_orgs AS (     SELECT r.FCLT_BUILDING_KEY, COUNT(DISTINCT r.FCLT_ORGANIZATION_KEY) AS total_organizations     FROM FCLT_ROOMS r     WHERE r.FCLT_ORGANIZATION_KEY IS NOT NULL     GROUP BY r.FCLT_BUILDING_KEY ), building_address AS (     SELECT          FCLT_BUILDING_KEY,         CITY,         STATE,         ROW_NUMBER() OVER (PARTITION BY FCLT_BUILDING_KEY ORDER BY              CASE WHEN ADDRESS_PURPOSE = 'STREET' THEN 1                   WHEN ADDRESS_PURPOSE = 'E911_1' THEN 2                   ELSE 3 END) AS rn     FROM FCLT_BUILDING_ADDRESS     WHERE CITY IS NOT NULL AND STATE IS NOT NULL ), building_data AS (     SELECT          b.CAMPUS_SECTOR,         b.BUILDING_NAME_LONG,         addr.CITY,         addr.STATE,         COALESCE(bf.total_floors, 0) AS total_floors,         b.ASSIGNABLE_AREA,         COALESCE(br.total_rooms, 0) AS total_rooms,         COALESCE(bo.total_organizations, 0) AS total_organizations,         b.OWNERSHIP_TYPE,         RANK() OVER (PARTITION BY b.CAMPUS_SECTOR ORDER BY b.ASSIGNABLE_AREA DESC) AS rnk     FROM FCLT_BUILDING b     LEFT JOIN building_floors bf ON b.FCLT_BUILDING_KEY = bf.FCLT_BUILDING_KEY     LEFT JOIN building_rooms br ON b.FCLT_BUILDING_KEY = br.FCLT_BUILDING_KEY     LEFT JOIN building_orgs bo ON b.FCLT_BUILDING_KEY = bo.FCLT_BUILDING_KEY     LEFT JOIN building_address addr ON b.FCLT_BUILDING_KEY = addr.FCLT_BUILDING_KEY AND addr.rn = 1 ) SELECT      CAMPUS_SECTOR,     BUILDING_NAME_LONG,     CITY,     STATE,     total_floors,     ASSIGNABLE_AREA,     total_rooms,     total_organizations,     OWNERSHIP_TYPE,     rnk FROM building_data UNION ALL SELECT      CAMPUS_SECTOR,     'Sector Total' AS BUILDING_NAME_LONG,     NULL AS CITY,     NULL AS STATE,     SUM(total_floors),     SUM(ASSIGNABLE_AREA),     NULL,     NULL,     NULL,     NULL FROM building_data GROUP BY CAMPUS_SECTOR UNION ALL SELECT      NULL,     'Grand Total',     NULL,     NULL,     SUM(total_floors),     SUM(ASSIGNABLE_AREA),     NULL,     NULL,     NULL,     NULL FROM building_data ORDER BY      (CAMPUS_SECTOR IS NULL),                     -- non-null sectors first     CAMPUS_SECTOR,                               -- then by sector name     CASE          WHEN BUILDING_NAME_LONG = 'Sector Total' THEN 2          WHEN BUILDING_NAME_LONG = 'Grand Total' THEN 3          ELSE 1                                   -- building rows     END,     rnk;                                         -- within building rows, by rank\t----- bird -----\tdw",
    "78": "WITH tip_base AS (     SELECT DISTINCT         tso.OFFER_DEPT_NAME AS dept_name,         tm.TITLE,         tm.AUTHOR,         tm.ISBN     FROM TIP_SUBJECT_OFFERED tso     JOIN TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY     JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY ), library_details AS (     SELECT         lso.OFFER_DEPT_NAME AS lib_dept,         lrc.CATALOG_ISBN AS lib_isbn,         lrm.TERM_CODE AS term_code,         lrm.LIBRARY_COURSE_INSTRUCTOR_KEY AS instructor_key     FROM LIBRARY_RESERVE_CATALOG lrc     JOIN LIBRARY_RESERVE_MATRL_DETAIL lrm ON lrc.LIBRARY_RESERVE_CATALOG_KEY = lrm.LIBRARY_RESERVE_CATALOG_KEY     JOIN LIBRARY_SUBJECT_OFFERED lso ON lrm.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY     WHERE lrc.CATALOG_ISBN IS NOT NULL ), lib_agg AS (     SELECT         lib_dept AS dept_name,         lib_isbn AS isbn,         MAX(term_code) AS lib_term_code,         COUNT(DISTINCT instructor_key) AS num_instructors     FROM library_details     GROUP BY lib_dept, lib_isbn ), dept_total AS (     SELECT         lib_dept AS dept_name,         COUNT(DISTINCT lib_isbn) AS dept_available_materials     FROM library_details     GROUP BY lib_dept ), overall_total AS (     SELECT COUNT(DISTINCT lib_isbn) AS overall_available_materials     FROM library_details ) SELECT     tb.dept_name,     tb.TITLE,     tb.AUTHOR,     tb.ISBN,     la.lib_term_code AS library_term_code,     CASE WHEN la.isbn IS NOT NULL THEN 'Available in Library' ELSE 'Not Available in Library' END AS availability,     COALESCE(la.num_instructors, 0) AS instructors_per_book,     COALESCE(dt.dept_available_materials, 0) AS dept_total_materials,     ot.overall_available_materials FROM tip_base tb LEFT JOIN lib_agg la ON tb.dept_name = la.dept_name AND tb.ISBN = la.isbn LEFT JOIN dept_total dt ON tb.dept_name = dt.dept_name CROSS JOIN overall_total ot ORDER BY tb.dept_name, tb.TITLE;\t----- bird -----\tdw",
    "79": "WITH combined AS (     SELECT          tso.OFFER_DEPT_NAME AS dept,         tms.TIP_MATERIAL_STATUS AS status,         1 AS tip_cnt,         0 AS lib_cnt     FROM TIP_DETAIL td     INNER JOIN TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY     INNER JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY     UNION ALL     SELECT         lso.OFFER_DEPT_NAME AS dept,         lms.LIBRARY_MATERIAL_STATUS AS status,         0 AS tip_cnt,         1 AS lib_cnt     FROM LIBRARY_RESERVE_MATRL_DETAIL lrd     INNER JOIN LIBRARY_SUBJECT_OFFERED lso ON lrd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY     INNER JOIN LIBRARY_MATERIAL_STATUS lms ON lrd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY ) SELECT     dept AS department_name,     status AS material_status,     SUM(tip_cnt) AS number_of_TIP_materials,     SUM(lib_cnt) AS number_of_library_materials,     SUM(tip_cnt + lib_cnt) AS total_materials FROM combined GROUP BY dept, status WITH ROLLUP;\t----- bird -----\tdw",
    "80": "SELECT building_number, full_name, street_address, building_type, occupancy_date, ownership_type, site_location FROM (     (SELECT 1 AS sort_order, 0 AS sub_sort,             fb.BUILDING_NUMBER AS building_number,             fb.BUILDING_NAME_LONG AS full_name,             b.BUILDING_STREET_ADDRESS AS street_address,             fb.BUILDING_TYPE AS building_type,             fb.DATE_OCCUPIED AS occupancy_date,             fb.OWNERSHIP_TYPE AS ownership_type,             fb.SITE AS site_location,             CAST(fb.BUILDING_NUMBER AS UNSIGNED) AS bldg_num_sort      FROM FAC_BUILDING fb      INNER JOIN BUILDINGS b ON fb.FAC_BUILDING_KEY = b.BUILDING_KEY      WHERE fb.PARENT_BUILDING_NUMBER IS NULL        AND fb.SITE = 'MIT')     UNION ALL     (SELECT 2, 1,             NULL,             CONCAT((SELECT COUNT(*) FROM FAC_BUILDING WHERE PARENT_BUILDING_NUMBER IS NULL AND SITE = 'MIT' AND OWNERSHIP_TYPE = 'OWNED'), ' Owned Buildings'),             NULL, NULL, NULL, NULL, NULL, NULL)     UNION ALL     (SELECT 2, 2,             NULL,             CONCAT((SELECT COUNT(*) FROM FAC_BUILDING WHERE PARENT_BUILDING_NUMBER IS NULL AND SITE = 'MIT' AND OWNERSHIP_TYPE = 'LEASED'), ' Leased Buildings'),             NULL, NULL, NULL, NULL, NULL, NULL)     UNION ALL     (SELECT 2, 3,             NULL,             CONCAT((SELECT COUNT(*) FROM FAC_BUILDING WHERE PARENT_BUILDING_NUMBER IS NULL AND SITE = 'MIT'), ' All Buildings'),             NULL, NULL, NULL, NULL, NULL, NULL) ) AS combined ORDER BY sort_order, sub_sort, bldg_num_sort, building_number;\t----- bird -----\tdw",
    "81": "WITH base AS (     SELECT          BUILDING_NUMBER AS bldg_num,         DATE_BUILT,         DATE_OCCUPIED     FROM FAC_BUILDING     WHERE OWNERSHIP_TYPE = 'OWNED'       AND (PARENT_BUILDING_NUMBER IS NULL OR PARENT_BUILDING_NUMBER = '') ), prep AS (     SELECT         bldg_num,         CASE              WHEN DATE_BUILT IS NULL OR DATE_BUILT = '' THEN 'UNKNOWN'             ELSE SUBSTRING_INDEX(DATE_BUILT, '/', -1)         END AS constr_year,         CASE              WHEN DATE_OCCUPIED IS NULL OR DATE_OCCUPIED = '' THEN 'UNKNOWN'             ELSE SUBSTRING_INDEX(DATE_OCCUPIED, '/', -1)         END AS occup_year,         CASE              WHEN DATE_BUILT IS NULL OR DATE_BUILT = '' THEN 9999             ELSE CAST(SUBSTRING_INDEX(DATE_BUILT, '/', -1) AS UNSIGNED)         END AS constr_year_num,         CAST(bldg_num AS UNSIGNED) AS bldg_num_num     FROM base ), ordered AS (     SELECT         bldg_num,         constr_year,         occup_year,         constr_year_num,         bldg_num_num,         LAG(constr_year) OVER (ORDER BY constr_year_num, bldg_num_num) AS prev_constr_year     FROM prep ), building_rows AS (     SELECT         CASE WHEN prev_constr_year IS NULL OR constr_year != prev_constr_year THEN constr_year ELSE NULL END AS construction_start_year,         bldg_num AS building_number,         occup_year AS year_of_initial_occupancy,         constr_year_num,         bldg_num_num,         0 AS seq     FROM ordered ), summary AS (     SELECT         NULL AS construction_start_year,         CONCAT(cnt, ' Buildings') AS building_number,         NULL AS year_of_initial_occupancy,         NULL AS constr_year_num,         NULL AS bldg_num_num,         1 AS seq     FROM (SELECT COUNT(*) AS cnt FROM base) t ) SELECT construction_start_year, building_number, year_of_initial_occupancy FROM (     SELECT * FROM building_rows     UNION ALL     SELECT * FROM summary ) combined ORDER BY seq, constr_year_num, bldg_num_num;\t----- bird -----\tdw",
    "82": "WITH latest_buildings AS (     SELECT b.FCLT_BUILDING_KEY, b.OWNERSHIP_TYPE, b.BUILDING_USE, b.EXT_GROSS_AREA     FROM FCLT_BUILDING_HIST b     WHERE b.SITE = 'MIT'       AND (b.FCLT_BUILDING_KEY, b.FISCAL_PERIOD) IN (           SELECT FCLT_BUILDING_KEY, MAX(FISCAL_PERIOD)           FROM FCLT_BUILDING_HIST           WHERE SITE = 'MIT'           GROUP BY FCLT_BUILDING_KEY       ) ), building_rooms AS (     SELECT b.FCLT_BUILDING_KEY,            COUNT(DISTINCT r.FCLT_ROOM_KEY) AS room_cnt,            COUNT(DISTINCT r.FCLT_ORGANIZATION_KEY) AS org_cnt_per_bldg     FROM latest_buildings b     LEFT JOIN FCLT_ROOMS r ON b.FCLT_BUILDING_KEY = r.FCLT_BUILDING_KEY     GROUP BY b.FCLT_BUILDING_KEY ), building_data AS (     SELECT b.FCLT_BUILDING_KEY,            b.OWNERSHIP_TYPE,            b.BUILDING_USE,            b.EXT_GROSS_AREA,            COALESCE(br.room_cnt, 0) AS room_cnt,            COALESCE(br.org_cnt_per_bldg, 0) AS org_cnt_per_bldg     FROM latest_buildings b     LEFT JOIN building_rooms br ON b.FCLT_BUILDING_KEY = br.FCLT_BUILDING_KEY ), building_org_map AS (     SELECT DISTINCT r.FCLT_BUILDING_KEY, r.FCLT_ORGANIZATION_KEY     FROM FCLT_ROOMS r     WHERE r.FCLT_ORGANIZATION_KEY IS NOT NULL ) SELECT     CASE         WHEN base.grp_owner = 1 OR base.grp_use = 1 THEN ''         WHEN LAG(base.ownership_type) OVER (ORDER BY base.grp_owner, base.ownership_type, base.grp_use, base.usage_type) = base.ownership_type THEN ''         ELSE base.ownership_type     END AS `Ownership Type`,     CASE WHEN base.grp_owner = 1 OR base.grp_use = 1 THEN '' ELSE base.usage_type END AS `Usage Type`,     base.num_buildings AS `Number of Buildings`,     base.gross_sq_ft AS `Gross Square Footage`,     base.num_rooms AS `Number of Rooms`,     base.num_organizations AS `Number of Organizations` FROM (     SELECT         bd.OWNERSHIP_TYPE AS ownership_type,         bd.BUILDING_USE AS usage_type,         COUNT(DISTINCT bd.FCLT_BUILDING_KEY) AS num_buildings,         FORMAT(ROUND(SUM(             CASE                 WHEN bom.FCLT_ORGANIZATION_KEY IS NOT NULL THEN bd.EXT_GROSS_AREA / bd.org_cnt_per_bldg                 ELSE bd.EXT_GROSS_AREA             END         )), 0) AS gross_sq_ft,         ROUND(SUM(             CASE                 WHEN bom.FCLT_ORGANIZATION_KEY IS NOT NULL THEN bd.room_cnt / bd.org_cnt_per_bldg                 ELSE bd.room_cnt             END         )) AS num_rooms,         COUNT(DISTINCT bom.FCLT_ORGANIZATION_KEY) AS num_organizations,         GROUPING(bd.OWNERSHIP_TYPE) AS grp_owner,         GROUPING(bd.BUILDING_USE) AS grp_use     FROM building_data bd     LEFT JOIN building_org_map bom ON bd.FCLT_BUILDING_KEY = bom.FCLT_BUILDING_KEY     GROUP BY bd.OWNERSHIP_TYPE, bd.BUILDING_USE WITH ROLLUP ) base ORDER BY base.grp_owner, base.ownership_type, base.grp_use, base.usage_type;\t----- bird -----\tdw",
    "83": "WITH  building_parent AS (     SELECT          FCLT_BUILDING_KEY,         COALESCE(PARENT_BUILDING_NUMBER, BUILDING_NUMBER) AS parent_id,         BUILDING_TYPE,         EXT_GROSS_AREA     FROM FCLT_BUILDING ), parent_attributes AS (     SELECT          parent_id,         MIN(BUILDING_TYPE) AS building_type,         SUM(EXT_GROSS_AREA) AS total_gross_area     FROM building_parent     GROUP BY parent_id ), parent_org_pairs AS (     SELECT DISTINCT         bp.parent_id,         o.FCLT_ORGANIZATION_KEY     FROM building_parent bp     INNER JOIN FCLT_ROOMS r ON bp.FCLT_BUILDING_KEY = r.FCLT_BUILDING_KEY     INNER JOIN FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY ), type_building_agg AS (     SELECT          CASE WHEN pa.building_type = 'RESIDENT' THEN 'RESIDENTIAL' ELSE pa.building_type END AS type,         COUNT(*) AS num_buildings,         SUM(pa.total_gross_area) AS total_gross_area     FROM parent_attributes pa     GROUP BY CASE WHEN pa.building_type = 'RESIDENT' THEN 'RESIDENTIAL' ELSE pa.building_type END ), type_org_agg AS (     SELECT          CASE WHEN pa.building_type = 'RESIDENT' THEN 'RESIDENTIAL' ELSE pa.building_type END AS type,         COUNT(DISTINCT pop.FCLT_ORGANIZATION_KEY) AS num_organizations     FROM parent_org_pairs pop     INNER JOIN parent_attributes pa ON pop.parent_id = pa.parent_id     GROUP BY CASE WHEN pa.building_type = 'RESIDENT' THEN 'RESIDENTIAL' ELSE pa.building_type END ), totals AS (     SELECT          'TOTAL' AS type,         (SELECT COUNT(*) FROM parent_attributes) AS num_buildings,         (SELECT SUM(total_gross_area) FROM parent_attributes) AS total_gross_area,         (SELECT COUNT(DISTINCT FCLT_ORGANIZATION_KEY) FROM parent_org_pairs) AS num_organizations ) SELECT      type,     FORMAT(num_buildings, 0) AS `Number of Buildings`,     FORMAT(total_gross_area, 0) AS `Total Gross Square Footage`,     FORMAT(num_organizations, 0) AS `Number of Organizations` FROM (     SELECT tba.type, tba.num_buildings, tba.total_gross_area, COALESCE(toa.num_organizations, 0) AS num_organizations     FROM type_building_agg tba     LEFT JOIN type_org_agg toa ON tba.type = toa.type     UNION ALL     SELECT type, num_buildings, total_gross_area, num_organizations FROM totals ) AS combined ORDER BY CASE WHEN type = 'TOTAL' THEN 1 ELSE 0 END, type;\t----- bird -----\tdw",
    "84": "SELECT      o.ORGANIZATION_ID AS ID,     o.ORGANIZATION_NUMBER AS `number`,     o.ORGANIZATION_LEVEL AS `level`,     CONCAT(REPEAT(' ', CAST(o.ORGANIZATION_LEVEL AS UNSIGNED) - 1), o.ORGANIZATION_NAME) AS formatted_name,     CASE WHEN o.ASSIGNABLE = '1' THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END AS assignable,     FORMAT(COALESCE(ROUND(SUM(r.AREA)), 0), 0) AS total_area,     FORMAT(COUNT(r.FCLT_ROOM_KEY), 0) AS number_of_rooms,     ROUND(AVG(r.AREA), 2) AS average_room_area FROM FCLT_ORGANIZATION o LEFT JOIN FCLT_ROOMS r ON o.FCLT_ORGANIZATION_KEY = r.FCLT_ORGANIZATION_KEY WHERE o.ORGANIZATION_NAME != 'Cambridge-MIT Institute' GROUP BY o.FCLT_ORGANIZATION_KEY ORDER BY o.ORGANIZATION_ID;\t----- bird -----\tdw",
    "85": "WITH Aggregated AS (     SELECT         CASE WHEN MU.ASSIGNABLE = '1' THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END AS assignable_status,         MU.DESCRIPTION AS major_use_desc,         COUNT(*) AS total_rooms,         SUM(R.AREA) AS total_area,         AVG(R.AREA) AS avg_area,         GROUPING(MU.ASSIGNABLE) AS grp_assignable,         GROUPING(MU.DESCRIPTION) AS grp_desc     FROM FCLT_ROOMS R     JOIN FCLT_MAJOR_USE MU ON R.FCLT_MAJOR_USE_KEY = MU.FCLT_MAJOR_USE_KEY     WHERE NOT (MU.MAJOR_USE LIKE 'ZUSE.%' OR MU.DESCRIPTION LIKE 'ZUSE.%')     GROUP BY MU.ASSIGNABLE, MU.DESCRIPTION WITH ROLLUP ) SELECT     CASE         WHEN grp_desc = 1 OR grp_assignable = 1 THEN NULL         ELSE              CASE                  WHEN assignable_status = LAG(assignable_status) OVER (                         ORDER BY grp_assignable, assignable_status, grp_desc, major_use_desc                     ) THEN NULL                 ELSE assignable_status             END     END AS `ASSIGNABLE_STATUS`,     CASE WHEN grp_desc = 1 OR grp_assignable = 1 THEN NULL ELSE major_use_desc END AS `MAJOR_USE_DESC`,     total_rooms AS `TOTAL_ROOMS`,     total_area AS `TOTAL_AREA`,     avg_area AS `AVG_AREA` FROM Aggregated ORDER BY grp_assignable, assignable_status, grp_desc, major_use_desc;\t----- bird -----\tdw",
    "86": "WITH aggregated AS (     SELECT         f.FLOOR_KEY,         o.ORGANIZATION_NAME AS department_name,         COUNT(*) AS num_rooms,         SUM(CAST(f.AREA AS DECIMAL(10,2))) AS total_area,         GROUPING(f.FLOOR_KEY) AS grp_floor,         GROUPING(o.ORGANIZATION_NAME) AS grp_dept     FROM FAC_ROOMS f     INNER JOIN BUILDINGS b ON f.BUILDING_KEY = b.BUILDING_KEY     INNER JOIN FCLT_ORGANIZATION o ON f.ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY     WHERE b.BUILDING_NAME LIKE '%Stata%'     GROUP BY f.FLOOR_KEY, o.ORGANIZATION_NAME WITH ROLLUP ) SELECT     CASE         WHEN grp_dept = 1 OR grp_floor = 1 THEN ''         ELSE              CASE                  WHEN ROW_NUMBER() OVER (PARTITION BY FLOOR_KEY ORDER BY department_name) = 1                  THEN FLOOR_KEY                  ELSE ''              END     END AS floor_key,     CASE WHEN grp_dept = 1 OR grp_floor = 1 THEN '' ELSE department_name END AS department_name,     FORMAT(num_rooms, 0) AS number_of_rooms,     FORMAT(ROUND(total_area), 0) AS total_area,     ROUND(total_area / num_rooms, 2) AS average_area FROM aggregated ORDER BY     grp_floor ASC,     FLOOR_KEY ASC,     grp_dept ASC,     department_name ASC;\t----- bird -----\tdw",
    "87": "SELECT     CASE         WHEN GROUPING(b.BUILDING_KEY) = 1 THEN NULL         ELSE b.BUILDING_KEY     END AS building_key,     CASE         WHEN GROUPING(r.FLOOR_KEY) = 1 AND GROUPING(b.BUILDING_KEY) = 0 THEN 'Total'         WHEN GROUPING(r.FLOOR_KEY) = 1 AND GROUPING(b.BUILDING_KEY) = 1 THEN 'Grand Total'         ELSE r.FLOOR_KEY     END AS floor_key,     FORMAT(COUNT(r.FAC_ROOM_KEY), 0) AS number_of_rooms,     FORMAT(ROUND(SUM(CAST(r.AREA AS DECIMAL(10,2))), 0), 0) AS total_area,     FORMAT(ROUND(AVG(CAST(r.AREA AS DECIMAL(10,2))), 0), 0) AS average_area_per_floor,     CASE WHEN GROUPING(b.BUILDING_KEY) = 0 THEN b.BUILDING_NAME_LONG ELSE NULL END AS building_name,     CASE WHEN GROUPING(b.BUILDING_KEY) = 0 THEN b.ACCESS_LEVEL_NAME ELSE NULL END AS access_level,     CASE WHEN GROUPING(r.FLOOR_KEY) = 0 THEN a.POSTAL_CODE ELSE NULL END AS zip_code,     CASE WHEN GROUPING(r.FLOOR_KEY) = 0 THEN a.CITY ELSE NULL END AS city FROM FAC_ROOMS r JOIN FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY JOIN FAC_BUILDING b ON r.BUILDING_KEY = b.BUILDING_KEY LEFT JOIN (     SELECT BUILDING_KEY, POSTAL_CODE, CITY     FROM FAC_BUILDING_ADDRESS     WHERE ADDRESS_PURPOSE = 'STREET'     GROUP BY BUILDING_KEY ) a ON b.BUILDING_KEY = a.BUILDING_KEY WHERE o.ORGANIZATION_NAME LIKE '%Facilities%' GROUP BY b.BUILDING_KEY, r.FLOOR_KEY WITH ROLLUP ORDER BY GROUPING(b.BUILDING_KEY), b.BUILDING_KEY, GROUPING(r.FLOOR_KEY), r.FLOOR_KEY;\t----- bird -----\tdw",
    "88": "WITH current_term AS (     SELECT TERM_CODE     FROM ACADEMIC_TERM_PARAMETER     WHERE IS_CURRENT_TERM = 'Y' ), current_subjects AS (     SELECT          s.LIBRARY_SUBJECT_OFFERED_KEY,         s.OFFER_DEPT_NAME,         s.OFFER_SCHOOL_NAME,         s.COURSE_NUMBER,         s.SUBJECT_TITLE,         s.NUM_ENROLLED_STUDENTS,         s.TERM_CODE     FROM LIBRARY_SUBJECT_OFFERED s     INNER JOIN current_term ct ON s.TERM_CODE = ct.TERM_CODE ), subject_reserves AS (     SELECT          cs.LIBRARY_SUBJECT_OFFERED_KEY,         COUNT(DISTINCT rc.CATALOG_ISBN) AS distinct_isbn_count     FROM current_subjects cs     LEFT JOIN LIBRARY_RESERVE_MATRL_DETAIL m ON cs.LIBRARY_SUBJECT_OFFERED_KEY = m.LIBRARY_SUBJECT_OFFERED_KEY     LEFT JOIN LIBRARY_RESERVE_CATALOG rc ON m.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY     GROUP BY cs.LIBRARY_SUBJECT_OFFERED_KEY ), subject_details AS (     SELECT          cs.OFFER_DEPT_NAME AS department,         cs.OFFER_SCHOOL_NAME AS school,         cs.COURSE_NUMBER AS course_number,         cs.SUBJECT_TITLE AS subject_title,         cs.NUM_ENROLLED_STUDENTS AS enrolled_students,         cs.TERM_CODE AS term_code,         COALESCE(sr.distinct_isbn_count, 0) AS distinct_isbn_count     FROM current_subjects cs     LEFT JOIN subject_reserves sr ON cs.LIBRARY_SUBJECT_OFFERED_KEY = sr.LIBRARY_SUBJECT_OFFERED_KEY ), total_students AS (     SELECT SUM(NUM_ENROLLED_STUDENTS) AS total_students     FROM current_subjects ), total_isbns AS (     SELECT COUNT(DISTINCT rc.CATALOG_ISBN) AS total_isbn_count     FROM LIBRARY_RESERVE_CATALOG rc     INNER JOIN LIBRARY_RESERVE_MATRL_DETAIL m ON rc.LIBRARY_RESERVE_CATALOG_KEY = m.LIBRARY_RESERVE_CATALOG_KEY     INNER JOIN current_subjects cs ON m.LIBRARY_SUBJECT_OFFERED_KEY = cs.LIBRARY_SUBJECT_OFFERED_KEY ) SELECT department, school, course_number, subject_title, enrolled_students, term_code, distinct_isbn_count FROM subject_details UNION ALL SELECT 'TOTAL:', NULL, NULL, NULL, total_students, NULL, total_isbn_count FROM total_students, total_isbns ORDER BY      CASE WHEN department = 'TOTAL:' THEN 1 ELSE 0 END,     department, school, course_number;\t----- bird -----\tdw",
    "89": "WITH base AS (     SELECT          o.OWNER_TYPE AS ownership_type,         l.MOIRA_LIST_NAME AS list_name,         COUNT(DISTINCT o.OWNER) AS num_owners,         COUNT(DISTINCT d.MOIRA_LIST_MEMBER_MIT_ID) AS num_subscribers     FROM MOIRA_LIST l     INNER JOIN MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY     INNER JOIN MOIRA_LIST_OWNER o ON d.MOIRA_LIST_OWNER_KEY = o.MOIRA_LIST_OWNER_KEY     INNER JOIN EMPLOYEE_DIRECTORY e ON d.MOIRA_LIST_MEMBER_MIT_ID = e.MIT_ID     WHERE l.IS_MOIRA_MAILING_LIST = 'Y'         AND e.DEPARTMENT_NAME LIKE 'Computer Science%'     GROUP BY o.OWNER_TYPE, l.MOIRA_LIST_NAME ), roll AS (     SELECT          ownership_type,         list_name,         SUM(num_owners) AS num_owners,         SUM(num_subscribers) AS num_subscribers,         GROUPING(ownership_type) AS g_type,         GROUPING(list_name) AS g_list     FROM base     GROUP BY ownership_type, list_name WITH ROLLUP ) SELECT      CASE          WHEN g_list = 1 AND g_type = 0 THEN 'SUBTOTAL'         WHEN g_list = 1 AND g_type = 1 THEN 'TOTAL'         ELSE              CASE                  WHEN ownership_type = LAG(ownership_type) OVER (ORDER BY g_type, ownership_type, g_list, list_name) THEN NULL                 ELSE ownership_type             END     END AS ownership_type,     list_name,     num_owners,     num_subscribers FROM roll ORDER BY g_type, ownership_type, g_list, list_name;\t----- bird -----\tdw",
    "90": "WITH  category_agg AS (     SELECT          c.IAP_SUBJECT_CATEGORY_KEY,         c.IAP_CATEGORY_NAME,         COUNT(DISTINCT d.IAP_SUBJECT_SESSION_KEY) AS unique_sessions,         COALESCE(SUM(d.MAX_ENROLLMENT), 0) AS total_attendees,         MIN(d.TERM_CODE) AS min_term,         MAX(d.TERM_CODE) AS max_term     FROM IAP_SUBJECT_CATEGORY c     LEFT JOIN IAP_SUBJECT_DETAIL d ON c.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY     GROUP BY c.IAP_SUBJECT_CATEGORY_KEY, c.IAP_CATEGORY_NAME ), sponsor_counts AS (     SELECT          c.IAP_SUBJECT_CATEGORY_KEY,         s.SPONSOR_NAME,         COUNT(*) AS cnt     FROM IAP_SUBJECT_CATEGORY c     LEFT JOIN IAP_SUBJECT_DETAIL d ON c.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY     LEFT JOIN IAP_SUBJECT_SPONSOR s ON d.IAP_SUBJECT_SPONSOR_KEY = s.IAP_SUBJECT_SPONSOR_KEY     WHERE s.SPONSOR_NAME IS NOT NULL     GROUP BY c.IAP_SUBJECT_CATEGORY_KEY, s.SPONSOR_NAME ), ranked_sponsor AS (     SELECT          IAP_SUBJECT_CATEGORY_KEY,         SPONSOR_NAME,         ROW_NUMBER() OVER (PARTITION BY IAP_SUBJECT_CATEGORY_KEY ORDER BY cnt DESC, SPONSOR_NAME ASC) AS rn     FROM sponsor_counts ), sponsor_mode AS (     SELECT IAP_SUBJECT_CATEGORY_KEY, SPONSOR_NAME AS mode_sponsor     FROM ranked_sponsor     WHERE rn = 1 ), start_time_counts AS (     SELECT          c.IAP_SUBJECT_CATEGORY_KEY,         sess.SESSION_START_TIME,         COUNT(*) AS cnt     FROM IAP_SUBJECT_CATEGORY c     LEFT JOIN IAP_SUBJECT_DETAIL d ON c.IAP_SUBJECT_CATEGORY_KEY = d.IAP_SUBJECT_CATEGORY_KEY     LEFT JOIN IAP_SUBJECT_SESSION sess ON d.IAP_SUBJECT_SESSION_KEY = sess.IAP_SUBJECT_SESSION_KEY     WHERE sess.SESSION_START_TIME IS NOT NULL     GROUP BY c.IAP_SUBJECT_CATEGORY_KEY, sess.SESSION_START_TIME ), ranked_start_time AS (     SELECT          IAP_SUBJECT_CATEGORY_KEY,         SESSION_START_TIME,         ROW_NUMBER() OVER (PARTITION BY IAP_SUBJECT_CATEGORY_KEY ORDER BY cnt DESC, SESSION_START_TIME ASC) AS rn     FROM start_time_counts ), time_mode AS (     SELECT IAP_SUBJECT_CATEGORY_KEY, SESSION_START_TIME AS mode_start_time     FROM ranked_start_time     WHERE rn = 1 ) SELECT      IAP_CATEGORY_NAME AS \"Category Name\",     unique_sessions AS \"Number of Unique Sessions\",     total_attendees AS \"Total Attendees\",     (min_term || '-' || max_term) AS \"Active Period\",     mode_sponsor AS \"Most Common Sponsor\",     mode_start_time AS \"Most Common Start Time\" FROM category_agg agg LEFT JOIN sponsor_mode sp ON agg.IAP_SUBJECT_CATEGORY_KEY = sp.IAP_SUBJECT_CATEGORY_KEY LEFT JOIN time_mode tm ON agg.IAP_SUBJECT_CATEGORY_KEY = tm.IAP_SUBJECT_CATEGORY_KEY  UNION ALL  SELECT      'TOTAL',     SUM(unique_sessions),     SUM(total_attendees),     NULL,     NULL,     NULL FROM category_agg  ORDER BY      CASE WHEN \"Category Name\" = 'TOTAL' THEN 1 ELSE 0 END,     \"Category Name\";\t----- bird -----\tdw",
    "91": "WITH building_latest AS (     SELECT          FCLT_BUILDING_KEY AS building_key,         BUILDING_TYPE,         PARENT_BUILDING_NUMBER,         EXT_GROSS_AREA,         ROW_NUMBER() OVER (PARTITION BY FCLT_BUILDING_KEY ORDER BY FISCAL_PERIOD DESC) AS rn     FROM FCLT_BUILDING_HIST ), building_current AS (     SELECT building_key, BUILDING_TYPE, PARENT_BUILDING_NUMBER, EXT_GROSS_AREA     FROM building_latest     WHERE rn = 1 ), employee_per_building AS (     SELECT r.BUILDING_KEY, COUNT(DISTINCT e.MIT_ID) AS emp_count     FROM EMPLOYEE_DIRECTORY e     INNER JOIN FAC_ROOMS r ON e.OFFICE_LOCATION = r.FAC_ROOM_KEY     GROUP BY r.BUILDING_KEY ), address_ranked AS (     SELECT          BUILDING_KEY,         CITY,         STATE,         POSTAL_CODE,         ROW_NUMBER() OVER (PARTITION BY BUILDING_KEY ORDER BY CITY, STATE, POSTAL_CODE) AS rn     FROM FAC_BUILDING_ADDRESS     WHERE ADDRESS_PURPOSE = 'STREET' ), address_selected AS (     SELECT BUILDING_KEY, CITY, STATE, POSTAL_CODE     FROM address_ranked     WHERE rn = 1 ), building_details AS (     SELECT          bc.building_key,         CASE WHEN LOWER(bc.BUILDING_TYPE) = 'resident' THEN 'RESIDENTIAL' ELSE bc.BUILDING_TYPE END AS btype,         bc.PARENT_BUILDING_NUMBER,         bc.EXT_GROSS_AREA,         b.BUILDING_STREET_ADDRESS AS street_addr,         addr.CITY,         addr.STATE,         addr.POSTAL_CODE,         COALESCE(epb.emp_count, 0) AS emp_count     FROM building_current bc     LEFT JOIN BUILDINGS b ON bc.building_key = b.BUILDING_KEY     LEFT JOIN address_selected addr ON bc.building_key = addr.BUILDING_KEY     LEFT JOIN employee_per_building epb ON bc.building_key = epb.BUILDING_KEY ) SELECT     CASE WHEN GROUPING(btype) = 1 THEN 'TOTAL' ELSE btype END AS building_type,     SUM(CASE WHEN (PARENT_BUILDING_NUMBER IS NULL OR TRIM(PARENT_BUILDING_NUMBER) = '') THEN 1 ELSE 0 END) AS num_buildings_not_subdivisions,     SUM(emp_count) AS num_employees,     COUNT(DISTINCT street_addr) AS num_unique_street_address,     COUNT(DISTINCT CITY) AS num_unique_city,     COUNT(DISTINCT STATE) AS num_unique_state,     COUNT(DISTINCT POSTAL_CODE) AS num_unique_postal_code,     SUM(EXT_GROSS_AREA) / NULLIF(SUM(emp_count), 0) AS avg_gross_sqft_per_employee FROM building_details GROUP BY btype WITH ROLLUP;\t----- bird -----\tdw",
    "92": "SELECT     Z.ACCESS_LEVEL AS access_level,     SU.SPACE_USAGE AS usage_type,     FO.DLC_NAME AS space_name,     FORMAT(COUNT(*), 0) AS num_spaces,     FORMAT(ROUND(SUM(SD.ROOM_SQUARE_FOOTAGE)), 0) AS total_area,     FORMAT(ROUND(AVG(SD.ROOM_SQUARE_FOOTAGE)), 0) AS avg_area FROM ZPM_ROOMS_LOAD Z JOIN SPACE_DETAIL SD     ON Z.BUILDING_ROOM = SD.BUILDING_ROOM     AND Z.BUILDING_COMPONENT = SD.BUILDING_COMPONENT JOIN SPACE_USAGE SU     ON SD.SPACE_USAGE_KEY = SU.SPACE_USAGE_KEY JOIN SPACE_UNIT SU2     ON Z.SPACE_UNIT_CODE = SU2.SPACE_UNIT_CODE JOIN FCLT_ORGANIZATION FO     ON SU2.FCLT_ORGANIZATION_KEY = FO.FCLT_ORGANIZATION_KEY WHERE Z.BUILDING_COMPONENT = '1'     AND SU.SPACE_USAGE NOT LIKE '%STORAGE%' GROUP BY Z.ACCESS_LEVEL, SU.SPACE_USAGE, FO.DLC_NAME WITH ROLLUP ORDER BY     (Z.ACCESS_LEVEL IS NULL), Z.ACCESS_LEVEL,     (SU.SPACE_USAGE IS NULL), SU.SPACE_USAGE,     (FO.DLC_NAME IS NULL), FO.DLC_NAME;\t----- bird -----\tdw",
    "93": "WITH faculty_agg AS (     SELECT         u.DLC_KEY,         CASE              WHEN f.EMERITUS_STATUS = 'Emeritus' THEN 'Emeritus'              ELSE 'Non-Emeritus'          END AS emeritus_status,         COUNT(DISTINCT f.MIT_ID) AS employer_count     FROM HR_FACULTY_ROSTER f     JOIN HR_ORG_UNIT u ON f.HR_ORG_UNIT_TITLE = u.HR_ORG_UNIT_TITLE     GROUP BY u.DLC_KEY,          CASE              WHEN f.EMERITUS_STATUS = 'Emeritus' THEN 'Emeritus'              ELSE 'Non-Emeritus'          END ), detail AS (     SELECT         o.ORGANIZATION_SORT AS break_group,         o.ORGANIZATION_ID AS ID,         o.ORGANIZATION_NAME AS name,         CASE CAST(o.ORGANIZATION_LEVEL AS INTEGER)             WHEN 1 THEN o.ORGANIZATION_NAME             WHEN 2 THEN '  ' || o.ORGANIZATION_NAME             WHEN 3 THEN '    ' || o.ORGANIZATION_NAME             WHEN 4 THEN '      ' || o.ORGANIZATION_NAME             WHEN 5 THEN '        ' || o.ORGANIZATION_NAME             WHEN 6 THEN '          ' || o.ORGANIZATION_NAME             ELSE o.ORGANIZATION_NAME         END AS formatted_name,         fa.emeritus_status,         o.ORGANIZATION_NUMBER AS org_number,         o.ORGANIZATION_LEVEL AS level,         fa.employer_count,         h.HIERARCHY_TYPE     FROM FCLT_ORGANIZATION o     JOIN faculty_agg fa ON o.DLC_KEY = fa.DLC_KEY     JOIN MASTER_DEPT_HIERARCHY h ON o.DLC_KEY = h.DLC_KEY     WHERE o.ORGANIZATION_ID NOT IN ('139', '250') ) SELECT break_group, ID, name, formatted_name, emeritus_status, org_number, level, employer_count, hierarchy_type FROM detail UNION ALL SELECT      NULL,     NULL,     NULL,     'Total',     NULL,     NULL,     NULL,     SUM(employer_count),     'Total' FROM detail ORDER BY      CASE WHEN hierarchy_type = 'Total' THEN 1 ELSE 0 END,     hierarchy_type,     ID,     emeritus_status;\t----- bird -----\tdw",
    "94": "SELECT      C.SUBJECT_TITLE AS title,     B.BUILDING_NAME AS building_name,     DATEDIFF(T.TERM_END_DATE, T.TERM_START_DATE) AS duration,     AVG(DATEDIFF(T.TERM_END_DATE, T.TERM_START_DATE)) OVER (         PARTITION BY T.ACADEMIC_YEAR          ORDER BY T.TERM_START_DATE          ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING     ) AS running_avg_duration FROM COURSE_CATALOG_SUBJECT_OFFERED C JOIN ACADEMIC_TERMS T ON C.EFFECTIVE_TERM_CODE = T.TERM_CODE LEFT JOIN FCLT_ROOMS R ON C.MEET_PLACE = R.BUILDING_ROOM LEFT JOIN FCLT_BUILDING B ON R.FCLT_BUILDING_KEY = B.FCLT_BUILDING_KEY;\t----- bird -----\tdw",
    "95": "SELECT      c.SUBJECT_TITLE AS course_name,     b.BUILDING_NAME_LONG AS building_name,     a.TERM_START_DATE AS start_date,     LAG(c.SUBJECT_TITLE) OVER (ORDER BY a.TERM_START_DATE, c.SUBJECT_TITLE) AS previous_course_name,     LEAD(c.SUBJECT_TITLE) OVER (ORDER BY a.TERM_START_DATE, c.SUBJECT_TITLE) AS next_course_name,     b.ACCESS_LEVEL_NAME AS access_level,     r.AREA AS assignable_area FROM COURSE_CATALOG_SUBJECT_OFFERED c LEFT JOIN ACADEMIC_TERMS a ON c.TERM_CODE = a.TERM_CODE LEFT JOIN FCLT_ROOMS r ON c.MEET_PLACE = r.BUILDING_ROOM LEFT JOIN FCLT_BUILDING b ON r.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY ORDER BY a.TERM_START_DATE, c.SUBJECT_TITLE;\t----- bird -----\tdw",
    "96": "SELECT      sub.SUBJECT_TITLE AS course_name,     bld.BUILDING_NAME AS building_name,     COUNT(*) OVER (PARTITION BY term.ACADEMIC_YEAR ORDER BY term.TERM_START_DATE) AS cumulative_courses FROM COURSE_CATALOG_SUBJECT_OFFERED sub JOIN ACADEMIC_TERMS term ON sub.EFFECTIVE_TERM_CODE = term.TERM_CODE JOIN FCLT_ROOMS room ON sub.MEET_PLACE = room.FCLT_ROOM_KEY JOIN FCLT_BUILDING bld ON room.FCLT_BUILDING_KEY = bld.FCLT_BUILDING_KEY ORDER BY term.ACADEMIC_YEAR, term.TERM_START_DATE;\t----- bird -----\tdw",
    "97": "WITH base AS (     SELECT          CASE WHEN a.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END AS current_status,         s.CLUSTER_TYPE,         DATEDIFF(a.TERM_END_DATE, a.TERM_START_DATE) AS duration,         s.TOTAL_UNITS AS total_units     FROM SUBJECT_SUMMARY s     INNER JOIN ACADEMIC_TERMS_ALL a ON s.TERM_CODE = a.TERM_CODE     WHERE s.DEPARTMENT_NAME LIKE '%Biology%' OR s.DEPARTMENT_NAME LIKE '%Chemistry%' ) SELECT      display_status AS current_status,     cluster_type,     max_duration,     max_units,     avg_duration,     avg_units FROM (     SELECT          CASE              WHEN GROUPING(current_status) = 1 AND GROUPING(cluster_type) = 1 THEN 'TOTAL'             WHEN GROUPING(cluster_type) = 1 THEN 'SUBTOTAL'             ELSE current_status         END AS display_status,         current_status AS original_status,         cluster_type,         GROUPING(current_status) AS grp_status,         GROUPING(cluster_type) AS grp_cluster,         MAX(duration) AS max_duration,         MAX(total_units) AS max_units,         AVG(duration) AS avg_duration,         AVG(total_units) AS avg_units     FROM base     GROUP BY current_status, cluster_type WITH ROLLUP ) AS rolled ORDER BY      grp_status,     original_status,     grp_cluster,     cluster_type;\t----- bird -----\tdw",
    "98": "SELECT      CASE          WHEN GROUPING(original_current_status) = 1 AND GROUPING(department) = 1 THEN 'TOTAL'         WHEN GROUPING(department) = 1 THEN 'SUBTOTAL'         ELSE original_current_status     END AS current_status,     department AS department_name,     MAX(duration_days) AS max_duration,     MAX(total_units) AS max_units,     AVG(duration_days) AS avg_duration,     AVG(total_units) AS avg_units FROM (     SELECT          CASE WHEN A.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END AS original_current_status,         O.OFFER_DEPT_NAME AS department,         DATEDIFF(A.TERM_END_DATE, A.TERM_START_DATE) AS duration_days,         S.TOTAL_UNITS AS total_units     FROM SUBJECT_SUMMARY S     JOIN ACADEMIC_TERMS_ALL A ON S.TERM_CODE = A.TERM_CODE     JOIN SUBJECT_OFFERED O ON S.SUBJECT_ID = O.SUBJECT_ID AND S.TERM_CODE = O.TERM_CODE     WHERE O.OFFER_DEPT_NAME IN ('Biology', 'Chemistry') ) AS base GROUP BY original_current_status, department WITH ROLLUP ORDER BY      GROUPING(original_current_status),     original_current_status,     GROUPING(department),     department;\t----- bird -----\tdw",
    "99": "WITH subject_groups AS (     SELECT OFFER_DEPT_NAME AS dept,            MASTER_COURSE_NUMBER AS master_course,            COUNT(DISTINCT SUBJECT_ID) AS num_subjects     FROM TIP_SUBJECT_OFFERED     GROUP BY OFFER_DEPT_NAME, MASTER_COURSE_NUMBER ), distinct_materials AS (     SELECT DISTINCT s.OFFER_DEPT_NAME,                     s.MASTER_COURSE_NUMBER,                     m.TIP_MATERIAL_KEY,                     m.NEW_SHELF_PRICE     FROM TIP_SUBJECT_OFFERED s     JOIN TIP_DETAIL d ON s.TIP_SUBJECT_OFFERED_KEY = d.TIP_SUBJECT_OFFERED_KEY     JOIN TIP_MATERIAL m ON d.TIP_MATERIAL_KEY = m.TIP_MATERIAL_KEY ), material_groups AS (     SELECT OFFER_DEPT_NAME AS dept,            MASTER_COURSE_NUMBER AS master_course,            COUNT(*) AS num_materials,            SUM(NEW_SHELF_PRICE) AS total_price     FROM distinct_materials     GROUP BY OFFER_DEPT_NAME, MASTER_COURSE_NUMBER ) SELECT      CASE          WHEN GROUPING(sg.dept) = 1 THEN 'Grand Total'         ELSE sg.dept     END AS department,     CASE          WHEN GROUPING(sg.master_course) = 1 AND GROUPING(sg.dept) = 0 THEN 'Department Total'         WHEN GROUPING(sg.master_course) = 1 AND GROUPING(sg.dept) = 1 THEN ''         ELSE sg.master_course     END AS master_course,     FORMAT(COALESCE(SUM(sg.num_subjects), 0), 0) AS num_subjects,     FORMAT(COALESCE(SUM(mg.total_price), 0), 0) AS total_new_shelf_price,     FORMAT(COALESCE(SUM(mg.num_materials), 0), 0) AS num_unique_materials FROM subject_groups sg LEFT JOIN material_groups mg ON sg.dept = mg.dept AND sg.master_course = mg.master_course GROUP BY sg.dept, sg.master_course WITH ROLLUP ORDER BY GROUPING(sg.dept), sg.dept, GROUPING(sg.master_course), sg.master_course;\t----- bird -----\tdw",
    "100": "WITH subject_data AS (   SELECT      C.TERM_CODE,     C.DEPARTMENT_CODE,     MAX(C.DEPARTMENT_NAME) AS DEPARTMENT_NAME,     MAX(D.SCHOOL_NAME) AS SCHOOL_NAME,     MAX(A.DEPARTMENT_PHONE_NUMBER) AS DEPARTMENT_PHONE_NUMBER,     MAX(CASE            WHEN C.EQUIVALENT_SUBJECTS IS NULL OR C.EQUIVALENT_SUBJECTS = '' THEN 0            ELSE (LENGTH(C.EQUIVALENT_SUBJECTS) - LENGTH(REPLACE(C.EQUIVALENT_SUBJECTS, ',', '')) + 1)          END) AS equiv_count   FROM COURSE_CATALOG_SUBJECT_OFFERED C   LEFT JOIN SIS_DEPARTMENT D ON C.DEPARTMENT_CODE = D.DEPARTMENT_CODE   LEFT JOIN SIS_ADMIN_DEPARTMENT A ON D.DEPARTMENT_CODE = A.SIS_ADMIN_DEPARTMENT_CODE   GROUP BY C.TERM_CODE, C.DEPARTMENT_CODE, C.SUBJECT_ID ), rollup_data AS (   SELECT      CASE        WHEN GROUPING(TERM_CODE) = 1 THEN 'TOTAL'       WHEN GROUPING(DEPARTMENT_CODE) = 1 THEN 'SUBTOTAL'       ELSE TERM_CODE     END AS term_display,     CASE WHEN GROUPING(DEPARTMENT_CODE) = 1 THEN NULL ELSE MAX(DEPARTMENT_NAME) END AS department,     COUNT(*) AS number_of_courses,     AVG(equiv_count) AS avg_equivalent_subjects,     CASE WHEN GROUPING(DEPARTMENT_CODE) = 0 THEN MAX(SCHOOL_NAME) ELSE NULL END AS school_name,     CASE WHEN GROUPING(DEPARTMENT_CODE) = 0 THEN MAX(DEPARTMENT_PHONE_NUMBER) ELSE NULL END AS department_phone_number,     TERM_CODE AS raw_term_code,     GROUPING(TERM_CODE) AS g_term,     GROUPING(DEPARTMENT_CODE) AS g_dept,     MAX(DEPARTMENT_NAME) AS raw_department_name   FROM subject_data   GROUP BY TERM_CODE, DEPARTMENT_CODE WITH ROLLUP ) SELECT    CASE      WHEN term_display = LAG(term_display) OVER (ORDER BY g_term, raw_term_code, g_dept, raw_department_name)      THEN NULL      ELSE term_display    END AS term,   department,   number_of_courses,   avg_equivalent_subjects,   school_name,   department_phone_number FROM rollup_data ORDER BY g_term, raw_term_code, g_dept, raw_department_name;\t----- bird -----\tdw",
    "101": "WITH session_data AS (     SELECT          CASE WHEN a.IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NOT CURRENT' END AS term_status,         c.IAP_CATEGORY_NAME AS category_name,         (TIME_TO_SEC(STR_TO_DATE(s.SESSION_END_TIME, '%h%i%p')) - TIME_TO_SEC(STR_TO_DATE(s.SESSION_START_TIME, '%h%i%p'))) / 86400.0 AS duration_days     FROM IAP_SUBJECT_DETAIL d     INNER JOIN ACADEMIC_TERMS a ON d.TERM_CODE = a.TERM_CODE     INNER JOIN IAP_SUBJECT_CATEGORY c ON d.IAP_SUBJECT_CATEGORY_KEY = c.IAP_SUBJECT_CATEGORY_KEY     INNER JOIN IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY ) SELECT      term_status AS `current_status`,     category_name AS `session_name`,     COUNT(*) AS `number_of_sessions`,     COALESCE(SUM(duration_days), 0) AS `total_session_time_days`,     COALESCE(AVG(duration_days), 0) AS `average_session_time_days` FROM session_data GROUP BY term_status, category_name WITH ROLLUP ORDER BY      GROUPING(term_status),     term_status,     GROUPING(category_name),     category_name;\t----- bird -----\tdw",
    "102": "WITH distinct_subject_terms AS (   SELECT DISTINCT SUBJECT_ID, TERM_CODE   FROM COURSE_CATALOG_SUBJECT_OFFERED ), subject_terms_with_date AS (   SELECT d.SUBJECT_ID, d.TERM_CODE, a.ACADEMIC_YEAR, a.TERM_START_DATE   FROM distinct_subject_terms d   JOIN ACADEMIC_TERMS_ALL a ON d.TERM_CODE = a.TERM_CODE ), subject_first_term AS (   SELECT      SUBJECT_ID,     TERM_CODE,     ACADEMIC_YEAR,     TERM_START_DATE,     ROW_NUMBER() OVER (PARTITION BY SUBJECT_ID ORDER BY TERM_START_DATE) AS rn   FROM subject_terms_with_date ), term_counts AS (   SELECT      ACADEMIC_YEAR,     TERM_CODE,     COUNT(*) AS new_subjects,     MIN(TERM_START_DATE) AS term_start_date   FROM subject_first_term   WHERE rn = 1   GROUP BY ACADEMIC_YEAR, TERM_CODE ) SELECT    academic_year,   term_code,   new_subjects FROM (   SELECT      CASE        WHEN LAG(ACADEMIC_YEAR) OVER (ORDER BY term_start_date) = ACADEMIC_YEAR THEN NULL       ELSE ACADEMIC_YEAR     END AS academic_year,     TERM_CODE,     new_subjects,     term_start_date   FROM term_counts   UNION ALL   SELECT      'TOTAL' AS academic_year,     NULL AS TERM_CODE,     SUM(new_subjects) AS new_subjects,     NULL AS term_start_date   FROM term_counts ) AS combined ORDER BY    CASE WHEN academic_year = 'TOTAL' THEN 2 ELSE 1 END,   term_start_date;\t----- bird -----\tdw",
    "103": "SELECT      l.MOIRA_LIST_NAME AS list_name,     o.OWNER AS owner,     COUNT(DISTINCT d.MOIRA_LIST_MEMBER) AS member_count FROM      MOIRA_LIST l     INNER JOIN MOIRA_LIST_DETAIL d ON l.MOIRA_LIST_KEY = d.MOIRA_LIST_KEY     INNER JOIN MOIRA_LIST_OWNER o ON d.MOIRA_LIST_OWNER_KEY = o.MOIRA_LIST_OWNER_KEY     LEFT JOIN SE_PERSON s ON d.MOIRA_LIST_MEMBER = s.KRB_NAME     LEFT JOIN MIT_STUDENT_DIRECTORY sd ON s.FULL_NAME = sd.FULL_NAME WHERE      LOWER(l.MOIRA_LIST_NAME) LIKE 'e%' GROUP BY      l.MOIRA_LIST_KEY, l.MOIRA_LIST_NAME, o.OWNER HAVING      COUNT(DISTINCT d.MOIRA_LIST_MEMBER) BETWEEN 10 AND 20     AND COUNT(DISTINCT CASE WHEN LOWER(sd.DEPARTMENT_NAME) LIKE '%computer science%' THEN d.MOIRA_LIST_MEMBER END) > 0.75 * COUNT(DISTINCT d.MOIRA_LIST_MEMBER);\t----- bird -----\tdw",
    "104": "WITH list_sizes AS (     SELECT         l.MOIRA_LIST_KEY,         COUNT(DISTINCT ld.MOIRA_LIST_MEMBER) AS list_size     FROM MOIRA_LIST l     JOIN MOIRA_LIST_DETAIL ld ON l.MOIRA_LIST_KEY = ld.MOIRA_LIST_KEY     WHERE l.IS_MOIRA_MAILING_LIST = 'Y'     GROUP BY l.MOIRA_LIST_KEY ), student_mailing_stats AS (     SELECT         p.MIT_ID,         COUNT(DISTINCT ls.MOIRA_LIST_KEY) AS total_mailing_lists,         AVG(ls.list_size) AS avg_mailing_list_size     FROM SE_PERSON p     LEFT JOIN MOIRA_LIST_DETAIL ld ON p.MIT_ID = ld.MOIRA_LIST_MEMBER_MIT_ID     LEFT JOIN list_sizes ls ON ld.MOIRA_LIST_KEY = ls.MOIRA_LIST_KEY     GROUP BY p.MIT_ID ) SELECT     s.FULL_NAME AS student_name,     adm.DEPARTMENT_PHONE_NUMBER AS department_phone,     sms.total_mailing_lists,     sms.avg_mailing_list_size FROM MIT_STUDENT_DIRECTORY s JOIN SE_PERSON p ON s.FULL_NAME = p.FULL_NAME JOIN SIS_DEPARTMENT dept ON s.DEPARTMENT = dept.DEPARTMENT_CODE JOIN SIS_ADMIN_DEPARTMENT adm ON dept.DEPARTMENT_CODE = adm.SIS_ADMIN_DEPARTMENT_CODE LEFT JOIN student_mailing_stats sms ON p.MIT_ID = sms.MIT_ID WHERE s.LAST_NAME LIKE 'K%' ORDER BY s.FULL_NAME;\t----- bird -----\tdw",
    "105": "WITH ListTotal AS (     SELECT MOIRA_LIST_KEY, COUNT(*) AS total_subscribers     FROM MOIRA_LIST_DETAIL     GROUP BY MOIRA_LIST_KEY ), RankedLists AS (     SELECT          ml.MOIRA_LIST_KEY,         ml.MOIRA_LIST_NAME,         ml.IS_PUBLIC,         lt.total_subscribers,         ROW_NUMBER() OVER (ORDER BY lt.total_subscribers DESC) AS rn     FROM MOIRA_LIST ml     JOIN ListTotal lt ON ml.MOIRA_LIST_KEY = lt.MOIRA_LIST_KEY ), DeptStudentCounts AS (     SELECT          mld.MOIRA_LIST_KEY,         sd.DEPARTMENT_NAME,         COUNT(*) AS student_count     FROM MOIRA_LIST_DETAIL mld     INNER JOIN MIT_STUDENT_DIRECTORY msd ON mld.MOIRA_LIST_MEMBER_FULL_NAME = msd.FULL_NAME     INNER JOIN SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE     GROUP BY mld.MOIRA_LIST_KEY, sd.DEPARTMENT_NAME ), RankedDepts AS (     SELECT          dsc.MOIRA_LIST_KEY,         dsc.DEPARTMENT_NAME,         dsc.student_count,         ROW_NUMBER() OVER (PARTITION BY dsc.MOIRA_LIST_KEY ORDER BY dsc.student_count DESC, dsc.DEPARTMENT_NAME ASC) AS rn     FROM DeptStudentCounts dsc ) SELECT      rl.MOIRA_LIST_NAME AS list_name,     rl.total_subscribers,     rl.IS_PUBLIC AS public_status,     rd.DEPARTMENT_NAME AS department_name,     COALESCE(rd.student_count, 0) AS student_count FROM RankedLists rl LEFT JOIN RankedDepts rd ON rl.MOIRA_LIST_KEY = rd.MOIRA_LIST_KEY AND rd.rn = 1 WHERE rl.rn <= 100 ORDER BY rl.total_subscribers DESC;\t----- bird -----\tdw",
    "106": "SELECT      b.BUILDING_NAME,     b.BUILDING_NUMBER,     COALESCE(f.total_assignable, 0) AS total_assignable_area,     COALESCE(f.total_non_assignable, 0) AS total_non_assignable_area,     COALESCE(r.total_rooms, 0) AS total_room_count FROM FAC_BUILDING b LEFT JOIN (     SELECT BUILDING_KEY,            SUM(ASSIGNABLE_AREA) AS total_assignable,            SUM(NON_ASSIGNABLE_AREA) AS total_non_assignable     FROM FAC_FLOOR     GROUP BY BUILDING_KEY ) f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY LEFT JOIN (     SELECT BUILDING_KEY,            COUNT(*) AS total_rooms     FROM FAC_ROOMS     GROUP BY BUILDING_KEY ) r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY ORDER BY total_assignable_area DESC;\t----- bird -----\tdw",
    "107": "SELECT      r.ROOM_FULL_NAME,     r.AREA,     m.MAJOR_USE,     o.ORGANIZATION_NAME,     COUNT(*) OVER (PARTITION BY r.MAJOR_USE_KEY) AS rooms_per_major_use,     SUM(CAST(r.AREA AS DECIMAL(10,2))) OVER (PARTITION BY r.ORGANIZATION_KEY) AS total_area_per_org FROM FAC_ROOMS r JOIN FAC_MAJOR_USE m ON r.MAJOR_USE_KEY = m.MAJOR_USE_KEY JOIN FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY WHERE r.BUILDING_KEY = '45';\t----- bird -----\tdw",
    "108": "SELECT     b.BUILDING_NAME AS name,     b.BUILDING_NUMBER AS number,     b.DATE_BUILT AS construction_date,     b.BUILDING_TYPE AS type,     b.EXT_GROSS_AREA AS gross_area,     COALESCE(a.addr_count, 0) AS address_count,     COALESCE(r.room_count, 0) AS room_count FROM FAC_BUILDING b LEFT JOIN (     SELECT BUILDING_KEY, COUNT(*) AS addr_count     FROM FAC_BUILDING_ADDRESS     GROUP BY BUILDING_KEY ) a ON b.FAC_BUILDING_KEY = a.BUILDING_KEY LEFT JOIN (     SELECT BUILDING_KEY, COUNT(*) AS room_count     FROM FAC_ROOMS     GROUP BY BUILDING_KEY ) r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY ORDER BY b.BUILDING_NAME;\t----- bird -----\tdw",
    "109": "SELECT      s.OFFER_DEPT_NAME AS department_name,     COUNT(DISTINCT s.MASTER_COURSE_NUMBER) AS unique_courses,     COUNT(DISTINCT rc.LIBRARY_RESERVE_CATALOG_KEY) AS unique_reserved_materials,     COUNT(DISTINCT i.INSTRUCTOR_NAME) AS unique_instructors FROM LIBRARY_SUBJECT_OFFERED s LEFT JOIN LIBRARY_RESERVE_MATRL_DETAIL d ON s.LIBRARY_SUBJECT_OFFERED_KEY = d.LIBRARY_SUBJECT_OFFERED_KEY LEFT JOIN LIBRARY_RESERVE_CATALOG rc ON d.LIBRARY_RESERVE_CATALOG_KEY = rc.LIBRARY_RESERVE_CATALOG_KEY LEFT JOIN LIBRARY_COURSE_INSTRUCTOR i ON d.LIBRARY_COURSE_INSTRUCTOR_KEY = i.LIBRARY_COURSE_INSTRUCTOR_KEY GROUP BY s.OFFER_DEPT_NAME ORDER BY unique_courses DESC;\t----- bird -----\tdw",
    "110": "SELECT      s.SUBJECT_TITLE AS title,     COUNT(DISTINCT r.LIBRARY_RESERVE_CATALOG_KEY) AS total_reserved_materials,     COUNT(DISTINCT m.LIBRARY_MATERIAL_STATUS) AS distinct_status_count FROM LIBRARY_RESERVE_MATRL_DETAIL r JOIN LIBRARY_SUBJECT_OFFERED s ON r.LIBRARY_SUBJECT_OFFERED_KEY = s.LIBRARY_SUBJECT_OFFERED_KEY JOIN LIBRARY_MATERIAL_STATUS m ON r.LIBRARY_MATERIAL_STATUS_KEY = m.LIBRARY_MATERIAL_STATUS_KEY GROUP BY s.SUBJECT_TITLE ORDER BY total_reserved_materials DESC;\t----- bird -----\tdw",
    "111": "SELECT     i.INSTRUCTOR_NAME AS instructor_name,     COUNT(DISTINCT i.COURSE_NAME) AS unique_courses,     COUNT(m.LIBRARY_RESERVE_CATALOG_KEY) AS total_assignments,     AVG(CAST(c.CATALOG_YEAR AS INTEGER)) AS avg_publication_year,     COUNT(DISTINCT s.LIBRARY_MATERIAL_STATUS) AS distinct_status_count FROM LIBRARY_COURSE_INSTRUCTOR i LEFT JOIN LIBRARY_RESERVE_MATRL_DETAIL m ON i.LIBRARY_COURSE_INSTRUCTOR_KEY = m.LIBRARY_COURSE_INSTRUCTOR_KEY LEFT JOIN LIBRARY_RESERVE_CATALOG c ON m.LIBRARY_RESERVE_CATALOG_KEY = c.LIBRARY_RESERVE_CATALOG_KEY LEFT JOIN LIBRARY_MATERIAL_STATUS s ON m.LIBRARY_MATERIAL_STATUS_KEY = s.LIBRARY_MATERIAL_STATUS_KEY GROUP BY i.INSTRUCTOR_NAME ORDER BY unique_courses DESC;\t----- bird -----\tdw",
    "112": "WITH  distinct_materials AS (     SELECT          c.CATALOG_YEAR,         c.LIBRARY_RESERVE_CATALOG_KEY,         LENGTH(c.CATALOG_TITLE) AS title_len     FROM LIBRARY_RESERVE_CATALOG c     WHERE EXISTS (         SELECT 1          FROM LIBRARY_RESERVE_MATRL_DETAIL d         WHERE d.LIBRARY_RESERVE_CATALOG_KEY = c.LIBRARY_RESERVE_CATALOG_KEY     ) ), year_stats AS (     SELECT         CATALOG_YEAR,         COUNT(*) AS total_materials,         AVG(title_len) AS avg_title_length     FROM distinct_materials     GROUP BY CATALOG_YEAR ), year_status_course AS (     SELECT         c.CATALOG_YEAR,         COUNT(DISTINCT s.LIBRARY_MATERIAL_STATUS) AS distinct_status_count,         COUNT(DISTINCT i.COURSE_NAME) AS number_courses     FROM LIBRARY_RESERVE_CATALOG c     INNER JOIN LIBRARY_RESERVE_MATRL_DETAIL d ON c.LIBRARY_RESERVE_CATALOG_KEY = d.LIBRARY_RESERVE_CATALOG_KEY     INNER JOIN LIBRARY_MATERIAL_STATUS s ON d.LIBRARY_MATERIAL_STATUS_KEY = s.LIBRARY_MATERIAL_STATUS_KEY     INNER JOIN LIBRARY_COURSE_INSTRUCTOR i ON d.LIBRARY_COURSE_INSTRUCTOR_KEY = i.LIBRARY_COURSE_INSTRUCTOR_KEY     GROUP BY c.CATALOG_YEAR ) SELECT      y.CATALOG_YEAR AS publication_year,     y.total_materials,     y.avg_title_length,     sc.distinct_status_count,     sc.number_courses FROM year_stats y JOIN year_status_course sc ON y.CATALOG_YEAR = sc.CATALOG_YEAR ORDER BY CAST(y.CATALOG_YEAR AS UNSIGNED) DESC;\t----- bird -----\tdw",
    "113": "SELECT      c.IAP_CATEGORY_NAME AS category_name,     s.SPONSOR_NAME AS sponsor_name,     COUNT(*) AS number_of_activities,     AVG(d.FEE) AS average_fee FROM IAP_SUBJECT_DETAIL d INNER JOIN IAP_SUBJECT_CATEGORY c ON d.IAP_SUBJECT_CATEGORY_KEY = c.IAP_SUBJECT_CATEGORY_KEY INNER JOIN IAP_SUBJECT_SPONSOR s ON d.IAP_SUBJECT_SPONSOR_KEY = s.IAP_SUBJECT_SPONSOR_KEY GROUP BY c.IAP_CATEGORY_KEY, c.IAP_CATEGORY_NAME, s.SPONSOR_KEY, s.SPONSOR_NAME ORDER BY number_of_activities DESC;\t----- bird -----\tdw",
    "114": "SELECT      sp.SPONSOR_NAME,     COUNT(s.IAP_SUBJECT_SESSION_KEY) AS `Number of IAP Sessions`,     COUNT(DISTINCT d.IAP_SUBJECT_SESSION_KEY) AS `Number of Unique Subjects` FROM      IAP_SUBJECT_SPONSOR sp     LEFT JOIN IAP_SUBJECT_DETAIL d ON sp.IAP_SUBJECT_SPONSOR_KEY = d.IAP_SUBJECT_SPONSOR_KEY     LEFT JOIN IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY GROUP BY      sp.SPONSOR_NAME;\t----- bird -----\tdw",
    "115": "SELECT      p.PERSON_ROLE AS role,     c.IAP_CATEGORY_NAME AS category_name,     COUNT(DISTINCT p.IAP_SUBJECT_PERSON_KEY) AS number_of_people,     AVG(d.FEE) AS average_fee FROM      IAP_SUBJECT_PERSON p     JOIN IAP_SUBJECT_DETAIL d ON p.IAP_SUBJECT_PERSON_KEY = d.IAP_SUBJECT_PERSON_KEY     JOIN IAP_SUBJECT_CATEGORY c ON d.IAP_SUBJECT_CATEGORY_KEY = c.IAP_SUBJECT_CATEGORY_KEY GROUP BY      p.PERSON_ROLE, c.IAP_CATEGORY_NAME ORDER BY      number_of_people DESC;\t----- bird -----\tdw",
    "116": "WITH building_floors AS (   SELECT b.FAC_BUILDING_KEY, b.BUILDING_NAME, COUNT(DISTINCT f.LEVEL_ID) AS floors   FROM FAC_BUILDING b   JOIN FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY   GROUP BY b.FAC_BUILDING_KEY, b.BUILDING_NAME ) SELECT BUILDING_NAME FROM building_floors WHERE floors = (SELECT MAX(floors) FROM building_floors);\t----- bird -----\tdw",
    "117": "SELECT C.SUBJECT_TITLE, COUNT(DISTINCT E.MIT_ID) AS number_of_instructors, MAX(LENGTH(E.FULL_NAME)) AS longest_instructor_name_length FROM COURSE_CATALOG_SUBJECT_OFFERED C JOIN ACADEMIC_TERMS_ALL A ON C.TERM_CODE = A.TERM_CODE JOIN EMPLOYEE_DIRECTORY E ON C.RESPONSIBLE_FACULTY_MIT_ID = E.MIT_ID WHERE A.TERM_CODE LIKE '%SU' GROUP BY C.SUBJECT_ID, C.SUBJECT_TITLE;\t----- bird -----\tdw",
    "118": "SELECT      o.OWNER AS owner,     COUNT(DISTINCT d.MOIRA_LIST_KEY) AS total_mailing_lists,     COUNT(d.MOIRA_LIST_MEMBER) AS total_members FROM MOIRA_LIST_OWNER o JOIN MOIRA_LIST_DETAIL d ON o.MOIRA_LIST_OWNER_KEY = d.MOIRA_LIST_OWNER_KEY JOIN MOIRA_LIST l ON d.MOIRA_LIST_KEY = l.MOIRA_LIST_KEY WHERE o.MOIRA_LIST_OWNER_KEY = 'LIST69.377-keeper-xenon' AND l.IS_MOIRA_MAILING_LIST = 'Y' GROUP BY o.OWNER;\t----- bird -----\tdw",
    "119": "SELECT d.SCHOOL_NAME,        COUNT(DISTINCT cd.COURSE) AS total_courses,        COUNT(DISTINCT CASE WHEN cd.IS_DEGREE_GRANTING = 'Y' THEN cd.COURSE END) AS degree_granting_courses FROM SIS_COURSE_DESCRIPTION cd JOIN SIS_DEPARTMENT d ON cd.DEPARTMENT = d.DEPARTMENT_CODE JOIN SIS_SUBJECT_CODE sc ON cd.COURSE = sc.COURSE_NUMBER GROUP BY d.SCHOOL_NAME ORDER BY d.SCHOOL_NAME;\t----- bird -----\tdw",
    "120": "SELECT d.DEPARTMENT_NAME, a.DEPARTMENT_PHONE_NUMBER, COUNT(*) AS number_of_students, MAX(LENGTH(s.FULL_NAME)) AS longest_full_name_length FROM SIS_DEPARTMENT d JOIN MIT_STUDENT_DIRECTORY s ON d.DEPARTMENT_CODE = s.DEPARTMENT JOIN SIS_ADMIN_DEPARTMENT a ON d.DEPARTMENT_CODE = a.SIS_ADMIN_DEPARTMENT_CODE GROUP BY d.DEPARTMENT_CODE, d.DEPARTMENT_NAME, a.DEPARTMENT_PHONE_NUMBER;\t----- bird -----\tdw"
}