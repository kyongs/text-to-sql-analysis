[
    {
        "db_id": "dw",
        "question": "Show the unique activity titles, locations, term start date, and supervisor name for all independent activities, sorted by the ascending order of start date.",
        "predicted_sql": "SELECT DISTINCT \n    d.ACTIVITY_TITLE,\n    s.SESSION_LOCATION,\n    t.TERM_START_DATE,\n    p.PERSON_NAME AS SUPERVISOR_NAME\nFROM \n    IAP_SUBJECT_DETAIL d\nJOIN \n    IAP_SUBJECT_SESSION s ON d.IAP_SUBJECT_SESSION_KEY = s.IAP_SUBJECT_SESSION_KEY\nJOIN \n    ACADEMIC_TERMS_ALL t ON d.TERM_CODE = t.TERM_CODE\nJOIN \n    IAP_SUBJECT_PERSON p ON d.IAP_SUBJECT_PERSON_KEY = p.IAP_SUBJECT_PERSON_KEY\nWHERE \n    p.PERSON_ROLE = 'Activity leader'\nORDER BY \n    t.TERM_START_DATE ASC;"
    },
    {
        "db_id": "dw",
        "question": "List the unique full room names, their corresponding building names, street addresses, cities, states, postal codes, and building heights for rooms associated with subjects that Computer Science students can enroll in.",
        "predicted_sql": "SELECT DISTINCT\n    FR.ROOM_FULL_NAME,\n    B.BUILDING_NAME,\n    B.BUILDING_STREET_ADDRESS,\n    FBA.CITY,\n    FBA.STATE,\n    FBA.POSTAL_CODE,\n    FB.BUILDING_HEIGHT\nFROM\n    FCLT_ROOMS FR\nJOIN\n    COURSE_CATALOG_SUBJECT_OFFERED CCO\nON\n    CCO.MEET_PLACE = FR.FCLT_ROOM_KEY\nJOIN\n    FCLT_BUILDING_ADDRESS FBA\nON\n    FBA.FCLT_BUILDING_KEY = FR.FCLT_BUILDING_KEY\nJOIN\n    FCLT_BUILDING FB\nON\n    FB.FCLT_BUILDING_KEY = FR.FCLT_BUILDING_KEY\nJOIN\n    BUILDINGS B\nON\n    B.BUILDING_KEY = FR.FCLT_BUILDING_KEY\nWHERE\n    CCO.DEPARTMENT_NAME = 'Computer Science'\nAND\n    FBA.ADDRESS_PURPOSE = 'STREET';"
    },
    {
        "db_id": "dw",
        "question": "For each building key, what is the building name and the number of courses offered by the Center for International Studies?",
        "predicted_sql": "SELECT \n    fb.FCLT_BUILDING_KEY AS building_key, \n    fb.BUILDING_NAME AS building_name, \n    COUNT(DISTINCT cco.SUBJECT_ID) AS num_courses\nFROM \n    CIS_COURSE_CATALOG ccc\nJOIN \n    COURSE_CATALOG_SUBJECT_OFFERED cco ON ccc.SUBJECT_ID = cco.SUBJECT_ID\nJOIN \n    FCLT_ROOMS fr ON cco.MEET_PLACE = fr.FCLT_ROOM_KEY\nJOIN \n    FCLT_BUILDING fb ON fr.FCLT_BUILDING_KEY = fb.FCLT_BUILDING_KEY\nWHERE \n    fb.FCLT_BUILDING_KEY IS NOT NULL\nGROUP BY \n    fb.FCLT_BUILDING_KEY, \n    fb.BUILDING_NAME;"
    },
    {
        "db_id": "dw",
        "question": "List the name and floor of the building with the largest floor number.",
        "predicted_sql": "SELECT b.BUILDING_NAME, f.FLOOR\nFROM FAC_BUILDING b\nJOIN FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY\nWHERE f.FLOOR = (SELECT MAX(FLOOR) FROM FAC_FLOOR);"
    },
    {
        "db_id": "dw",
        "question": "Give the count of mailing lists with names starting with B that include members from the Electrical Engineering and Computer Science department, along with the name of the list starting with B that have the highest number of members from that department and the corresponding member count.",
        "predicted_sql": "WITH ListMemberCount AS (\n    SELECT \n        ml.MOIRA_LIST_NAME,\n        COUNT(1) AS MemberCount\n    FROM \n        MOIRA_LIST ml\n    JOIN \n        MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY\n    JOIN \n        SE_PERSON sp ON mld.MOIRA_LIST_MEMBER = sp.KRB_NAME\n    WHERE \n        ml.MOIRA_LIST_NAME LIKE 'B%' \n        AND ml.IS_MOIRA_MAILING_LIST = 'Y'\n        AND sp.ORGANIZATION = 'Electrical Engineering and Computer Science'\n    GROUP BY \n        ml.MOIRA_LIST_NAME\n),\nMaxMemberList AS (\n    SELECT \n        MOIRA_LIST_NAME, \n        MemberCount\n    FROM \n        ListMemberCount\n    WHERE \n        MemberCount = (SELECT MAX(MemberCount) FROM ListMemberCount)\n)\nSELECT \n    (SELECT COUNT(*) FROM ListMemberCount) AS MailingListCount, \n    MaxMemberList.MOIRA_LIST_NAME AS ListWithMaxMembers, \n    MaxMemberList.MemberCount AS MaxMemberCount\nFROM \n    MaxMemberList;"
    },
    {
        "db_id": "dw",
        "question": "For subjects offered in the summer term, list the subject titles, number of instructors, and the length of the longest instructor name.",
        "predicted_sql": "SELECT \n    c.SUBJECT_TITLE,\n    COUNT(DISTINCT e.MIT_ID) AS number_of_instructors,\n    MAX(LENGTH(e.FULL_NAME)) AS longest_instructor_name_length\nFROM \n    COURSE_CATALOG_SUBJECT_OFFERED c\nJOIN \n    EMPLOYEE_DIRECTORY e ON c.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID\nJOIN \n    ACADEMIC_TERMS_ALL a ON c.TERM_CODE = a.TERM_CODE\nWHERE \n    c.IS_OFFERED_SUMMER_TERM = 'Y'\nGROUP BY \n    c.SUBJECT_TITLE;"
    }
]