[
  {
    "sql_idx": 0,
    "ground_truth": "SELECT DISTINCT d.FCLT_BUILDING_KEY, e.BUILDING_STREET_ADDRESS, d.CITY, d.STATE, d.POSTAL_CODE FROM FCLT_BUILDING_ADDRESS d JOIN FCLT_ROOMS a ON a.FCLT_BUILDING_KEY = d.FCLT_BUILDING_KEY JOIN FCLT_ORG_DLC_KEY b ON a.FCLT_ORGANIZATION_KEY = b.FCLT_ORGANIZATION_KEY JOIN MASTER_DEPT_HIERARCHY c ON b.DLC_KEY = c.DLC_KEY JOIN BUILDINGS e ON e.BUILDING_KEY = d.FCLT_BUILDING_KEY WHERE lower(c.DLC_NAME) = lower('History') AND d.ADDRESS_PURPOSE = 'STREET';",
    "res": 0
  },
  {
    "sql_idx": 1,
    "ground_truth": "SELECT DISTINCT a.activity_title, d.session_location, c.term_start_date, b.person_name AS Leader FROM iap_subject_detail a JOIN iap_subject_person b ON a.iap_subject_person_key = b.iap_subject_person_key JOIN academic_terms_all c ON c.term_code = a.term_code JOIN iap_subject_session d ON a.iap_subject_session_key = d.iap_subject_session_key WHERE b.person_role = 'Activity leader' ORDER BY term_start_date ASC;",
    "res": 1
  },
  {
    "sql_idx": 2,
    "ground_truth": "SELECT DISTINCT LIBRARY_COURSE_INSTRUCTOR.instructor_name, LIBRARY_SUBJECT_OFFERED.subject_title, COUNT(LIBRARY_RESERVE_CATALOG.catalog_isbn) OVER (PARTITION BY LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY, LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY) FROM LIBRARY_COURSE_INSTRUCTOR JOIN LIBRARY_RESERVE_MATRL_DETAIL ON LIBRARY_COURSE_INSTRUCTOR.LIBRARY_COURSE_INSTRUCTOR_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_COURSE_INSTRUCTOR_KEY JOIN LIBRARY_SUBJECT_OFFERED ON LIBRARY_SUBJECT_OFFERED.LIBRARY_SUBJECT_OFFERED_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_SUBJECT_OFFERED_KEY JOIN LIBRARY_RESERVE_CATALOG ON LIBRARY_RESERVE_CATALOG.LIBRARY_RESERVE_CATALOG_KEY = LIBRARY_RESERVE_MATRL_DETAIL.LIBRARY_RESERVE_CATALOG_KEY;",
    "res": 0
  },
  {
    "sql_idx": 3,
    "ground_truth": "SELECT DISTINCT fac_rooms.Room, fac_rooms.floor, fac_building_address.BUILDING_KEY, BUILDINGS.BUILDING_STREET_ADDRESS, fac_building_address.CITY, fac_building_address.STATE, fac_building_address.POSTAL_CODE FROM (SELECT office_location FROM employee_directory WHERE full_name = 'Haynes, Summer') AS emp_office JOIN fac_rooms ON emp_office.office_location = fac_rooms.fac_room_key JOIN fac_building_address ON fac_rooms.building_key = fac_building_address.BUILDING_KEY JOIN BUILDINGS ON BUILDINGS.BUILDING_KEY = fac_building_address.BUILDING_KEY WHERE fac_building_address.ADDRESS_PURPOSE = 'STREET';",
    "res": 1
  },
  {
    "sql_idx": 4,
    "ground_truth": "SELECT DISTINCT fr.ROOM_FULL_NAME, b.BUILDING_NAME, b.BUILDING_STREET_ADDRESS, fba.CITY, fba.STATE, fba.POSTAL_CODE, fb.BUILDING_HEIGHT FROM COURSE_CATALOG_SUBJECT_OFFERED JOIN FCLT_ROOMS fr ON MEET_PLACE = FCLT_ROOM_KEY JOIN FCLT_BUILDING_ADDRESS fba ON fba.FCLT_BUILDING_KEY = fr.FCLT_BUILDING_KEY JOIN FCLT_BUILDING fb ON fb.FCLT_BUILDING_KEY = fr.FCLT_BUILDING_KEY JOIN BUILDINGS b ON b.BUILDING_KEY = fr.FCLT_BUILDING_KEY WHERE DEPARTMENT_NAME = 'Electrical Eng & Computer Sci' AND fba.ADDRESS_PURPOSE = 'STREET';",
    "res": 0
  },
  {
    "sql_idx": 5,
    "ground_truth": "SELECT DISTINCT s.TERM_CODE, s.subject_title, fr.room, fr.floor, b.BUILDING_KEY, b.BUILDING_STREET_ADDRESS, fba.CITY, fba.STATE, fba.POSTAL_CODE, s.form_type, s.num_enrolled_students FROM subject_offered s JOIN FCLT_ROOMS fr ON MEET_PLACE = FCLT_ROOM_KEY JOIN FCLT_BUILDING_ADDRESS fba ON fba.FCLT_BUILDING_KEY = fr.FCLT_BUILDING_KEY JOIN BUILDINGS b ON fr.FCLT_BUILDING_KEY = b.BUILDING_KEY WHERE s.num_enrolled_students > 300 AND fba.ADDRESS_PURPOSE = 'STREET';",
    "res": 1
  },
  {
    "sql_idx": 6,
    "ground_truth": "SELECT DISTINCT tso.SUBJECT_TITLE, tm.title, tm.isbn, tm.new_shelf_price, SUM(tm.new_shelf_price) OVER(PARTITION BY tso.SUBJECT_TITLE) FROM tip_material tm JOIN TIP_DETAIL td ON tm.TIP_MATERIAL_KEY = td.TIP_MATERIAL_KEY JOIN TIP_SUBJECT_OFFERED tso ON tso.SUBJECT_ID = td.SUBJECT_ID ORDER BY tm.new_shelf_price ASC;",
    "res": 0
  },
  {
    "sql_idx": 7,
    "ground_truth": "SELECT * FROM (SELECT DISTINCT a.BUILDING_NAME_LONG, a.year_built, COUNT(employee_directory.MIT_ID) OVER (PARTITION BY a.BUILDING_NAME_LONG, a.year_built) AS num_employees FROM (SELECT * FROM (SELECT DISTINCT FCLT_BUILDING_KEY, BUILDING_NAME_LONG, EXTRACT(YEAR FROM STR_TO_DATE(date_built, '%m/%d/%Y')) AS year_built FROM fclt_building_hist) AS sub1 WHERE year_built < 1950) AS a JOIN fclt_rooms ON fclt_rooms.FCLT_BUILDING_KEY = a.FCLT_BUILDING_KEY JOIN (SELECT DISTINCT MIT_ID, OFFICE_LOCATION FROM employee_directory) AS employee_directory ON employee_directory.OFFICE_LOCATION = fclt_rooms.BUILDING_ROOM) AS sub2 WHERE num_employees > 100;",
    "res": 0
  },
  {
    "sql_idx": 8,
    "ground_truth": "SELECT fb.BUILDING_NAME, COUNT(DISTINCT ccc.subject_id) FROM cis_course_catalog ccc JOIN COURSE_CATALOG_SUBJECT_OFFERED ccso ON ccc.SUBJECT_ID = ccso.SUBJECT_ID JOIN FCLT_ROOMS fr ON ccso.MEET_PLACE = fr.FCLT_ROOM_KEY JOIN FCLT_BUILDING fb ON fb.FCLT_BUILDING_KEY = fr.FCLT_BUILDING_KEY GROUP BY fb.FCLT_BUILDING_KEY, fb.BUILDING_NAME;",
    "res": 0
  },
  {
    "sql_idx": 9,
    "ground_truth": "SELECT DISTINCT building_name, num_students FROM (SELECT fclt_building_key, COUNT(DISTINCT full_name) AS num_students FROM fclt_rooms JOIN mit_student_directory ON office_location = BUILDING_ROOM GROUP BY fclt_building_key) AS a JOIN fclt_building ON a.fclt_building_key = fclt_building.fclt_building_key JOIN (SELECT MAX(num_students) AS max_num_students FROM (SELECT fclt_building_key, COUNT(DISTINCT full_name) AS num_students FROM fclt_rooms JOIN mit_student_directory ON office_location = BUILDING_ROOM GROUP BY fclt_building_key) AS subquery1) AS b ON a.num_students = b.max_num_students;",
    "res": 1
  },
  {
    "sql_idx": 10,
    "ground_truth": "SELECT DISTINCT B.BUILDING_NAME, A.FLOOR FROM FAC_FLOOR A JOIN FAC_BUILDING B ON A.BUILDING_KEY = B.FAC_BUILDING_KEY JOIN (SELECT MAX(f) AS highest_floor FROM (SELECT CASE WHEN FLOOR REGEXP '^[0-9]+$' THEN CAST(FLOOR AS UNSIGNED) ELSE NULL END AS f FROM FAC_FLOOR) AS subquery1) AS subquery2 ON (CASE WHEN A.FLOOR REGEXP '^[0-9]+$' THEN CAST(A.FLOOR AS UNSIGNED) ELSE NULL END) = subquery2.highest_floor;",
    "res": 1
  },
  {
    "sql_idx": 11,
    "ground_truth": "SELECT isc.IAP_CATEGORY_NAME, td.ACADEMIC_YEAR, SUM(isd.FEE) AS Total_Fee, COUNT(distinct isd.ACTIVITY_TITLE) AS Total_Subjects, MIN(isd.MAX_ENROLLMENT) AS Min_Attendance, MAX(isd.MAX_ENROLLMENT) AS Max_Attendance FROM IAP_SUBJECT_DETAIL isd JOIN IAP_SUBJECT_CATEGORY isc ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY JOIN TIME_DAY td ON isd.TERM_CODE = td.ACADEMIC_TERM_CODE GROUP BY isc.IAP_CATEGORY_NAME, td.ACADEMIC_YEAR;",
    "res": 1
  },
  {
    "sql_idx": 12,
    "ground_truth": "SELECT issr.SPONSOR_NAME, COUNT(DISTINCT iss.IAP_SUBJECT_SESSION_KEY) AS Total_Sessions, SUM(isd.MAX_ENROLLMENT), MIN(isd.FEE) AS Min_Fee, MAX(isd.FEE) AS Max_Fee, SUM(CASE WHEN iss.HAS_SESSION_INFO = 'Y' THEN 1 ELSE 0 END) AS Num_Sessions_With_Info, SUM(CASE WHEN iss.HAS_SESSION_INFO = 'N' THEN 1 ELSE 0 END) AS Num_Sessions_Without_Info FROM IAP_SUBJECT_SESSION iss JOIN IAP_SUBJECT_DETAIL isd ON iss.IAP_SUBJECT_SESSION_KEY = isd.IAP_SUBJECT_SESSION_KEY JOIN IAP_SUBJECT_SPONSOR issr ON isd.IAP_SUBJECT_SPONSOR_KEY = issr.IAP_SUBJECT_SPONSOR_KEY GROUP BY issr.SPONSOR_NAME;",
    "res": 1
  },
  {
    "sql_idx": 13,
    "ground_truth": "SELECT isp.PERSON_EMAIL, isp.PERSON_NAME, td.ACADEMIC_YEAR, COUNT(distinct isd.ACTIVITY_TITLE) AS Total_Subjects, MIN(isd.FEE) AS Min_Fee, MAX(isd.FEE) AS Max_Fee, SUM(isd.MAX_ENROLLMENT) FROM IAP_SUBJECT_PERSON isp JOIN IAP_SUBJECT_DETAIL isd ON isp.IAP_SUBJECT_PERSON_KEY = isd.IAP_SUBJECT_PERSON_KEY JOIN TIME_DAY td ON isd.TERM_CODE = td.ACADEMIC_TERM_CODE GROUP BY isp.PERSON_EMAIL, isp.PERSON_NAME, td.ACADEMIC_YEAR;",
    "res": 1
  },
  {
    "sql_idx": 14,
    "ground_truth": "SELECT isd.TERM_CODE, ata.TERM_DESCRIPTION, COUNT(distinct iss.IAP_SUBJECT_SESSION_KEY) AS Total_Sessions, SUM(isd.FEE) AS Total_Fee, MIN(isd.MAX_ENROLLMENT) AS Min_Enrollment, MAX(isd.MAX_ENROLLMENT) AS Max_Enrollment FROM IAP_SUBJECT_SESSION iss JOIN IAP_SUBJECT_DETAIL isd ON iss.IAP_SUBJECT_SESSION_KEY = isd.IAP_SUBJECT_SESSION_KEY JOIN ACADEMIC_TERMS_ALL ata ON isd.TERM_CODE = ata.TERM_CODE GROUP BY isd.TERM_CODE, ata.TERM_DESCRIPTION;",
    "res": 1
  },
  {
    "sql_idx": 15,
    "ground_truth": "SELECT b.BUILDING_NAME, COUNT(DISTINCT isd.ACTIVITY_TITLE) AS Total_Subjects, SUM(isd.FEE) AS Total_Fee, MIN(TIMESTAMPDIFF(MINUTE, STR_TO_DATE(iss.SESSION_START_TIME, '%h%i%p'), CASE WHEN STR_TO_DATE(iss.SESSION_START_TIME, '%h%i%p') > STR_TO_DATE(iss.SESSION_END_TIME, '%h%i%p') THEN STR_TO_DATE('1200PM', '%h%i%p') ELSE STR_TO_DATE(iss.SESSION_END_TIME, '%h%i%p') END)) AS Min_Sessions, MAX(TIMESTAMPDIFF(MINUTE, STR_TO_DATE(iss.SESSION_START_TIME, '%h%i%p'), CASE WHEN STR_TO_DATE(iss.SESSION_START_TIME, '%h%i%p') > STR_TO_DATE(iss.SESSION_END_TIME, '%h%i%p') THEN STR_TO_DATE('1200PM', '%h%i%p') ELSE STR_TO_DATE(iss.SESSION_END_TIME, '%h%i%p') END)) AS Max_Sessions FROM IAP_SUBJECT_SESSION iss JOIN IAP_SUBJECT_DETAIL isd ON iss.IAP_SUBJECT_SESSION_KEY = isd.IAP_SUBJECT_SESSION_KEY JOIN BUILDINGS b ON b.BUILDING_NUMBER = iss.SESSION_LOCATION GROUP BY b.BUILDING_NAME;",
    "res": 0
  },
  {
    "sql_idx": 16,
    "ground_truth": "SELECT COUNT(DISTINCT isd.ACTIVITY_TITLE) AS Total_Subjects, SUM(isd.FEE) AS Total_Fee, MIN(TIMESTAMPDIFF(MINUTE, STR_TO_DATE(iss.SESSION_START_TIME, '%h%i%p'), CASE WHEN STR_TO_DATE(iss.SESSION_START_TIME, '%h%i%p') > STR_TO_DATE(iss.SESSION_END_TIME, '%h%i%p') THEN STR_TO_DATE('1200PM', '%h%i%p') ELSE STR_TO_DATE(iss.SESSION_END_TIME, '%h%i%p') END)) AS Min_Sessions, MAX(TIMESTAMPDIFF(MINUTE, STR_TO_DATE(iss.SESSION_START_TIME, '%h%i%p'), CASE WHEN STR_TO_DATE(iss.SESSION_START_TIME, '%h%i%p') > STR_TO_DATE(iss.SESSION_END_TIME, '%h%i%p') THEN STR_TO_DATE('1200PM', '%h%i%p') ELSE STR_TO_DATE(iss.SESSION_END_TIME, '%h%i%p') END)) AS Max_Sessions FROM IAP_SUBJECT_SESSION iss JOIN IAP_SUBJECT_DETAIL isd ON iss.IAP_SUBJECT_SESSION_KEY = isd.IAP_SUBJECT_SESSION_KEY JOIN BUILDINGS b ON b.BUILDING_NUMBER != iss.SESSION_LOCATION;",
    "res": 0
  },
  {
    "sql_idx": 17,
    "ground_truth": "SELECT ssc.SCHOOL_CODE, ssc.SCHOOL_NAME, sd.DEPARTMENT_FULL_NAME, scd.COURSE_LEVEL, COUNT(DISTINCT scd.COURSE) AS Total_Courses, SUM(CASE WHEN scd.IS_DEGREE_GRANTING = 'Y' THEN 1 ELSE 0 END) AS Total_Degree_Granting_Courses FROM SIS_COURSE_DESCRIPTION scd JOIN SIS_DEPARTMENT sd ON scd.DEPARTMENT = sd.DEPARTMENT_CODE JOIN SIS_SUBJECT_CODE ssc ON scd.COURSE = ssc.SUBJECT_CODE GROUP BY ssc.SCHOOL_CODE, ssc.SCHOOL_NAME, scd.DEPARTMENT, sd.DEPARTMENT_FULL_NAME, scd.COURSE_LEVEL;",
    "res": 1
  },
  {
    "sql_idx": 18,
    "ground_truth": "SELECT ssc.SCHOOL_CODE, ssc.SCHOOL_NAME, sd.DEPARTMENT_CODE, sad.SIS_ADMIN_DEPARTMENT_NAME, COUNT(DISTINCT sad.DEPARTMENT_PHONE_NUMBER) AS Total_Phone_Numbers, CASE WHEN SUM(CASE WHEN scd.COURSE_LEVEL = 'U' THEN 1 ELSE 0 END) >= SUM(CASE WHEN scd.COURSE_LEVEL = 'G' THEN 1 ELSE 0 END) THEN 'U' ELSE 'G' END AS Most_Common_Course_Level FROM SIS_ADMIN_DEPARTMENT sad JOIN SIS_DEPARTMENT sd ON sad.SIS_ADMIN_DEPARTMENT_CODE = sd.DEPARTMENT_CODE JOIN SIS_COURSE_DESCRIPTION scd ON sd.DEPARTMENT_CODE = scd.DEPARTMENT JOIN SIS_SUBJECT_CODE ssc ON scd.COURSE = ssc.SUBJECT_CODE GROUP BY ssc.SCHOOL_CODE, ssc.SCHOOL_NAME, sd.DEPARTMENT_CODE, sad.SIS_ADMIN_DEPARTMENT_NAME;",
    "res": 0
  },
  {
    "sql_idx": 19,
    "ground_truth": "SELECT ssc.SCHOOL_CODE, ssc.SCHOOL_NAME, sd.DLC_KEY, GRADUATE_LEVEL, COUNT(DISTINCT ssc.SUBJECT_CODE) AS Total_Subjects, MIN(ssc.COURSE_NUMBER) AS Min_Course_Number, MAX(ssc.COURSE_NUMBER) AS Max_Course_Number, COUNT(DISTINCT sd.DEPARTMENT_CODE) AS Total_Departments FROM SIS_SUBJECT_CODE ssc JOIN SIS_COURSE_DESCRIPTION scd ON ssc.SUBJECT_CODE = scd.COURSE JOIN SIS_DEPARTMENT sd ON scd.DEPARTMENT = sd.DEPARTMENT_CODE GROUP BY ssc.SCHOOL_CODE, ssc.SCHOOL_NAME, sd.DLC_KEY,GRADUATE_LEVEL;",
    "res": 1
  },
  {
    "sql_idx": 20,
    "ground_truth": "SELECT sd.BUILDING_COMPONENT, b.BUILDING_NAME, sd.Total_Square_Footage, COUNT(DISTINCT SF.FLOOR) AS Total_Number_Of_Floors, COUNT(DISTINCT sd.BUILDING_ROOM) AS Total_Rooms, COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) as Total_Number_FCLT, COUNT(DISTINCT ssu.MIT_ID) AS Total_Supervisors, SUM(ssu.NUM_OF_SUPERVISEES) AS Total_Supervisees FROM (SELECT SPACE_DETAIL.*, SUM(ROOM_SQUARE_FOOTAGE) OVER (PARTITION BY BUILDING_COMPONENT) AS Total_Square_Footage FROM SPACE_DETAIL) sd JOIN BUILDINGS b ON b.BUILDING_KEY = sd.BUILDING_KEY JOIN SPACE_FLOOR sf ON sd.FLOOR_KEY = sf.FLOOR_KEY JOIN SPACE_UNIT su ON sd.SPACE_UNIT_KEY = su.SPACE_UNIT_KEY JOIN SPACE_SUPERVISOR_USAGE ssu ON su.DLC_KEY = ssu.DEPT_NAMES GROUP BY sd.BUILDING_COMPONENT, b.BUILDING_NAME, sd.Total_Square_Footage;",
    "res": 0
  },
  {
    "sql_idx": 21,
    "ground_truth": "SELECT su.DLC_KEY, fo.DLC_NAME, COUNT(DISTINCT sf.FLOOR) AS Total_Number_Of_Floors, sd.Total_Square_Footage, COUNT(DISTINCT su.FCLT_ORGANIZATION_KEY) AS Total_Number_Facility, COUNT(DISTINCT ssu.MIT_ID) AS Total_Supervisors, SUM(ssu.NUM_OF_SUPERVISEES) AS Total_Supervisees, SUM(fb.BUILDING_HEIGHT) AS Cumulative_Building_Height FROM (SELECT SPACE_DETAIL.*, SUM(ROOM_SQUARE_FOOTAGE) OVER (PARTITION BY BUILDING_COMPONENT) AS Total_Square_Footage FROM SPACE_DETAIL) sd JOIN FCLT_BUILDING fb ON fb.FCLT_BUILDING_KEY = sd.BUILDING_KEY JOIN SPACE_FLOOR sf ON sd.FLOOR_KEY = sf.FLOOR_KEY JOIN SPACE_UNIT su ON sd.SPACE_UNIT_KEY = su.SPACE_UNIT_KEY JOIN SPACE_SUPERVISOR_USAGE ssu ON su.DLC_KEY = ssu.DEPT_NAMES JOIN (SELECT DISTINCT DLC_KEY, DLC_NAME FROM FCLT_ORGANIZATION) fo ON fo.DLC_KEY = su.DLC_KEY GROUP BY su.DLC_KEY, fo.DLC_NAME, sd.Total_Square_Footage;",
    "res": 0
  },
  {
    "sql_idx": 22,
    "ground_truth": "SELECT tso.OFFER_DEPT_NAME, COUNT(distinct tso.SUBJECT_ID) AS Total_Subjects, SUM(tso.NUM_ENROLLED_STUDENTS) AS Total_Enrolled_Students, MIN(tm.RENTAL_NEW_PRICE) AS Min_Rental_New_Price, MAX(tm.RENTAL_NEW_PRICE) AS Max_Rental_New_Price FROM TIP_SUBJECT_OFFERED tso JOIN TIP_DETAIL td ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY GROUP BY tso.OFFER_DEPT_NAME;",
    "res": 0
  },
  {
    "sql_idx": 23,
    "ground_truth": "SELECT CC.ACADEMIC_YEAR, CC.TERM_CODE, SO.HGN_CODE, COUNT(DISTINCT CC.SUBJECT_ID) AS TOTAL_COURSES, AVG(CC.TOTAL_UNITS) AS AVERAGE_UNITS, CC.DEPARTMENT_NAME, ED.FULL_NAME AS RESPONSIBLE_FACULTY_NAME, ED.EMAIL_ADDRESS AS RESPONSIBLE_FACULTY_EMAIL FROM COURSE_CATALOG_SUBJECT_OFFERED CC JOIN SUBJECT_OFFERED SO ON CC.SUBJECT_ID = SO.SUBJECT_ID JOIN ACADEMIC_TERMS AT ON CC.TERM_CODE = AT.TERM_CODE JOIN EMPLOYEE_DIRECTORY ED ON SO.RESPONSIBLE_FACULTY_MIT_ID = ED.MIT_ID WHERE AT.IS_CURRENT_TERM = 'Y' GROUP BY CC.ACADEMIC_YEAR, CC.TERM_CODE, SO.HGN_CODE, CC.DEPARTMENT_NAME, ED.FULL_NAME, ED.EMAIL_ADDRESS;",
    "res": 0
  },
  {
    "sql_idx": 24,
    "ground_truth": "SELECT isd.ACTIVITY_TITLE, isc.IAP_CATEGORY_NAME, iss.SESSION_TITLE, iss.SESSION_START_TIME, iss.SESSION_END_TIME, isp.SPONSOR_NAME, COUNT(distinct iss.IAP_SUBJECT_SESSION_KEY) AS Total_Sessions FROM IAP_SUBJECT_DETAIL isd JOIN IAP_SUBJECT_CATEGORY isc ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY JOIN IAP_SUBJECT_SESSION iss ON isd.IAP_SUBJECT_SESSION_KEY = iss.IAP_SUBJECT_SESSION_KEY JOIN IAP_SUBJECT_SPONSOR isp ON isd.IAP_SUBJECT_SPONSOR_KEY = isp.IAP_SUBJECT_SPONSOR_KEY GROUP BY isd.ACTIVITY_TITLE, isc.IAP_CATEGORY_NAME, iss.SESSION_TITLE, iss.SESSION_START_TIME, iss.SESSION_END_TIME, isp.SPONSOR_NAME;",
    "res": 0
  },
  {
    "sql_idx": 25,
    "ground_truth": "SELECT sd.DEPARTMENT_NAME, sc.SUBJECT_CODE, sc.SUBJECT_CODE_DESC, scd.GRADUATE_LEVEL, Total_Courses.Total_Courses FROM SIS_DEPARTMENT sd JOIN SIS_COURSE_DESCRIPTION scd ON sd.DEPARTMENT_CODE = scd.DEPARTMENT JOIN SIS_SUBJECT_CODE sc ON scd.COURSE = sc.COURSE_NUMBER JOIN (SELECT sd.DEPARTMENT_NAME, COUNT(DISTINCT COURSE_NUMBER) AS Total_Courses FROM SIS_DEPARTMENT sd JOIN SIS_COURSE_DESCRIPTION scd ON sd.DEPARTMENT_CODE = scd.DEPARTMENT JOIN SIS_SUBJECT_CODE sc ON scd.COURSE = sc.COURSE_NUMBER GROUP BY DEPARTMENT_NAME) AS Total_Courses ON sd.DEPARTMENT_NAME = Total_Courses.DEPARTMENT_NAME;",
    "res": 0
  },
  {
    "sql_idx": 26,
    "ground_truth": "SELECT at.TERM_CODE, at.TERM_DESCRIPTION, at.IS_CURRENT_TERM2, COUNT(DISTINCT at.SUBJECT_ID) AS Total_SUBJECTS FROM (SELECT at.*, SUBJECT_ID, CASE WHEN at.ACADEMIC_YEAR = YEAR(CURDATE()) AND atp.IS_CURRENT_TERM = 'Y' THEN 'Y' ELSE 'N' END AS IS_CURRENT_TERM2 FROM (SELECT ACADEMIC_TERMS_ALL.*, CASE WHEN TERM_CODE LIKE '%FA' THEN 'Y' END AS A, CASE WHEN TERM_CODE LIKE '%JA' THEN 'Y' END AS B, CASE WHEN TERM_CODE LIKE '%SP' THEN 'Y' END AS C, CASE WHEN TERM_CODE LIKE '%SU' THEN 'Y' END AS D FROM ACADEMIC_TERMS_ALL) at LEFT OUTER JOIN ACADEMIC_TERM_PARAMETER atp ON at.TERM_CODE = atp.TERM_CODE LEFT OUTER JOIN CIS_COURSE_CATALOG ccc ON ccc.ACADEMIC_YEAR = at.ACADEMIC_YEAR AND (IS_OFFERED_FALL_TERM = at.A OR IS_OFFERED_IAP = at.B OR IS_OFFERED_SPRING_TERM = at.C OR IS_OFFERED_SUMMER_TERM = at.D)) at GROUP BY at.TERM_CODE, at.TERM_DESCRIPTION, at.IS_CURRENT_TERM2;",
    "res": 0
  },
  {
    "sql_idx": 27,
    "ground_truth": "SELECT tm.AUTHOR, sd.SCHOOL_NAME, tms.TIP_MATERIAL_STATUS, SUM(td.RECORD_COUNT) AS Total_Record_Count , COUNT(distinct td.SUBJECT_ID) AS Total_Subject FROM TIP_DETAIL td JOIN (select TIP_MATERIAL_KEY, CASE WHEN INSTR(AUTHOR, ';') > 0 THEN SUBSTR(AUTHOR, 1, INSTR(AUTHOR, ';') - 1) ELSE AUTHOR END AS AUTHOR FROM TIP_MATERIAL) tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY JOIN TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY JOIN STUDENT_DEPARTMENT sd ON tso.OFFER_DEPT_CODE = sd.DEPARTMENT_CODE GROUP BY tm.AUTHOR, tms.TIP_MATERIAL_STATUS, sd.SCHOOL_NAME;",
    "res": 0
  },
  {
    "sql_idx": 28,
    "ground_truth": "SELECT tso.COURSE_NUMBER, tso.SUBJECT_TITLE, tms.TIP_MATERIAL_STATUS, SUM(tm.NEW_SHELF_PRICE) as Total_New_Price, Min(tm.NEW_SHELF_PRICE) as Min_New_Price, Max(tm.NEW_SHELF_PRICE) as Max_New_Price, SUM(tm.USED_SHELF_PRICE) as Total_Used_Price, Min(tm.USED_SHELF_PRICE) as Min_Used_Price, Max(tm.USED_SHELF_PRICE) as Max_Used_Price, COUNT(DISTINCT OFFER_SCHOOL_NAME) AS Total_Num_Schools, COUNT(distinct td.TIP_MATERIAL_KEY) AS Total_Num_Materials FROM TIP_DETAIL td JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY JOIN TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY GROUP BY tso.COURSE_NUMBER, tso.SUBJECT_TITLE, tms.TIP_MATERIAL_STATUS;",
    "res": 1
  },
  {
    "sql_idx": 29,
    "ground_truth": "SELECT tms.TIP_MATERIAL_STATUS, COUNT(DISTINCT td.TIP_MATERIAL_KEY) AS Total_Materials, COUNT(DISTINCT td.SUBJECT_ID) AS Total_Subjects, COUNT(DISTINCT sd.SCHOOL_NAME) AS Total_Num_Schools, MAX(tm.YEAR) AS Most_Recent_Year FROM TIP_DETAIL td JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY JOIN TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY JOIN STUDENT_DEPARTMENT sd ON tso.OFFER_DEPT_CODE = sd.DEPARTMENT_CODE GROUP BY tms.TIP_MATERIAL_STATUS;",
    "res": 1
  },
  {
    "sql_idx": 30,
    "ground_truth": "SELECT at.TERM_DESCRIPTION, at.IS_CURRENT_TERM, COUNT(DISTINCT tso.COURSE_NUMBER) AS Total_Courses, COUNT(DISTINCT tm.ISBN) AS Total_Materials, MIN(tso.NUM_ENROLLED_STUDENTS) AS Min_Enrolled_Students, MAX(tso.NUM_ENROLLED_STUDENTS) AS Max_Enrolled_Students, COUNT(DISTINCT OFFER_SCHOOL_NAME) AS Total_Num_Schools, SUM(td.RECORD_COUNT) AS Total_Records FROM ACADEMIC_TERMS_ALL at LEFT OUTER JOIN TIP_SUBJECT_OFFERED tso ON at.TERM_CODE = tso.TERM_CODE JOIN TIP_DETAIL td ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY GROUP BY at.TERM_CODE, at.TERM_DESCRIPTION, at.IS_CURRENT_TERM;",
    "res": 1
  },
  {
    "sql_idx": 31,
    "ground_truth": "SELECT DISTINCT new.BUILDING_NAME, new.BUILDING_NUMBER, fb.BUILDING_HEIGHT, new.BUILDING_STREET_ADDRESS, fba.CITY, fba.STATE, new.HR_DEPARTMENT_NAME, new.BLDG_ASSIGNABLE_SQUARE_FOOTAGE, new.Total_Square_Footage, new.Avg_Square_Footage_Per_Room FROM (SELECT b.BUILDING_NAME, b.BUILDING_NUMBER, b.BUILDING_STREET_ADDRESS, fb.FAC_BUILDING_KEY, fo.HR_DEPARTMENT_NAME, b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE, SUM(fr.AREA) AS Total_Square_Footage, AVG(fr.AREA) AS Avg_Square_Footage_Per_Room FROM BUILDINGS b JOIN FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY JOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY JOIN FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY GROUP BY b.BUILDING_NAME, b.BUILDING_NUMBER, b.BUILDING_STREET_ADDRESS, fb.FAC_BUILDING_KEY, fo.HR_DEPARTMENT_NAME, b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) new JOIN FAC_BUILDING_ADDRESS fba ON new.FAC_BUILDING_KEY = fba.BUILDING_KEY JOIN FAC_BUILDING fb ON new.FAC_BUILDING_KEY = fb.FAC_BUILDING_KEY WHERE fba.ADDRESS_PURPOSE = 'STREET' ORDER BY new.BLDG_ASSIGNABLE_SQUARE_FOOTAGE DESC, new.Total_Square_Footage DESC, new.Avg_Square_Footage_Per_Room DESC;",
    "res": 0
  },
  {
    "sql_idx": 32,
    "ground_truth": "WITH SubjectCounts AS (SELECT TERM_CODE, FALL_INSTRUCTORS, SUBJECT_ID, COUNT(*) OVER (PARTITION BY TERM_CODE) AS Total_Subjects, COUNT(*) OVER (PARTITION BY FALL_INSTRUCTORS) AS Experience FROM COURSE_CATALOG_SUBJECT_OFFERED WHERE TERM_CODE = '2023FA') SELECT DISTINCT at.TERM_DESCRIPTION, ccso.SUBJECT_TITLE, ccso.PREREQUISITES, sc.Total_Subjects, ccso.FALL_INSTRUCTORS, sc.Experience FROM COURSE_CATALOG_SUBJECT_OFFERED ccso JOIN ACADEMIC_TERMS at ON ccso.TERM_CODE = at.TERM_CODE JOIN SubjectCounts sc ON ccso.TERM_CODE = sc.TERM_CODE AND ccso.SUBJECT_ID = sc.SUBJECT_ID WHERE ccso.TERM_CODE = '2023FA';",
    "res": 0
  },
  {
    "sql_idx": 33,
    "ground_truth": "SELECT fr.ROOM_FULL_NAME, fb.BUILDING_NAME, ff.FLOOR, fo.ORGANIZATION_NAME, fo.HR_DEPARTMENT_NAME, CASE WHEN ff.ASSIGNABLE_AREA = 0 THEN 0 ELSE fr.AREA/ff.ASSIGNABLE_AREA END AS PERC_OF_ASG_FLOOR, CASE WHEN fb.ASSIGNABLE_AREA = 0 THEN 0 ELSE fr.AREA/fb.ASSIGNABLE_AREA END AS PERC_OF_ASG_BUILDING FROM FAC_ROOMS fr JOIN FAC_BUILDING fb ON fr.BUILDING_KEY = fb.FAC_BUILDING_KEY JOIN FAC_FLOOR ff ON fr.FLOOR_KEY = ff.FLOOR_KEY JOIN FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY;",
    "res": 0
  },
  {
    "sql_idx": 34,
    "ground_truth": "SELECT fr.ROOM_FULL_NAME, fb.BUILDING_NAME, ff.FLOOR, fo.ORGANIZATION_NAME, fo.HR_DEPARTMENT_NAME, CASE WHEN FLOOR_AREA = 0 THEN 0 ELSE fr.AREA/FLOOR_AREA END AS PERC_OF_FLOOR, CASE WHEN BUILDING_AREA = 0 THEN 0 ELSE fr.AREA/BUILDING_AREA END AS PERC_OF_BUILDING FROM (SELECT ROOM_FULL_NAME, BUILDING_KEY, FLOOR_KEY,ORGANIZATION_KEY, AREA, SUM(AREA) OVER (PARTITION BY FLOOR_KEY) AS FLOOR_AREA, SUM(AREA) OVER (PARTITION BY BUILDING_KEY) AS BUILDING_AREA FROM FAC_ROOMS) fr JOIN FAC_BUILDING fb ON fr.BUILDING_KEY = fb.FAC_BUILDING_KEY JOIN FAC_FLOOR ff ON fr.FLOOR_KEY = ff.FLOOR_KEY JOIN FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY;",
    "res": 0
  },
  {
    "sql_idx": 35,
    "ground_truth": "SELECT ata.ACADEMIC_YEAR, ed.FULL_NAME, COUNT(distinct so.COURSE_NUMBER) AS Total_Courses FROM SUBJECT_OFFERED so JOIN ACADEMIC_TERMS_ALL ata ON so.TERM_CODE = ata.TERM_CODE JOIN EMPLOYEE_DIRECTORY ed ON so.RESPONSIBLE_FACULTY_MIT_ID = ed.MIT_ID WHERE ata.ACADEMIC_YEAR = 2022 GROUP BY ata.ACADEMIC_YEAR, ed.FULL_NAME;",
    "res": 1
  },
  {
    "sql_idx": 36,
    "ground_truth": "SELECT fb.BUILDING_NAME, fo.HR_DEPARTMENT_NAME, fo.ORGANIZATION, MAX(ff.LEVEL_ID) as MAX_FLOOR, MIN(ff.LEVEL_ID) as MIN_FLOOR, COUNT(distinct fr.FAC_ROOM_KEY) AS Total_Rooms FROM FAC_BUILDING fb JOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY JOIN FAC_FLOOR ff ON fr.FLOOR_KEY = ff.FLOOR_KEY JOIN FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY GROUP BY fb.FAC_BUILDING_KEY, fb.BUILDING_NAME, fo.HR_DEPARTMENT_NAME, fo.ORGANIZATION;",
    "res": 0
  },
  {
    "sql_idx": 37,
    "ground_truth": "SELECT DISTINCT msd.FULL_NAME, msd.EMAIL_ADDRESS, sd.DEPARTMENT_NAME, sad.DEPARTMENT_PHONE_NUMBER, sd.SCHOOL_NAME, (SELECT COUNT(DISTINCT msd2.EMAIL_ADDRESS) FROM MIT_STUDENT_DIRECTORY msd2 JOIN SIS_DEPARTMENT sd2 ON msd2.DEPARTMENT = sd2.DEPARTMENT_CODE WHERE sd2.DEPARTMENT_CODE = sd.DEPARTMENT_CODE) AS Total_Students_DEPT, (SELECT COUNT(DISTINCT msd3.EMAIL_ADDRESS) FROM MIT_STUDENT_DIRECTORY msd3 JOIN SIS_DEPARTMENT sd3 ON msd3.DEPARTMENT = sd3.DEPARTMENT_CODE WHERE sd3.SCHOOL_CODE = sd.SCHOOL_CODE) AS Total_Students_SCHOOL FROM MIT_STUDENT_DIRECTORY msd JOIN SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE JOIN SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE WHERE msd.FIRST_NAME = 'Kevin';",
    "res": 0
  },
  {
    "sql_idx": 38,
    "ground_truth": "SELECT ccso.SUBJECT_TITLE, e.FULL_NAME AS INSTRUCTOR, e.EMAIL_ADDRESS, Total_Subjects.Total_Subjects FROM EMPLOYEE_DIRECTORY e JOIN COURSE_CATALOG_SUBJECT_OFFERED ccso ON ccso.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID JOIN ACADEMIC_TERMS_ALL at ON ccso.TERM_CODE = at.TERM_CODE JOIN (SELECT ccso.RESPONSIBLE_FACULTY_MIT_ID, COUNT(DISTINCT ccso.SUBJECT_ID) AS Total_Subjects FROM COURSE_CATALOG_SUBJECT_OFFERED ccso JOIN ACADEMIC_TERMS_ALL at ON ccso.TERM_CODE = at.TERM_CODE WHERE at.TERM_CODE LIKE '%FA' GROUP BY ccso.RESPONSIBLE_FACULTY_MIT_ID) AS Total_Subjects ON e.MIT_ID = Total_Subjects.RESPONSIBLE_FACULTY_MIT_ID WHERE at.TERM_CODE LIKE '%FA' GROUP BY ccso.SUBJECT_TITLE, e.FULL_NAME, e.EMAIL_ADDRESS, Total_Subjects.Total_Subjects;",
    "res": 0
  },
  {
    "sql_idx": 39,
    "ground_truth": "SELECT b.BUILDING_NAME, fo.HR_DEPARTMENT_NAME, SUM(b.BLDG_GROSS_SQUARE_FOOTAGE) AS Total_Gross_Sq_Ft, SUM(b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS Total_Assignable_Sq_Ft, AVG(b.BLDG_ASSIGNABLE_SQUARE_FOOTAGE) AS Avg_Assignable_Sq_Ft, YEAR(STR_TO_DATE(fb.DATE_BUILT, '%m/%d/%Y')) AS Year_Built FROM BUILDINGS b JOIN FAC_BUILDING fb ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY JOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY JOIN FAC_ORGANIZATION fo ON fr.ORGANIZATION_KEY = fo.ORGANIZATION_KEY GROUP BY b.BUILDING_KEY, b.BUILDING_NAME, fo.HR_DEPARTMENT_NAME, fb.DATE_BUILT;",
    "res": 0
  },
  {
    "sql_idx": 40,
    "ground_truth": "SELECT ccso.SUBJECT_TITLE, ccso.SUBJECT_DESCRIPTION, ccso.RESPONSIBLE_FACULTY_NAME, ed.EMAIL_ADDRESS, b.BUILDING_NAME, fr.ROOM_FULL_NAME, ff.LEVEL_ID, b.BUILDING_STREET_ADDRESS, (SELECT COUNT(DISTINCT ccso2.SUBJECT_ID) FROM COURSE_CATALOG_SUBJECT_OFFERED ccso2 WHERE ccso2.DEPARTMENT_CODE = ccso.DEPARTMENT_CODE) AS Total_Courses FROM COURSE_CATALOG_SUBJECT_OFFERED ccso JOIN EMPLOYEE_DIRECTORY ed ON ccso.RESPONSIBLE_FACULTY_MIT_ID = ed.MIT_ID JOIN ACADEMIC_TERMS at ON ccso.TERM_CODE = at.TERM_CODE JOIN FAC_ROOMS fr ON ccso.MEET_PLACE = fr.FAC_ROOM_KEY JOIN FAC_FLOOR ff ON ff.FLOOR_KEY = fr.FLOOR_KEY JOIN BUILDINGS b ON fr.BUILDING_KEY = b.BUILDING_KEY JOIN FAC_BUILDING_ADDRESS fba ON fba.BUILDING_KEY = fr.BUILDING_KEY WHERE at.TERM_CODE LIKE '%SU' AND fba.ADDRESS_PURPOSE = 'STREET';",
    "res": 0
  },
  {
    "sql_idx": 41,
    "ground_truth": "SELECT ata.TERM_DESCRIPTION, ccso.HASS_ATTRIBUTE_DESC, sd.DEPARTMENT_NAME, sd.SCHOOL_NAME, (SELECT COUNT(DISTINCT ccso2.SUBJECT_ID) FROM COURSE_CATALOG_SUBJECT_OFFERED ccso2 JOIN CIS_HASS_ATTRIBUTE cha2 ON ccso2.HASS_ATTRIBUTE = cha2.HASS_ATTRIBUTE WHERE ccso2.TERM_CODE = ata.TERM_CODE AND cha2.CIS_ATTRIBUTE_GROUP = cha.CIS_ATTRIBUTE_GROUP) AS Total_Subjects FROM COURSE_CATALOG_SUBJECT_OFFERED ccso JOIN CIS_HASS_ATTRIBUTE cha ON ccso.HASS_ATTRIBUTE = cha.HASS_ATTRIBUTE JOIN SIS_DEPARTMENT sd ON ccso.DEPARTMENT_CODE = sd.DEPARTMENT_CODE JOIN ACADEMIC_TERMS_ALL ata ON ccso.TERM_CODE = ata.TERM_CODE WHERE cha.CIS_ATTRIBUTE_GROUP = 'H';",
    "res": 0
  },
  {
    "sql_idx": 42,
    "ground_truth": "SELECT fb.BUILDING_NAME, fb.BUILDING_HEIGHT, b.BUILDING_STREET_ADDRESS, fba.CITY, fba.STATE, fba.POSTAL_CODE, fb.EXT_GROSS_AREA, fb.ASSIGNABLE_AREA, MIN(ff.LEVEL_ID) as SMALLEST_FLOOR, MAX(LEVEL_ID) AS HIGHEST_FLOOR, SUM(fr.AREA) AS Total_Room_Area FROM FAC_BUILDING fb JOIN FAC_BUILDING_ADDRESS fba ON fb.FAC_BUILDING_KEY = fba.BUILDING_KEY JOIN FAC_FLOOR ff ON fb.FAC_BUILDING_KEY = ff.BUILDING_KEY JOIN FAC_ROOMS fr ON ff.FLOOR_KEY = fr.FLOOR_KEY JOIN BUILDINGS b ON b.BUILDING_KEY = fb.FAC_BUILDING_KEY WHERE fba.ADDRESS_PURPOSE = 'STREET' GROUP BY fb.FAC_BUILDING_KEY, fb.BUILDING_NAME, fb.BUILDING_HEIGHT, fba.CITY, fba.POSTAL_CODE, fba.STATE, b.BUILDING_STREET_ADDRESS, fb.EXT_GROSS_AREA, fb.ASSIGNABLE_AREA;",
    "res": 0
  },
  {
    "sql_idx": 43,
    "ground_truth": "SELECT c.CATEGORY_TITLE, c.VERSION, sd.DEPARTMENT_NAME, sd.SCHOOL_NAME, SUM(CASE WHEN scd.COURSE_LEVEL = 'U' THEN 1 ELSE 0 END) AS Total_U_Courses, SUM(CASE WHEN scd.COURSE_LEVEL = 'G' THEN 1 ELSE 0 END) AS Total_G_Courses, SUM(CASE WHEN scd.IS_DEGREE_GRANTING = 'Y' THEN 1 ELSE 0 END) AS Total_Degree_Granting_Courses FROM CIP c JOIN SIS_COURSE_DESCRIPTION scd ON c.PROGRAM_CODE = scd.CIP_PROGRAM_CODE JOIN SIS_DEPARTMENT sd ON scd.DEPARTMENT = sd.DEPARTMENT_CODE GROUP BY c.CATEGORY_CODE, c.CATEGORY_TITLE, c.VERSION, sd.DEPARTMENT_NAME, sd.SCHOOL_NAME;",
    "res": 0
  },
  {
    "sql_idx": 44,
    "ground_truth": "SELECT COUNT(distinct lrc.CATALOG_SYSTEM_NUMBER) AS Total_Materials, MIN(lrc.CATALOG_YEAR) AS Min_Publication_Year, MAX(lrc.CATALOG_YEAR) AS Max_Publication_Year, COUNT(DISTINCT lms.LIBRARY_MATERIAL_STATUS) AS Total_Statuses FROM LIBRARY_COURSE_INSTRUCTOR lci JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrmd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY JOIN LIBRARY_MATERIAL_STATUS lms ON lrmd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY GROUP BY lci.COURSE_NAME;",
    "res": 0
  },
  {
    "sql_idx": 45,
    "ground_truth": "SELECT COUNT(distinct lrc.CATALOG_SYSTEM_NUMBER) AS Total_Materials, MIN(lrc.CATALOG_YEAR) AS Min_Publication_Year, MAX(lrc.CATALOG_YEAR) AS Max_Publication_Year, SUM(lso.NUM_ENROLLED_STUDENTS) AS Total_Enrolled_Students FROM LIBRARY_COURSE_INSTRUCTOR lci JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrmd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY JOIN LIBRARY_SUBJECT_OFFERED lso ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY GROUP BY lci.INSTRUCTOR_NAME;",
    "res": 0
  },
  {
    "sql_idx": 46,
    "ground_truth": "SELECT lms.LIBRARY_MATERIAL_STATUS, ata.TERM_DESCRIPTION, COUNT(DISTINCT lso.COURSE_NUMBER) AS Total_Courses, COUNT(DISTINCT lrc.CATALOG_SYSTEM_NUMBER) AS Total_Materials, COUNT(DISTINCT lso.OFFER_DEPT_CODE), COUNT(DISTINCT lso.OFFER_SCHOOL_NAME), COUNT(DISTINCT lci.INSTRUCTOR_NAME) AS Total_Instructors FROM LIBRARY_MATERIAL_STATUS lms JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lms.LIBRARY_MATERIAL_STATUS_KEY = lrmd.LIBRARY_MATERIAL_STATUS_KEY JOIN LIBRARY_SUBJECT_OFFERED lso ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY JOIN LIBRARY_COURSE_INSTRUCTOR lci ON lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY = lci.LIBRARY_COURSE_INSTRUCTOR_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrmd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY JOIN ACADEMIC_TERMS_ALL ata ON ata.TERM_CODE = lso.TERM_CODE GROUP BY lms.LIBRARY_MATERIAL_STATUS_CODE, lms.LIBRARY_MATERIAL_STATUS, lso.TERM_CODE, ata.TERM_DESCRIPTION;",
    "res": 0
  },
  {
    "sql_idx": 47,
    "ground_truth": "SELECT DISTINCT su.SPACE_UNIT, sf.FLOOR, b.BUILDING_NAME, b.BUILDING_STREET_ADDRESS, su2.SPACE_USAGE, (SELECT COUNT(DISTINCT fo2.FCLT_ORGANIZATION_KEY) FROM SPACE_UNIT su2 JOIN SPACE_DETAIL sd2 ON su2.SPACE_UNIT_KEY = sd2.SPACE_UNIT_KEY JOIN FCLT_ORGANIZATION fo2 ON fo2.FCLT_ORGANIZATION_KEY = su2.FCLT_ORGANIZATION_KEY WHERE sd2.FLOOR_KEY = sd.FLOOR_KEY AND sd2.BUILDING_KEY = sd.BUILDING_KEY) AS Total_Organizations, (SELECT COUNT(DISTINCT su3.SPACE_UNIT) FROM SPACE_UNIT su3 JOIN SPACE_DETAIL sd3 ON su3.SPACE_UNIT_KEY = sd3.SPACE_UNIT_KEY WHERE sd3.FLOOR_KEY = sd.FLOOR_KEY AND sd3.BUILDING_KEY = sd.BUILDING_KEY) AS Total_Space_Units FROM SPACE_UNIT su JOIN SPACE_DETAIL sd ON su.SPACE_UNIT_KEY = sd.SPACE_UNIT_KEY JOIN SPACE_USAGE su2 ON su2.SPACE_USAGE_KEY = sd.SPACE_USAGE_KEY JOIN SPACE_FLOOR sf ON sd.FLOOR_KEY = sf.FLOOR_KEY JOIN BUILDINGS b ON b.BUILDING_KEY = sd.BUILDING_KEY JOIN FCLT_ORGANIZATION fo ON fo.FCLT_ORGANIZATION_KEY = su.FCLT_ORGANIZATION_KEY JOIN FCLT_BUILDING_ADDRESS fba ON fba.FCLT_BUILDING_KEY = b.BUILDING_KEY WHERE fba.ADDRESS_PURPOSE = 'STREET' AND b.BUILDING_NUMBER = 36;",
    "res": 0
  },
  {
    "sql_idx": 48,
    "ground_truth": "SELECT ml.MOIRA_LIST_NAME, ml.IS_MOIRA_MAILING_LIST, ml.IS_MOIRA_GROUP, ml.IS_NFS_GROUP, mlo.OWNER, member_counts.occurrences FROM MOIRA_LIST_DETAIL mld JOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY JOIN MOIRA_LIST_OWNER mlo ON mld.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY JOIN ( SELECT mld.MOIRA_LIST_KEY, COUNT(mld.MOIRA_LIST_MEMBER) AS occurrences FROM MOIRA_LIST_DETAIL mld GROUP BY mld.MOIRA_LIST_KEY HAVING COUNT(mld.MOIRA_LIST_MEMBER) > 1000 ) member_counts ON ml.MOIRA_LIST_KEY = member_counts.MOIRA_LIST_KEY WHERE upper(ml.MOIRA_LIST_NAME) LIKE 'A%';",
    "res": 0
  },
  {
    "sql_idx": 49,
    "ground_truth": "WITH Occurrences AS ( SELECT mld.MOIRA_LIST_KEY, mld.MOIRA_LIST_OWNER_KEY, COUNT(mld.MOIRA_LIST_MEMBER) AS occurrences FROM MOIRA_LIST_DETAIL mld GROUP BY mld.MOIRA_LIST_KEY,mld.MOIRA_LIST_OWNER_KEY ) SELECT DISTINCT ml.MOIRA_LIST_NAME, mlo.OWNER, ml.IS_PUBLIC, ml.IS_HIDDEN, o.occurrences FROM Occurrences o JOIN MOIRA_LIST ml ON o.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY JOIN MOIRA_LIST_OWNER mlo ON O.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY WHERE o.occurrences = (SELECT MIN(occurrences) FROM Occurrences) OR o.occurrences = (SELECT MAX(occurrences) FROM Occurrences);",
    "res": 0
  },
  {
    "sql_idx": 50,
    "ground_truth": "WITH FilteredLists AS ( SELECT ml.MOIRA_LIST_KEY, ml.MOIRA_LIST_NAME FROM MOIRA_LIST ml WHERE upper(ml.MOIRA_LIST_NAME) LIKE 'C%' ) SELECT DISTINCT fl.MOIRA_LIST_NAME AS Moira_List_Name, COUNT(mld.MOIRA_LIST_MEMBER) AS Member_Count, COUNT(DISTINCT ed.MIT_ID) AS Distinct_Faculty_Count FROM COURSE_CATALOG_SUBJECT_OFFERED ccso JOIN EMPLOYEE_DIRECTORY ed ON ccso.RESPONSIBLE_FACULTY_MIT_ID = ed.MIT_ID JOIN MOIRA_LIST_DETAIL mld ON UPPER(ed.KRB_NAME) = UPPER(mld.MOIRA_LIST_MEMBER) JOIN FilteredLists fl ON mld.MOIRA_LIST_KEY = fl.MOIRA_LIST_KEY JOIN ACADEMIC_TERMS at ON ccso.TERM_CODE = at.TERM_CODE WHERE at.TERM_CODE LIKE '%SU' AND CAST(at.FINANCIAL_AID_YEAR AS UNSIGNED) > 2001 GROUP BY fl.MOIRA_LIST_NAME;",
    "res": 0
  },
  {
    "sql_idx": 51,
    "ground_truth": "SELECT COUNT(DISTINCT se.MIT_ID) AS Student_Count, COUNT(DISTINCT sd.DEPARTMENT_CODE) AS Department_Count, COUNT(DISTINCT sd.SCHOOL_CODE) AS School_Count FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN SE_PERSON se ON upper(mld.MOIRA_LIST_MEMBER) = upper(se.KRB_NAME) JOIN MIT_STUDENT_DIRECTORY msd ON msd.FULL_NAME = se.FULL_NAME JOIN SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE WHERE ml.MOIRA_LIST_NAME = 'candle-duo-users'",
    "res": 1
  },
  {
    "sql_idx": 52,
    "ground_truth": "WITH filtered_lists AS ( SELECT mld.MOIRA_LIST_KEY FROM MOIRA_LIST_DETAIL mld GROUP BY mld.MOIRA_LIST_KEY HAVING COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) = 10 ), instructor_courses AS ( SELECT fl.MOIRA_LIST_KEY, ccso.RESPONSIBLE_FACULTY_MIT_ID, COUNT(DISTINCT ccso.SUBJECT_TITLE) AS course_count FROM filtered_lists fl JOIN MOIRA_LIST_DETAIL mld ON fl.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN employee_directory ed ON UPPER(mld.MOIRA_LIST_MEMBER) = UPPER(ed.KRB_NAME) JOIN COURSE_CATALOG_SUBJECT_OFFERED ccso ON ed.MIT_ID = ccso.RESPONSIBLE_FACULTY_MIT_ID WHERE ccso.TERM_CODE = '2023FA' GROUP BY fl.MOIRA_LIST_KEY, ccso.RESPONSIBLE_FACULTY_MIT_ID ), instructor_counts AS ( SELECT MOIRA_LIST_KEY, COUNT(DISTINCT RESPONSIBLE_FACULTY_MIT_ID) AS instructor_count, SUM(course_count) AS total_courses FROM instructor_courses GROUP BY MOIRA_LIST_KEY ) SELECT ml.MOIRA_LIST_NAME, ic.instructor_count, ic.total_courses FROM instructor_counts ic JOIN MOIRA_LIST ml ON ic.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY WHERE ic.instructor_count > 0;",
    "res": 0
  },
  {
    "sql_idx": 53,
    "ground_truth": "WITH FilteredLists AS ( SELECT ml.MOIRA_LIST_KEY, ml.MOIRA_LIST_NAME, mld.MOIRA_LIST_MEMBER FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY WHERE ml.MOIRA_LIST_NAME='keeper-zephyr' ) SELECT fl.MOIRA_LIST_NAME, lci.INSTRUCTOR_NAME, MIN(lrc.CATALOG_YEAR) AS Min_Publication_Year, MAX(lrc.CATALOG_YEAR) AS Max_Publication_Year, SUM(lso.NUM_ENROLLED_STUDENTS) AS Total_Enrolled_Students FROM LIBRARY_COURSE_INSTRUCTOR lci JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrmd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY JOIN LIBRARY_SUBJECT_OFFERED lso ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY JOIN SE_PERSON se ON lci.INSTRUCTOR_NAME = se.FULL_NAME JOIN FilteredLists fl ON UPPER(se.KRB_NAME) = UPPER(fl.MOIRA_LIST_MEMBER) GROUP BY fl.MOIRA_LIST_NAME, lci.INSTRUCTOR_NAME;",
    "res": 0
  },
  {
    "sql_idx": 54,
    "ground_truth": "WITH FilteredLists AS ( SELECT DISTINCT ml.MOIRA_LIST_KEY, ml.MOIRA_LIST_NAME, ml.MOIRA_LIST_DESCRIPTION, mlo.OWNER FROM SE_PERSON se JOIN MOIRA_LIST_DETAIL mld ON UPPER(se.KRB_NAME) = UPPER(mld.MOIRA_LIST_MEMBER) JOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY JOIN MOIRA_LIST_OWNER mlo ON mld.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY WHERE se.FULL_NAME = 'Hopkins, Ayden' AND UPPER(ml.MOIRA_LIST_NAME) LIKE 'R%' ), MemberCounts AS ( SELECT fl.MOIRA_LIST_KEY, fl.MOIRA_LIST_NAME, fl.MOIRA_LIST_DESCRIPTION, fl.OWNER, COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS Member_Count FROM FilteredLists fl JOIN MOIRA_LIST_DETAIL mld ON fl.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY GROUP BY fl.MOIRA_LIST_KEY, fl.MOIRA_LIST_NAME, fl.MOIRA_LIST_DESCRIPTION, fl.OWNER ), FacultyTenuredCounts AS ( SELECT fl.MOIRA_LIST_KEY, COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS Faculty_Tenured_Count FROM FilteredLists fl JOIN MOIRA_LIST_DETAIL mld ON fl.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN SE_PERSON se ON UPPER(mld.MOIRA_LIST_MEMBER) = UPPER(se.KRB_NAME) WHERE se.PAYROLL_RANK = 'Faculty Tenured' GROUP BY fl.MOIRA_LIST_KEY ) SELECT DISTINCT mc.MOIRA_LIST_NAME, mc.MOIRA_LIST_DESCRIPTION, mc.OWNER, mc.Member_Count, COALESCE(ftc.Faculty_Tenured_Count, 0) AS Faculty_Tenured_Count FROM MemberCounts mc LEFT JOIN FacultyTenuredCounts ftc ON mc.MOIRA_LIST_KEY = ftc.MOIRA_LIST_KEY ORDER BY mc.Member_Count DESC;",
    "res": 0
  },
  {
    "sql_idx": 55,
    "ground_truth": "WITH FilteredList AS ( SELECT MOIRA_LIST_KEY, MOIRA_LIST_NAME FROM MOIRA_LIST WHERE MOIRA_LIST_NAME = 'date-destiny' ), FilteredListDetails AS ( SELECT mld.MOIRA_LIST_KEY, mld.MOIRA_LIST_MEMBER FROM MOIRA_LIST_DETAIL mld JOIN FilteredList fl ON mld.MOIRA_LIST_KEY = fl.MOIRA_LIST_KEY ) SELECT ml.MOIRA_LIST_NAME, COUNT(CASE WHEN UPPER(ad.SIS_ADMIN_DEPARTMENT_NAME) = 'MANAGEMENT' THEN 1 ELSE NULL END) AS MANAGEMENT_STUDENT_COUNT, ROUND( COUNT(CASE WHEN UPPER(ad.SIS_ADMIN_DEPARTMENT_NAME) = 'MANAGEMENT' THEN 1 ELSE NULL END) * 100.0 / COUNT(fld.MOIRA_LIST_MEMBER), 2 ) AS MANAGEMENT_STUDENT_PERCENTAGE FROM MIT_STUDENT_DIRECTORY msd JOIN SE_PERSON se ON msd.FULL_NAME = se.FULL_NAME JOIN FilteredListDetails fld ON UPPER(se.KRB_NAME) = UPPER(fld.MOIRA_LIST_MEMBER) JOIN FilteredList ml ON fld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY LEFT JOIN SIS_ADMIN_DEPARTMENT ad ON msd.DEPARTMENT = ad.SIS_ADMIN_DEPARTMENT_CODE GROUP BY ml.MOIRA_LIST_NAME;",
    "res": 0
  },
  {
    "sql_idx": 56,
    "ground_truth": "WITH FilteredMoiraLists AS ( SELECT MOIRA_LIST_KEY, MOIRA_LIST_NAME FROM MOIRA_LIST WHERE MOIRA_LIST_NAME LIKE 'a%' ), FilteredMoiraListDetails AS ( SELECT mld.MOIRA_LIST_MEMBER, mld.MOIRA_LIST_KEY FROM MOIRA_LIST_DETAIL mld JOIN FilteredMoiraLists fml ON mld.MOIRA_LIST_KEY = fml.MOIRA_LIST_KEY ), FloorsWithLevels AS ( SELECT fb.BUILDING_NAME, MAX(ff.LEVEL_ID) OVER (PARTITION BY ff.BUILDING_KEY) AS MAX_LEVEL, MIN(ff.LEVEL_ID) OVER (PARTITION BY ff.BUILDING_KEY) AS MIN_LEVEL FROM FAC_BUILDING fb JOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY JOIN FAC_FLOOR ff ON fr.FLOOR_KEY = ff.FLOOR_KEY ), FloorsPerBuilding AS ( SELECT BUILDING_NAME, MAX_LEVEL - MIN_LEVEL + 1 AS NUM_FLOORS FROM FloorsWithLevels GROUP BY BUILDING_NAME, MAX_LEVEL, MIN_LEVEL ), MaxFloors AS ( SELECT MAX(NUM_FLOORS) AS MAX_FLOORS FROM FloorsPerBuilding ), BuildingWithMostFloors AS ( SELECT a.BUILDING_NAME FROM FloorsPerBuilding a JOIN MaxFloors b ON a.NUM_FLOORS = b.MAX_FLOORS ), EmployeesInTallestBuildings AS ( SELECT DISTINCT UPPER(e.KRB_NAME) AS KRB_NAME, fb.building_name FROM BuildingWithMostFloors b JOIN FAC_BUILDING fb ON b.BUILDING_NAME = fb.BUILDING_NAME JOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY JOIN EMPLOYEE_DIRECTORY e ON e.OFFICE_LOCATION = fr.FAC_ROOM_KEY WHERE upper(e.KRB_NAME) LIKE 'C%' ) SELECT DISTINCT etb.BUILDING_NAME, fml.MOIRA_LIST_NAME FROM EmployeesInTallestBuildings etb JOIN FilteredMoiraListDetails fmld ON UPPER(etb.KRB_NAME) = UPPER(fmld.MOIRA_LIST_MEMBER) JOIN FilteredMoiraLists fml ON fmld.MOIRA_LIST_KEY = fml.MOIRA_LIST_KEY;",
    "res": 0
  },
  {
    "sql_idx": 57,
    "ground_truth": "SELECT DISTINCT ml.MOIRA_LIST_NAME, COUNT(ccso.SUBJECT_ID) AS course_count, COUNT(DISTINCT ccso.RESPONSIBLE_FACULTY_NAME) AS distinct_faculty_count FROM COURSE_CATALOG_SUBJECT_OFFERED CCSO JOIN EMPLOYEE_DIRECTORY E ON ccso.RESPONSIBLE_FACULTY_MIT_ID = E.MIT_ID JOIN MOIRA_LIST_DETAIL mld ON upper(e.KRB_NAME_UPPERCASE) = upper(mld.MOIRA_LIST_MEMBER) JOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY WHERE ccso.RESPONSIBLE_FACULTY_NAME LIKE 'Y%' GROUP BY ML.MOIRA_LIST_NAME",
    "res": 0
  },
  {
    "sql_idx": 58,
    "ground_truth": "WITH FilteredMoiraLists AS ( SELECT MOIRA_LIST_KEY, MOIRA_LIST_NAME FROM MOIRA_LIST WHERE MOIRA_LIST_NAME = 'beacon-date-date' ), FilteredMoiraListDetails AS ( SELECT mld.MOIRA_LIST_MEMBER, mld.MOIRA_LIST_KEY FROM MOIRA_LIST_DETAIL mld JOIN FilteredMoiraLists fml ON mld.MOIRA_LIST_KEY = fml.MOIRA_LIST_KEY ), MailingListSizes AS ( SELECT fml.MOIRA_LIST_KEY, fml.MOIRA_LIST_NAME, COUNT(fmld.MOIRA_LIST_MEMBER) AS List_Size FROM FilteredMoiraLists fml JOIN FilteredMoiraListDetails fmld ON fml.MOIRA_LIST_KEY = fmld.MOIRA_LIST_KEY GROUP BY fml.MOIRA_LIST_KEY, fml.MOIRA_LIST_NAME ) SELECT msd.FULL_NAME AS Student_Name, sad.DEPARTMENT_PHONE_NUMBER, MLS.List_Size AS List_Size FROM MIT_STUDENT_DIRECTORY msd JOIN SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE JOIN SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE JOIN SE_PERSON se ON msd.FULL_NAME = se.FULL_NAME JOIN FilteredMoiraListDetails fmld ON UPPER(se.KRB_NAME) = UPPER(fmld.MOIRA_LIST_MEMBER) JOIN FilteredMoiraLists fml ON fmld.MOIRA_LIST_KEY = fml.MOIRA_LIST_KEY JOIN MailingListSizes MLS ON fml.MOIRA_LIST_KEY = MLS.MOIRA_LIST_KEY WHERE msd.LAST_NAME LIKE 'H%';",
    "res": 0
  },
  {
    "sql_idx": 59,
    "ground_truth": "WITH DistinctLists AS ( SELECT ml.MOIRA_LIST_NAME, COUNT(DISTINCT se.MIT_ID) AS Member_Count FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN SE_PERSON se ON UPPER(mld.MOIRA_LIST_MEMBER) = UPPER(se.KRB_NAME) WHERE UPPER(ml.MOIRA_LIST_NAME) LIKE 'B%' AND se.ORGANIZATION = 'Electrical Engineering-Computer Science' GROUP BY ml.MOIRA_LIST_NAME ), Moira_List_With_Most_Members AS ( SELECT MOIRA_LIST_NAME, Member_Count FROM DistinctLists WHERE Member_Count = (SELECT MAX(Member_Count) FROM DistinctLists) ) SELECT COUNT(DISTINCT dl.MOIRA_LIST_NAME) AS Moira_Lists_Start_With_B, (SELECT MOIRA_LIST_NAME FROM Moira_List_With_Most_Members LIMIT 1) AS Moira_List_With_Most_Members, (SELECT Member_Count FROM Moira_List_With_Most_Members LIMIT 1) AS Most_Number_Of_Members FROM DistinctLists dl;",
    "res": 0
  },
  {
    "sql_idx": 60,
    "ground_truth": "WITH FilteredList AS ( SELECT MOIRA_LIST_KEY, MOIRA_LIST_NAME FROM MOIRA_LIST WHERE MOIRA_LIST_NAME = 'kangaroo-inspire-yearn' ), FilteredListDetails AS ( SELECT mld.MOIRA_LIST_KEY, mld.MOIRA_LIST_MEMBER FROM MOIRA_LIST_DETAIL mld JOIN FilteredList fl ON mld.MOIRA_LIST_KEY = fl.MOIRA_LIST_KEY ), DepartmentCounts AS ( SELECT ad.SIS_ADMIN_DEPARTMENT_NAME AS department_name, COUNT(DISTINCT fld.MOIRA_LIST_MEMBER) AS department_student_count FROM MIT_STUDENT_DIRECTORY msd JOIN SE_PERSON se ON msd.FULL_NAME = se.FULL_NAME JOIN FilteredListDetails fld ON UPPER(se.KRB_NAME) = UPPER(fld.MOIRA_LIST_MEMBER) LEFT JOIN SIS_ADMIN_DEPARTMENT ad ON msd.DEPARTMENT = ad.SIS_ADMIN_DEPARTMENT_CODE GROUP BY ad.SIS_ADMIN_DEPARTMENT_NAME ), TotalStudents AS ( SELECT COUNT(DISTINCT fld.MOIRA_LIST_MEMBER) AS total_students FROM FilteredListDetails fld ) SELECT dc.department_name, dc.department_student_count, ROUND( dc.department_student_count * 100.0 / ts.total_students, 2 ) AS department_student_percentage FROM DepartmentCounts dc, TotalStudents ts;",
    "res": 0
  },
  {
    "sql_idx": 61,
    "ground_truth": "WITH MailingListStats AS ( SELECT ml.MOIRA_LIST_NAME, COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS Total_Members FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN EMPLOYEE_DIRECTORY ed ON mld.MOIRA_LIST_MEMBER = ed.KRB_NAME WHERE ed.OFFICE_LOCATION LIKE '24%' GROUP BY ml.MOIRA_LIST_NAME ), Largest AS ( SELECT MOIRA_LIST_NAME, Total_Members, RANK() OVER (ORDER BY Total_Members DESC) AS Size_Rank FROM MailingListStats ) SELECT MAX(CASE WHEN Size_Rank = 1 THEN MOIRA_LIST_NAME END) AS Largest_Mailing_List, MAX(CASE WHEN Size_Rank = 1 THEN Total_Members END) AS Member_Count FROM Largest;",
    "res": 1
  },
  {
    "sql_idx": 62,
    "ground_truth": "SELECT ml.MOIRA_LIST_NAME, SUM(CASE WHEN se.EMPLOYEE_TYPE = 'Support Staff' THEN 1 ELSE 0 END) AS SUPPORT_COUNT, SUM(CASE WHEN se.EMPLOYEE_TYPE = 'Faculty' THEN 1 ELSE 0 END) AS FACULTY_COUNT, ml.IS_ACTIVE FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN SE_PERSON se ON upper(mld.MOIRA_LIST_MEMBER) = upper(se.KRB_NAME) WHERE se.EMPLOYEE_TYPE IN ('Support Staff', 'Faculty') GROUP BY ml.MOIRA_LIST_NAME, ml.IS_ACTIVE;",
    "res": 0
  },
  {
    "sql_idx": 63,
    "ground_truth": "WITH FilteredList AS ( SELECT MOIRA_LIST_KEY, MOIRA_LIST_NAME FROM MOIRA_LIST WHERE MOIRA_LIST_NAME = 'ocean-apple' ), FilteredListDetails AS ( SELECT mld.MOIRA_LIST_KEY, mld.MOIRA_LIST_MEMBER FROM MOIRA_LIST_DETAIL mld JOIN FilteredList fl ON mld.MOIRA_LIST_KEY = fl.MOIRA_LIST_KEY ), StudentMemberCounts AS ( SELECT fl.MOIRA_LIST_KEY, fl.MOIRA_LIST_NAME, ad.DEPARTMENT_PHONE_NUMBER AS department_phone, ad.SIS_ADMIN_DEPARTMENT_NAME AS department_name, COUNT(DISTINCT msd.FULL_NAME) AS student_members FROM FilteredList fl JOIN FilteredListDetails fld ON fl.MOIRA_LIST_KEY = fld.MOIRA_LIST_KEY JOIN SE_PERSON se ON UPPER(fld.MOIRA_LIST_MEMBER) = UPPER(se.KRB_NAME) JOIN MIT_STUDENT_DIRECTORY msd ON se.FULL_NAME = msd.FULL_NAME LEFT JOIN SIS_ADMIN_DEPARTMENT ad ON msd.DEPARTMENT = ad.SIS_ADMIN_DEPARTMENT_CODE GROUP BY fl.MOIRA_LIST_KEY, fl.MOIRA_LIST_NAME, ad.DEPARTMENT_PHONE_NUMBER, ad.SIS_ADMIN_DEPARTMENT_NAME ), RankedDepartments AS ( SELECT department_name, department_phone, SUM(student_members) AS total_student_members, RANK() OVER (ORDER BY SUM(student_members) DESC) AS department_rank FROM StudentMemberCounts GROUP BY department_name, department_phone ) SELECT department_name AS most_prominent_dpt, department_phone AS most_prominent_dpt_phone, total_student_members FROM RankedDepartments WHERE department_rank = 1;",
    "res": 0
  },
  {
    "sql_idx": 64,
    "ground_truth": "WITH MemberVisibility AS ( SELECT mo.OWNER, mo.OWNER_TYPE, ml.MOIRA_LIST_NAME, CASE WHEN ml.IS_PUBLIC = 'Y' THEN 'Public Members' WHEN ml.IS_PUBLIC = 'N' THEN 'Hidden Members' ELSE NULL END AS member_visibility, COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS total_members FROM MOIRA_LIST_DETAIL mld JOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY JOIN MOIRA_LIST_OWNER mo ON mld.MOIRA_LIST_OWNER_KEY = mo.MOIRA_LIST_OWNER_KEY WHERE ml.IS_MOIRA_GROUP = 'Y' AND upper(ml.MOIRA_LIST_NAME) LIKE 'B%' GROUP BY mo.OWNER, mo.OWNER_TYPE, ml.MOIRA_LIST_NAME, ml.IS_PUBLIC ), RollupResults AS ( SELECT MOIRA_LIST_NAME, member_visibility, SUM(total_members) AS total_members FROM MemberVisibility GROUP BY MOIRA_LIST_NAME, member_visibility WITH ROLLUP HAVING SUM(total_members) > 0 ) SELECT rr.MOIRA_LIST_NAME, mv.OWNER, mv.OWNER_TYPE, rr.member_visibility, rr.total_members FROM RollupResults rr LEFT JOIN (SELECT DISTINCT MOIRA_LIST_NAME, OWNER, OWNER_TYPE FROM MemberVisibility) mv ON rr.MOIRA_LIST_NAME = mv.MOIRA_LIST_NAME ORDER BY rr.MOIRA_LIST_NAME, rr.member_visibility;",
    "res": 0
  },
  {
    "sql_idx": 65,
    "ground_truth": "WITH EnrollmentWithAnalytics AS ( SELECT sos.SUBJECT_ID, sos.SUBJECT_TITLE, sos.OFFER_DEPT_NAME AS DEPARTMENT, sos.CLUSTER_TYPE, sos.NUM_ENROLLED_STUDENTS, AVG(sos.NUM_ENROLLED_STUDENTS) OVER (PARTITION BY sos.CLUSTER_TYPE) AS avg_enrollment_in_cluster, scd.COURSE_LEVEL FROM SUBJECT_OFFERED_SUMMARY sos LEFT JOIN SIS_COURSE_DESCRIPTION scd ON sos.COURSE_NUMBER = scd.COURSE WHERE sos.OFFER_DEPT_NAME = 'Biology' ), EnrollmentWithTIP AS ( SELECT ewa.SUBJECT_ID, ewa.SUBJECT_TITLE, ewa.DEPARTMENT, ewa.CLUSTER_TYPE, ewa.NUM_ENROLLED_STUDENTS, ewa.avg_enrollment_in_cluster, ewa.COURSE_LEVEL, tm.TITLE AS material_title, tm.NEW_SHELF_PRICE, tm.USED_SHELF_PRICE, td.RECORD_COUNT AS material_record_count FROM EnrollmentWithAnalytics ewa LEFT JOIN TIP_DETAIL td ON ewa.SUBJECT_ID = td.SUBJECT_ID LEFT JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY ), EnrollmentWithLibrary AS ( SELECT ewt.SUBJECT_ID, ewt.SUBJECT_TITLE, ewt.DEPARTMENT, ewt.CLUSTER_TYPE, ewt.NUM_ENROLLED_STUDENTS, ewt.avg_enrollment_in_cluster, ewt.COURSE_LEVEL, ewt.material_title, ewt.NEW_SHELF_PRICE, ewt.USED_SHELF_PRICE, ewt.material_record_count, lrc.CATALOG_TITLE AS library_title, lrc.CATALOG_AUTHOR_NAME AS library_author, lrc.CATALOG_ISBN AS library_isbn FROM EnrollmentWithTIP ewt LEFT JOIN LIBRARY_RESERVE_CATALOG lrc ON ewt.SUBJECT_ID = lrc.CATALOG_SYSTEM_NUMBER ) SELECT DEPARTMENT, SUBJECT_TITLE, CLUSTER_TYPE, SUM(NUM_ENROLLED_STUDENTS) AS total_enrollment, AVG(avg_enrollment_in_cluster) AS avg_enrollment_in_cluster, COURSE_LEVEL, COUNT(DISTINCT material_title) AS num_unique_materials, AVG(NEW_SHELF_PRICE) AS avg_new_material_price, AVG(USED_SHELF_PRICE) AS avg_used_material_price, SUM(material_record_count) AS total_material_records, COUNT(DISTINCT library_title) AS num_unique_library_titles, COUNT(DISTINCT library_isbn) AS num_unique_library_isbns FROM EnrollmentWithLibrary GROUP BY DEPARTMENT, SUBJECT_TITLE, CLUSTER_TYPE, COURSE_LEVEL ORDER BY DEPARTMENT, SUBJECT_TITLE, CLUSTER_TYPE;",
    "res": 0
  },
  {
    "sql_idx": 66,
    "ground_truth": "WITH SubjectsByTerm AS ( SELECT cc.SUBJECT_ID, cc.SUBJECT_TITLE, cc.TOTAL_UNITS, cc.DEPARTMENT_NAME, CASE WHEN cc.TERM_CODE LIKE '%FA' THEN 'Fall' WHEN cc.TERM_CODE LIKE '%SP' THEN 'Spring' END AS offered_term, at.TERM_DESCRIPTION AS term_description, sd.SCHOOL_NAME, scd.COURSE_LEVEL, cc.FALL_INSTRUCTORS, cc.SPRING_INSTRUCTORS FROM COURSE_CATALOG_SUBJECT_OFFERED cc JOIN ACADEMIC_TERMS at ON cc.TERM_CODE = at.TERM_CODE LEFT JOIN SIS_DEPARTMENT sd ON cc.DEPARTMENT_CODE = sd.DEPARTMENT_CODE LEFT JOIN SIS_COURSE_DESCRIPTION scd ON cc.SUBJECT_CODE = scd.COURSE WHERE cc.IS_OFFERED_THIS_YEAR = 'Y' AND (cc.TERM_CODE LIKE '%FA' OR cc.TERM_CODE LIKE '%SP') ), SubjectsAggregated AS ( SELECT SUBJECT_ID, SUBJECT_TITLE, DEPARTMENT_NAME, SCHOOL_NAME, COURSE_LEVEL, TOTAL_UNITS, offered_term, term_description, COUNT(DISTINCT FALL_INSTRUCTORS) AS num_fall_instructors, COUNT(DISTINCT SPRING_INSTRUCTORS) AS num_spring_instructors FROM SubjectsByTerm GROUP BY SUBJECT_ID, SUBJECT_TITLE, DEPARTMENT_NAME, SCHOOL_NAME, COURSE_LEVEL, TOTAL_UNITS, offered_term, term_description ) SELECT DEPARTMENT_NAME, SCHOOL_NAME, SUBJECT_ID, SUBJECT_TITLE, COURSE_LEVEL, TOTAL_UNITS, offered_term, term_description, num_fall_instructors, num_spring_instructors FROM SubjectsAggregated ORDER BY DEPARTMENT_NAME, SUBJECT_ID, SUBJECT_TITLE, offered_term;",
    "res": 0
  },
  {
    "sql_idx": 67,
    "ground_truth": "WITH HASSAttributes AS (SELECT cc.HASS_ATTRIBUTE, cc.HASS_ATTRIBUTE_DESC, cc.SUBJECT_ID, cc.TOTAL_UNITS, sos.NUM_ENROLLED_STUDENTS, sd.DEPARTMENT_NAME, sd.IS_DEGREE_GRANTING, sc.SUBJECT_CODE_DESC FROM CIS_COURSE_CATALOG cc JOIN SIS_SUBJECT_CODE sc ON cc.SUBJECT_CODE = sc.SUBJECT_CODE JOIN SUBJECT_OFFERED_SUMMARY sos ON cc.SUBJECT_ID = sos.SUBJECT_ID LEFT JOIN SIS_DEPARTMENT sd ON sc.DEPARTMENT_CODE = sd.DEPARTMENT_CODE WHERE cc.HASS_ATTRIBUTE IS NOT NULL AND sd.DEPARTMENT_NAME = 'Political Science') SELECT HASS_ATTRIBUTE, HASS_ATTRIBUTE_DESC, COUNT(DISTINCT SUBJECT_ID) AS num_subjects, AVG(TOTAL_UNITS) AS avg_units, SUM(NUM_ENROLLED_STUDENTS) AS total_enrollment, COUNT(DISTINCT CASE WHEN IS_DEGREE_GRANTING = 'Y' THEN DEPARTMENT_NAME END) AS num_degree_granting, SUBJECT_CODE_DESC FROM HASSAttributes GROUP BY HASS_ATTRIBUTE, HASS_ATTRIBUTE_DESC, SUBJECT_CODE_DESC ORDER BY HASS_ATTRIBUTE, HASS_ATTRIBUTE_DESC, SUBJECT_CODE_DESC;",
    "res": 0
  },
  {
    "sql_idx": 68,
    "ground_truth": "WITH ClusterSummary AS (SELECT sos.CLUSTER_TYPE, sos.OFFER_DEPT_NAME AS DEPARTMENT, sd.SCHOOL_NAME, COUNT(DISTINCT sos.SUBJECT_ID) AS num_subjects, SUM(sos.NUM_ENROLLED_STUDENTS) AS total_enrollment, AVG(sos.NUM_ENROLLED_STUDENTS) AS avg_enrollment, sd.IS_DEGREE_GRANTING AS degree_granting_status FROM SUBJECT_OFFERED_SUMMARY sos LEFT JOIN SIS_COURSE_DESCRIPTION scd ON sos.COURSE_NUMBER = scd.COURSE LEFT JOIN SIS_DEPARTMENT sd ON sos.OFFER_DEPT_CODE = sd.DEPARTMENT_CODE WHERE sos.CLUSTER_TYPE IS NOT NULL AND sos.NUM_ENROLLED_STUDENTS > 0 AND sd.SCHOOL_NAME IS NOT NULL GROUP BY sos.CLUSTER_TYPE, sos.OFFER_DEPT_NAME, sd.SCHOOL_NAME, sd.IS_DEGREE_GRANTING) SELECT CLUSTER_TYPE, DEPARTMENT, SCHOOL_NAME, degree_granting_status, num_subjects, total_enrollment, avg_enrollment FROM ClusterSummary ORDER BY CLUSTER_TYPE, DEPARTMENT, SCHOOL_NAME;",
    "res": 0
  },
  {
    "sql_idx": 69,
    "ground_truth": "SELECT ba.BUILDING_NAME, ba.course_level, ba.unique_courses, ba.total_instructors FROM (SELECT b.BUILDING_NAME, CASE WHEN scd.COURSE_LEVEL = 'G' THEN 'Graduate' WHEN scd.COURSE_LEVEL = 'U' THEN 'Undergraduate' ELSE 'Other' END AS course_level, COUNT(DISTINCT s.SUBJECT_ID) AS unique_courses, SUM(COUNT(DISTINCT s.RESPONSIBLE_FACULTY_NAME)) OVER (PARTITION BY b.BUILDING_NAME) AS total_instructors FROM FAC_BUILDING b JOIN SUBJECT_OFFERED s ON b.FAC_BUILDING_KEY = s.MEET_PLACE JOIN SIS_COURSE_DESCRIPTION scd ON s.COURSE_NUMBER = scd.COURSE JOIN FAC_BUILDING_ADDRESS ba ON b.FAC_BUILDING_KEY = ba.BUILDING_KEY WHERE b.SITE = 'MIT' GROUP BY b.BUILDING_NAME, scd.COURSE_LEVEL) ba ORDER BY ba.unique_courses DESC, ba.BUILDING_NAME;",
    "res": 0
  },
  {
    "sql_idx": 70,
    "ground_truth": "WITH MeetingPlaceDetails AS ( SELECT c.MEET_PLACE AS room_number, c.MEET_TIME, c.TERM_CODE, c.SUBJECT_ID, c.TOTAL_UNITS, b.BUILDING_NAME, b.BUILDING_NUMBER, ba.CITY AS building_city, ba.STATE AS building_state, fr.AREA, fr.ORGANIZATION_NAME, fmu.MAJOR_USE, scd.COURSE_LEVEL AS course_level, scd.COURSE_DESCRIPTION AS course_description FROM COURSE_CATALOG_SUBJECT_OFFERED c JOIN FAC_ROOMS fr ON c.MEET_PLACE = fr.FAC_ROOM_KEY JOIN FAC_BUILDING b ON fr.BUILDING_KEY = b.FAC_BUILDING_KEY JOIN FAC_MAJOR_USE fmu ON fr.MAJOR_USE_KEY = fmu.MAJOR_USE_KEY LEFT JOIN FAC_BUILDING_ADDRESS ba ON b.FAC_BUILDING_KEY = ba.BUILDING_KEY LEFT JOIN SIS_COURSE_DESCRIPTION scd ON c.SUBJECT_ID = scd.COURSE WHERE c.MEET_PLACE IS NOT NULL AND c.MEET_TIME IS NOT NULL ), MeetingPlaceAggregates AS ( SELECT room_number, BUILDING_NAME, BUILDING_NUMBER, building_city, building_state, AREA, ORGANIZATION_NAME, MAJOR_USE, TERM_CODE, course_level, COUNT(DISTINCT SUBJECT_ID) AS num_subjects, COUNT(DISTINCT MEET_TIME) AS unique_meet_times, SUM(TOTAL_UNITS) AS total_units FROM MeetingPlaceDetails GROUP BY room_number, BUILDING_NAME, BUILDING_NUMBER, building_city, building_state, AREA, ORGANIZATION_NAME, MAJOR_USE, TERM_CODE, course_level ) SELECT room_number, BUILDING_NAME, BUILDING_NUMBER, building_city, building_state, AREA, ORGANIZATION_NAME, MAJOR_USE, TERM_CODE, course_level, num_subjects, unique_meet_times, total_units FROM MeetingPlaceAggregates ORDER BY TERM_CODE, total_units DESC, room_number;",
    "res": 0
  },
  {
    "sql_idx": 71,
    "ground_truth": "WITH MaterialUsage AS ( SELECT lms.LIBRARY_MATERIAL_STATUS, sc.DEPARTMENT_NAME AS department, COUNT(DISTINCT lrc.LIBRARY_RESERVE_CATALOG_KEY) AS num_catalog_items, SUM(lso.NUM_ENROLLED_STUDENTS) AS total_students FROM LIBRARY_RESERVE_MATRL_DETAIL lrd JOIN LIBRARY_MATERIAL_STATUS lms ON lrd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY JOIN LIBRARY_SUBJECT_OFFERED lso ON lrd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY LEFT JOIN SIS_SUBJECT_CODE sc ON lso.COURSE_NUMBER = sc.COURSE_NUMBER WHERE lrc.CATALOG_YEAR >= 2000 GROUP BY lms.LIBRARY_MATERIAL_STATUS, sc.DEPARTMENT_NAME ), MaterialSubtotals AS ( SELECT LIBRARY_MATERIAL_STATUS, NULL AS department, SUM(num_catalog_items) AS total_catalog_items, SUM(total_students) AS total_students FROM MaterialUsage GROUP BY LIBRARY_MATERIAL_STATUS ), MaterialGrandTotal AS ( SELECT 'Grand Total' AS LIBRARY_MATERIAL_STATUS, NULL AS department, SUM(num_catalog_items) AS total_catalog_items, SUM(total_students) AS total_students FROM MaterialUsage ), MaterialCombined AS ( SELECT LIBRARY_MATERIAL_STATUS, department, num_catalog_items, total_students FROM MaterialUsage UNION ALL SELECT LIBRARY_MATERIAL_STATUS, department, total_catalog_items, total_students FROM MaterialSubtotals UNION ALL SELECT LIBRARY_MATERIAL_STATUS, department, total_catalog_items, total_students FROM MaterialGrandTotal ) SELECT COALESCE(LIBRARY_MATERIAL_STATUS, 'Subtotal') AS library_material_status, department, num_catalog_items, total_students FROM MaterialCombined ORDER BY CASE WHEN LIBRARY_MATERIAL_STATUS = 'Grand Total' THEN 1 WHEN department IS NULL THEN 2 ELSE 0 END, LIBRARY_MATERIAL_STATUS, department;",
    "res": 0
  },
  {
    "sql_idx": 72,
    "ground_truth": "WITH DepartmentLibraryUsage AS ( SELECT lci.DEPARTMENT, lci.COURSE_NAME, COUNT(DISTINCT lrc.LIBRARY_RESERVE_CATALOG_KEY) AS num_catalog_items, SUM(lso.NUM_ENROLLED_STUDENTS) AS total_students FROM LIBRARY_RESERVE_MATRL_DETAIL lrd JOIN LIBRARY_COURSE_INSTRUCTOR lci ON lrd.LIBRARY_COURSE_INSTRUCTOR_KEY = lci.LIBRARY_COURSE_INSTRUCTOR_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY JOIN LIBRARY_SUBJECT_OFFERED lso ON lrd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY WHERE lso.NUM_ENROLLED_STUDENTS > 0 GROUP BY lci.DEPARTMENT, lci.COURSE_NAME ), DepartmentAggregates AS ( SELECT DEPARTMENT, COUNT(DISTINCT COURSE_NAME) AS total_courses, SUM(num_catalog_items) AS total_catalog_items, AVG(total_students) AS avg_students_per_course FROM DepartmentLibraryUsage GROUP BY DEPARTMENT ), GrandTotal AS ( SELECT 'Grand Total' AS DEPARTMENT, SUM(total_courses) AS total_courses, SUM(total_catalog_items) AS total_catalog_items, AVG(avg_students_per_course) AS avg_students_per_course FROM DepartmentAggregates ) SELECT * FROM ( SELECT * FROM GrandTotal UNION ALL SELECT * FROM DepartmentAggregates ) CombinedResults ORDER BY CASE WHEN DEPARTMENT = 'Grand Total' THEN 0 ELSE 1 END, DEPARTMENT;",
    "res": 0
  },
  {
    "sql_idx": 73,
    "ground_truth": "WITH MaterialCostDetails AS ( SELECT tso.OFFER_DEPT_NAME AS department_name, tso.SUBJECT_TITLE, tm.TITLE AS material_title, tm.NEW_SHELF_PRICE, tm.USED_SHELF_PRICE, tms.TIP_MATERIAL_STATUS AS material_status, tms.TIP_MATERIAL_STATUS_CODE AS material_status_code, td.RECORD_COUNT AS material_record_count, ts.SCHOOL_NAME AS school_name FROM TIP_DETAIL td JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY JOIN TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY JOIN SIS_DEPARTMENT ts ON tso.OFFER_DEPT_CODE = ts.DEPARTMENT_CODE WHERE tso.IS_NO_COURSE_MATERIAL = 'N' ), MaterialCostAggregates AS ( SELECT department_name, school_name, COUNT(DISTINCT material_title) AS num_unique_materials, COUNT(DISTINCT SUBJECT_TITLE) AS num_courses, AVG(NEW_SHELF_PRICE) AS avg_new_price, AVG(USED_SHELF_PRICE) AS avg_used_price, SUM(material_record_count) AS total_material_records, COUNT(DISTINCT material_status) AS num_material_statuses FROM MaterialCostDetails GROUP BY department_name, school_name ), GrandTotal AS ( SELECT NULL AS department_name, NULL AS school_name, COUNT(DISTINCT material_title) AS num_unique_materials, COUNT(DISTINCT SUBJECT_TITLE) AS num_courses, AVG(NEW_SHELF_PRICE) AS avg_new_price, AVG(USED_SHELF_PRICE) AS avg_used_price, SUM(material_record_count) AS total_material_records, COUNT(DISTINCT material_status) AS num_material_statuses FROM MaterialCostDetails ) SELECT department_name, school_name, num_unique_materials, num_courses, avg_new_price, avg_used_price, total_material_records, num_material_statuses FROM MaterialCostAggregates UNION ALL SELECT department_name, school_name, num_unique_materials, num_courses, avg_new_price, avg_used_price, total_material_records, num_material_statuses FROM GrandTotal ORDER BY school_name, department_name;",
    "res": 0
  },
  {
    "sql_idx": 74,
    "ground_truth": "SELECT COALESCE(material_status, 'Grand Total') AS material_status, num_materials, total_record_count, total_enrollment FROM (SELECT CASE WHEN material_status IS NULL THEN 'No material status' ELSE material_status END AS material_status, COUNT(DISTINCT material_title) AS num_materials, SUM(RECORD_COUNT) AS total_record_count, SUM(NUM_ENROLLED_STUDENTS) AS total_enrollment FROM (SELECT tms.TIP_MATERIAL_STATUS AS material_status, tm.TITLE AS material_title, td.RECORD_COUNT, tso.NUM_ENROLLED_STUDENTS FROM TIP_DETAIL td JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY JOIN TIP_MATERIAL tm ON td.TIP_MATERIAL_KEY = tm.TIP_MATERIAL_KEY JOIN TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY WHERE td.RECORD_COUNT > 0) MaterialStatusDetails GROUP BY material_status WITH ROLLUP) MaterialStatusAggregates ORDER BY CASE WHEN material_status = 'Grand Total' THEN 1 ELSE 0 END, total_record_count DESC, material_status;",
    "res": 0
  },
  {
    "sql_idx": 75,
    "ground_truth": "SELECT Building_Name, FLOOR, Room, OWNERSHIP_TYPE, Organization_Name, FORMAT(Total_Rooms, 0) AS Total_Rooms, FORMAT(Total_Area, 0) AS Total_Area, Percent_Of_Total FROM (SELECT 0 AS SortOrder, NULL AS Building_Name, NULL AS FLOOR, NULL AS Room, NULL AS OWNERSHIP_TYPE, NULL AS Organization_Name, SUM(Total_Rooms) AS Total_Rooms, SUM(Total_Area) AS Total_Area, 100 AS Percent_Of_Total FROM (SELECT b.BUILDING_NAME_LONG AS Building_Name, f.FLOOR, r.BUILDING_ROOM AS Room, COUNT(r.FCLT_ROOM_KEY) AS Total_Rooms, SUM(r.AREA) AS Total_Area, b.OWNERSHIP_TYPE, o.ORGANIZATION_NAME AS Organization_Name, (SELECT SUM(r2.AREA) FROM FCLT_ROOMS r2 JOIN FCLT_FLOOR f2 ON r2.FCLT_FLOOR_KEY = f2.FCLT_FLOOR_KEY WHERE f2.FCLT_BUILDING_KEY = f.FCLT_BUILDING_KEY) AS Building_Total_Area, (SELECT SUM(r3.AREA) FROM FCLT_ROOMS r3) AS Overall_Total_Area FROM FCLT_FLOOR f LEFT JOIN FCLT_ROOMS r ON f.FCLT_FLOOR_KEY = r.FCLT_FLOOR_KEY LEFT JOIN FCLT_BUILDING b ON f.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY LEFT JOIN FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY GROUP BY b.BUILDING_NAME_LONG, f.FLOOR, r.BUILDING_ROOM, b.OWNERSHIP_TYPE, o.ORGANIZATION_NAME, f.FCLT_BUILDING_KEY) AS FloorStats WHERE Building_Name IS NOT NULL UNION ALL SELECT 1 AS SortOrder, Building_Name, FLOOR, Room, OWNERSHIP_TYPE, Organization_Name, Total_Rooms, Total_Area, CASE WHEN FLOOR IS NOT NULL AND Building_Total_Area > 0 THEN ROUND(Total_Area * 100.0 / Building_Total_Area, 2) WHEN FLOOR IS NULL AND Building_Name IS NOT NULL AND Overall_Total_Area > 0 THEN ROUND(Total_Area * 100.0 / Overall_Total_Area, 2) ELSE NULL END AS Percent_Of_Total FROM (SELECT b.BUILDING_NAME_LONG AS Building_Name, f.FLOOR, r.BUILDING_ROOM AS Room, COUNT(r.FCLT_ROOM_KEY) AS Total_Rooms, SUM(r.AREA) AS Total_Area, b.OWNERSHIP_TYPE, o.ORGANIZATION_NAME AS Organization_Name, (SELECT SUM(r2.AREA) FROM FCLT_ROOMS r2 JOIN FCLT_FLOOR f2 ON r2.FCLT_FLOOR_KEY = f2.FCLT_FLOOR_KEY WHERE f2.FCLT_BUILDING_KEY = f.FCLT_BUILDING_KEY) AS Building_Total_Area, (SELECT SUM(r3.AREA) FROM FCLT_ROOMS r3) AS Overall_Total_Area FROM FCLT_FLOOR f LEFT JOIN FCLT_ROOMS r ON f.FCLT_FLOOR_KEY = r.FCLT_FLOOR_KEY LEFT JOIN FCLT_BUILDING b ON f.FCLT_BUILDING_KEY = b.FCLT_BUILDING_KEY LEFT JOIN FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY GROUP BY b.BUILDING_NAME_LONG, f.FLOOR, r.BUILDING_ROOM, b.OWNERSHIP_TYPE, o.ORGANIZATION_NAME, f.FCLT_BUILDING_KEY WITH ROLLUP) AS RollupWithPercentages WHERE Building_Name IS NOT NULL) AS AllData ORDER BY SortOrder, Building_Name, FLOOR, Room;",
    "res": 0
  },
  {
    "sql_idx": 76,
    "ground_truth": "WITH FinancialAidDetails AS ( SELECT at.TERM_CODE, at.TERM_DESCRIPTION, at.ACADEMIC_YEAR, at.FINANCIAL_AID_YEAR, td.START_DATE AS Term_Start_Date, td.END_DATE AS Term_End_Date, tm.FISCAL_PERIOD, tm.FISCAL_YEAR, tq.FY_QUARTER_CODE, tp.TERM_PARAMETER AS Dept_Term_Param FROM ACADEMIC_TERMS at JOIN TIME_DAY td ON at.TERM_START_DATE = td.CALENDAR_DATE JOIN TIME_MONTH tm ON td.FISCAL_PERIOD = tm.FISCAL_PERIOD AND td.FISCAL_YEAR = tm.FISCAL_YEAR JOIN TIME_QUARTER tq ON tm.FISCAL_YEAR = tq.FISCAL_YEAR AND tm.FY_QUARTER_CODE = tq.FY_QUARTER_CODE LEFT JOIN ACADEMIC_TERM_PARAMETER tp ON at.TERM_CODE = tp.TERM_CODE WHERE at.FINANCIAL_AID_YEAR IS NOT NULL ) SELECT FINANCIAL_AID_YEAR, ACADEMIC_YEAR, COUNT(DISTINCT FISCAL_PERIOD) AS Total_Fiscal_Periods, COUNT(DISTINCT FY_QUARTER_CODE) AS Total_Quarters, MIN(Term_Start_Date) AS First_Term_Start_Date, MAX(Term_End_Date) AS Last_Term_End_Date, COUNT(DISTINCT Dept_Term_Param) AS Distinct_Term_Params FROM FinancialAidDetails GROUP BY FINANCIAL_AID_YEAR, ACADEMIC_YEAR ORDER BY FINANCIAL_AID_YEAR DESC, ACADEMIC_YEAR ASC;",
    "res": 0
  },
  {
    "sql_idx": 77,
    "ground_truth": "WITH BuildingArea AS ( SELECT b.CAMPUS_SECTOR, b.BUILDING_NAME_LONG AS Building_Name, f.FLOOR AS Floor_Number, b.ASSIGNABLE_AREA, ba.CITY AS Building_City, ba.STATE AS Building_State FROM FCLT_BUILDING b LEFT JOIN FCLT_FLOOR f ON b.FCLT_BUILDING_KEY = f.FCLT_BUILDING_KEY LEFT JOIN FCLT_BUILDING_ADDRESS ba ON b.FCLT_BUILDING_KEY = ba.FCLT_BUILDING_KEY ), TotalRooms AS ( SELECT b.BUILDING_NAME_LONG AS Building_Name, COUNT(r.FCLT_ROOM_KEY) AS Total_Rooms FROM FCLT_BUILDING b LEFT JOIN FCLT_ROOMS r ON b.FCLT_BUILDING_KEY = r.FCLT_BUILDING_KEY GROUP BY b.BUILDING_NAME_LONG ), TotalOrganizations AS ( SELECT b.BUILDING_NAME_LONG AS Building_Name, COUNT(DISTINCT o.FCLT_ORGANIZATION_KEY) AS Total_Organizations FROM FCLT_BUILDING b LEFT JOIN FCLT_ROOMS r ON b.FCLT_BUILDING_KEY = r.FCLT_BUILDING_KEY LEFT JOIN FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY GROUP BY b.BUILDING_NAME_LONG ), BuildingDetails AS ( SELECT b.BUILDING_NAME_LONG AS Building_Name, b.OWNERSHIP_TYPE AS Ownership_Type FROM FCLT_BUILDING b ), RollupRows AS ( SELECT CAMPUS_SECTOR, Building_Name, MAX(Building_City) AS Building_City, MAX(Building_State) AS Building_State, COUNT(DISTINCT Floor_Number) AS Total_Floors, SUM(ASSIGNABLE_AREA) AS Assignable_Area FROM BuildingArea GROUP BY CAMPUS_SECTOR, Building_Name WITH ROLLUP ), RankedRows AS ( SELECT rr.CAMPUS_SECTOR AS Campus_Sector, rr.Building_Name, rr.Building_City, rr.Building_State, rr.Total_Floors, rr.Assignable_Area, tr.Total_Rooms, toz.Total_Organizations, bd.Ownership_Type, CASE WHEN rr.Building_Name IS NOT NULL THEN RANK() OVER (PARTITION BY rr.CAMPUS_SECTOR ORDER BY rr.Assignable_Area DESC) - 1 ELSE NULL END AS Adjusted_Sector_Rank FROM RollupRows rr LEFT JOIN TotalRooms tr ON rr.Building_Name = tr.Building_Name LEFT JOIN TotalOrganizations toz ON rr.Building_Name = toz.Building_Name LEFT JOIN BuildingDetails bd ON rr.Building_Name = bd.Building_Name WHERE rr.CAMPUS_SECTOR IS NOT NULL ), GrandTotal AS ( SELECT NULL AS Campus_Sector, NULL AS Building_Name, NULL AS Building_City, NULL AS Building_State, SUM(Total_Floors) AS Total_Floors, SUM(Assignable_Area) AS Assignable_Area, NULL AS Total_Rooms, NULL AS Total_Organizations, NULL AS Ownership_Type, 1 AS Adjusted_Sector_Rank FROM RankedRows ) SELECT Campus_Sector, Building_Name, Building_City, Building_State, Total_Floors, FORMAT(Assignable_Area, 0) AS Assignable_Area, Total_Rooms, Total_Organizations, Ownership_Type, Adjusted_Sector_Rank FROM RankedRows UNION ALL SELECT Campus_Sector, Building_Name, NULL AS Building_City, NULL AS Building_State, Total_Floors, FORMAT(Assignable_Area, 0) AS Assignable_Area, NULL AS Total_Rooms, NULL AS Total_Organizations, Ownership_Type, Adjusted_Sector_Rank FROM GrandTotal ORDER BY Campus_Sector, Adjusted_Sector_Rank, Building_Name;",
    "res": 0
  },
  {
    "sql_idx": 78,
    "ground_truth": "WITH TIPMaterials AS ( SELECT tm.TITLE AS TIP_Title, tm.ISBN AS TIP_ISBN, tso.OFFER_DEPT_NAME AS TIP_Department FROM TIP_MATERIAL tm JOIN TIP_DETAIL td ON tm.TIP_MATERIAL_KEY = td.TIP_MATERIAL_KEY JOIN TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY ), InstructorCounts AS ( SELECT lrc.CATALOG_ISBN AS ISBN, COUNT(DISTINCT lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY) AS Num_Instructors FROM LIBRARY_RESERVE_CATALOG lrc JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lrc.LIBRARY_RESERVE_CATALOG_KEY = lrmd.LIBRARY_RESERVE_CATALOG_KEY GROUP BY lrc.CATALOG_ISBN ), DepartmentMaterials AS ( SELECT lso.OFFER_DEPT_NAME AS Department, COUNT(DISTINCT lrc.CATALOG_ISBN) AS Total_Available_Materials_Per_Dept FROM LIBRARY_RESERVE_CATALOG lrc JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lrc.LIBRARY_RESERVE_CATALOG_KEY = lrmd.LIBRARY_RESERVE_CATALOG_KEY JOIN LIBRARY_SUBJECT_OFFERED lso ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY GROUP BY lso.OFFER_DEPT_NAME ), OverallMaterials AS ( SELECT COUNT(DISTINCT lrc.CATALOG_ISBN) AS Total_Available_Materials_All_Departments FROM LIBRARY_RESERVE_CATALOG lrc JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lrc.LIBRARY_RESERVE_CATALOG_KEY = lrmd.LIBRARY_RESERVE_CATALOG_KEY ) SELECT DISTINCT tm.TIP_Department AS Department, tm.TIP_Title, tm.TIP_ISBN, lrmd.TERM_CODE AS Library_Term_Code, CASE WHEN lrc.CATALOG_ISBN IS NOT NULL THEN 'Available in Library' ELSE 'Not Available in Library' END AS Availability_Status, COALESCE(ic.Num_Instructors, 0) AS Num_Instructors, COALESCE(dm.Total_Available_Materials_Per_Dept, 0) AS Total_Available_Materials_Per_Dept, COALESCE(om.Total_Available_Materials_All_Departments, 0) AS Total_Available_Materials_All_Departments FROM TIPMaterials tm LEFT JOIN LIBRARY_RESERVE_CATALOG lrc ON tm.TIP_ISBN = lrc.CATALOG_ISBN LEFT JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lrc.LIBRARY_RESERVE_CATALOG_KEY = lrmd.LIBRARY_RESERVE_CATALOG_KEY LEFT JOIN InstructorCounts ic ON tm.TIP_ISBN = ic.ISBN LEFT JOIN DepartmentMaterials dm ON tm.TIP_Department = dm.Department LEFT JOIN OverallMaterials om ON 1=1 ORDER BY tm.TIP_Department, tm.TIP_Title;",
    "res": 0
  },
  {
    "sql_idx": 79,
    "ground_truth": "WITH TIPMaterialStatuses AS ( SELECT tso.OFFER_DEPT_NAME AS Department, tms.TIP_MATERIAL_STATUS AS Status, COUNT(td.TIP_MATERIAL_KEY) AS Total_TIP_Materials FROM TIP_DETAIL td JOIN TIP_SUBJECT_OFFERED tso ON td.TIP_SUBJECT_OFFERED_KEY = tso.TIP_SUBJECT_OFFERED_KEY JOIN TIP_MATERIAL_STATUS tms ON td.TIP_MATERIAL_STATUS_KEY = tms.TIP_MATERIAL_STATUS_KEY GROUP BY tso.OFFER_DEPT_NAME, tms.TIP_MATERIAL_STATUS ), LibraryMaterialStatuses AS ( SELECT lso.OFFER_DEPT_NAME AS Department, lms.LIBRARY_MATERIAL_STATUS AS Status, COUNT(lrmd.LIBRARY_RESERVE_CATALOG_KEY) AS Total_Library_Materials FROM LIBRARY_RESERVE_MATRL_DETAIL lrmd JOIN LIBRARY_SUBJECT_OFFERED lso ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY JOIN LIBRARY_MATERIAL_STATUS lms ON lrmd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY GROUP BY lso.OFFER_DEPT_NAME, lms.LIBRARY_MATERIAL_STATUS ), CombinedStatuses AS ( SELECT Department, Status, Total_TIP_Materials, 0 AS Total_Library_Materials FROM TIPMaterialStatuses UNION ALL SELECT Department, Status, 0 AS Total_TIP_Materials, Total_Library_Materials FROM LibraryMaterialStatuses ) SELECT Department, Status, SUM(Total_TIP_Materials) AS Total_TIP_Materials, SUM(Total_Library_Materials) AS Total_Library_Materials, SUM(Total_TIP_Materials + Total_Library_Materials) AS Total_All_Materials FROM CombinedStatuses GROUP BY Department, Status WITH ROLLUP ORDER BY Department, Status;",
    "res": 0
  },
  {
    "sql_idx": 80,
    "ground_truth": "SELECT * FROM (SELECT FAC_BUILDING.BUILDING_NUMBER AS BUILDING, FAC_BUILDING.BUILDING_NAME_LONG AS NAME, BUILDINGS.BUILDING_STREET_ADDRESS AS `STREET ADDRESS`, FAC_BUILDING.BUILDING_TYPE AS TYPE, FAC_BUILDING.DATE_OCCUPIED, FAC_BUILDING.OWNERSHIP_TYPE AS OWNERSHIP, FAC_BUILDING.SITE AS SITE FROM FAC_BUILDING_ADDRESS JOIN FAC_BUILDING ON FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY JOIN BUILDINGS ON FAC_BUILDING_ADDRESS.BUILDING_KEY = BUILDINGS.BUILDING_KEY WHERE FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE = 'STREET' AND FAC_BUILDING.PARENT_BUILDING_NUMBER IS NULL) AS tbl1 UNION ALL SELECT NULL, CONCAT(COUNT(FAC_BUILDING.BUILDING_NUMBER), ' Buildings'), NULL, NULL, NULL, NULL, NULL FROM FAC_BUILDING_ADDRESS JOIN FAC_BUILDING ON FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY WHERE FAC_BUILDING.OWNERSHIP_TYPE = 'OWNED' AND FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE = 'STREET' AND FAC_BUILDING.PARENT_BUILDING_NUMBER IS NULL AND FAC_BUILDING.SITE = 'MIT' UNION ALL SELECT NULL, CONCAT(COUNT(FAC_BUILDING.BUILDING_NUMBER), ' Buildings'), NULL, NULL, NULL, NULL, NULL FROM FAC_BUILDING_ADDRESS JOIN FAC_BUILDING ON FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY WHERE FAC_BUILDING.OWNERSHIP_TYPE = 'LEASED' AND FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE = 'STREET' AND FAC_BUILDING.PARENT_BUILDING_NUMBER IS NULL AND FAC_BUILDING.SITE = 'MIT' UNION ALL SELECT NULL, CONCAT(COUNT(FAC_BUILDING.BUILDING_NUMBER), ' Buildings'), NULL, NULL, NULL, NULL, NULL FROM FAC_BUILDING_ADDRESS JOIN FAC_BUILDING ON FAC_BUILDING_ADDRESS.BUILDING_KEY = FAC_BUILDING.FAC_BUILDING_KEY WHERE FAC_BUILDING_ADDRESS.ADDRESS_PURPOSE = 'STREET' AND FAC_BUILDING.PARENT_BUILDING_NUMBER IS NULL AND FAC_BUILDING.SITE = 'MIT';",
    "res": 0
  },
  {
    "sql_idx": 81,
    "ground_truth": "SELECT CASE WHEN LAG(year_construct_began) OVER (ORDER BY year_construct_began, building_sort, BUILDING_NUMBER) = year_construct_began THEN NULL WHEN BUILDING_NUMBER IS NULL THEN NULL ELSE year_construct_began END AS `YEAR CONSTRUCT BEGAN`, BUILDING_NUMBER AS BUILDING, year_occupied AS `YEAR INITIALLY OCCUPIED` FROM (SELECT year_construct_began, temp2.BUILDING_NUMBER, CASE WHEN FAC_BUILDING.BUILDING_NUMBER IS NOT NULL THEN IFNULL(DATE_FORMAT(STR_TO_DATE(FAC_BUILDING.DATE_OCCUPIED, '%m/%d/%Y'), '%Y'), 'UNKNOWN') ELSE NULL END AS year_occupied, CASE WHEN FAC_BUILDING.BUILDING_NUMBER IS NOT NULL THEN building_sort ELSE NULL END AS building_sort FROM (SELECT CASE WHEN BUILDING_NUMBER IS NOT NULL THEN year_construct_began ELSE CONCAT(year_construct_began, '*') END AS year_construct_began, BUILDING_NUMBER FROM (SELECT IFNULL(DATE_FORMAT(STR_TO_DATE(DATE_BUILT, '%m/%d/%Y'), '%Y'), 'UNKNOWN') AS year_construct_began, BUILDING_NUMBER FROM FAC_BUILDING WHERE ownership_type = 'OWNED' AND PARENT_BUILDING_NUMBER IS NULL) temp1 GROUP BY year_construct_began, BUILDING_NUMBER HAVING year_construct_began IS NOT NULL) temp2 LEFT JOIN FAC_BUILDING ON FAC_BUILDING.BUILDING_NUMBER = temp2.BUILDING_NUMBER) temp3 UNION ALL SELECT NULL, CONCAT(COUNT(FAC_BUILDING.BUILDING_NUMBER), ' Buildings'), NULL FROM FAC_BUILDING WHERE ownership_type = 'OWNED' AND PARENT_BUILDING_NUMBER IS NULL;",
    "res": 0
  },
  {
    "sql_idx": 82,
    "ground_truth": "SELECT CASE WHEN LAG(OWNERSHIP) OVER (ORDER BY OWNERSHIP_TYPE DESC, TYPE) = OWNERSHIP THEN NULL ELSE OWNERSHIP END AS OWNERSHIP, TYPE, BUILDINGS, GROSS_SQFT, ROOM_COUNT, ORG_COUNT FROM (SELECT CASE WHEN FLOOR.OWNERSHIP_TYPE IS NULL OR FLOOR.BUILDING_USE IS NULL THEN 'UNKNOWN' ELSE CONCAT(FLOOR.OWNERSHIP_TYPE, '2') END AS OWNERSHIP_TYPE, CASE WHEN FLOOR.BUILDING_USE IS NULL OR FLOOR.OWNERSHIP_TYPE IS NULL THEN NULL ELSE FLOOR.OWNERSHIP_TYPE END AS OWNERSHIP, FLOOR.BUILDING_USE AS TYPE, COUNT(DISTINCT COALESCE(FLOOR.PARENT_BUILDING_NUMBER, FLOOR.FCLT_BUILDING_KEY)) AS BUILDINGS, SUM(FLOOR.EXT_GROSS_AREA) AS GROSS_SQFT, COUNT(DISTINCT rm.FCLT_ROOM_KEY) AS ROOM_COUNT, COUNT(DISTINCT org.FCLT_ORGANIZATION_KEY) AS ORG_COUNT FROM FCLT_BUILDING_HIST FLOOR LEFT JOIN FCLT_ROOMS rm ON FLOOR.FCLT_BUILDING_KEY = rm.FCLT_BUILDING_KEY LEFT JOIN FCLT_ORGANIZATION org ON rm.FCLT_ORGANIZATION_KEY = org.FCLT_ORGANIZATION_KEY WHERE FLOOR.SITE = 'MIT' GROUP BY FLOOR.OWNERSHIP_TYPE, FLOOR.BUILDING_USE ORDER BY FLOOR.OWNERSHIP_TYPE DESC, FLOOR.BUILDING_USE) AS tbltmp;",
    "res": 0
  },
  {
    "sql_idx": 83,
    "ground_truth": "SELECT * FROM (SELECT CASE WHEN FLOOR.BUILDING_USE = 'RESIDENT' THEN 'RESIDENTIAL' ELSE FLOOR.BUILDING_USE END AS TYPE, COUNT(DISTINCT COALESCE(FLOOR.PARENT_BUILDING_NUMBER, FLOOR.FCLT_BUILDING_KEY)) AS BUILDINGS, FORMAT(SUM(FLOOR.EXT_GROSS_AREA), 0) AS GROSS_SQFT, COUNT(DISTINCT org.FCLT_ORGANIZATION_KEY) AS NUM_ORGANIZATIONS FROM FCLT_BUILDING FLOOR LEFT JOIN FCLT_ROOMS rm ON FLOOR.FCLT_BUILDING_KEY = rm.FCLT_BUILDING_KEY LEFT JOIN FCLT_ORGANIZATION org ON rm.FCLT_ORGANIZATION_KEY = org.FCLT_ORGANIZATION_KEY WHERE FLOOR.BUILDING_USE IS NOT NULL GROUP BY FLOOR.BUILDING_USE) AS derived_table UNION ALL SELECT NULL AS TYPE, COUNT(DISTINCT COALESCE(FLOOR.PARENT_BUILDING_NUMBER, FLOOR.FCLT_BUILDING_KEY)) AS BUILDINGS, FORMAT(SUM(FLOOR.EXT_GROSS_AREA), 0) AS GROSS_SQFT, COUNT(DISTINCT org.FCLT_ORGANIZATION_KEY) AS NUM_ORGANIZATIONS FROM FCLT_BUILDING FLOOR LEFT JOIN FCLT_ROOMS rm ON FLOOR.FCLT_BUILDING_KEY = rm.FCLT_BUILDING_KEY LEFT JOIN FCLT_ORGANIZATION org ON rm.FCLT_ORGANIZATION_KEY = org.FCLT_ORGANIZATION_KEY;",
    "res": 0
  },
  {
    "sql_idx": 84,
    "ground_truth": "SELECT o1.organization_id, organization_number, organization_level, CASE WHEN organization_level = 2 THEN CONCAT(' ', organization_name) WHEN organization_level = 3 THEN CONCAT(' ', organization_name) WHEN organization_level = 4 THEN CONCAT(' ', organization_name) WHEN organization_level = 5 THEN CONCAT(' ', organization_name) WHEN organization_level = 6 THEN CONCAT(' ', organization_name) ELSE organization_name END AS formatted_name, CASE WHEN ASSIGNABLE = 1 THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END AS assign, (SELECT FORMAT(SUM(area), 0) FROM FCLT_ROOMS r JOIN FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY WHERE o.organization_id = o1.organization_id) AS area, (SELECT FORMAT(COUNT(ROOM), 0) FROM FCLT_ROOMS r JOIN FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY WHERE o.organization_id = o1.organization_id) AS rmcnt, (SELECT FORMAT(AVG(area), 0) FROM FCLT_ROOMS r JOIN FCLT_ORGANIZATION o ON r.FCLT_ORGANIZATION_KEY = o.FCLT_ORGANIZATION_KEY WHERE o.organization_id = o1.organization_id) AS area_avg FROM FCLT_ORGANIZATION o1 JOIN MASTER_DEPT_HIERARCHY ON o1.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY WHERE o1.organization_name NOT IN ('CAMBRIDGE-MIT INST');",
    "res": 0
  },
  {
    "sql_idx": 85,
    "ground_truth": "SELECT CASE WHEN LAG(assign) OVER (ORDER BY assign) = assign THEN NULL ELSE assign END AS assign, CASE WHEN LAG(muse) OVER (ORDER BY assign, muse_sort) = muse THEN NULL ELSE muse END AS muse, rmcnt, area, area_avg FROM (SELECT CASE WHEN GROUPING(ASSIGNABLE) = 1 THEN NULL ELSE CASE WHEN ASSIGNABLE = 1 THEN 'ASSIGNABLE' ELSE 'NON-ASSIGNABLE' END END AS assign, CASE WHEN GROUPING(FCLT_ROOMS.MAJOR_USE_DESC) = 1 AND GROUPING(ASSIGNABLE) = 0 THEN NULL ELSE FCLT_ROOMS.MAJOR_USE_DESC END AS muse, CASE WHEN GROUPING(FCLT_ROOMS.MAJOR_USE_DESC) = 1 AND GROUPING(ASSIGNABLE) = 0 THEN 'zzz' ELSE FCLT_ROOMS.MAJOR_USE_DESC END AS muse_sort, COUNT(ROOM) AS rmcnt, SUM(FCLT_ROOMS.AREA) AS area, AVG(FCLT_ROOMS.AREA) AS area_avg FROM FCLT_ROOMS JOIN FCLT_MAJOR_USE ON FCLT_MAJOR_USE.FCLT_MAJOR_USE_KEY = FCLT_ROOMS.FCLT_MAJOR_USE_KEY WHERE FCLT_MAJOR_USE.MAJOR_USE NOT LIKE 'ZUSE%' AND FCLT_MAJOR_USE.DESCRIPTION NOT LIKE 'ZUSE%' GROUP BY ASSIGNABLE, FCLT_ROOMS.MAJOR_USE_DESC WITH ROLLUP ORDER BY assign, muse_sort) tbltmp;",
    "res": 0
  },
  {
    "sql_idx": 86,
    "ground_truth": "SELECT CASE WHEN LAG(FLOOR_KEY) OVER (ORDER BY COALESCE(FAC_FLOOR.FLOOR_SORT_SEQUENCE, 999), flsort, orgname) = FLOOR_KEY THEN NULL ELSE FLOOR_KEY END AS flid2, CASE WHEN orgname = 'zzz' THEN NULL ELSE orgname END AS dept, rmcnt, areasum, area_avg FROM (SELECT FLOOR_KEY AS flsort, CASE WHEN GROUPING(FLOOR_KEY) = 0 AND GROUPING(org.ORGANIZATION_NAME) = 1 THEN 'SUBTOTAL' WHEN GROUPING(FLOOR_KEY) = 1 AND GROUPING(org.ORGANIZATION_NAME) = 1 THEN 'TOTAL' ELSE FLOOR_KEY END AS flid, CASE WHEN GROUPING(FLOOR_KEY) = 0 AND GROUPING(org.ORGANIZATION_NAME) = 1 THEN 'zzz' ELSE org.ORGANIZATION_NAME END AS orgname, COUNT(rm.FAC_ROOM_KEY) AS rmcnt, SUM(rm.AREA) AS areasum, AVG(rm.AREA) AS area_avg FROM FAC_ROOMS rm JOIN FCLT_ORGANIZATION org ON rm.ORGANIZATION_KEY = org.FCLT_ORGANIZATION_KEY JOIN BUILDINGS bu ON rm.BUILDING_KEY = bu.BUILDING_KEY WHERE bu.BUILDING_NAME = 'Ray and Maria Stata Center' GROUP BY FLOOR_KEY, org.ORGANIZATION_NAME WITH ROLLUP ORDER BY flsort, orgname) tbltmp LEFT JOIN FAC_FLOOR ON FLOOR_KEY = flsort;",
    "res": 0
  },
  {
    "sql_idx": 87,
    "ground_truth": "SELECT DISTINCT tbltmp.blsort AS building_id, tbltmp.flsort AS floor_id, tbltmp.rmcnt AS total_rooms, tbltmp.areasum AS total_area, tbltmp.area_avg AS avg_area, fb.BUILDING_NAME_LONG AS building_name, fb.ACCESS_LEVEL_NAME AS access_level, CASE WHEN tbltmp.flsort IS NULL THEN NULL ELSE fba.POSTAL_CODE END AS postal_code, CASE WHEN tbltmp.flsort IS NULL THEN NULL ELSE fba.CITY END AS city FROM (SELECT rm.BUILDING_KEY AS blsort, rm.FLOOR_KEY AS flsort, COUNT(rm.FAC_ROOM_KEY) AS rmcnt, SUM(rm.AREA) AS areasum, AVG(rm.AREA) AS area_avg FROM FAC_ROOMS rm JOIN FAC_ORGANIZATION fo ON rm.ORGANIZATION_KEY = fo.ORGANIZATION_KEY WHERE fo.ORGANIZATION_NAME = 'DP OF FACILITIES' GROUP BY rm.BUILDING_KEY, rm.FLOOR_KEY WITH ROLLUP) tbltmp LEFT JOIN FAC_FLOOR fl ON fl.BUILDING_KEY = tbltmp.blsort AND fl.FLOOR_KEY = tbltmp.flsort LEFT JOIN FAC_BUILDING fb ON tbltmp.blsort = fb.FAC_BUILDING_KEY LEFT JOIN FAC_BUILDING_ADDRESS fba ON tbltmp.blsort = fba.BUILDING_KEY ORDER BY building_id, floor_id, postal_code, city;",
    "res": 0
  },
  {
    "sql_idx": 88,
    "ground_truth": "SELECT * FROM (SELECT OFFER_DEPT_NAME AS DEPT, OFFER_SCHOOL_NAME AS SCHOOL, COURSE_NUMBER AS COURSE_NR, SUBJECT_TITLE AS TITLE, SUM(NUM_ENROLLED_STUDENTS) AS TOTAL_ENROLLED, lso.TERM_CODE, COUNT(DISTINCT CATALOG_ISBN) AS OWNERSHIP FROM LIBRARY_SUBJECT_OFFERED lso JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrc.LIBRARY_RESERVE_CATALOG_KEY = lrmd.LIBRARY_RESERVE_CATALOG_KEY GROUP BY OFFER_DEPT_NAME, OFFER_SCHOOL_NAME, COURSE_NUMBER, SUBJECT_TITLE, lso.TERM_CODE) AS SubQuery UNION ALL SELECT 'TOTAL:', NULL, NULL, NULL, SUM(NUM_ENROLLED_STUDENTS), NULL, COUNT(DISTINCT CATALOG_ISBN) FROM LIBRARY_SUBJECT_OFFERED lso JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrc.LIBRARY_RESERVE_CATALOG_KEY = lrmd.LIBRARY_RESERVE_CATALOG_KEY JOIN ACADEMIC_TERM_PARAMETER acp ON lso.TERM_CODE = acp.TERM_CODE WHERE IS_CURRENT_TERM = 'Y' GROUP BY IS_CURRENT_TERM ORDER BY DEPT, COURSE_NR, TITLE, TERM_CODE;",
    "res": 0
  },
  {
    "sql_idx": 89,
    "ground_truth": "SELECT CASE WHEN LAG(OWNERSHIP_TYPE) OVER (ORDER BY OWNERSHIP_TYPE_gr DESC, ML) = OWNERSHIP_TYPE THEN NULL ELSE OWNERSHIP_TYPE END AS OWNERSHIP_TYPE, ML, nr_owner, nr_member FROM (SELECT CASE WHEN OWNER_TYPE IS NULL AND MOIRA_LIST_NAME IS NOT NULL THEN CONCAT(OWNER_TYPE, '1') ELSE CONCAT(OWNER_TYPE, '2') END AS OWNERSHIP_TYPE_gr, CASE WHEN MOIRA_LIST_NAME IS NULL AND OWNER_TYPE IS NOT NULL THEN 'SUBTOTAL' WHEN MOIRA_LIST_NAME IS NULL AND OWNER_TYPE IS NULL THEN 'TOTAL' ELSE OWNER_TYPE END AS OWNERSHIP_TYPE, MOIRA_LIST_NAME AS ML, COUNT(DISTINCT OWNER) AS nr_owner, COUNT(DISTINCT MOIRA_LIST_MEMBER_MIT_ID) AS nr_member FROM MOIRA_LIST_OWNER mlo JOIN MOIRA_LIST_DETAIL mld ON mld.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY JOIN MOIRA_LIST ml ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN EMPLOYEE_DIRECTORY ON MIT_ID = MOIRA_LIST_MEMBER_MIT_ID WHERE department_name LIKE 'Computer Science%' GROUP BY OWNER_TYPE, MOIRA_LIST_NAME WITH ROLLUP ORDER BY OWNER_TYPE DESC, MOIRA_LIST_NAME) tbltmp;",
    "res": 0
  },
  {
    "sql_idx": 90,
    "ground_truth": "WITH SponsorAndStartTime AS (SELECT isc.IAP_CATEGORY_NAME, isp.SPONSOR_NAME, iss.SESSION_START_TIME, COUNT(isp.SPONSOR_NAME) AS sponsor_count, COUNT(iss.SESSION_START_TIME) AS start_time_count FROM IAP_SUBJECT_CATEGORY isc JOIN IAP_SUBJECT_DETAIL isd ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY LEFT JOIN IAP_SUBJECT_SESSION iss ON isd.IAP_SUBJECT_SESSION_KEY = iss.IAP_SUBJECT_SESSION_KEY LEFT JOIN IAP_SUBJECT_SPONSOR isp ON isd.IAP_SUBJECT_SPONSOR_KEY = isp.IAP_SUBJECT_SPONSOR_KEY GROUP BY isc.IAP_CATEGORY_NAME, isp.SPONSOR_NAME, iss.SESSION_START_TIME), MostCommonDetails AS (SELECT IAP_CATEGORY_NAME, (SELECT SPONSOR_NAME FROM SponsorAndStartTime WHERE IAP_CATEGORY_NAME = sast.IAP_CATEGORY_NAME GROUP BY SPONSOR_NAME ORDER BY COUNT(*) DESC LIMIT 1) AS most_common_sponsor, (SELECT SESSION_START_TIME FROM SponsorAndStartTime WHERE IAP_CATEGORY_NAME = sast.IAP_CATEGORY_NAME GROUP BY SESSION_START_TIME ORDER BY COUNT(*) DESC LIMIT 1) AS most_common_start_time FROM SponsorAndStartTime sast GROUP BY IAP_CATEGORY_NAME), CategorySummary AS (SELECT isc.IAP_CATEGORY_NAME AS TYPE, COUNT(DISTINCT isd.IAP_SUBJECT_SESSION_KEY) AS nr_sessions, FORMAT(SUM(isd.MAX_ENROLLMENT), 0) AS total_attend, MIN(isd.TERM_CODE) AS first_active_year, MAX(isd.TERM_CODE) AS last_active_year, mcd.most_common_sponsor, mcd.most_common_start_time FROM IAP_SUBJECT_CATEGORY isc JOIN IAP_SUBJECT_DETAIL isd ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY LEFT JOIN MostCommonDetails mcd ON isc.IAP_CATEGORY_NAME = mcd.IAP_CATEGORY_NAME GROUP BY isc.IAP_CATEGORY_NAME, mcd.most_common_sponsor, mcd.most_common_start_time) SELECT TYPE, nr_sessions, total_attend, CONCAT(first_active_year, '-', last_active_year) AS active_years, most_common_sponsor, most_common_start_time FROM CategorySummary UNION ALL SELECT 'TOTAL', COUNT(DISTINCT IAP_SUBJECT_SESSION_KEY), FORMAT(SUM(MAX_ENROLLMENT), 0), NULL, NULL, NULL FROM IAP_SUBJECT_DETAIL ORDER BY TYPE;",
    "res": 0
  },
  {
    "sql_idx": 91,
    "ground_truth": "SELECT * FROM (SELECT CASE WHEN BUILDING_TYPE = 'RESIDENT' THEN 'RESIDENTIAL' ELSE BUILDING_TYPE END AS TYPE, COUNT(DISTINCT COALESCE(PARENT_BUILDING_NUMBER, FCLT_BUILDING_KEY)) AS BUILDINGS, COUNT(DISTINCT MIT_ID) AS MIT_ID_COUNT, COUNT(DISTINCT BUILDINGS.BUILDING_STREET_ADDRESS) AS ADDRESS_COUNT, COUNT(DISTINCT fac_building_address.CITY) AS CITY_COUNT, COUNT(DISTINCT fac_building_address.STATE) AS STATE_COUNT, COUNT(DISTINCT fac_building_address.POSTAL_CODE) AS POSTAL_CODE_COUNT, SUM(FLOOR.EXT_GROSS_AREA)/NULLIF(COUNT(DISTINCT MIT_ID), 0) AS AVG_AREA FROM FCLT_BUILDING_HIST FLOOR JOIN fac_building_address ON FLOOR.fclt_building_key = fac_building_address.BUILDING_KEY JOIN BUILDINGS ON BUILDINGS.BUILDING_KEY = fac_building_address.BUILDING_KEY JOIN FAC_ROOMS fr ON fr.BUILDING_KEY = BUILDINGS.BUILDING_KEY JOIN EMPLOYEE_DIRECTORY e ON e.OFFICE_LOCATION = fr.FAC_ROOM_KEY WHERE fac_building_address.ADDRESS_PURPOSE = 'STREET' GROUP BY BUILDING_TYPE ORDER BY BUILDING_TYPE ASC) AS subquery1 UNION ALL SELECT 'TOTAL', COUNT(DISTINCT COALESCE(PARENT_BUILDING_NUMBER, FCLT_BUILDING_KEY)), COUNT(DISTINCT MIT_ID), COUNT(DISTINCT BUILDINGS.BUILDING_STREET_ADDRESS), COUNT(DISTINCT fac_building_address.CITY), COUNT(DISTINCT fac_building_address.STATE), COUNT(DISTINCT fac_building_address.POSTAL_CODE), SUM(FLOOR.EXT_GROSS_AREA)/NULLIF(COUNT(DISTINCT MIT_ID), 0) FROM FCLT_BUILDING_HIST FLOOR JOIN fac_building_address ON FLOOR.fclt_building_key = fac_building_address.BUILDING_KEY JOIN BUILDINGS ON BUILDINGS.BUILDING_KEY = fac_building_address.BUILDING_KEY JOIN FAC_ROOMS fr ON fr.BUILDING_KEY = BUILDINGS.BUILDING_KEY JOIN EMPLOYEE_DIRECTORY e ON e.OFFICE_LOCATION = fr.FAC_ROOM_KEY WHERE fac_building_address.ADDRESS_PURPOSE = 'STREET';",
    "res": 0
  },
  {
    "sql_idx": 92,
    "ground_truth": "SELECT CASE WHEN LAG(assign) OVER (ORDER BY assign) = assign THEN NULL ELSE assign END AS assign, CASE WHEN LAG(muse) OVER (ORDER BY assign, muse_sort) = muse THEN NULL ELSE muse END AS muse, rmuse, rmcnt, area, area_avg FROM (SELECT CASE WHEN ACCESS_LEVEL IS NULL THEN 'TOTAL' ELSE ACCESS_LEVEL END AS assign, CASE WHEN su2.SPACE_USAGE IS NULL AND ACCESS_LEVEL IS NOT NULL THEN 'SUBTOTAL' ELSE su2.SPACE_USAGE END AS muse, CASE WHEN su2.SPACE_USAGE IS NULL AND ACCESS_LEVEL IS NOT NULL THEN 'zzz' ELSE su2.SPACE_USAGE END AS muse_sort, CASE WHEN DLC_NAME IS NULL AND su2.SPACE_USAGE IS NOT NULL THEN 'SUBTOTAL' ELSE DLC_NAME END AS rmuse, CASE WHEN DLC_NAME IS NULL AND su2.SPACE_USAGE IS NOT NULL THEN 'zzz' ELSE DLC_NAME END AS rmuse_sort, FORMAT(COUNT(DISTINCT SPACE_UNIT), 0) AS rmcnt, FORMAT(SUM(ROOM_SQUARE_FOOTAGE), 0) AS area, FORMAT(AVG(ROOM_SQUARE_FOOTAGE), 0) AS area_avg FROM SPACE_UNIT su JOIN (SELECT * FROM SPACE_DETAIL WHERE BUILDING_KEY = '32') sd ON sd.SPACE_UNIT_KEY = su.SPACE_UNIT_KEY JOIN SPACE_USAGE su2 ON su2.SPACE_USAGE_KEY = sd.SPACE_USAGE_KEY JOIN (SELECT * FROM ZPM_ROOMS_LOAD WHERE BUILDING_COMPONENT = '32') zrl ON zrl.SPACE_UNIT_CODE = su.SPACE_UNIT_CODE JOIN FCLT_ORGANIZATION fo ON fo.FCLT_ORGANIZATION_KEY = su.FCLT_ORGANIZATION_KEY WHERE su2.SPACE_USAGE NOT LIKE '%STORAGE%' GROUP BY ACCESS_LEVEL, su2.SPACE_USAGE, DLC_NAME WITH ROLLUP ORDER BY assign, muse_sort, rmuse_sort) tbltmp;",
    "res": 0
  },
  {
    "sql_idx": 93,
    "ground_truth": "SELECT SUBSTR(organization_sort, 5, 2) AS breakgrp, organization_id, organization_name, CASE WHEN organization_level = 4 THEN ' ' || organization_name WHEN organization_level = 5 THEN ' ' || organization_name WHEN organization_level = 6 THEN ' ' || organization_name ELSE organization_name END AS formatted_name, CASE WHEN EMERITUS_STATUS = 'Emeritus' THEN 'EMERITUS' ELSE 'NON-EMERITUS' END AS assign, organization_number, organization_level, (SELECT COUNT(DISTINCT hfr2.MIT_ID) AS employer_count FROM HR_FACULTY_ROSTER hfr2 WHERE hfr2.HR_ORG_UNIT_TITLE=hou.HR_ORG_UNIT_TITLE) , HIERARCHY_TYPE, organization_sort FROM FCLT_ORGANIZATION JOIN MASTER_DEPT_HIERARCHY ON FCLT_ORGANIZATION.DLC_KEY = MASTER_DEPT_HIERARCHY.DLC_KEY JOIN HR_ORG_UNIT hou on hou.DLC_KEY=FCLT_ORGANIZATION.DLC_KEY JOIN HR_FACULTY_ROSTER hfr ON hfr.HR_ORG_UNIT_TITLE=hou.HR_ORG_UNIT_TITLE WHERE organization_level IN ('3', '4', '5', '6') AND organization_id NOT IN ('139', '250') ORDER BY HIERARCHY_TYPE",
    "res": 0
  },
  {
    "sql_idx": 94,
    "ground_truth": "select distinct ccso.subject_title, building_name, ccso.duration, avg(duration) over (partition by ccso.academic_year order by ccso.term_start_date rows between 2 preceding and 2 following) from (select distinct subject_title, term_start_date, term_end_date-term_start_date as duration, cis.academic_year, meet_place from academic_terms join COURSE_CATALOG_SUBJECT_OFFERED cis on cis.effective_term_code=academic_terms.term_code) ccso JOIN FCLT_ROOMS fr ON ccso.MEET_PLACE = fr.FCLT_ROOM_KEY JOIN FCLT_BUILDING fb ON fb.FCLT_BUILDING_KEY = fr.FCLT_BUILDING_KEY;",
    "res": 0
  },
  {
    "sql_idx": 95,
    "ground_truth": "SELECT ccso.subject_title, fb.BUILDING_NAME_LONG AS building_name, at.TERM_START_DATE AS term_start_date, lag(ccso.subject_title) OVER ( ORDER BY at.TERM_START_DATE ASC, ccso.subject_title ASC ) AS previous_subject_title, lead(ccso.subject_title) OVER ( ORDER BY at.TERM_START_DATE ASC, ccso.subject_title ASC ) AS next_subject_title, fb.ACCESS_LEVEL_NAME AS access_level, fr.AREA AS room_assignable_area FROM ( SELECT DISTINCT subject_id, subject_title, effective_term_code, meet_place FROM COURSE_CATALOG_SUBJECT_OFFERED ) ccso JOIN ACADEMIC_TERMS at ON at.TERM_CODE = ccso.effective_term_code JOIN FCLT_ROOMS fr ON ccso.MEET_PLACE = fr.FCLT_ROOM_KEY JOIN FCLT_BUILDING fb ON fb.FCLT_BUILDING_KEY = fr.FCLT_BUILDING_KEY ORDER BY at.TERM_START_DATE ASC, ccso.subject_title ASC;",
    "res": 0
  },
  {
    "sql_idx": 96,
    "ground_truth": "select distinct subject_title, building_name, count(ccso.subject_id) over (partition by ccso.academic_year order by term_start_date asc range between unbounded preceding and current row) from COURSE_CATALOG_SUBJECT_OFFERED ccso join academic_terms on ccso.effective_term_code =academic_terms.term_code JOIN FCLT_ROOMS fr ON ccso.MEET_PLACE = fr.FCLT_ROOM_KEY JOIN FCLT_BUILDING fb ON fb.FCLT_BUILDING_KEY = fr.FCLT_BUILDING_KEY",
    "res": 1
  },
  {
    "sql_idx": 97,
    "ground_truth": "SELECT CASE WHEN LAG(assign) OVER (ORDER BY IS_CURRENT_TERM DESC, assign, CLUSTER_TYPE ASC) = assign THEN NULL ELSE assign END AS assign, CLUSTER_TYPE, max_duration, max_units, avg_dur, avg_unit FROM ( SELECT CASE WHEN GROUPING(CLUSTER_TYPE) = 1 AND GROUPING(IS_CURRENT_TERM) = 0 THEN 'SUBTOTAL' WHEN GROUPING(CLUSTER_TYPE) = 1 AND GROUPING(IS_CURRENT_TERM) = 1 THEN 'TOTAL' ELSE CASE WHEN IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END END AS assign, IS_CURRENT_TERM, CLUSTER_TYPE, MAX(DATEDIFF(STR_TO_DATE(term_end_date, '%d-%b-%y'), STR_TO_DATE(term_start_date, '%d-%b-%y'))) AS max_duration, MAX(TOTAL_UNITS) AS max_units, AVG(DATEDIFF(STR_TO_DATE(term_end_date, '%d-%b-%y'), STR_TO_DATE(term_start_date, '%d-%b-%y'))) AS avg_dur, AVG(TOTAL_UNITS) AS avg_unit FROM SUBJECT_SUMMARY ss JOIN ACADEMIC_TERMS_ALL ata ON ata.TERM_CODE = ss.TERM_CODE WHERE CLUSTER_TYPE IS NOT NULL AND ss.department_name IN ('Chemistry', 'Biology') GROUP BY IS_CURRENT_TERM, CLUSTER_TYPE WITH ROLLUP ORDER BY IS_CURRENT_TERM DESC, assign, CLUSTER_TYPE ASC ) tbltmp;",
    "res": 0
  },
  {
    "sql_idx": 98,
    "ground_truth": "SELECT CASE WHEN LAG(assign) OVER (ORDER BY IS_CURRENT_TERM DESC, assign, OFFER_DEPT_NAME ASC) = assign THEN NULL ELSE assign END AS assign, OFFER_DEPT_NAME, max_duration, max_units, avg_dur, avg_unit FROM (SELECT CASE WHEN GROUPING(OFFER_DEPT_NAME) = 1 AND GROUPING(IS_CURRENT_TERM) = 0 THEN 'SUBTOTAL' WHEN GROUPING(OFFER_DEPT_NAME) = 1 AND GROUPING(IS_CURRENT_TERM) = 1 THEN 'TOTAL' ELSE CASE WHEN IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NON-CURRENT' END END AS assign, IS_CURRENT_TERM, OFFER_DEPT_NAME, MAX(DATEDIFF(STR_TO_DATE(term_end_date, '%d-%b-%y'), STR_TO_DATE(term_start_date, '%d-%b-%y'))) AS max_duration, MAX(TOTAL_UNITS) AS max_units, AVG(DATEDIFF(STR_TO_DATE(term_end_date, '%d-%b-%y'), STR_TO_DATE(term_start_date, '%d-%b-%y'))) AS avg_dur, AVG(TOTAL_UNITS) AS avg_unit FROM SUBJECT_SUMMARY ss JOIN ACADEMIC_TERMS_ALL ata ON ata.TERM_CODE = ss.TERM_CODE JOIN SUBJECT_OFFERED so ON so.SUBJECT_ID = ss.SUBJECT_ID WHERE so.offer_dept_name IN ('Chemistry', 'Biology') GROUP BY IS_CURRENT_TERM, OFFER_DEPT_NAME WITH ROLLUP ORDER BY IS_CURRENT_TERM DESC, assign, OFFER_DEPT_NAME ASC) tbltmp;",
    "res": 0
  },
  {
    "sql_idx": 99,
    "ground_truth": "SELECT CASE WHEN LAG(dept) OVER (ORDER BY dept, dept_sort, master) = dept THEN NULL ELSE dept END AS dept, CASE WHEN master = 'zzz' THEN NULL ELSE master END AS master, subcnt, totalprice, matcnt FROM (SELECT CASE WHEN GROUPING(OFFER_DEPT_NAME) = 1 AND GROUPING(MASTER_COURSE_NUMBER) = 1 THEN 'zzz' ELSE OFFER_DEPT_NAME END AS dept_sort, CASE WHEN GROUPING(OFFER_DEPT_NAME) = 0 AND GROUPING(MASTER_COURSE_NUMBER) = 1 THEN 'SUBTOTAL' WHEN GROUPING(OFFER_DEPT_NAME) = 1 AND GROUPING(MASTER_COURSE_NUMBER) = 1 THEN 'TOTAL' ELSE OFFER_DEPT_NAME END AS dept, CASE WHEN GROUPING(OFFER_DEPT_NAME) = 0 AND GROUPING(MASTER_COURSE_NUMBER) = 1 THEN 'zzz' ELSE MASTER_COURSE_NUMBER END AS master, FORMAT(COUNT(DISTINCT tso.SUBJECT_ID), 0) AS subcnt, FORMAT(SUM(NEW_SHELF_PRICE), 0) AS totalprice, FORMAT(COUNT(DISTINCT tm.ISBN), 0) AS matcnt FROM TIP_DETAIL td JOIN TIP_SUBJECT_OFFERED tso ON tso.TIP_SUBJECT_OFFERED_KEY = td.TIP_SUBJECT_OFFERED_KEY JOIN TIP_MATERIAL tm ON tm.TIP_MATERIAL_KEY = td.TIP_MATERIAL_KEY GROUP BY OFFER_DEPT_NAME, MASTER_COURSE_NUMBER WITH ROLLUP ORDER BY dept_sort, master) tbltmp;",
    "res": 0
  },
  {
    "sql_idx": 100,
    "ground_truth": "SELECT CASE WHEN LAG(term) OVER (ORDER BY term_sort, term, dept_sort) = term THEN NULL ELSE term END AS term, dept, subcnt, avgeqisub, sd.SCHOOL_NAME AS school_name, ad.DEPARTMENT_PHONE_NUMBER AS department_phone FROM (SELECT CASE WHEN GROUPING(TERM_CODE) = 1 AND GROUPING(DEPARTMENT_NAME) = 1 THEN 'zzz' ELSE TERM_CODE END AS term_sort, CASE WHEN GROUPING(TERM_CODE) = 0 AND GROUPING(DEPARTMENT_NAME) = 1 THEN 'SUBTOTAL' WHEN GROUPING(TERM_CODE) = 1 AND GROUPING(DEPARTMENT_NAME) = 1 THEN 'TOTAL' ELSE TERM_CODE END AS term, CASE WHEN GROUPING(TERM_CODE) = 0 AND GROUPING(DEPARTMENT_NAME) = 1 THEN 'zzz' ELSE DEPARTMENT_NAME END AS dept_sort, DEPARTMENT_NAME AS dept, COUNT(DISTINCT SUBJECT_ID) AS subcnt, MIN(MEET_TIME) AS mintime, AVG(CASE WHEN equivalent_subjects IS NULL THEN 0 ELSE 1 + LENGTH(equivalent_subjects) - LENGTH(REPLACE(equivalent_subjects, ',', '')) END) AS avgeqisub FROM COURSE_CATALOG_SUBJECT_OFFERED GROUP BY TERM_CODE, DEPARTMENT_NAME WITH ROLLUP) tbltmp LEFT JOIN SIS_DEPARTMENT sd ON tbltmp.dept = sd.DEPARTMENT_NAME LEFT JOIN SIS_ADMIN_DEPARTMENT ad ON sd.DEPARTMENT_CODE = ad.SIS_ADMIN_DEPARTMENT_CODE ORDER BY term_sort, dept_sort;",
    "res": 0
  },
  {
    "sql_idx": 101,
    "ground_truth": "SELECT CASE WHEN LAG(assign) OVER (ORDER BY assign) = assign THEN NULL ELSE assign END AS assign, muse, session_count, total_time, avg_time FROM (SELECT CASE WHEN IS_CURRENT_TERM IS NULL AND IAP_CATEGORY_NAME IS NOT NULL THEN 'SUBTOTAL' WHEN IS_CURRENT_TERM IS NULL AND IAP_CATEGORY_NAME IS NULL THEN 'TOTAL' ELSE CASE WHEN IS_CURRENT_TERM = 'Y' THEN 'CURRENT' ELSE 'NOT CURRENT' END END AS assign, IAP_CATEGORY_NAME AS muse, COUNT(SESSION_DATE) AS session_count, SUM(COALESCE(TIMESTAMPDIFF(HOUR, STR_TO_DATE(CONCAT(LEFT(SESSION_START_TIME, 2), ':', SUBSTRING(SESSION_START_TIME, 3, 2), ' ', RIGHT(SESSION_START_TIME, 2)), '%h:%i %p'), STR_TO_DATE(CONCAT(LEFT(SESSION_END_TIME, 2), ':', SUBSTRING(SESSION_END_TIME, 3, 2), ' ', RIGHT(SESSION_END_TIME, 2)), '%h:%i %p')) / 24.0, 0)) AS total_time, AVG(COALESCE(TIMESTAMPDIFF(HOUR, STR_TO_DATE(CONCAT(LEFT(SESSION_START_TIME, 2), ':', SUBSTRING(SESSION_START_TIME, 3, 2), ' ', RIGHT(SESSION_START_TIME, 2)), '%h:%i %p'), STR_TO_DATE(CONCAT(LEFT(SESSION_END_TIME, 2), ':', SUBSTRING(SESSION_END_TIME, 3, 2), ' ', RIGHT(SESSION_END_TIME, 2)), '%h:%i %p')) / 24.0, 0)) AS avg_time FROM IAP_SUBJECT_DETAIL ss JOIN ACADEMIC_TERMS at ON at.TERM_CODE = ss.TERM_CODE JOIN IAP_SUBJECT_SESSION iss ON iss.IAP_SUBJECT_SESSION_KEY = ss.IAP_SUBJECT_SESSION_KEY JOIN IAP_SUBJECT_CATEGORY isc ON isc.IAP_SUBJECT_CATEGORY_KEY = ss.IAP_SUBJECT_CATEGORY_KEY GROUP BY IS_CURRENT_TERM, IAP_CATEGORY_NAME WITH ROLLUP HAVING IS_CURRENT_TERM IS NOT NULL OR IAP_CATEGORY_NAME IS NOT NULL) AS tbltmp ORDER BY assign, muse;",
    "res": 0
  },
  {
    "sql_idx": 102,
    "ground_truth": "SELECT CASE WHEN LAG(ACADEMIC_YEAR) OVER (ORDER BY ata.TERM_CODE) = ACADEMIC_YEAR THEN NULL ELSE ACADEMIC_YEAR END AS ACADEMIC_YEAR, ata.TERM_CODE, COUNT(DISTINCT si) AS distinct_subject_count FROM ACADEMIC_TERMS_ALL ata LEFT OUTER JOIN (SELECT CASE WHEN LAG(subject_id) OVER (ORDER BY SUBJECT_ID, TERM_CODE ASC, ACADEMIC_YEAR ASC) = subject_id THEN NULL ELSE subject_id END AS si, CASE WHEN LAG(TERM_CODE) OVER (ORDER BY SUBJECT_ID, TERM_CODE ASC, ACADEMIC_YEAR ASC) = TERM_CODE THEN NULL ELSE term_code END AS term_code FROM course_catalog_subject_offered) AS a ON ata.TERM_CODE = a.TERM_CODE GROUP BY ata.TERM_CODE, ACADEMIC_YEAR UNION ALL SELECT 'TOTAL', NULL, COUNT(DISTINCT SUBJECT_ID) AS total_distinct_subject_count FROM course_catalog_subject_offered;",
    "res": 0
  },
  {
    "sql_idx": 103,
    "ground_truth": "WITH FilteredLists AS ( SELECT ml.MOIRA_LIST_NAME, mlo.OWNER, COUNT(mld.MOIRA_LIST_MEMBER) AS TOTAL_MEMBER_COUNT FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN MOIRA_LIST_OWNER mlo ON mld.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY WHERE UPPER(ml.MOIRA_LIST_NAME) LIKE 'E%' GROUP BY ml.MOIRA_LIST_NAME, mlo.OWNER HAVING COUNT(mld.MOIRA_LIST_MEMBER) BETWEEN 10 AND 20 ), CSStudentCounts AS ( SELECT ml.MOIRA_LIST_NAME, COUNT(CASE WHEN msd.DEPARTMENT = '6' THEN 1 ELSE NULL END) AS CS_STUDENT_COUNT FROM FilteredLists fl JOIN MOIRA_LIST ml ON fl.MOIRA_LIST_NAME = ml.MOIRA_LIST_NAME JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN SE_PERSON se ON UPPER(mld.MOIRA_LIST_MEMBER) = UPPER(se.KRB_NAME) JOIN MIT_STUDENT_DIRECTORY msd ON se.FULL_NAME = msd.FULL_NAME GROUP BY ml.MOIRA_LIST_NAME ) SELECT fl.MOIRA_LIST_NAME, fl.OWNER, fl.TOTAL_MEMBER_COUNT FROM FilteredLists fl JOIN CSStudentCounts cs ON fl.MOIRA_LIST_NAME = cs.MOIRA_LIST_NAME WHERE cs.CS_STUDENT_COUNT > 0.75 * fl.TOTAL_MEMBER_COUNT;",
    "res": 0
  },
  {
    "sql_idx": 104,
    "ground_truth": "WITH MailingListSizes AS (SELECT ml.MOIRA_LIST_KEY, ml.MOIRA_LIST_NAME, COUNT(mld.MOIRA_LIST_MEMBER) AS List_Size FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY GROUP BY ml.MOIRA_LIST_KEY, ml.MOIRA_LIST_NAME) SELECT msd.FULL_NAME AS Student_Name, sad.DEPARTMENT_PHONE_NUMBER, COUNT(ml.MOIRA_LIST_KEY) AS Total_Lists, AVG(MLS.List_Size) AS Avg_List_Size FROM MIT_STUDENT_DIRECTORY msd JOIN SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE JOIN SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE JOIN SE_PERSON se ON msd.FULL_NAME = se.FULL_NAME JOIN MOIRA_LIST_DETAIL mld ON upper(se.KRB_NAME) = UPPER(mld.MOIRA_LIST_MEMBER) JOIN MOIRA_LIST ml ON mld.MOIRA_LIST_KEY = ml.MOIRA_LIST_KEY JOIN MailingListSizes MLS ON ml.MOIRA_LIST_KEY = MLS.MOIRA_LIST_KEY WHERE msd.LAST_NAME LIKE 'K%' GROUP BY msd.FULL_NAME, sad.DEPARTMENT_PHONE_NUMBER;",
    "res": 0
  },
  {
    "sql_idx": 105,
    "ground_truth": "SELECT lmc.MOIRA_LIST_NAME, lmc.Member_Count, lmc.IS_PUBLIC, dc.DEPARTMENT_NAME AS Most_Prominent_Department, dc.Student_Count FROM (SELECT ml.MOIRA_LIST_NAME, ml.IS_PUBLIC, COUNT(mld.MOIRA_LIST_MEMBER) AS Member_Count FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY GROUP BY ml.MOIRA_LIST_NAME, ml.IS_PUBLIC) lmc LEFT JOIN (SELECT lmc.MOIRA_LIST_NAME, lmc.DEPARTMENT_NAME, lmc.Student_Count, @rank := IF(@current_list = lmc.MOIRA_LIST_NAME, @rank + 1, 1) AS `Rank`, @current_list := lmc.MOIRA_LIST_NAME FROM (SELECT ml.MOIRA_LIST_NAME, sd.DEPARTMENT_NAME, COUNT(msd.FULL_NAME) AS Student_Count FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN SE_PERSON se ON UPPER(mld.MOIRA_LIST_MEMBER) = UPPER(se.KRB_NAME) JOIN MIT_STUDENT_DIRECTORY msd ON msd.FULL_NAME = se.FULL_NAME JOIN SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE GROUP BY ml.MOIRA_LIST_NAME, sd.DEPARTMENT_NAME) lmc CROSS JOIN (SELECT @rank := 0, @current_list := '') vars ORDER BY lmc.MOIRA_LIST_NAME, Student_Count DESC) dc ON lmc.MOIRA_LIST_NAME = dc.MOIRA_LIST_NAME AND dc.`Rank` = 1 ORDER BY lmc.Member_Count DESC LIMIT 100;",
    "res": 0
  },
  {
    "sql_idx": 106,
    "ground_truth": "SELECT b.BUILDING_NAME, b.BUILDING_NUMBER, SUM(f.ASSIGNABLE_AREA) AS TOTAL_ASSIGNABLE_AREA, SUM(f.NON_ASSIGNABLE_AREA) AS TOTAL_NON_ASSIGNABLE_AREA, COUNT(r.FAC_ROOM_KEY) AS TOTAL_ROOMS FROM FAC_BUILDING b JOIN FAC_FLOOR f ON b.FAC_BUILDING_KEY = f.BUILDING_KEY JOIN FAC_ROOMS r ON f.BUILDING_KEY = r.BUILDING_KEY AND f.FLOOR = r.FLOOR GROUP BY b.BUILDING_NAME, b.BUILDING_NUMBER ORDER BY TOTAL_ASSIGNABLE_AREA DESC;",
    "res": 0
  },
  {
    "sql_idx": 107,
    "ground_truth": "SELECT r.ROOM_FULL_NAME, MAX(r.AREA), mu.MAJOR_USE, MAX(o.ORGANIZATION_NAME), COUNT(r.FAC_ROOM_KEY) AS ROOM_COUNT, SUM(r.AREA) AS TOTAL_ROOM_AREA FROM FAC_ROOMS r JOIN FAC_MAJOR_USE mu ON r.MAJOR_USE_KEY = mu.MAJOR_USE_KEY JOIN FAC_ORGANIZATION o ON r.ORGANIZATION_KEY = o.ORGANIZATION_KEY WHERE r.BUILDING_KEY = 45 GROUP BY r.ROOM_FULL_NAME, mu.MAJOR_USE ORDER BY r.ROOM_FULL_NAME;",
    "res": 0
  },
  {
    "sql_idx": 108,
    "ground_truth": "SELECT b.BUILDING_NAME, b.BUILDING_NUMBER, b.DATE_BUILT, b.BUILDING_TYPE, COUNT(a.BUILDING_ADDRESS_KEY) AS ADDRESS_COUNT, AVG(b.EXT_GROSS_AREA) AS AVG_GROSS_AREA, COUNT(r.FAC_ROOM_KEY) AS TOTAL_ROOMS FROM FAC_BUILDING b JOIN FAC_BUILDING_ADDRESS a ON b.FAC_BUILDING_KEY = a.BUILDING_KEY JOIN FAC_ROOMS r ON b.FAC_BUILDING_KEY = r.BUILDING_KEY GROUP BY b.BUILDING_NAME, b.BUILDING_NUMBER, b.DATE_BUILT, b.BUILDING_TYPE ORDER BY b.BUILDING_NAME;",
    "res": 0
  },
  {
    "sql_idx": 109,
    "ground_truth": "SELECT lso.OFFER_DEPT_NAME AS DEPARTMENT, COUNT(DISTINCT lso.MASTER_COURSE_NUMBER) AS COURSE_COUNT, COUNT(DISTINCT lrc.CATALOG_TITLE) AS UNIQUE_MATERIALS, COUNT(DISTINCT lci.INSTRUCTOR_NAME) AS UNIQUE_INSTRUCTORS FROM LIBRARY_SUBJECT_OFFERED lso JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lso.LIBRARY_SUBJECT_OFFERED_KEY = lrmd.LIBRARY_SUBJECT_OFFERED_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrmd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY JOIN LIBRARY_COURSE_INSTRUCTOR lci ON lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY = lci.LIBRARY_COURSE_INSTRUCTOR_KEY GROUP BY lso.OFFER_DEPT_NAME ORDER BY COURSE_COUNT DESC;",
    "res": 0
  },
  {
    "sql_idx": 110,
    "ground_truth": "SELECT lso.SUBJECT_TITLE AS COURSE_TITLE, COUNT(lrmd.LIBRARY_RESERVE_CATALOG_KEY) AS TOTAL_MATERIALS, COUNT(DISTINCT lms.LIBRARY_MATERIAL_STATUS) AS STATUS_COUNT FROM LIBRARY_RESERVE_MATRL_DETAIL lrmd JOIN LIBRARY_SUBJECT_OFFERED lso ON lrmd.LIBRARY_SUBJECT_OFFERED_KEY = lso.LIBRARY_SUBJECT_OFFERED_KEY JOIN LIBRARY_MATERIAL_STATUS lms ON lrmd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY GROUP BY lso.SUBJECT_TITLE ORDER BY TOTAL_MATERIALS DESC;",
    "res": 0
  },
  {
    "sql_idx": 111,
    "ground_truth": "SELECT lci.INSTRUCTOR_NAME, COUNT(DISTINCT lci.COURSE_NAME) AS COURSE_COUNT, COUNT(lci.LIBRARY_COURSE_INSTRUCTOR_KEY) AS MATERIAL_ASSIGNMENTS, AVG(lrc.CATALOG_YEAR) AS AVG_PUBLICATION_YEAR, COUNT(DISTINCT lms.LIBRARY_MATERIAL_STATUS) AS STATUS_COUNT FROM LIBRARY_COURSE_INSTRUCTOR lci JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lci.LIBRARY_COURSE_INSTRUCTOR_KEY = lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY JOIN LIBRARY_RESERVE_CATALOG lrc ON lrmd.LIBRARY_RESERVE_CATALOG_KEY = lrc.LIBRARY_RESERVE_CATALOG_KEY JOIN LIBRARY_MATERIAL_STATUS lms ON lrmd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY GROUP BY lci.INSTRUCTOR_NAME ORDER BY COURSE_COUNT DESC;",
    "res": 0
  },
  {
    "sql_idx": 112,
    "ground_truth": "SELECT lrc.CATALOG_YEAR AS PUBLICATION_YEAR, COUNT(distinct lrc.LIBRARY_RESERVE_CATALOG_KEY) AS TOTAL_MATERIALS, AVG(LENGTH(lrc.CATALOG_TITLE)) AS AVG_TITLE_LENGTH, COUNT(DISTINCT lms.LIBRARY_MATERIAL_STATUS) AS STATUS_COUNT, COUNT(DISTINCT lci.COURSE_NAME) AS COURSE_COUNT FROM LIBRARY_RESERVE_CATALOG lrc JOIN LIBRARY_RESERVE_MATRL_DETAIL lrmd ON lrc.LIBRARY_RESERVE_CATALOG_KEY = lrmd.LIBRARY_RESERVE_CATALOG_KEY JOIN LIBRARY_MATERIAL_STATUS lms ON lrmd.LIBRARY_MATERIAL_STATUS_KEY = lms.LIBRARY_MATERIAL_STATUS_KEY JOIN LIBRARY_COURSE_INSTRUCTOR lci ON lrmd.LIBRARY_COURSE_INSTRUCTOR_KEY = lci.LIBRARY_COURSE_INSTRUCTOR_KEY GROUP BY lrc.CATALOG_YEAR ORDER BY PUBLICATION_YEAR DESC;",
    "res": 1
  },
  {
    "sql_idx": 113,
    "ground_truth": "SELECT isc.IAP_CATEGORY_NAME AS CATEGORY_NAME, iss.SPONSOR_NAME, COUNT(isd.IAP_SUBJECT_CATEGORY_KEY) AS ACTIVITY_COUNT, AVG(isd.FEE) AS AVG_FEE_PER_ACTIVITY FROM IAP_SUBJECT_DETAIL isd JOIN IAP_SUBJECT_CATEGORY isc ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY JOIN IAP_SUBJECT_SPONSOR iss ON isd.IAP_SUBJECT_SPONSOR_KEY = iss.IAP_SUBJECT_SPONSOR_KEY GROUP BY isc.IAP_CATEGORY_NAME, iss.SPONSOR_NAME ORDER BY ACTIVITY_COUNT DESC;",
    "res": 1
  },
  {
    "sql_idx": 114,
    "ground_truth": "SELECT iss.SPONSOR_NAME, COUNT(issp.IAP_SUBJECT_SESSION_KEY) AS SESSION_COUNT, COUNT(DISTINCT isd.IAP_SUBJECT_SESSION_KEY) AS UNIQUE_SUBJECTS FROM IAP_SUBJECT_SESSION issp JOIN IAP_SUBJECT_DETAIL isd ON issp.IAP_SUBJECT_SESSION_KEY = isd.IAP_SUBJECT_SESSION_KEY JOIN IAP_SUBJECT_SPONSOR iss ON isd.IAP_SUBJECT_SPONSOR_KEY = iss.IAP_SUBJECT_SPONSOR_KEY GROUP BY iss.SPONSOR_NAME ORDER BY SESSION_COUNT DESC;",
    "res": 0
  },
  {
    "sql_idx": 115,
    "ground_truth": "SELECT isp.PERSON_ROLE, isc.IAP_CATEGORY_NAME, COUNT(DISTINCT isp.IAP_SUBJECT_PERSON_KEY) AS ROLE_COUNT, AVG(isd.FEE) AS AVG_FEE FROM IAP_SUBJECT_PERSON isp JOIN IAP_SUBJECT_DETAIL isd ON isp.IAP_SUBJECT_PERSON_KEY = isd.IAP_SUBJECT_PERSON_KEY JOIN IAP_SUBJECT_CATEGORY isc ON isd.IAP_SUBJECT_CATEGORY_KEY = isc.IAP_SUBJECT_CATEGORY_KEY GROUP BY isp.PERSON_ROLE, isc.IAP_CATEGORY_NAME ORDER BY ROLE_COUNT DESC;",
    "res": 1
  },
  {
    "sql_idx": 116,
    "ground_truth": "WITH FloorsPerBuilding AS ( SELECT fb.BUILDING_NAME, MAX(ff.LEVEL_ID) - MIN(ff.LEVEL_ID) AS NUM_FLOORS FROM FAC_BUILDING fb JOIN FAC_ROOMS fr ON fb.FAC_BUILDING_KEY = fr.BUILDING_KEY JOIN FAC_FLOOR ff ON fr.FLOOR_KEY = ff.FLOOR_KEY GROUP BY fb.BUILDING_NAME ), MaxFloors AS ( SELECT MAX(NUM_FLOORS) AS MAX_FLOORS FROM FloorsPerBuilding ) SELECT a.BUILDING_NAME FROM FloorsPerBuilding a JOIN MaxFloors b ON a.NUM_FLOORS = b.MAX_FLOORS;",
    "res": 0
  },
  {
    "sql_idx": 117,
    "ground_truth": "SELECT ccso.SUBJECT_TITLE, COUNT(DISTINCT e.FULL_NAME) AS Num_Instructors, MAX(LENGTH(e.FULL_NAME)) AS Longest_Instructor_Name FROM EMPLOYEE_DIRECTORY e JOIN COURSE_CATALOG_SUBJECT_OFFERED ccso ON ccso.RESPONSIBLE_FACULTY_MIT_ID = e.MIT_ID JOIN ACADEMIC_TERMS_ALL at ON ccso.TERM_CODE = at.TERM_CODE WHERE at.TERM_CODE LIKE '%SU' GROUP BY ccso.SUBJECT_TITLE;",
    "res": 0
  },
  {
    "sql_idx": 118,
    "ground_truth": "SELECT mlo.OWNER, COUNT(DISTINCT ml.MOIRA_LIST_KEY) AS Total_Lists, COUNT(DISTINCT mld.MOIRA_LIST_MEMBER) AS Total_Members FROM MOIRA_LIST ml JOIN MOIRA_LIST_DETAIL mld ON ml.MOIRA_LIST_KEY = mld.MOIRA_LIST_KEY JOIN MOIRA_LIST_OWNER mlo ON mld.MOIRA_LIST_OWNER_KEY = mlo.MOIRA_LIST_OWNER_KEY WHERE mlo.MOIRA_LIST_OWNER_KEY = 'LIST69.377-keeper-xenon' GROUP BY mlo.OWNER;",
    "res": 1
  },
  {
    "sql_idx": 119,
    "ground_truth": "SELECT sd.SCHOOL_NAME, COUNT(DISTINCT scd.COURSE) AS Total_Courses, COUNT(CASE WHEN scd.IS_DEGREE_GRANTING = 'Y' THEN 1 END) AS Num_Degree_Granting_Y FROM SIS_COURSE_DESCRIPTION scd JOIN SIS_DEPARTMENT sd ON scd.DEPARTMENT = sd.DEPARTMENT_CODE JOIN SIS_SUBJECT_CODE ssc ON scd.COURSE = ssc.COURSE_NUMBER GROUP BY sd.SCHOOL_NAME;",
    "res": 1
  },
  {
    "sql_idx": 120,
    "ground_truth": "SELECT sd.DEPARTMENT_NAME, sad.DEPARTMENT_PHONE_NUMBER, COUNT(DISTINCT msd.EMAIL_ADDRESS) AS Num_Students, MAX(LENGTH(msd.FULL_NAME)) AS Longest_Student_Name_Length FROM MIT_STUDENT_DIRECTORY msd JOIN SIS_DEPARTMENT sd ON msd.DEPARTMENT = sd.DEPARTMENT_CODE JOIN SIS_ADMIN_DEPARTMENT sad ON sd.DEPARTMENT_CODE = sad.SIS_ADMIN_DEPARTMENT_CODE GROUP BY sd.DEPARTMENT_NAME, sad.DEPARTMENT_PHONE_NUMBER;",
    "res": 0
  }
]